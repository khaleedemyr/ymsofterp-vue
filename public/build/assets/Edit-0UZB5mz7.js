import{P as j,r as y,A as $,B as n,C as P,D as l,G as v,O as q,L as u,E as w,H as d,Q as r,J as p,F as c,M as x,N as k,I as V,x as F,S as O}from"./vendor-vue-g7iCcTkf.js";import{S as I}from"./app-D-uxhaxN.js";import{a as R}from"./vendor-utils-CpgP2uT4.js";import{A as H}from"./AppLayout-C6QNM8cp.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-cFrDwyHJ.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const G={class:"max-w-4xl w-full mx-auto py-8 px-2"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},W=["value"],X={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},J={class:"flex gap-2"},Q=["value"],z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Z=["value"],ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},le=["value"],te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={key:0},re={class:"grid grid-cols-4 gap-4"},oe=["src"],ae=["onClick"],ne={key:0,class:"mt-4 grid grid-cols-4 gap-4"},ue=["src"],de=["onClick"],ie={class:"flex justify-end gap-3 pt-4 border-t border-gray-200"},pe=["disabled"],be={key:0,class:"fa-solid fa-spinner fa-spin"},Ue={__name:"Edit",props:{asset:Object,categories:Array,outlets:Array,suppliers:Array,brands:Array},setup(b){const a=b,S=()=>{if(!a.asset.supplier)return null;const o=a.suppliers.find(e=>e.name===a.asset.supplier);return o?o.id:null},C=()=>{if(!a.asset.brand)return null;const o=a.brands.find(e=>e.name===a.asset.brand);return o?o.id:null},s=j({asset_code:a.asset.asset_code||"",name:a.asset.name||"",category_id:a.asset.category_id||"",brand:a.asset.brand||"",brand_id:C(),model:a.asset.model||"",serial_number:a.asset.serial_number||"",purchase_date:a.asset.purchase_date||"",purchase_price:a.asset.purchase_price||null,supplier_id:S(),supplier:a.asset.supplier||"",current_outlet_id:a.asset.current_outlet_id||null,status:a.asset.status||"Active",photos:[],description:a.asset.description||"",useful_life:a.asset.useful_life||null,warranty_expiry_date:a.asset.warranty_expiry_date||"",keep_existing_photos:!0}),m=y(a.asset.photos||[]),U=y([]),A=y([]),g=y(!1),f=y(""),B=y(!1);function E(o){const e=Array.from(o.target.files);A.value=[...A.value,...e],e.forEach(t=>{const i=new FileReader;i.onload=_=>{U.value.push(_.target.result)},i.readAsDataURL(t)})}function h(o){U.value.splice(o,1),A.value.splice(o,1)}function D(o){m.value.splice(o,1),s.keep_existing_photos=m.value.length>0}function M(){if(s.supplier_id){const o=a.suppliers.find(e=>e.id==s.supplier_id);o&&(s.supplier=o.name)}}function N(){if(s.brand_id==="new")g.value=!0,s.brand_id=null;else if(s.brand_id){const o=a.brands.find(e=>e.id==s.brand_id);o&&(s.brand=o.name),g.value=!1}else g.value=!1}async function T(){var o,e,t;if(!f.value||f.value.trim()===""){g.value=!1;return}B.value=!0;try{const i=await R.post("/asset-management/assets/create-brand",{name:f.value.trim()},{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});(o=i.data)!=null&&o.success&&(a.brands.push(i.data.data),s.brand_id=i.data.data.id,s.brand=i.data.data.name,f.value="",g.value=!1)}catch(i){I.fire("Error",((t=(e=i.response)==null?void 0:e.data)==null?void 0:t.message)||"Gagal membuat brand baru","error")}finally{B.value=!1}}function L(){const o=new FormData;Object.keys(s.data()).forEach(e=>{if(e!=="photos"){const t=s[e];t!=null&&o.append(e,t)}}),s.keep_existing_photos&&m.value.length>0&&m.value.forEach((e,t)=>{o.append(`existing_photos[${t}]`,e)}),A.value.forEach((e,t)=>{o.append(`photos[${t}]`,e)}),s.transform(()=>o).put(`/asset-management/assets/${a.asset.id}`,{forceFormData:!0,preserveScroll:!0})}return(o,e)=>(n(),$(H,null,{default:P(()=>[l("div",G,[e[42]||(e[42]=l("div",{class:"mb-6"},[l("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[l("i",{class:"fa-solid fa-edit text-blue-500"}),v(" Edit Asset ")])],-1)),l("form",{onSubmit:q(L,["prevent"]),class:"bg-white rounded-xl shadow-lg p-6 space-y-6"},[l("div",null,[e[17]||(e[17]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Asset Code",-1)),d(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>r(s).asset_code=t),required:"",disabled:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100"},null,512),[[p,r(s).asset_code]])]),l("div",K,[l("div",null,[e[18]||(e[18]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[v(" Nama Asset "),l("span",{class:"text-red-500"},"*")],-1)),d(l("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>r(s).name=t),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[p,r(s).name]])]),l("div",null,[e[20]||(e[20]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[v(" Kategori "),l("span",{class:"text-red-500"},"*")],-1)),d(l("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>r(s).category_id=t),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[19]||(e[19]=l("option",{value:""},"Pilih Kategori",-1)),(n(!0),u(c,null,x(b.categories,t=>(n(),u("option",{key:t.id,value:t.id},k(t.name),9,W))),128))],512),[[V,r(s).category_id]])])]),l("div",X,[l("div",null,[e[23]||(e[23]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Brand",-1)),l("div",J,[d(l("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>r(s).brand_id=t),onChange:N,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[21]||(e[21]=l("option",{value:null},"Pilih Brand",-1)),(n(!0),u(c,null,x(b.brands,t=>(n(),u("option",{key:t.id,value:t.id},k(t.name),9,Q))),128)),e[22]||(e[22]=l("option",{value:"new"},"+ Tambah Brand Baru",-1))],544),[[V,r(s).brand_id]])]),g.value?d((n(),u("input",{key:0,type:"text","onUpdate:modelValue":e[4]||(e[4]=t=>f.value=t),onBlur:T,placeholder:"Masukkan nama brand baru",class:"w-full mt-2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,544)),[[p,f.value]]):r(s).brand_id?w("",!0):d((n(),u("input",{key:1,type:"text","onUpdate:modelValue":e[5]||(e[5]=t=>r(s).brand=t),placeholder:"Atau masukkan brand manual",class:"w-full mt-2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512)),[[p,r(s).brand]])]),l("div",null,[e[24]||(e[24]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Model",-1)),d(l("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=t=>r(s).model=t),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[p,r(s).model]])])]),l("div",z,[l("div",null,[e[25]||(e[25]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Serial Number",-1)),d(l("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=t=>r(s).serial_number=t),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[p,r(s).serial_number]])]),l("div",null,[e[26]||(e[26]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Pembelian",-1)),d(l("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=t=>r(s).purchase_date=t),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[p,r(s).purchase_date]])])]),l("div",Y,[l("div",null,[e[27]||(e[27]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Harga Pembelian",-1)),d(l("input",{type:"number","onUpdate:modelValue":e[9]||(e[9]=t=>r(s).purchase_price=t),step:"0.01",min:"0",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[p,r(s).purchase_price]])]),l("div",null,[e[29]||(e[29]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Supplier",-1)),d(l("select",{"onUpdate:modelValue":e[10]||(e[10]=t=>r(s).supplier_id=t),onChange:M,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[28]||(e[28]=l("option",{value:null},"Pilih Supplier",-1)),(n(!0),u(c,null,x(b.suppliers,t=>(n(),u("option",{key:t.id,value:t.id},k(t.name),9,Z))),128))],544),[[V,r(s).supplier_id]]),r(s).supplier_id?w("",!0):d((n(),u("input",{key:0,type:"text","onUpdate:modelValue":e[11]||(e[11]=t=>r(s).supplier=t),placeholder:"Atau masukkan supplier manual",class:"w-full mt-2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512)),[[p,r(s).supplier]])])]),l("div",ee,[l("div",null,[e[31]||(e[31]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Outlet",-1)),d(l("select",{"onUpdate:modelValue":e[12]||(e[12]=t=>r(s).current_outlet_id=t),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[30]||(e[30]=l("option",{value:null},"Tidak Terikat Outlet",-1)),(n(!0),u(c,null,x(b.outlets,t=>(n(),u("option",{key:t.id,value:t.id},k(t.name),9,le))),128))],512),[[V,r(s).current_outlet_id]])]),l("div",null,[e[33]||(e[33]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[v(" Status "),l("span",{class:"text-red-500"},"*")],-1)),d(l("select",{"onUpdate:modelValue":e[13]||(e[13]=t=>r(s).status=t),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},e[32]||(e[32]=[l("option",{value:"Active"},"Active",-1),l("option",{value:"Maintenance"},"Maintenance",-1),l("option",{value:"Disposed"},"Disposed",-1),l("option",{value:"Lost"},"Lost",-1),l("option",{value:"Transfer"},"Transfer",-1)]),512),[[V,r(s).status]])])]),l("div",te,[l("div",null,[e[34]||(e[34]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Useful Life (Tahun)",-1)),d(l("input",{type:"number","onUpdate:modelValue":e[14]||(e[14]=t=>r(s).useful_life=t),min:"1",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[p,r(s).useful_life]])]),l("div",null,[e[35]||(e[35]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Warranty Expiry Date",-1)),d(l("input",{type:"date","onUpdate:modelValue":e[15]||(e[15]=t=>r(s).warranty_expiry_date=t),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[p,r(s).warranty_expiry_date]])])]),m.value.length>0?(n(),u("div",se,[e[37]||(e[37]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Existing Photos",-1)),l("div",re,[(n(!0),u(c,null,x(m.value,(t,i)=>(n(),u("div",{key:i,class:"relative"},[l("img",{src:`/storage/${t}`,alt:"Photo",class:"w-full h-24 object-cover rounded-lg"},null,8,oe),l("button",{type:"button",onClick:_=>D(i),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs"},e[36]||(e[36]=[l("i",{class:"fa-solid fa-times"},null,-1)]),8,ae)]))),128))])])):w("",!0),l("div",null,[e[39]||(e[39]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tambah Photos",-1)),l("input",{type:"file",onChange:E,multiple:"",accept:"image/*",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,32),U.value.length>0?(n(),u("div",ne,[(n(!0),u(c,null,x(U.value,(t,i)=>(n(),u("div",{key:i,class:"relative"},[l("img",{src:t,alt:"Preview",class:"w-full h-24 object-cover rounded-lg"},null,8,ue),l("button",{type:"button",onClick:_=>h(i),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs"},e[38]||(e[38]=[l("i",{class:"fa-solid fa-times"},null,-1)]),8,de)]))),128))])):w("",!0)]),l("div",null,[e[40]||(e[40]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Deskripsi",-1)),d(l("textarea",{"onUpdate:modelValue":e[16]||(e[16]=t=>r(s).description=t),rows:"4",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[p,r(s).description]])]),l("div",ie,[F(r(O),{href:`/asset-management/assets/${b.asset.id}`,class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"},{default:P(()=>e[41]||(e[41]=[v(" Batal ")])),_:1},8,["href"]),l("button",{type:"submit",disabled:r(s).processing,class:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg flex items-center gap-2 disabled:opacity-50"},[r(s).processing?(n(),u("i",be)):w("",!0),l("span",null,k(r(s).processing?"Menyimpan...":"Simpan"),1)],8,pe)])],32)])]),_:1}))}};export{Ue as default};
