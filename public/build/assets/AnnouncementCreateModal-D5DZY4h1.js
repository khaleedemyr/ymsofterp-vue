import{r as m,P as N,c as k,L as s,E as V,B as a,D as t,Q as f,F as d,M as c,O,H as x,J as h,N as v,l as T,G as g}from"./vendor-vue-g7iCcTkf.js";import"./vendor-utils-CpgP2uT4.js";const J={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},q={class:"bg-white rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl border border-blue-100 relative"},z={class:"flex justify-between items-center mb-4"},I={key:0,class:"mb-4 p-4 bg-red-100 text-red-700 rounded"},K={class:"mb-4"},P={class:"mb-4"},G={class:"mb-4"},Q={class:"mb-4"},R={class:"mb-4"},W={class:"flex gap-2 mb-2"},X=["onClick"],Y={key:0},Z={class:"border rounded mb-2 h-32 overflow-y-auto"},ee=["onClick"],te=["checked"],le={class:"flex flex-wrap gap-2 mt-2"},se=["onClick"],ae={key:1},ne={class:"border rounded mb-2 h-32 overflow-y-auto"},oe=["onClick"],ie=["checked"],ue={class:"flex flex-wrap gap-2 mt-2"},re=["onClick"],de={key:2},ce={class:"border rounded mb-2 h-32 overflow-y-auto"},ve=["onClick"],pe=["checked"],be={class:"flex flex-wrap gap-2 mt-2"},me=["onClick"],fe={key:3},_e={class:"border rounded mb-2 h-32 overflow-y-auto"},xe=["onClick"],he=["checked"],ye={class:"flex flex-wrap gap-2 mt-2"},ke=["onClick"],ge={key:4},Ce={class:"border rounded mb-2 h-32 overflow-y-auto"},we=["onClick"],je=["checked"],$e={class:"flex flex-wrap gap-2 mt-2"},Le=["onClick"],Ve={class:"flex justify-end gap-2 mt-2"},Ae=["disabled"],Se=["disabled"],Ue={key:0},He={key:1},Ee={__name:"AnnouncementCreateModal",props:{users:Array,jabatans:Array,divisis:Array,levels:Array,outlets:Array,show:Boolean},emits:["close","success"],setup(A,{emit:U}){const i=A,S=U,_=m("user"),n=m({user:[],jabatan:[],divisi:[],level:[],outlet:[]}),p=N({title:"",content:"",image:null,files:[],targets:[]}),y=m(!1),C=m(""),w=m(""),j=m(""),$=m(""),L=m(""),H=k(()=>C.value?i.users.filter(u=>u.nama_lengkap.toLowerCase().includes(C.value.toLowerCase())):i.users),B=k(()=>w.value?i.jabatans.filter(u=>u.nama_jabatan.toLowerCase().includes(w.value.toLowerCase())):i.jabatans),D=k(()=>j.value?i.divisis.filter(u=>u.nama_divisi.toLowerCase().includes(j.value.toLowerCase())):i.divisis),E=k(()=>$.value?i.levels.filter(u=>u.nama_level.toLowerCase().includes($.value.toLowerCase())):i.levels),M=k(()=>L.value?i.outlets.filter(u=>u.nama_outlet.toLowerCase().includes(L.value.toLowerCase())):i.outlets);function F(){p.targets=[],Object.entries(n.value).forEach(([u,l])=>{l.forEach(e=>p.targets.push({type:u,id:e}))}),y.value=!0,p.post(route("announcement.store"),{forceFormData:!0,onSuccess:()=>{y.value=!1,S("success"),S("close")},onError:()=>{y.value=!1}})}return(u,l)=>A.show?(a(),s("div",J,[t("div",q,[t("div",z,[l[11]||(l[11]=t("h2",{class:"text-xl font-bold text-blue-800"},"Buat Announcement",-1)),t("button",{onClick:l[0]||(l[0]=e=>u.$emit("close")),class:"text-gray-400 hover:text-blue-600 text-2xl"},"×")]),Object.keys(f(p).errors).length?(a(),s("div",I,[t("ul",null,[(a(!0),s(d,null,c(f(p).errors,(e,o)=>(a(),s("li",{key:o},v(e),1))),128))])])):V("",!0),t("form",{onSubmit:O(F,["prevent"])},[t("div",K,[l[12]||(l[12]=t("label",{class:"block font-medium mb-1"},"Judul",-1)),x(t("input",{"onUpdate:modelValue":l[1]||(l[1]=e=>f(p).title=e),class:"input w-full",required:""},null,512),[[h,f(p).title]])]),t("div",P,[l[13]||(l[13]=t("label",{class:"block font-medium mb-1"},"Isi Konten",-1)),x(t("textarea",{"onUpdate:modelValue":l[2]||(l[2]=e=>f(p).content=e),class:"input w-full",rows:"4",required:""},null,512),[[h,f(p).content]])]),t("div",G,[l[14]||(l[14]=t("label",{class:"block font-medium mb-1"},"Header Image",-1)),t("input",{type:"file",onChange:l[3]||(l[3]=e=>f(p).image=e.target.files[0]),accept:"image/*",class:"input w-full"},null,32)]),t("div",Q,[l[15]||(l[15]=t("label",{class:"block font-medium mb-1"},"Lampiran File (bisa multiple)",-1)),t("input",{type:"file",multiple:"",onChange:l[4]||(l[4]=e=>f(p).files=Array.from(e.target.files)),class:"input w-full"},null,32)]),t("div",R,[l[16]||(l[16]=t("label",{class:"block font-medium mb-1"},"Pilih Target",-1)),t("div",W,[(a(),s(d,null,c(["user","jabatan","divisi","level","outlet"],e=>t("button",{key:e,type:"button",class:T(["px-3 py-1 rounded",_.value===e?"bg-blue-600 text-white":"bg-gray-200"]),onClick:o=>_.value=e},v(e.charAt(0).toUpperCase()+e.slice(1)),11,X)),64))]),_.value==="user"?(a(),s("div",Y,[x(t("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>C.value=e),type:"text",placeholder:"Cari user...",class:"input w-full mb-2"},null,512),[[h,C.value]]),t("div",Z,[(a(!0),s(d,null,c(H.value,e=>(a(),s("div",{key:e.id,class:"flex items-center px-2 py-1 hover:bg-blue-50 cursor-pointer",onClick:o=>!n.value.user.includes(e.id)&&n.value.user.push(e.id)},[t("input",{type:"checkbox",checked:n.value.user.includes(e.id),class:"mr-2"},null,8,te),t("span",null,v(e.nama_lengkap),1)],8,ee))),128))]),t("div",le,[(a(!0),s(d,null,c(n.value.user,e=>{var o;return a(),s("span",{key:e,class:"bg-blue-100 text-blue-700 px-2 py-1 rounded flex items-center"},[g(v(((o=i.users.find(r=>r.id===e))==null?void 0:o.nama_lengkap)||e)+" ",1),t("button",{type:"button",class:"ml-1 text-red-500 hover:text-red-700",onClick:r=>n.value.user=n.value.user.filter(b=>b!==e),title:"Hapus"},"×",8,se)])}),128))])])):_.value==="jabatan"?(a(),s("div",ae,[x(t("input",{"onUpdate:modelValue":l[6]||(l[6]=e=>w.value=e),type:"text",placeholder:"Cari jabatan...",class:"input w-full mb-2"},null,512),[[h,w.value]]),t("div",ne,[(a(!0),s(d,null,c(B.value,e=>(a(),s("div",{key:e.id_jabatan,class:"flex items-center px-2 py-1 hover:bg-blue-50 cursor-pointer",onClick:o=>!n.value.jabatan.includes(e.id_jabatan)&&n.value.jabatan.push(e.id_jabatan)},[t("input",{type:"checkbox",checked:n.value.jabatan.includes(e.id_jabatan),class:"mr-2"},null,8,ie),t("span",null,v(e.nama_jabatan),1)],8,oe))),128))]),t("div",ue,[(a(!0),s(d,null,c(n.value.jabatan,e=>{var o;return a(),s("span",{key:e,class:"bg-blue-100 text-blue-700 px-2 py-1 rounded flex items-center"},[g(v(((o=i.jabatans.find(r=>r.id_jabatan===e))==null?void 0:o.nama_jabatan)||e)+" ",1),t("button",{type:"button",class:"ml-1 text-red-500 hover:text-red-700",onClick:r=>n.value.jabatan=n.value.jabatan.filter(b=>b!==e),title:"Hapus"},"×",8,re)])}),128))])])):_.value==="divisi"?(a(),s("div",de,[x(t("input",{"onUpdate:modelValue":l[7]||(l[7]=e=>j.value=e),type:"text",placeholder:"Cari divisi...",class:"input w-full mb-2"},null,512),[[h,j.value]]),t("div",ce,[(a(!0),s(d,null,c(D.value,e=>(a(),s("div",{key:e.id,class:"flex items-center px-2 py-1 hover:bg-blue-50 cursor-pointer",onClick:o=>!n.value.divisi.includes(e.id)&&n.value.divisi.push(e.id)},[t("input",{type:"checkbox",checked:n.value.divisi.includes(e.id),class:"mr-2"},null,8,pe),t("span",null,v(e.nama_divisi),1)],8,ve))),128))]),t("div",be,[(a(!0),s(d,null,c(n.value.divisi,e=>{var o;return a(),s("span",{key:e,class:"bg-blue-100 text-blue-700 px-2 py-1 rounded flex items-center"},[g(v(((o=i.divisis.find(r=>r.id===e))==null?void 0:o.nama_divisi)||e)+" ",1),t("button",{type:"button",class:"ml-1 text-red-500 hover:text-red-700",onClick:r=>n.value.divisi=n.value.divisi.filter(b=>b!==e),title:"Hapus"},"×",8,me)])}),128))])])):_.value==="level"?(a(),s("div",fe,[x(t("input",{"onUpdate:modelValue":l[8]||(l[8]=e=>$.value=e),type:"text",placeholder:"Cari level...",class:"input w-full mb-2"},null,512),[[h,$.value]]),t("div",_e,[(a(!0),s(d,null,c(E.value,e=>(a(),s("div",{key:e.id,class:"flex items-center px-2 py-1 hover:bg-blue-50 cursor-pointer",onClick:o=>!n.value.level.includes(e.id)&&n.value.level.push(e.id)},[t("input",{type:"checkbox",checked:n.value.level.includes(e.id),class:"mr-2"},null,8,he),t("span",null,v(e.nama_level),1)],8,xe))),128))]),t("div",ye,[(a(!0),s(d,null,c(n.value.level,e=>{var o;return a(),s("span",{key:e,class:"bg-blue-100 text-blue-700 px-2 py-1 rounded flex items-center"},[g(v(((o=i.levels.find(r=>r.id===e))==null?void 0:o.nama_level)||e)+" ",1),t("button",{type:"button",class:"ml-1 text-red-500 hover:text-red-700",onClick:r=>n.value.level=n.value.level.filter(b=>b!==e),title:"Hapus"},"×",8,ke)])}),128))])])):_.value==="outlet"?(a(),s("div",ge,[x(t("input",{"onUpdate:modelValue":l[9]||(l[9]=e=>L.value=e),type:"text",placeholder:"Cari outlet...",class:"input w-full mb-2"},null,512),[[h,L.value]]),t("div",Ce,[(a(!0),s(d,null,c(M.value,e=>(a(),s("div",{key:e.id_outlet,class:"flex items-center px-2 py-1 hover:bg-blue-50 cursor-pointer",onClick:o=>!n.value.outlet.includes(e.id_outlet)&&n.value.outlet.push(e.id_outlet)},[t("input",{type:"checkbox",checked:n.value.outlet.includes(e.id_outlet),class:"mr-2"},null,8,je),t("span",null,v(e.nama_outlet),1)],8,we))),128))]),t("div",$e,[(a(!0),s(d,null,c(n.value.outlet,e=>{var o;return a(),s("span",{key:e,class:"bg-blue-100 text-blue-700 px-2 py-1 rounded flex items-center"},[g(v(((o=i.outlets.find(r=>r.id_outlet===e))==null?void 0:o.nama_outlet)||e)+" ",1),t("button",{type:"button",class:"ml-1 text-red-500 hover:text-red-700",onClick:r=>n.value.outlet=n.value.outlet.filter(b=>b!==e),title:"Hapus"},"×",8,Le)])}),128))])])):V("",!0)]),t("div",Ve,[t("button",{type:"button",onClick:l[10]||(l[10]=e=>u.$emit("close")),disabled:y.value,class:"px-4 py-2 rounded font-semibold bg-gray-200 hover:bg-gray-300 text-gray-700 transition disabled:opacity-60"}," Cancel ",8,Ae),t("button",{type:"submit",disabled:y.value,class:"px-4 py-2 rounded font-semibold bg-blue-600 hover:bg-blue-700 text-white transition disabled:opacity-60"},[y.value?(a(),s("span",Ue,"Menyimpan...")):(a(),s("span",He,"Kirim"))],8,Se)])],32)])])):V("",!0)}};export{Ee as default};
