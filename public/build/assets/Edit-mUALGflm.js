import{r as n,$ as N,a as V,L as o,B as i,D as t,E as B,G as b,N as u,l as C,H as m,J as g,I as w,F as S,M as E,O as L}from"./vendor-vue-g7iCcTkf.js";import{a as c}from"./vendor-utils-CpgP2uT4.js";import{S as T}from"./app-C51E4rvH.js";import{A as q}from"./AppLayout-BE0dNalr.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-D219A2Up.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const A={class:"max-w-7xl mx-auto py-6"},F={class:"flex justify-between items-center mb-6"},U={class:"flex gap-3"},$=["href"],K={key:0,class:"text-center py-12"},j={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-6"},G={class:"flex items-center"},W={class:"text-red-700 mt-1"},z={key:2,class:"bg-white rounded-lg shadow p-6"},H={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},J=["value"],Y={class:"md:col-span-2"},Q={class:"md:col-span-2"},X=["value"],Z=["value"],h={class:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-200"},ee=["disabled"],te={key:0,class:"fas fa-spinner fa-spin mr-2"},se={key:1,class:"fas fa-save mr-2"},ae={layout:q},le=Object.assign(ae,{__name:"Edit",props:{id:String},setup(y){const f=y,l=n(null),v=n(!0),p=n(null),d=n(!1),x=n([]),k=n([]),a=n({title:"",description:"",priority_id:"",label_id:"",due_date:""});N();async function _(){var r,e;try{v.value=!0,p.value=null;const[s,D,I]=await Promise.all([c.get(`/api/maintenance-order/${f.id}`),c.get("/api/maintenance-priorities"),c.get("/api/maintenance-labels")]);l.value=s.data,x.value=D.data,k.value=I.data,a.value={title:l.value.title,description:l.value.description,priority_id:l.value.priority_id,label_id:l.value.label_id,due_date:l.value.due_date?new Date(l.value.due_date).toISOString().split("T")[0]:""}}catch(s){console.error("Error loading task:",s),p.value=((e=(r=s.response)==null?void 0:r.data)==null?void 0:e.error)||"Failed to load task details"}finally{v.value=!1}}async function R(){var r,e;try{d.value=!0;const s=await c.put(`/api/maintenance-order/${f.id}`,a.value);if(s.data.success)T.fire({title:"Success!",text:"Task updated successfully",icon:"success",confirmButtonText:"OK"}).then(()=>{window.location.href=`/maintenance-order/${f.id}`});else throw new Error(s.data.error||"Failed to update task")}catch(s){console.error("Error saving task:",s),T.fire({title:"Error!",text:((e=(r=s.response)==null?void 0:r.data)==null?void 0:e.error)||"Failed to update task",icon:"error",confirmButtonText:"OK"})}finally{d.value=!1}}function O(r){return{TASK:"To Do",PR:"Purchase Requisition",PO:"Purchase Order",IN_PROGRESS:"In Progress",IN_REVIEW:"In Review",DONE:"Done"}[r]||r}function P(r){return{TASK:"bg-gray-100 text-gray-800",PR:"bg-yellow-100 text-yellow-800",PO:"bg-blue-100 text-blue-800",IN_PROGRESS:"bg-purple-100 text-purple-800",IN_REVIEW:"bg-orange-100 text-orange-800",DONE:"bg-green-100 text-green-800"}[r]||"bg-gray-100 text-gray-800"}return V(()=>{_(),document.title="Edit Task - YMSoft"}),(r,e)=>(i(),o("div",A,[t("div",F,[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold text-blue-900"},"Edit Task",-1)),t("div",U,[e[6]||(e[6]=t("a",{href:"/maintenance-order/list",class:"btn-secondary"},[t("i",{class:"fas fa-arrow-left mr-2"}),b(" Back to List ")],-1)),t("a",{href:`/maintenance-order/${y.id}`,class:"btn-secondary"},e[5]||(e[5]=[t("i",{class:"fas fa-eye mr-2"},null,-1),b(" View Task ")]),8,$)])]),v.value?(i(),o("div",K,e[8]||(e[8]=[t("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-600"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Loading task details...",-1)]))):p.value?(i(),o("div",j,[t("div",G,[e[10]||(e[10]=t("i",{class:"fas fa-exclamation-triangle text-red-600 text-xl mr-3"},null,-1)),t("div",null,[e[9]||(e[9]=t("h3",{class:"text-lg font-medium text-red-800"},"Error Loading Task",-1)),t("p",W,u(p.value),1)])]),t("div",{class:"mt-4"},[t("button",{onClick:_,class:"btn-primary"},e[11]||(e[11]=[t("i",{class:"fas fa-redo mr-2"},null,-1),b(" Try Again ")]))])])):l.value?(i(),o("div",z,[t("form",{onSubmit:L(R,["prevent"])},[t("div",H,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"Task Number",-1)),t("input",{type:"text",value:l.value.task_number,disabled:"",class:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-500"},null,8,J)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),t("span",{class:C([P(l.value.status),"mt-1 inline-block px-3 py-2 text-sm font-medium rounded-md"])},u(O(l.value.status)),3)]),t("div",Y,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700"},"Title *",-1)),m(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.value.title=s),type:"text",required:"",class:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter task title"},null,512),[[g,a.value.title]])]),t("div",Q,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700"},"Description *",-1)),m(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.description=s),rows:"4",required:"",class:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter task description"},null,512),[[g,a.value.description]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700"},"Priority *",-1)),m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.priority_id=s),required:"",class:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[e[16]||(e[16]=t("option",{value:""},"Select Priority",-1)),(i(!0),o(S,null,E(x.value,s=>(i(),o("option",{key:s.id,value:s.id},u(s.priority),9,X))),128))],512),[[w,a.value.priority_id]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700"},"Category *",-1)),m(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.label_id=s),required:"",class:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},[e[18]||(e[18]=t("option",{value:""},"Select Category",-1)),(i(!0),o(S,null,E(k.value,s=>(i(),o("option",{key:s.id,value:s.id},u(s.name),9,Z))),128))],512),[[w,a.value.label_id]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Due Date *",-1)),m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.due_date=s),type:"date",required:"",class:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"},null,512),[[g,a.value.due_date]])])]),t("div",h,[e[21]||(e[21]=t("a",{href:"/maintenance-order/list",class:"btn-secondary"}," Cancel ",-1)),t("button",{type:"submit",disabled:d.value,class:"btn-primary"},[d.value?(i(),o("i",te)):(i(),o("i",se)),b(" "+u(d.value?"Saving...":"Save Changes"),1)],8,ee)])],32)])):B("",!0)]))}}),fe=M(le,[["__scopeId","data-v-586d9e7f"]]);export{fe as default};
