import{P as A,r as v,A as D,B as i,C as q,D as e,G as x,O as y,L as r,E as S,H as d,Q as o,F as g,M as f,N as w,I as k,J as m}from"./vendor-vue-g7iCcTkf.js";import{S as C}from"./app-BGYKUG_N.js";import{A as j}from"./AppLayout-Cbd4awZb.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-BnNxTHIx.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const E={class:"max-w-xl w-full mx-auto py-8 px-2"},O={class:"flex justify-between items-center mb-6"},T={class:"bg-white rounded-xl shadow-lg p-6"},L={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},M=["value"],$=["value"],F={class:"grid grid-cols-1 gap-4 mb-4"},G={class:"mb-4"},N={key:0,class:"mb-4"},R={class:"flex flex-wrap gap-2"},K=["src"],H=["onClick"],J=["src"],Q=["onClick"],Y={class:"mt-6 flex justify-end"},z=["disabled"],W={key:0,class:"fa-solid fa-spinner fa-spin"},X={key:1,class:"fa-solid fa-save"},nt={__name:"ActionPlanGuestReviewEdit",props:{plan:Object,outlets:Array,pics:Array},setup(B){const a=B,s=A({outlet:a.plan.outlet,tanggal:a.plan.tanggal,dept:a.plan.dept,pic:a.plan.pic,problem:a.plan.problem,analisa:a.plan.analisa,preventive:a.plan.preventive,status:a.plan.status,documentation:[]}),p=v([...a.plan.images]),U=v([]),b=v([]),P=n=>{const t=n.target.files;for(let l=0;l<t.length;l++){const u=t[l];s.documentation.push(u);const c=URL.createObjectURL(u);b.value.push(c)}},h=n=>{s.documentation.splice(n,1),b.value.splice(n,1)},I=n=>{U.value.push(n);const t=p.value.findIndex(l=>l.id===n);t!==-1&&p.value.splice(t,1)},V=async()=>{(await C.fire({title:"Konfirmasi",text:"Apakah anda yakin ingin update data ini?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Update",cancelButtonText:"Batal",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})).isConfirmed&&s.put(`/ops-kitchen/action-plan-guest-review/${a.plan.id}`,{data:{deleted_images:U.value},onSuccess:()=>{C.fire({title:"Berhasil!",text:"Data berhasil diupdate",icon:"success",confirmButtonColor:"#3085d6"})},onError:t=>{C.fire({title:"Error!",text:"Terjadi kesalahan saat update data",icon:"error",confirmButtonColor:"#3085d6"})}})};return(n,t)=>(i(),D(j,null,{default:q(()=>[e("div",E,[e("div",O,[t[10]||(t[10]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-clipboard-list text-blue-500"}),x(" Edit Action Plan Guest Review ")],-1)),e("button",{onClick:t[0]||(t[0]=l=>n.$inertia.visit("/ops-kitchen/action-plan-guest-review")),class:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center gap-2"},t[9]||(t[9]=[e("i",{class:"fa-solid fa-arrow-left"},null,-1),x(" Kembali ")]))]),e("div",T,[e("form",{onSubmit:y(V,["prevent"])},[t[26]||(t[26]=e("h2",{class:"text-lg font-semibold text-gray-800 mb-2"},"Informasi Umum",-1)),e("div",L,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700"},"Outlet",-1)),d(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>o(s).outlet=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},[t[11]||(t[11]=e("option",{value:""},"Pilih Outlet",-1)),(i(!0),r(g,null,f(a.outlets,l=>(i(),r("option",{key:l.id_outlet,value:l.id_outlet},w(l.nama_outlet),9,M))),128))],512),[[k,o(s).outlet]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Tanggal",-1)),d(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=l=>o(s).tanggal=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[m,o(s).tanggal]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Dept. Concern",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=l=>o(s).dept=l),readonly:"",class:"mt-1 block w-full rounded-md border-gray-300 bg-gray-50 shadow-sm"},null,512),[[m,o(s).dept]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700"},"PIC",-1)),d(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).pic=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},[t[15]||(t[15]=e("option",{value:""},"Pilih PIC",-1)),(i(!0),r(g,null,f(a.pics,l=>(i(),r("option",{key:l.id,value:l.id},w(l.nama_lengkap),9,$))),128))],512),[[k,o(s).pic]])])]),t[27]||(t[27]=e("h2",{class:"text-lg font-semibold text-gray-800 mb-2 mt-6"},"Detail Komplain",-1)),e("div",F,[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"Problem",-1)),d(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>o(s).problem=l),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[m,o(s).problem]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700"},"Analisa",-1)),d(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=l=>o(s).analisa=l),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[m,o(s).analisa]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700"},"Preventive Action",-1)),d(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=l=>o(s).preventive=l),rows:"2",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},null,512),[[m,o(s).preventive]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),d(e("select",{"onUpdate:modelValue":t[8]||(t[8]=l=>o(s).status=l),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:""},t[20]||(t[20]=[e("option",{value:""},"Pilih Status",-1),e("option",{value:"Done"},"Done",-1),e("option",{value:"Progress"},"Progress",-1)]),512),[[k,o(s).status]])])]),t[28]||(t[28]=e("h2",{class:"text-lg font-semibold text-gray-800 mb-2 mt-6"},"Dokumentasi",-1)),e("div",G,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Upload Foto (max 5)",-1)),e("input",{type:"file",multiple:"",onChange:P,accept:"image/*",class:"mt-1 block w-full"},null,32)]),b.value.length>0||p.value.length>0?(i(),r("div",N,[t[25]||(t[25]=e("div",{class:"font-bold mb-2"},"Preview Gambar:",-1)),e("div",R,[(i(!0),r(g,null,f(p.value,(l,u)=>(i(),r("div",{key:"old"+l.id,class:"relative"},[e("img",{src:"/storage/"+l.path,style:{"max-width":"90px","max-height":"90px","border-radius":"8px","object-fit":"cover"}},null,8,K),e("button",{onClick:y(c=>I(l.id),["prevent"]),class:"absolute top-1 right-1 text-red-500 bg-white rounded-full p-1"},t[23]||(t[23]=[e("i",{class:"fa-solid fa-xmark"},null,-1)]),8,H)]))),128)),(i(!0),r(g,null,f(b.value,(l,u)=>(i(),r("div",{key:"new"+u,class:"relative"},[e("img",{src:l,style:{"max-width":"90px","max-height":"90px","border-radius":"8px","object-fit":"cover"}},null,8,J),e("button",{onClick:y(c=>h(u),["prevent"]),class:"absolute top-1 right-1 text-red-500 bg-white rounded-full p-1"},t[24]||(t[24]=[e("i",{class:"fa-solid fa-xmark"},null,-1)]),8,Q)]))),128))])])):S("",!0),e("div",Y,[e("button",{type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg flex items-center gap-2",disabled:o(s).processing},[o(s).processing?(i(),r("i",W)):(i(),r("i",X)),x(" "+w(o(s).processing?"Menyimpan...":"Update"),1)],8,z)])],32)])])]),_:1}))}};export{nt as default};
