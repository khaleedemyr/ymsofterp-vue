import{r as a,W as d,w as E,A as W,B as l,C as O,D as e,x as k,G as m,Q as Y,l as g,H as q,J,L as r,F as L,M as I,N as u,E as T}from"./vendor-vue-g7iCcTkf.js";import{l as K}from"./lodash-DB3HVzpp.js";import{S as n}from"./app-V2AeMLhf.js";import{A as P}from"./AppLayout-IVexHyAO.js";import X from"./OutletFormModal-DjhMbbeS.js";import{a as j}from"./vendor-utils-CpgP2uT4.js";import Z from"./OutletMapModal-BzBZJ_UU.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as te}from"./vendor-ui-CrPgGUUb.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-BZZ_tA4T.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./PickLocationMapModal-Bsonypp7.js";const se={class:"max-w-7xl w-full mx-auto py-8 px-2"},oe={class:"flex items-center gap-3 mb-4"},ae={class:"mb-4"},le={class:"bg-white rounded-2xl shadow-lg overflow-hidden"},re={class:"overflow-x-auto"},ne={class:"min-w-full divide-y divide-gray-200"},ie={class:"bg-white divide-y divide-gray-200"},de={class:"px-6 py-3 font-semibold"},ue={class:"px-6 py-3"},ce={class:"max-w-xs"},pe={class:"text-sm"},xe={key:0,class:"text-xs text-gray-500 mt-1"},me={class:"px-6 py-3"},ge={class:"px-6 py-3"},fe={class:"flex items-center gap-2"},ve={class:"text-xs font-mono bg-gray-100 px-2 py-1 rounded"},be=["href"],he={class:"px-6 py-3"},we={key:0},ye=["onClick"],_e={key:1},ke={class:"px-6 py-3"},Ce=["onClick"],Me={class:"px-6 py-3"},$e={class:"flex gap-2"},De=["onClick"],Be=["onClick"],Se={class:"flex justify-end mt-4 gap-2"},Ee=["disabled","onClick","innerHTML"],Oe={__name:"Index",props:{outlets:Object,filters:Object},setup(f){var S;const c=a(((S=f.filters)==null?void 0:S.search)||""),i=a(!1),p=a(!1),v=a("create"),b=a(null),x=a({regions:[]}),h=a(!1),w=a(!1),C=a(null),M=a(null),$=a(""),A=K.debounce(()=>{d.get("/outlets",{search:c.value,status:i.value?"inactive":"active"},{preserveState:!0,replace:!0})},400);E(i,s=>{d.get("/outlets",{search:c.value,status:s?"inactive":"active"},{preserveState:!0,replace:!0})});function V(){A()}function H(s){s&&d.visit(s,{preserveState:!0,replace:!0})}function N(){v.value="create",b.value=null,B(),p.value=!0}function F(s){v.value="edit",b.value=s,B(),p.value=!0}async function U(s){(await n.fire({title:"Hapus Outlet?",text:`Yakin ingin menghapus outlet "${s.nama_outlet}"?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed&&d.delete(route("outlets.destroy",s.id_outlet),{onSuccess:()=>n.fire("Berhasil","Outlet berhasil dihapus!","success")})}function D(){d.reload({preserveState:!0,replace:!0})}function G(){p.value=!1}function Q(s){d.patch(route("outlets.toggle-status",s.id_outlet),{},{preserveState:!0,onSuccess:D})}async function B(){h.value=!0;try{const s=await j.get(route("outlets.dropdown-data"));s.data.success?(x.value={regions:s.data.regions||[]},console.log("Dropdown data loaded:",x.value)):(console.error("Failed to load dropdown data:",s.data.message),n.fire({icon:"error",title:"Error",text:"Gagal memuat data dropdown: "+(s.data.message||"Unknown error")}))}catch(s){console.error("Error fetching dropdown data:",s),n.fire({icon:"error",title:"Error",text:"Gagal memuat data dropdown. Silakan coba lagi."})}finally{h.value=!1}}async function R(){try{const s=await j.get(route("outlets.debug-database"));console.log("Debug data:",s.data),s.data.success?n.fire({icon:"success",title:"Debug Info",html:`
          <div class="text-left">
            <p><strong>Connection:</strong> ${s.data.debug.connection}</p>
            <p><strong>Tables:</strong></p>
            <ul class="list-disc list-inside">
              ${Object.entries(s.data.debug.tables||{}).map(([o,t])=>`<li>${o}: ${t.exists?`Exists (${t.total_count} records, ${t.active_count} active)`:`Error: ${t.error}`}</li>`).join("")}
            </ul>
            <p><strong>Models:</strong></p>
            <ul class="list-disc list-inside">
              ${Object.entries(s.data.debug.models||{}).map(([o,t])=>`<li>${o}: ${t.error?`Error: ${t.error}`:`${t.total} total, ${t.active} active`}</li>`).join("")}
            </ul>
          </div>
        `,width:"600px"}):n.fire({icon:"error",title:"Debug Error",text:s.data.error||"Unknown error"})}catch(s){console.error("Debug error:",s),n.fire({icon:"error",title:"Debug Error",text:"Failed to get debug information"})}}E(x,s=>{console.log("Dropdown data changed:",s)},{deep:!0});function z(s){C.value=s.lat,M.value=s.long,$.value=s.lokasi||s.nama_outlet,w.value=!0}return(s,o)=>(l(),W(P,null,{default:O(()=>[e("div",se,[e("div",{class:"flex justify-between items-center mb-6"},[o[3]||(o[3]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-store text-blue-500"}),m(" Master Data Outlet ")],-1)),e("div",{class:"flex gap-2"},[e("button",{onClick:R,class:"bg-gray-500 text-white px-3 py-2 rounded-lg shadow hover:bg-gray-600 transition-all font-semibold text-sm"}," Debug DB "),e("button",{onClick:N,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Buat Outlet Baru ")])]),e("div",oe,[k(Y(te),{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value=t),class:g([i.value?"bg-blue-600":"bg-gray-200","relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none"])},{default:O(()=>[e("span",{class:g([i.value?"translate-x-6":"translate-x-1","inline-block h-4 w-4 transform rounded-full bg-white transition"])},null,2)]),_:1},8,["modelValue","class"]),o[4]||(o[4]=e("span",{class:"ml-2 text-sm text-gray-700"},"Tampilkan Inactive",-1))]),e("div",ae,[q(e("input",{"onUpdate:modelValue":o[1]||(o[1]=t=>c.value=t),onInput:V,type:"text",placeholder:"Cari nama outlet, lokasi, atau QR code...",class:"w-full px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,544),[[J,c.value]])]),e("div",le,[e("div",re,[e("table",ne,[o[9]||(o[9]=e("thead",{class:"bg-gradient-to-r from-blue-500 to-blue-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Nama Outlet"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Lokasi"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Region"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"QR Code"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Koordinat"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Aksi")])],-1)),e("tbody",ie,[(l(!0),r(L,null,I(f.outlets.data,t=>{var y;return l(),r("tr",{key:t.id_outlet,class:"hover:bg-blue-50 transition shadow-sm"},[e("td",de,u(t.nama_outlet),1),e("td",ue,[e("div",ce,[e("div",pe,u(t.lokasi),1),t.keterangan?(l(),r("div",xe,u(t.keterangan),1)):T("",!0)])]),e("td",me,u(((y=t.region)==null?void 0:y.name)||"-"),1),e("td",ge,[e("div",fe,[e("span",ve,u(t.qr_code),1),t.url_places?(l(),r("a",{key:0,href:t.url_places,target:"_blank",class:"text-blue-500 hover:text-blue-700"},o[5]||(o[5]=[e("i",{class:"fa-solid fa-external-link-alt text-xs"},null,-1)]),8,be)):T("",!0)])]),e("td",he,[t.lat&&t.long&&t.lat!=="-"&&t.long!=="-"?(l(),r("div",we,[e("span",{class:"text-blue-600 cursor-pointer hover:underline flex items-center gap-1",onClick:_=>z(t)},o[6]||(o[6]=[e("i",{class:"fas fa-map-marker-alt"},null,-1),m(" Lihat di Maps ")]),8,ye)])):(l(),r("div",_e,"-"))]),e("td",ke,[e("button",{class:g([t.status==="A"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700","px-2 py-1 rounded-full text-xs font-semibold shadow hover:opacity-80 transition"]),onClick:_=>Q(t)},u(t.status==="A"?"Active":"Inactive"),11,Ce)]),e("td",Me,[e("div",$e,[e("button",{onClick:_=>F(t),class:"inline-flex items-center btn btn-xs bg-yellow-100 text-yellow-800 hover:bg-yellow-200 rounded px-2 py-1 font-semibold transition"},o[7]||(o[7]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M15.232 5.232l3.536 3.536M9 13l6-6m2 2l-6 6m-2 2h6a2 2 0 002-2v-6a2 2 0 00-2-2H7a2 2 0 00-2 2v6a2 2 0 002 2z"})],-1),m(" Edit ")]),8,De),e("button",{onClick:_=>U(t),class:"inline-flex items-center btn btn-xs bg-red-100 text-red-700 hover:bg-red-200 rounded px-2 py-1 font-semibold transition"},o[8]||(o[8]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M6 18L18 6M6 6l12 12"})],-1),m(" Hapus ")]),8,Be)])])])}),128))])])])]),e("div",Se,[(l(!0),r(L,null,I(f.outlets.links,t=>(l(),r("button",{key:t.label,disabled:!t.url,onClick:y=>H(t.url),innerHTML:t.label,class:g(["px-3 py-1 rounded-lg border text-sm font-semibold",[t.active?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-700 hover:bg-blue-50",t.url?"cursor-pointer":"opacity-50 cursor-not-allowed"]])},null,10,Ee))),128))]),k(X,{show:p.value,mode:v.value,outlet:b.value,"dropdown-data":x.value,"is-loading-dropdown":h.value,onClose:G,onSuccess:D},null,8,["show","mode","outlet","dropdown-data","is-loading-dropdown"]),k(Z,{show:w.value,lat:C.value,long:M.value,alamat:$.value,onClose:o[2]||(o[2]=t=>w.value=!1)},null,8,["show","lat","long","alamat"])])]),_:1}))}},qe=ee(Oe,[["__scopeId","data-v-4cb26b1a"]]);export{qe as default};
