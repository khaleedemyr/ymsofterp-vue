import{P as H,r as m,c as A,w as J,A as me,B as n,C as L,D as s,x as K,G as c,Q as _,S as ye,O as fe,L as r,E as y,H as f,F as h,M as S,N as d,I as Y,J as k,l as E,X as ge,n as he}from"./vendor-vue-g7iCcTkf.js";import{A as be}from"./AppLayout-IVexHyAO.js";import{_ as xe}from"./Modal-BBL5yay4.js";import{a as R}from"./vendor-utils-CpgP2uT4.js";import"./app-V2AeMLhf.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-BZZ_tA4T.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const ve={class:"w-full py-8 px-4"},qe={class:"flex justify-between items-center mb-6"},we={class:"flex items-center gap-2"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Se=["disabled"],Ie=["value"],Ce=["value"],Oe={class:"mb-6"},Fe={class:"mb-4"},Ae={class:"relative"},Te={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},De=["onClick"],Me={class:"font-medium"},Ve={class:"text-sm text-gray-600"},$e={key:0,class:"text-xs text-blue-600 font-medium"},Pe={key:0,class:"space-y-2"},je={key:0,class:"flex items-center justify-between p-3 rounded-md bg-gray-50 border border-gray-200"},Ue={class:"flex items-center space-x-3"},Be={class:"flex items-center space-x-2"},Le=["onClick"],Ee=["onClick"],Re={class:"flex items-center space-x-2"},Ne={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},We={class:"font-medium"},Ge={class:"text-sm text-gray-600"},Qe={key:0,class:"text-xs text-blue-600 font-medium"},ze=["onClick"],Xe={key:0,class:"mb-6"},He={class:"flex justify-between items-center mb-4"},Je={class:"text-lg font-semibold text-gray-800"},Ke={class:"overflow-x-auto"},Ye={class:"min-w-full divide-y divide-gray-200 border border-gray-300"},Ze={class:"bg-white divide-y divide-gray-200"},et=["onClick"],tt={class:"px-4 py-3 font-bold text-gray-800",colspan:"8"},st={class:"flex items-center justify-between"},lt={class:"flex items-center gap-2"},at={class:"text-sm"},ot={class:"text-xs text-gray-500 font-normal"},nt={class:"text-xs text-gray-600"},rt={key:0,class:"fa-solid fa-chevron-down"},it={key:1,class:"fa-solid fa-chevron-right"},ut={class:"px-4 py-3 text-sm font-medium text-gray-900"},dt={class:"font-semibold pl-6"},_t={class:"px-3 py-3"},ct={class:"flex items-center gap-2"},pt=["onUpdate:modelValue","onInput"],mt={class:"text-xs text-gray-600 font-medium whitespace-nowrap"},yt={class:"px-3 py-3"},ft={class:"flex items-center gap-2"},gt=["onUpdate:modelValue","onInput"],ht={class:"text-xs text-gray-600 font-medium whitespace-nowrap"},bt={class:"px-3 py-3"},xt={class:"flex items-center gap-2"},vt=["onUpdate:modelValue","onInput"],qt={class:"text-xs text-gray-600 font-medium whitespace-nowrap"},wt={class:"px-3 py-3 text-sm text-right text-gray-700"},kt={class:"font-medium"},St={class:"px-3 py-3 text-sm text-right text-gray-700"},It={class:"font-semibold"},Ct={class:"px-3 py-3 text-center text-sm"},Ot={key:0},Ft={key:1,class:"text-gray-400 text-xs"},At={class:"px-3 py-3"},Tt=["onUpdate:modelValue"],Dt={key:1,class:"text-gray-400 text-xs"},Mt={class:"bg-gray-100 border-t-2 border-gray-400"},Vt={class:"px-3 py-4 text-right font-bold text-gray-900 text-lg"},$t={key:1,class:"text-center py-8"},Pt={key:2,class:"text-center py-8 text-gray-500"},jt={key:3,class:"flex justify-end gap-4 mt-6"},Ut=["disabled"],Bt={key:0,class:"fa fa-spinner fa-spin mr-2"},Lt={key:1,class:"fa-solid fa-save mr-2"},Et={class:"p-6"},Rt={class:"mb-4"},Nt={key:0,class:"mb-4 p-3 bg-red-50 text-red-700 rounded text-sm"},Wt={class:"flex justify-end gap-2 mt-4"},Gt=["disabled"],Qt={key:0},zt={key:1},ns={__name:"Create",props:{outlets:Array,warehouseOutlets:Array,items:Array,selectedOutletId:[String,Number],selectedWarehouseOutletId:[String,Number],user_outlet_id:[String,Number]},setup(N){const p=N,o=H({outlet_id:p.user_outlet_id&&String(p.user_outlet_id)!=="1"?String(p.user_outlet_id):p.selectedOutletId||"",warehouse_outlet_id:p.selectedWarehouseOutletId||"",opname_date:new Date().toISOString().split("T")[0],notes:"",items:p.items||[],approvers:[]}),T=m(!1),I=m(!1),b=m(new Set),x=m(""),g=m([]),v=m(!1),D=m(null),M=m(!1),C=m(null),q=m(""),O=m(!1),V=m(null),F=m(!1),W=A(()=>String(p.user_outlet_id)==="1"),Z=A(()=>{const e={};return o.items.forEach(t=>{const l=t.category_name||"Uncategorized";e[l]||(e[l]=[]),e[l].push(t)}),e});function G(e){if(!e||e.qty_physical_small===null||e.qty_physical_small===void 0||e.qty_physical_small==="")return 0;const t=parseFloat(e.qty_physical_small)||0,l=parseFloat(e.mac)||0;return t*l}const ee=A(()=>!o.items||o.items.length===0?0:o.items.reduce((e,t)=>e+G(t),0));function te(e){b.value.has(e)?b.value.delete(e):b.value.add(e)}J(()=>o.items,e=>{if(e&&e.length>0){const t=new Set;e.forEach(l=>{t.add(l.category_name||"Uncategorized")}),b.value=t}},{immediate:!0});const se=A(()=>{if(!p.warehouseOutlets||p.warehouseOutlets.length===0)return[];let e=[...p.warehouseOutlets];if(!W.value&&p.user_outlet_id){const t=String(p.user_outlet_id);e=e.filter(l=>(l.outlet_id?String(l.outlet_id):"")===t)}if(o.outlet_id){const t=String(o.outlet_id);e=e.filter(l=>(l.outlet_id?String(l.outlet_id):"")===t)}return e});function le(){if(!o.outlet_id||!o.warehouse_outlet_id){typeof Swal<"u"?Swal.fire({title:"Perhatian",text:"Pilih Outlet dan Warehouse Outlet terlebih dahulu.",icon:"warning",confirmButtonColor:"#3085d6"}):alert("Pilih Outlet dan Warehouse Outlet terlebih dahulu.");return}const e=new URLSearchParams({outlet_id:o.outlet_id,warehouse_outlet_id:o.warehouse_outlet_id,opname_date:o.opname_date||new Date().toISOString().split("T")[0],notes:o.notes||""});window.location.href=route("stock-opnames.download-template")+"?"+e.toString()}function ae(){o.warehouse_outlet_id="",o.items=[]}async function $(){var e;if(!o.outlet_id||!o.warehouse_outlet_id){o.items=[];return}T.value=!0;try{const t=await R.get(route("stock-opnames.get-items"),{params:{outlet_id:o.outlet_id,warehouse_outlet_id:o.warehouse_outlet_id}});o.items=t.data.map(l=>({inventory_item_id:l.inventory_item_id,item_name:l.item_name,category_name:l.category_name,qty_system_small:parseFloat(l.qty_system_small)||0,qty_system_medium:parseFloat(l.qty_system_medium)||0,qty_system_large:parseFloat(l.qty_system_large)||0,qty_physical_small:null,qty_physical_medium:null,qty_physical_large:null,reason:"",small_unit_name:l.small_unit_name,medium_unit_name:l.medium_unit_name,large_unit_name:l.large_unit_name,small_conversion_qty:parseFloat(l.small_conversion_qty)||1,medium_conversion_qty:parseFloat(l.medium_conversion_qty)||1,mac:parseFloat(l.mac)||0}))}catch(t){console.error("Error loading items:",t),t.response?alert("Gagal memuat items: "+(((e=t.response.data)==null?void 0:e.message)||t.message)):t.request?alert("Gagal memuat items: Server tidak merespon. Pastikan server berjalan."):alert("Gagal memuat items: "+t.message),o.items=[]}finally{T.value=!1}}function P(e,t){const l=e[`qty_physical_${t}`];if(l==null||l===""){e.qty_physical_small=null,e.qty_physical_medium=null,e.qty_physical_large=null;return}const a=parseFloat(l);isNaN(a)||a<0||(t==="small"?e.small_conversion_qty&&e.small_conversion_qty>0?(e.qty_physical_medium=a/e.small_conversion_qty,e.medium_conversion_qty&&e.medium_conversion_qty>0?e.qty_physical_large=a/(e.small_conversion_qty*e.medium_conversion_qty):e.qty_physical_large=e.qty_physical_medium):(e.qty_physical_medium=a,e.qty_physical_large=a):t==="medium"?(e.small_conversion_qty&&e.small_conversion_qty>0?e.qty_physical_small=a*e.small_conversion_qty:e.qty_physical_small=a,e.medium_conversion_qty&&e.medium_conversion_qty>0?e.qty_physical_large=a/e.medium_conversion_qty:e.qty_physical_large=a):t==="large"&&(e.medium_conversion_qty&&e.medium_conversion_qty>0?(e.qty_physical_medium=a*e.medium_conversion_qty,e.small_conversion_qty&&e.small_conversion_qty>0?e.qty_physical_small=e.qty_physical_medium*e.small_conversion_qty:e.qty_physical_small=e.qty_physical_medium):(e.qty_physical_medium=a,e.qty_physical_small=a)),e.qty_physical_small!==null&&(e.qty_physical_small=Math.round(e.qty_physical_small*100)/100),e.qty_physical_medium!==null&&(e.qty_physical_medium=Math.round(e.qty_physical_medium*100)/100),e.qty_physical_large!==null&&(e.qty_physical_large=Math.round(e.qty_physical_large*100)/100))}function j(e){const t=(e.qty_physical_small??e.qty_system_small)-e.qty_system_small,l=(e.qty_physical_medium??e.qty_system_medium)-e.qty_system_medium,a=(e.qty_physical_large??e.qty_system_large)-e.qty_system_large;return t!==0||l!==0||a!==0}function oe(e){const t=(e.qty_physical_small??e.qty_system_small)-e.qty_system_small;return t>0?"+":t<0?"-":"0"}function ne(e){const t=(e.qty_physical_small??e.qty_system_small)-e.qty_system_small;return t>0?"bg-green-100 text-green-800":t<0?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}function Q(e){return e==null?"0":Number(e).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}function re(e){return e==null||e===""||isNaN(e)?"Rp 0":"Rp "+Number(e).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}async function z(e=""){if(e.length<2){g.value=[],v.value=!1;return}try{const t=await R.get(route("stock-opnames.approvers"),{params:{search:e},headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});console.log("Approvers response:",t.data),t.data&&t.data.success?(g.value=t.data.users||[],v.value=g.value.length>0):(g.value=[],v.value=!1)}catch(t){console.error("Failed to load approvers:",t),g.value=[],v.value=!1}}function ie(){D.value&&clearTimeout(D.value),D.value=setTimeout(()=>{x.value.length>=2?z(x.value):(g.value=[],v.value=!1)},300)}function ue(e){if(!e||!e.id){console.error("Invalid user object:",e);return}o.approvers.find(t=>t&&t.id===e.id)||o.approvers.push(e),x.value="",v.value=!1}function de(e){o.approvers.splice(e,1)}function X(e,t){const l=o.approvers.splice(e,1)[0];o.approvers.splice(t,0,l)}function _e(){if(o.items.length===0){Swal.fire({title:"Error",text:"Minimal harus ada 1 item.",icon:"error",confirmButtonColor:"#3085d6"});return}const e=o.items.map(a=>{const i={inventory_item_id:a.inventory_item_id,qty_physical_small:a.qty_physical_small!==null&&a.qty_physical_small!==void 0&&a.qty_physical_small!==""?parseFloat(a.qty_physical_small):null,qty_physical_medium:a.qty_physical_medium!==null&&a.qty_physical_medium!==void 0&&a.qty_physical_medium!==""?parseFloat(a.qty_physical_medium):null,qty_physical_large:a.qty_physical_large!==null&&a.qty_physical_large!==void 0&&a.qty_physical_large!==""?parseFloat(a.qty_physical_large):null,reason:a.reason||""};return console.log("Item before processing:",{inventory_item_id:a.inventory_item_id,qty_physical_small_raw:a.qty_physical_small,qty_physical_medium_raw:a.qty_physical_medium,qty_physical_large_raw:a.qty_physical_large,qty_system_small:a.qty_system_small,qty_system_medium:a.qty_system_medium,qty_system_large:a.qty_system_large}),console.log("Item after processing:",i),i});console.log("All items to submit:",e),I.value=!0;const t=o.approvers.filter(a=>a&&a.id).map(a=>a.id);H({outlet_id:o.outlet_id,warehouse_outlet_id:o.warehouse_outlet_id,opname_date:o.opname_date,notes:o.notes,items:e,approvers:t}).post(route("stock-opnames.store"),{preserveScroll:!0,onSuccess:()=>{I.value=!1},onError:a=>{I.value=!1,console.error("Error:",a),Swal.fire({title:"Error",text:"Gagal menyimpan stock opname. Silakan coba lagi.",icon:"error",confirmButtonColor:"#3085d6"})}})}function ce(e){var t;C.value=((t=e.target.files)==null?void 0:t[0])||null,q.value=""}async function pe(){var t,l,a,i;if(!C.value)return;O.value=!0,q.value="";const e=new FormData;e.append("file",C.value);try{const u=await R.post(route("stock-opnames.preview-import"),e,{headers:{"Content-Type":"multipart/form-data",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(u.data.success){F.value=!0,o.outlet_id=String(u.data.outlet_id??""),o.warehouse_outlet_id=String(u.data.warehouse_outlet_id??""),o.opname_date=u.data.opname_date||new Date().toISOString().split("T")[0],o.notes=u.data.notes||"",o.items=(u.data.items||[]).map(w=>({...w,qty_physical_small:w.qty_physical_small??null,qty_physical_medium:w.qty_physical_medium??null,qty_physical_large:w.qty_physical_large??null})),U(),await he(),F.value=!1;const B=u.data.errors||[];if(B.length){const w=`${((t=u.data.items)==null?void 0:t.length)||0} item dimuat. ${B.length} baris error: ${((l=B[0])==null?void 0:l.error)||""}`;typeof Swal<"u"?Swal.fire({title:"Import",text:w,icon:"info",confirmButtonColor:"#3085d6"}):alert(w)}else typeof Swal<"u"&&Swal.fire({title:"Berhasil",text:`${o.items.length} item dimuat ke form.`,icon:"success",timer:2e3,showConfirmButton:!1})}else q.value=u.data.message||"Gagal memuat file."}catch(u){q.value=((i=(a=u.response)==null?void 0:a.data)==null?void 0:i.message)||"Gagal memuat file."}finally{O.value=!1}}function U(){M.value=!1,C.value=null,q.value="",V.value&&(V.value.value="")}return J(()=>o.warehouse_outlet_id,()=>{if(o.warehouse_outlet_id){if(F.value){F.value=!1;return}$()}}),p.user_outlet_id&&String(p.user_outlet_id)!=="1"&&(o.outlet_id=String(p.user_outlet_id)),o.outlet_id&&o.warehouse_outlet_id&&o.items.length===0&&$(),(e,t)=>(n(),me(be,null,{default:L(()=>[s("div",ve,[s("div",qe,[t[11]||(t[11]=s("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[s("i",{class:"fa-solid fa-clipboard-check text-blue-500"}),c(" Buat Stock Opname Baru ")],-1)),s("div",we,[s("button",{type:"button",onClick:le,class:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},t[8]||(t[8]=[s("i",{class:"fas fa-download mr-2"},null,-1),c(" Download Template ")])),s("button",{type:"button",onClick:t[0]||(t[0]=l=>M.value=!0),class:"bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded"},t[9]||(t[9]=[s("i",{class:"fas fa-file-import mr-2"},null,-1),c(" Import ")])),K(_(ye),{href:e.route("stock-opnames.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:L(()=>t[10]||(t[10]=[s("i",{class:"fas fa-arrow-left mr-2"},null,-1),c(" Kembali ")])),_:1},8,["href"])])]),s("form",{onSubmit:fe(_e,["prevent"]),class:"bg-white rounded-xl shadow-lg p-6"},[s("div",ke,[s("div",null,[t[13]||(t[13]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Outlet *",-1)),f(s("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>_(o).outlet_id=l),onChange:ae,required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!W.value},[t[12]||(t[12]=s("option",{value:""},"Pilih Outlet",-1)),(n(!0),r(h,null,S(N.outlets,l=>(n(),r("option",{key:l.id,value:l.id},d(l.name),9,Ie))),128))],40,Se),[[Y,_(o).outlet_id]])]),s("div",null,[t[15]||(t[15]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Warehouse Outlet *",-1)),f(s("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>_(o).warehouse_outlet_id=l),onChange:$,required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[t[14]||(t[14]=s("option",{value:""},"Pilih Warehouse Outlet",-1)),(n(!0),r(h,null,S(se.value,l=>(n(),r("option",{key:l.id,value:l.id},d(l.name),9,Ce))),128))],544),[[Y,_(o).warehouse_outlet_id]])]),s("div",null,[t[16]||(t[16]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Opname *",-1)),f(s("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>_(o).opname_date=l),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[k,_(o).opname_date]])]),s("div",null,[t[17]||(t[17]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catatan",-1)),f(s("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>_(o).notes=l),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Catatan tambahan..."},null,512),[[k,_(o).notes]])])]),s("div",Oe,[t[22]||(t[22]=s("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Approval Flow",-1)),t[23]||(t[23]=s("p",{class:"text-sm text-gray-600 mb-4"},"Tambahkan approvers secara berurutan dari terendah ke tertinggi. Approver pertama = level terendah, approver terakhir = level tertinggi.",-1)),s("div",Fe,[s("div",Ae,[f(s("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>x.value=l),type:"text",placeholder:"Cari user berdasarkan nama, email, atau jabatan...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onInput:ie,onFocus:t[6]||(t[6]=l=>x.value.length>=2&&z(x.value))},null,544),[[k,x.value]]),v.value&&g.value.length>0?(n(),r("div",Te,[(n(!0),r(h,null,S(g.value,l=>(n(),r("div",{key:l.id,onClick:a=>ue(l),class:"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200 last:border-b-0"},[s("div",Me,d(l.name),1),s("div",Ve,d(l.email),1),l.jabatan?(n(),r("div",$e,d(l.jabatan),1)):y("",!0)],8,De))),128))])):y("",!0)])]),_(o).approvers.length>0?(n(),r("div",Pe,[t[21]||(t[21]=s("h4",{class:"font-medium text-gray-700"},"Urutan Approval (Terendah ke Tertinggi):",-1)),(n(!0),r(h,null,S(_(o).approvers,(l,a)=>(n(),r(h,{key:(l==null?void 0:l.id)||a},[l&&l.id?(n(),r("div",je,[s("div",Ue,[s("div",Be,[a>0?(n(),r("button",{key:0,onClick:i=>X(a,a-1),class:"p-1 text-gray-500 hover:text-gray-700",title:"Pindah ke atas"},t[18]||(t[18]=[s("i",{class:"fa fa-arrow-up"},null,-1)]),8,Le)):y("",!0),a<_(o).approvers.length-1?(n(),r("button",{key:1,onClick:i=>X(a,a+1),class:"p-1 text-gray-500 hover:text-gray-700",title:"Pindah ke bawah"},t[19]||(t[19]=[s("i",{class:"fa fa-arrow-down"},null,-1)]),8,Ee)):y("",!0)]),s("div",Re,[s("span",Ne," Level "+d(a+1),1),s("div",null,[s("div",We,d(l.name),1),s("div",Ge,d(l.email),1),l.jabatan?(n(),r("div",Qe,d(l.jabatan),1)):y("",!0)])])]),s("button",{onClick:i=>de(a),class:"p-1 text-red-500 hover:text-red-700",title:"Hapus Approver"},t[20]||(t[20]=[s("i",{class:"fa fa-times"},null,-1)]),8,ze)])):y("",!0)],64))),128))])):y("",!0)]),_(o).items.length>0?(n(),r("div",Xe,[s("div",He,[s("h3",Je,"Items ("+d(_(o).items.length)+")",1)]),s("div",Ke,[s("table",Ye,[t[26]||(t[26]=s("thead",{class:"bg-gray-50"},[s("tr",null,[s("th",{class:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase w-48"},"Item"),s("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-40"},[c(" Qty Physical"),s("br"),c("Small ")]),s("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-40"},[c(" Qty Physical"),s("br"),c("Medium ")]),s("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-40"},[c(" Qty Physical"),s("br"),c("Large ")]),s("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-32"},"MAC"),s("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-40"},[c("Subtotal"),s("br"),c("(Qty Ã— MAC)")]),s("th",{class:"px-3 py-3 text-center text-xs font-bold text-gray-700 uppercase w-48"},"Selisih"),s("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase w-48"},"Alasan")])],-1)),s("tbody",Ze,[(n(!0),r(h,null,S(Z.value,(l,a)=>(n(),r(h,{key:a},[s("tr",{class:"bg-blue-50 hover:bg-blue-100 cursor-pointer transition",onClick:i=>te(a)},[s("td",tt,[s("div",st,[s("div",lt,[s("i",{class:E([b.value.has(a)?"fa-solid fa-chevron-down":"fa-solid fa-chevron-right","text-blue-600 transition-transform"])},null,2),s("span",at,d(a||"Uncategorized"),1),s("span",ot," ("+d(l.length)+" item"+d(l.length>1?"s":"")+") ",1)]),s("div",nt,[b.value.has(a)?(n(),r("i",rt)):(n(),r("i",it))])])])],8,et),(n(!0),r(h,null,S(l,i=>f((n(),r("tr",{key:i.inventory_item_id,class:E([{"bg-yellow-50":j(i)},"hover:bg-gray-50 transition"])},[s("td",ut,[s("div",dt,d(i.item_name),1)]),s("td",_t,[s("div",ct,[f(s("input",{"onUpdate:modelValue":u=>i.qty_physical_small=u,type:"number",step:"any",min:"0",onInput:u=>P(i,"small"),class:"w-full px-3 py-2 border border-gray-300 rounded-md text-right text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,pt),[[k,i.qty_physical_small,void 0,{number:!0}]]),s("span",mt,d(i.small_unit_name||"-"),1)])]),s("td",yt,[s("div",ft,[f(s("input",{"onUpdate:modelValue":u=>i.qty_physical_medium=u,type:"number",step:"any",min:"0",onInput:u=>P(i,"medium"),class:"w-full px-3 py-2 border border-gray-300 rounded-md text-right text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,gt),[[k,i.qty_physical_medium,void 0,{number:!0}]]),s("span",ht,d(i.medium_unit_name||"-"),1)])]),s("td",bt,[s("div",xt,[f(s("input",{"onUpdate:modelValue":u=>i.qty_physical_large=u,type:"number",step:"any",min:"0",onInput:u=>P(i,"large"),class:"w-full px-3 py-2 border border-gray-300 rounded-md text-right text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,vt),[[k,i.qty_physical_large,void 0,{number:!0}]]),s("span",qt,d(i.large_unit_name||"-"),1)])]),s("td",wt,[s("div",kt,d(re(i.mac)),1)]),s("td",St,[s("div",It,d(Q(G(i))),1)]),s("td",Ct,[j(i)?(n(),r("div",Ot,[s("span",{class:E([ne(i),"px-2 py-1 rounded text-xs font-semibold whitespace-nowrap"])},d(oe(i)),3)])):(n(),r("span",Ft,"-"))]),s("td",At,[j(i)?f((n(),r("input",{key:0,"onUpdate:modelValue":u=>i.reason=u,type:"text",placeholder:"Alasan selisih...",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,Tt)),[[k,i.reason]]):(n(),r("span",Dt,"-"))])],2)),[[ge,b.value.has(a)]])),128))],64))),128))]),s("tfoot",Mt,[s("tr",null,[t[24]||(t[24]=s("td",{class:"px-4 py-4 text-right font-bold text-gray-900",colspan:"5"}," GRAND TOTAL ",-1)),s("td",Vt,d(Q(ee.value)),1),t[25]||(t[25]=s("td",{class:"px-3 py-4",colspan:"2"},null,-1))])])])])])):y("",!0),T.value?(n(),r("div",$t,t[27]||(t[27]=[s("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"},null,-1),s("p",{class:"mt-2 text-gray-600"},"Memuat items...",-1)]))):_(o).items.length===0&&_(o).outlet_id&&_(o).warehouse_outlet_id?(n(),r("div",Pt,t[28]||(t[28]=[s("i",{class:"fa-solid fa-inbox text-4xl mb-4"},null,-1),s("p",null,"Tidak ada item dengan stock untuk outlet dan warehouse outlet yang dipilih.",-1)]))):y("",!0),_(o).items.length>0?(n(),r("div",jt,[s("button",{type:"button",onClick:t[7]||(t[7]=l=>e.$inertia.visit(e.route("stock-opnames.index"))),class:"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-semibold"}," Batal "),s("button",{type:"submit",disabled:I.value,class:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-semibold disabled:opacity-50"},[I.value?(n(),r("i",Bt)):(n(),r("i",Lt)),t[29]||(t[29]=c(" Simpan Draft "))],8,Ut)])):y("",!0)],32),K(xe,{show:M.value,onClose:U,"max-width":"2xl"},{default:L(()=>[s("div",Et,[t[32]||(t[32]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Import Stock Opname",-1)),t[33]||(t[33]=s("p",{class:"text-sm text-gray-600 mb-4"},[c("Pilih file Excel (dari Download Template). Data akan langsung terisi ke list item di bawah. Isi hanya "),s("b",null,"Qty Terkecil"),c(" di Excel (dan Alasan bila ada selisih).")],-1)),s("div",Rt,[t[30]||(t[30]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Pilih File",-1)),s("input",{ref_key:"fileInputRef",ref:V,type:"file",accept:".xlsx,.xls",onChange:ce,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200"},null,544)]),q.value?(n(),r("div",Nt,d(q.value),1)):y("",!0),s("div",Wt,[s("button",{type:"button",onClick:U,class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded font-medium"}," Tutup "),C.value?(n(),r("button",{key:0,type:"button",onClick:pe,disabled:O.value,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-medium disabled:opacity-50"},[O.value?(n(),r("span",Qt,t[31]||(t[31]=[s("i",{class:"fas fa-spinner fa-spin mr-1"},null,-1),c(" Memuat...")]))):(n(),r("span",zt,"Import"))],8,Gt)):y("",!0)])])]),_:1},8,["show"])])]),_:1}))}};export{ns as default};
