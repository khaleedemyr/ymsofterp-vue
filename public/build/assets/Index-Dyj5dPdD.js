import{r as n,a as j,c as T,A as P,B as l,C as F,D as t,L as o,E as V,G as B,H as x,J as w,F as k,M as _,N as c,I as U,l as z,O as G,x as $,Q as q}from"./vendor-vue-g7iCcTkf.js";import{a as v}from"./vendor-utils-CpgP2uT4.js";import{A as Y}from"./AppLayout-DkG6xw-a.js";import{s as J}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{S as u}from"./app-5ZP5W-3z.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-COEZdPkp.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const R={class:"max-w-5xl w-full mx-auto py-8 px-2"},W={class:"bg-white rounded-xl shadow-lg p-4 mb-6"},K={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},X=["value"],Z={class:"bg-white rounded-xl shadow-lg overflow-hidden"},ee={class:"min-w-full divide-y divide-gray-200"},te={class:"bg-white divide-y divide-gray-200"},ae={key:0},se={class:"px-6 py-4 whitespace-nowrap"},le={class:"px-6 py-4 whitespace-nowrap"},oe={class:"px-6 py-4 whitespace-nowrap"},re={class:"px-6 py-4 whitespace-nowrap"},ie={key:0,class:"list-disc pl-4"},ne={key:1},ue={class:"px-6 py-4 whitespace-nowrap text-center"},de=["onClick"],ce=["onClick"],me={class:"flex justify-end mt-4 gap-2"},pe=["onClick"],fe={key:0,class:"fixed inset-0 z-40 flex items-center justify-center bg-black bg-opacity-40 transition-all"},be={class:"max-w-lg mx-auto py-8 px-2"},xe={class:"text-2xl font-bold text-blue-700 mb-6"},ve={class:"flex justify-end gap-2 mt-8"},ge=["disabled"],ye={key:0},he={key:1},I=10,we={__name:"Index",setup(ke){const g=n([]),f=n([]),b=n(!1),d=n(!1),r=n({id:null,name:"",email:"",phone:"",outlet_ids:[]}),m=n(""),p=n(""),y=n(1),S=n(!1),h=n(!1);j(async()=>{try{const s=await v.get("/api/outlets/investor");s.data.outlets?(f.value=s.data.outlets,s.data.warning&&u.fire("Warning",s.data.warning,"warning")):Array.isArray(s.data)?f.value=s.data:f.value=[],await C(),S.value=!0}catch(s){console.error("Error loading data:",s),s.response&&s.response.data&&s.response.data.error?u.fire("Error",s.response.data.error,"error"):u.fire("Error","Gagal memuat data outlet. Silakan refresh halaman.","error")}});async function C(){try{const s=await v.get("/api/investors");g.value=s.data}catch(s){console.error("Error fetching investors:",s),u.fire("Error","Gagal memuat data investor. Silakan refresh halaman.","error")}}const E=T(()=>{let s=g.value;if(m.value){const e=m.value.toLowerCase();s=s.filter(a=>a.name.toLowerCase().includes(e)||a.email&&a.email.toLowerCase().includes(e)||a.phone&&a.phone.toLowerCase().includes(e))}return p.value&&(s=s.filter(e=>e.outlets&&e.outlets.some(a=>a.id===Number(p.value)))),s.slice((y.value-1)*I,y.value*I)}),L=T(()=>{let s=g.value;if(m.value){const e=m.value.toLowerCase();s=s.filter(a=>a.name.toLowerCase().includes(e)||a.email&&a.email.toLowerCase().includes(e)||a.phone&&a.phone.toLowerCase().includes(e))}return p.value&&(s=s.filter(e=>e.outlets&&e.outlets.some(a=>a.id===Number(p.value)))),Math.ceil(s.length/I)||1});function M(s){y.value=s}function N(){r.value={id:null,name:"",email:"",phone:"",outlet_ids:[]},d.value=!1,b.value=!0}function D(s){S.value&&(r.value={id:s.id,name:s.name,email:s.email,phone:s.phone,outlet_ids:s.outlets?s.outlets.map(e=>e.id):[]},d.value=!0,b.value=!0)}function A(){b.value=!1}async function H(){const s=(r.value.outlet_ids||[]).map(i=>typeof i=="object"?i.id:i),e={...r.value,outlet_ids:s};if((await u.fire({title:d.value?"Simpan perubahan investor?":"Tambah investor baru?",text:d.value?"Data investor akan diperbarui.":"Data investor akan ditambahkan.",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Simpan",cancelButtonText:"Batal"})).isConfirmed){h.value=!0;try{d.value?await v.put(`/api/investors/${r.value.id}`,e):await v.post("/api/investors",e),b.value=!1,await C(),u.fire("Berhasil",d.value?"Investor berhasil diupdate!":"Investor berhasil ditambahkan!","success")}catch{u.fire("Gagal","Terjadi kesalahan saat menyimpan data.","error")}finally{h.value=!1}}}async function O(s){if((await u.fire({title:"Hapus investor?",text:"Data investor akan dihapus permanen!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"})).isConfirmed)try{await v.delete(`/api/investors/${s}`),await C(),u.fire("Berhasil","Investor berhasil dihapus!","success")}catch{u.fire("Gagal","Terjadi kesalahan saat menghapus data.","error")}}return(s,e)=>(l(),P(Y,null,{default:F(()=>[t("div",R,[t("div",{class:"flex justify-between items-center mb-6"},[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-user-tie text-blue-500"}),B(" Data Investor Outlet ")],-1)),t("button",{onClick:N,class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2"},e[6]||(e[6]=[t("i",{class:"fa-solid fa-plus"},null,-1),B(" Tambah Investor ")]))]),t("div",W,[t("div",K,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),x(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a),placeholder:"Cari nama, email, atau no HP...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,m.value]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Filter Outlet",-1)),x(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>p.value=a),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[9]||(e[9]=t("option",{value:""},"Semua Outlet",-1)),(l(!0),o(k,null,_(f.value,a=>(l(),o("option",{key:a.id,value:a.id},c(a.name),9,X))),128))],512),[[U,p.value]])])])]),t("div",Z,[t("table",ee,[e[12]||(e[12]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nama"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No HP"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet Dimiliki"),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi")])],-1)),t("tbody",te,[g.value.length===0?(l(),o("tr",ae,e[11]||(e[11]=[t("td",{colspan:"5",class:"text-center py-10 text-gray-400"},"Tidak ada data investor.",-1)]))):V("",!0),(l(!0),o(k,null,_(E.value,a=>(l(),o("tr",{key:a.id,class:"hover:bg-gray-50"},[t("td",se,c(a.name),1),t("td",le,c(a.email),1),t("td",oe,c(a.phone),1),t("td",re,[a.outlets&&a.outlets.length?(l(),o("ul",ie,[(l(!0),o(k,null,_(a.outlets,i=>(l(),o("li",{key:i.id},c(i.name),1))),128))])):(l(),o("span",ne,"-"))]),t("td",ue,[t("button",{class:"px-2 py-1 bg-yellow-400 rounded mr-2",onClick:i=>D(a)},"Edit",8,de),t("button",{class:"px-2 py-1 bg-red-500 text-white rounded",onClick:i=>O(a.id)},"Hapus",8,ce)])]))),128))])])]),t("div",me,[(l(!0),o(k,null,_(L.value,a=>(l(),o("button",{key:a,onClick:i=>M(a),class:z(["px-3 py-1 rounded-lg border text-sm font-semibold",a===y.value?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-700 hover:bg-blue-50","cursor-pointer"])},c(a),11,pe))),128))]),b.value?(l(),o("div",fe,[t("div",be,[t("h2",xe,c(d.value?"Edit Investor":"Tambah Investor"),1),t("form",{onSubmit:G(H,["prevent"]),class:"space-y-5 bg-white rounded-2xl shadow-xl p-8"},[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700"},"Nama",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.name=a),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:"",maxlength:"100"},null,512),[[w,r.value.name]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),x(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>r.value.email=a),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,r.value.email]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700"},"No HP",-1)),x(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>r.value.phone=a),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,r.value.phone]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"Outlet Dimiliki",-1)),$(q(J),{modelValue:r.value.outlet_ids,"onUpdate:modelValue":e[5]||(e[5]=a=>r.value.outlet_ids=a),options:f.value,multiple:!0,label:"name","track-by":"id",placeholder:"Pilih Outlet",class:"mt-1"},null,8,["modelValue","options"])]),t("div",ve,[t("button",{type:"button",onClick:A,class:"px-4 py-2 rounded bg-gray-100 text-gray-700 font-semibold hover:bg-gray-200"},"Batal"),t("button",{type:"submit",disabled:h.value,class:"px-6 py-2 rounded bg-blue-600 text-white font-bold hover:bg-blue-700"},[h.value?(l(),o("span",ye,e[17]||(e[17]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),B(" Menyimpan... ")]))):(l(),o("span",he," Simpan "))],8,ge)])],32)])])):V("",!0)])]),_:1}))}},Ae=Q(we,[["__scopeId","data-v-fadd7501"]]);export{Ae as default};
