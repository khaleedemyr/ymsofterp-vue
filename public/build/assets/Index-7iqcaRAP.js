import{$ as K,c as M,w as Y,r as z,k as Q,A as R,B as n,C as Z,D as t,G as b,L as i,E as v,H as u,Z as q,J as _,F as h,M as w,N as l,I as k,l as g,Q as X,S as tt,W as p}from"./vendor-vue-g7iCcTkf.js";import{A as et}from"./AppLayout-IVexHyAO.js";import{S as x}from"./app-V2AeMLhf.js";import{a as st}from"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-BZZ_tA4T.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const at={class:"max-w-7xl mx-auto py-8 px-2"},rt={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},ot={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},nt={class:"lg:col-span-2"},it={key:0},lt=["value"],dt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},ut={class:"bg-white rounded-xl shadow-lg overflow-hidden"},pt={class:"overflow-x-auto"},ct={class:"min-w-full divide-y divide-gray-200"},gt={class:"bg-white divide-y divide-gray-200"},xt={key:0},ft={class:"px-3 py-3 whitespace-nowrap"},mt={class:"px-3 py-3 whitespace-nowrap"},yt={class:"text-sm text-gray-900"},bt={class:"text-xs text-gray-500"},vt={class:"px-3 py-3 whitespace-nowrap"},ht={class:"text-sm text-gray-900"},wt={class:"px-3 py-3 whitespace-nowrap"},_t={class:"px-3 py-3"},kt={key:0,class:"flex flex-wrap gap-1 max-w-[200px]"},Dt=["title"],Ct={key:1,class:"text-xs text-gray-400"},St={class:"px-3 py-3"},Tt={class:"text-sm text-gray-900 font-medium"},Et={class:"text-xs text-gray-500"},Bt={class:"px-3 py-3"},At=["title"],Mt={class:"px-3 py-3 whitespace-nowrap"},Rt={class:"flex items-center justify-center gap-1"},Lt=["onClick"],Ot=["onClick"],Vt=["onClick","disabled"],Ft={key:0,class:"px-6 py-4 border-t border-gray-200"},Pt={class:"flex items-center justify-between"},Ut={class:"text-sm text-gray-700"},jt={class:"flex items-center space-x-2"},Qt={__name:"Index",props:{data:Object,outlets:Array,filters:Object},setup(f){var C,S,T,E,B,A;const D=K(),L=M(()=>{var a;return((a=D.props.auth)==null?void 0:a.user)||{}}),O=M(()=>L.value.id_outlet==1);Y(()=>D.props.flash,a=>{a!=null&&a.error&&x.fire({icon:"error",title:"Error",html:a.error,confirmButtonText:"OK",confirmButtonColor:"#EF4444"}),a!=null&&a.success&&x.fire({icon:"success",title:"Berhasil",text:a.success,timer:2e3,showConfirmButton:!1})},{immediate:!0});const o=f,m=z(null),r=Q({search:((C=o.filters)==null?void 0:C.search)||"",outlet_id:((S=o.filters)==null?void 0:S.outlet_id)||"",type:((T=o.filters)==null?void 0:T.type)||"",date_from:((E=o.filters)==null?void 0:E.date_from)||"",date_to:((B=o.filters)==null?void 0:B.date_to)||"",per_page:((A=o.filters)==null?void 0:A.per_page)||10});function y(){p.get("/outlet-internal-use-waste",r,{preserveState:!0,preserveScroll:!0})}function V(){r.search="",r.outlet_id="",r.type="",r.date_from="",r.date_to="",r.per_page=10,y()}function F(){p.visit(route("outlet-internal-use-waste.create"))}function P(){p.visit(route("outlet-internal-use-waste.report-universal"))}function U(a){p.visit(route("outlet-internal-use-waste.show",a))}function j(a){p.visit(route("outlet-internal-use-waste.edit",a))}function I(a){x.fire({title:"Yakin hapus data ini?",text:"Stok akan di-rollback otomatis!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus",cancelButtonText:"Batal",reverseButtons:!0}).then(async e=>{var s,d;if(e.isConfirmed){m.value=a;try{const c=await st.delete(`/outlet-internal-use-waste/${a}`);if(c.data&&c.data.success)x.fire({icon:"success",title:"Berhasil",text:"Data berhasil dihapus dan stok di-rollback!",timer:1500,showConfirmButton:!1}),setTimeout(()=>p.reload(),1200);else throw new Error("Gagal menghapus data")}catch(c){x.fire({icon:"error",title:"Gagal",text:((d=(s=c.response)==null?void 0:s.data)==null?void 0:d.message)||c.message||"Gagal menghapus data"})}finally{m.value=null}}})}function N(a){return a?new Date(a).toLocaleDateString("id-ID"):"-"}function W(a){return a?new Date(a).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}function $(a){return a==="internal_use"?"Internal Use":a==="spoil"?"Spoil":a==="waste"?"Waste":a==="stock_cut"?"Stock Cut":a==="r_and_d"?"R & D":a==="marketing"?"Marketing":a==="non_commodity"?"Non Commodity":a==="guest_supplies"?"Guest Supplies":a==="wrong_maker"?"Wrong Maker":a==="training"?"Training":a}function G(a){return{DRAFT:"Draft",SUBMITTED:"Menunggu Approval",APPROVED:"Disetujui",REJECTED:"Ditolak",PROCESSED:"Diproses"}[a]||a}function H(a){return{DRAFT:"bg-gray-100 text-gray-800",SUBMITTED:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800",PROCESSED:"bg-blue-100 text-blue-800"}[a]||"bg-gray-100 text-gray-800"}function J(a){return a==="APPROVED"?"bg-green-100 text-green-700":a==="REJECTED"?"bg-red-100 text-red-700":a==="PENDING"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}return(a,e)=>(n(),R(et,null,{default:Z(()=>[t("div",at,[t("div",{class:"flex justify-between items-center mb-6"},[e[7]||(e[7]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-recycle text-green-500"}),b(" Category Cost Outlet ")],-1)),t("div",{class:"flex gap-2"},[t("button",{onClick:P,class:"bg-blue-500 text-white px-4 py-2 rounded-xl shadow-lg hover:bg-blue-600 transition-all font-semibold"},e[6]||(e[6]=[t("i",{class:"fa fa-file-lines mr-1"},null,-1),b(" Laporan ")])),t("button",{onClick:F,class:"bg-gradient-to-r from-green-500 to-green-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Tambah Baru ")])]),t("div",rt,[t("div",ot,[t("div",nt,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.search=s),type:"text",placeholder:"Search by number, outlet, warehouse, or creator...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",onKeyup:q(y,["enter"])},null,544),[[_,r.search]])]),O.value&&f.outlets&&f.outlets.length>0?(n(),i("div",it,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Outlet",-1)),u(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.outlet_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"},[e[9]||(e[9]=t("option",{value:""},"All Outlets",-1)),(n(!0),i(h,null,w(f.outlets,s=>(n(),i("option",{key:s.id,value:s.id},l(s.name),9,lt))),128))],512),[[k,r.outlet_id]])])):v("",!0),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>r.type=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"},e[11]||(e[11]=[t("option",{value:""},"All Types",-1),t("option",{value:"internal_use"},"Internal Use",-1),t("option",{value:"spoil"},"Spoil",-1),t("option",{value:"waste"},"Waste",-1),t("option",{value:"stock_cut"},"Stock Cut",-1),t("option",{value:"r_and_d"},"R & D",-1),t("option",{value:"marketing"},"Marketing",-1),t("option",{value:"non_commodity"},"Non Commodity",-1),t("option",{value:"guest_supplies"},"Guest Supplies",-1),t("option",{value:"wrong_maker"},"Wrong Maker",-1),t("option",{value:"training"},"Training",-1)]),512),[[k,r.type]])])]),t("div",dt,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date From",-1)),u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.date_from=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[_,r.date_from]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date To",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>r.date_to=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"},null,512),[[_,r.date_to]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Per Page",-1)),u(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>r.per_page=s),onChange:y,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"},e[15]||(e[15]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),544),[[k,r.per_page]])])]),t("div",{class:"flex justify-end gap-2"},[t("button",{onClick:V,class:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition"},e[17]||(e[17]=[t("i",{class:"fa fa-refresh mr-1"},null,-1),b(" Reset ")])),t("button",{onClick:y,class:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition"},e[18]||(e[18]=[t("i",{class:"fa fa-search mr-1"},null,-1),b(" Apply Filters ")]))])]),t("div",ut,[t("div",pt,[t("table",ct,[e[22]||(e[22]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider whitespace-nowrap"},"Nomor"),t("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider whitespace-nowrap"},"Tanggal"),t("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider whitespace-nowrap"},"Tipe"),t("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider whitespace-nowrap"},"Status"),t("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider whitespace-nowrap"},"Approval"),t("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider whitespace-nowrap"},"Outlet / Warehouse"),t("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider whitespace-nowrap"},"Creator"),t("th",{class:"px-3 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider whitespace-nowrap"},"Aksi")])],-1)),t("tbody",gt,[!o.data||!o.data.data||o.data.data.length===0?(n(),i("tr",xt,e[19]||(e[19]=[t("td",{colspan:"8",class:"text-center py-10 text-green-300"},"Tidak ada data.",-1)]))):v("",!0),(n(!0),i(h,null,w(o.data.data,s=>(n(),i("tr",{key:s.id,class:"hover:bg-gray-50 transition"},[t("td",ft,[t("span",{class:g(["text-sm font-semibold",s.number&&s.number.startsWith("DRAFT-")?"text-orange-600":"text-blue-600"])},l(s.number||"-"),3)]),t("td",mt,[t("div",yt,l(N(s.date)),1),t("div",bt,l(W(s.created_at)),1)]),t("td",vt,[t("span",ht,l($(s.type)),1)]),t("td",wt,[t("span",{class:g(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",H(s.status)])},l(G(s.status)),3)]),t("td",_t,[s.approval_flows&&s.approval_flows.length>0?(n(),i("div",kt,[(n(!0),i(h,null,w(s.approval_flows,d=>(n(),i("span",{key:d.approval_level,class:g([J(d.status),"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] font-medium whitespace-nowrap"]),title:`Level ${d.approval_level}: ${d.approver_name} (${d.status})`}," L"+l(d.approval_level),11,Dt))),128))])):(n(),i("span",Ct,"-"))]),t("td",St,[t("div",Tt,l(s.outlet_name),1),t("div",Et,l(s.warehouse_outlet_name||"-"),1)]),t("td",Bt,[t("span",{class:"text-sm text-gray-900 max-w-[120px] truncate block",title:s.creator_name||"-"},l(s.creator_name||"-"),9,At)]),t("td",Mt,[t("div",Rt,[t("button",{class:"inline-flex items-center justify-center w-8 h-8 bg-green-100 text-green-700 hover:bg-green-200 rounded transition",onClick:d=>U(s.id),title:"Detail"},e[20]||(e[20]=[t("i",{class:"fa fa-eye text-sm"},null,-1)]),8,Lt),s.status==="DRAFT"?(n(),i("button",{key:0,class:"inline-flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-700 hover:bg-blue-200 rounded transition",onClick:d=>j(s.id),title:"Edit"},e[21]||(e[21]=[t("i",{class:"fa fa-edit text-sm"},null,-1)]),8,Ot)):v("",!0),t("button",{class:"inline-flex items-center justify-center w-8 h-8 bg-red-100 text-red-700 hover:bg-red-200 rounded transition",onClick:d=>I(s.id),disabled:m.value===s.id,title:"Hapus"},[t("i",{class:g([m.value===s.id?"fa fa-spinner fa-spin":"fa fa-trash","text-sm"])},null,2)],8,Vt)])])]))),128))])])]),o.data&&o.data.links&&o.data.links.length>3?(n(),i("div",Ft,[t("div",Pt,[t("div",Ut," Showing "+l(o.data.from||0)+" to "+l(o.data.to||0)+" of "+l(o.data.total||0)+" results ",1),t("div",jt,[(n(!0),i(h,null,w(o.data.links,s=>(n(),R(X(tt),{key:s.label,href:s.url||"#",class:g(["px-3 py-2 text-sm rounded-md transition",s.active?"bg-green-500 text-white font-semibold":s.url?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"]),innerHTML:s.label},null,8,["href","class","innerHTML"]))),128))])])])):v("",!0)])])]),_:1}))}};export{Qt as default};
