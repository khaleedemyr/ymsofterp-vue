import{a as c}from"./vendor-utils-CpgP2uT4.js";import O from"./FilterBar-Bldxef7N.js";import _ from"./KanbanBoard-B99TVFjp.js";import{$ as T,c as p,r as u,a as w,n as g,w as x,L as y,B as b,R as N,D as E,x as m,N as A,F}from"./vendor-vue-g7iCcTkf.js";import{A as L}from"./AppLayout-BpSu8nlk.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./app-C7BJ3pFi.js";import"./vendor-charts-CuqD4wLC.js";import"./KanbanColumn-Cay4jKBy.js";import"./KanbanCard-DTSaThE8.js";import"./CommentModal-GvRka-2x.js";import"./CameraModal-UOq4SzNh.js";import"./vendor-ui-CrPgGUUb.js";import"./AssignMemberModal-Dve_0Ypd.js";import"./ActionPlanButton-B-KASXkn.js";import"./ActionPlanList-XU2D29cy.js";import"./id-C4ThNj35.js";import"./AddRetailItem-BXVCwB5m.js";import"./RetailList-nbVbAXBp.js";import"./TimelineModal-wu9gKOdI.js";import"./PurchaseRequisitionListModal-CPdbyYQQ.js";import"./PurchaseRequisitionForm-C67jgfAL.js";import"./PurchaseOrderTypeModal-CY2Rqcl6.js";import"./BiddingStartModal-DZmboMrH.js";import"./BiddingPrintPreviewModal-BsohxcIw.js";import"./BiddingList-46nGJqqS.js";import"./BiddingSupplierInputModal-Dn5O5Iqm.js";import"./PurchaseOrderListModal-CHcdBWfr.js";import"./PurchaseOrderDetailModal-BFFqiKFT.js";import"./GoodReceiveModal-OrofRLRF.js";import"./EvidenceModal-BlQiPLPh.js";import"./EvidenceList-eDE95GxJ.js";import"./CreateTaskModal-O9EDVgav.js";import"./ProfileUpdateModal-DDWCBsJM.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const S={class:"mb-2 text-sm text-gray-500"},U={layout:L},B=Object.assign(U,{__name:"index",setup(C){c.defaults.baseURL=window.location.origin;const v=T(),s=p(()=>{var e,t;return((t=(e=v.props.auth)==null?void 0:e.user)==null?void 0:t.id_outlet)||""}),n=u(null),f=u([]),o=u([]),l=u(""),a=u(""),i=p(()=>s.value&&s.value!=1);async function k(){console.log("Fetching outlets...");const{data:e}=await c.get("/api/outlet/active");f.value=e,console.log("Outlets fetched:",e)}async function r(e){console.log("Fetching rukos for outlet:",e);try{if(e==1){console.log("Testing ruko endpoint...");const t=await c.get("/api/ruko/test");console.log("Ruko test response:",t.data);const d=await c.get("/api/ruko",{params:{id_outlet:1}});console.log("Rukos API response:",d),o.value=d.data,console.log("Rukos fetched:",d.data),console.log("Rukos count:",o.value.length)}else o.value=[],console.log("Rukos cleared for non-outlet-1")}catch(t){console.error("Error fetching rukos:",t),console.error("Error response:",t.response),o.value=[]}}async function h(e){var t;console.log("=== OUTLET CHANGE START ==="),console.log("Outlet changed to:",e),l.value=String(e),a.value="",console.log("Ruko selection reset"),await r(e),e==1&&o.value.length>0&&(a.value=o.value[0].id_ruko,console.log("Auto-selected first ruko:",a.value),await g(),console.log("After nextTick - selectedRuko:",a.value)),console.log("Final state - selectedOutlet:",l.value,"selectedRuko:",a.value),console.log("Rukos array state:",o.value),console.log("Rukos length:",o.value.length),o.value.length>0&&console.log("First ruko data:",o.value[0]),(t=n.value)!=null&&t.refreshTasks&&(console.log("Refreshing tasks after outlet change"),await n.value.refreshTasks()),console.log("=== OUTLET CHANGE END ===")}async function R(e){var t;console.log("Ruko changed to:",e),a.value=e,(t=n.value)!=null&&t.refreshTasks&&(console.log("Refreshing tasks after ruko change"),await n.value.refreshTasks())}return w(async()=>{console.log("=== COMPONENT MOUNTED START ==="),console.log("Component mounted, userOutlet:",s.value),await k(),i.value?(l.value=String(s.value),await r(s.value)):s.value==1&&(l.value="1",await r(1),o.value.length>0&&(a.value=o.value[0].id_ruko,console.log("Auto-selected first ruko on mount:",a.value),await g(),console.log("After nextTick - selectedRuko:",a.value))),console.log("Final mounted state - selectedOutlet:",l.value,"selectedRuko:",a.value),console.log("Rukos array state:",o.value),console.log("Rukos length:",o.value.length),o.value.length>0&&console.log("First ruko data:",o.value[0]),document.title="Maintenance Order - YMSoft",console.log("=== COMPONENT MOUNTED END ===")}),x(s,e=>{i.value?(l.value=String(e),r(e)):e==1&&(l.value="1",r(1))}),(e,t)=>(b(),y(F,null,[t[0]||(t[0]=N('<div class="flex justify-between items-center mb-6" data-v-0a8f5827><h1 class="text-2xl font-bold text-blue-900" data-v-0a8f5827>Maintenance Order</h1><div class="flex gap-3" data-v-0a8f5827><a href="/maintenance-order/list" class="btn-secondary" data-v-0a8f5827><i class="fas fa-list mr-2" data-v-0a8f5827></i> List View </a><a href="/maintenance-order/schedule-calendar" class="btn-primary" data-v-0a8f5827><i class="fas fa-calendar-alt mr-2" data-v-0a8f5827></i> Lihat Kalender Jadwal </a></div></div>',1)),E("div",S,"ID Outlet User Login: "+A(s.value),1),m(O,{outlets:f.value,rukos:o.value,selectedOutlet:l.value,selectedRuko:a.value,disableOutlet:i.value,hideRuko:i.value,"onUpdate:outlet":h,"onUpdate:ruko":R},null,8,["outlets","rukos","selectedOutlet","selectedRuko","disableOutlet","hideRuko"]),m(_,{ref_key:"kanbanBoard",ref:n,outlet:l.value,ruko:a.value},null,8,["outlet","ruko"])],64))}}),Oe=M(B,[["__scopeId","data-v-0a8f5827"]]);export{Oe as default};
