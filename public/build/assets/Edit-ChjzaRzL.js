import{r as b,k as U,c as M,a as O,A as T,B as d,C as f,D as t,G as u,O as $,N as y,L as x,E as V,H as s,F,M as L,I as S,x as C,Q as _,J as i,W as P}from"./vendor-vue-g7iCcTkf.js";import{u as R,A as q}from"./AppLayout-BKllqouQ.js";import{s as h}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import"./vendor-utils-CpgP2uT4.js";import"./app-DlrnVByK.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-10Z7fBeb.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const E={class:"w-full py-8 px-0"},j={class:"bg-white rounded-2xl shadow-2xl p-6"},I={class:"mb-4"},H={class:"text-lg font-semibold text-gray-900"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},G=["value"],J={key:0,class:"md:col-span-2"},K={class:"mt-1 text-xs text-gray-500"},Q={class:"mt-6"},z={class:"mt-6"},X={class:"flex justify-end gap-4"},Y=["disabled"],Z={key:0,class:"fa fa-spinner fa-spin mr-2"},pe={__name:"Edit",props:{payment:Object,suppliers:Array,banks:{type:Array,default:()=>[]}},setup(g){const l=g,r=b(!1),{showLoading:A,hideLoading:c}=R(),m=b(null),p=b([]),k=b(null),n=U({supplier_id:"",amount:"",payment_method:"",bank_id:null,payment_date:"",due_date:"",description:"",reference_number:"",notes:""}),v=M(()=>!l.banks||!Array.isArray(l.banks)?[]:l.banks.map(o=>{var a;const e=((a=o.outlet)==null?void 0:a.nama_outlet)||o.outlet_name||"Head Office";return{...o,display_name:`${o.bank_name} - ${o.account_number} (${o.account_name}) - ${e}`}}));function N(o){o&&o.id&&(n.bank_id=o.id)}function B(){n.bank_id=null,m.value=null}O(()=>{if(l.payment&&(n.supplier_id=l.payment.supplier_id||"",n.amount=l.payment.amount||"",n.payment_method=l.payment.payment_method||"",n.bank_id=l.payment.bank_id||null,n.coa_id=l.payment.coa_id||"",n.payment_date=l.payment.payment_date?new Date(l.payment.payment_date).toISOString().split("T")[0]:"",n.due_date=l.payment.due_date?new Date(l.payment.due_date).toISOString().split("T")[0]:"",n.description=l.payment.description||"",n.reference_number=l.payment.reference_number||"",n.notes=l.payment.notes||"",l.payment.bank_id&&v.value.length>0)){const o=v.value.find(e=>e.id==l.payment.bank_id);o&&(m.value=o)}(async function(){try{const o=await axios.get("/api/chart-of-accounts/dropdown");if(p.value=(o.data||[]).map(e=>({...e,display_name:`${e.code} - ${e.name}`})),n.coa_id){const e=p.value.find(a=>String(a.id)===String(n.coa_id));e&&(k.value=e)}}catch(o){console.error("Failed to load COA list",o),p.value=[]}})()});function w(){P.visit(`/non-food-payments/${l.payment.id}`)}function D(){r.value=!0,A("Menyimpan perubahan Non Food Payment...","Mohon tunggu sebentar"),P.put(`/non-food-payments/${l.payment.id}`,n,{onSuccess:()=>{r.value=!1,c()},onError:o=>{r.value=!1,c(),console.error("Validation errors:",o)},onFinish:()=>{r.value=!1,c()}})}return(o,e)=>(d(),T(q,null,{default:f(()=>[t("div",E,[t("div",{class:"flex justify-between items-center mb-6"},[e[13]||(e[13]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-pencil-alt"}),u(" Edit Non Food Payment ")],-1)),t("button",{onClick:w,class:"bg-gray-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},e[12]||(e[12]=[t("i",{class:"fa fa-arrow-left mr-1"},null,-1),u(" Kembali ")]))]),t("form",{onSubmit:$(D,["prevent"]),class:"space-y-6"},[t("div",j,[e[31]||(e[31]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Informasi Payment",-1)),t("div",I,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Payment Number",-1)),t("p",H,y(g.payment.payment_number),1)]),t("div",W,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Supplier *",-1)),s(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>n.supplier_id=a),required:"",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},[e[15]||(e[15]=t("option",{value:""},"Pilih Supplier",-1)),(d(!0),x(F,null,L(g.suppliers,a=>(d(),x("option",{key:a.id,value:a.id},y(a.name),9,G))),128))],512),[[S,n.supplier_id]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Akun Pembayaran (COA)",-1)),C(_(h),{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=a=>k.value=a),options:p.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Pilih Akun (ketik untuk mencari)",label:"display_name","track-by":"id",onSelect:e[2]||(e[2]=a=>o.onCoaSelect(a)),onRemove:e[3]||(e[3]=()=>o.onCoaRemove()),class:"w-full"},{noOptions:f(()=>e[17]||(e[17]=[t("span",null,"Tidak ada akun ditemukan",-1)])),_:1},8,["modelValue","options"]),e[19]||(e[19]=t("p",{class:"mt-1 text-xs text-gray-500"},"Opsional: pilih akun untuk jurnal pembayaran",-1))]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Amount * "),t("span",{class:"text-xs font-normal text-gray-500"},"(Dapat diubah)")],-1)),s(t("input",{type:"number","onUpdate:modelValue":e[4]||(e[4]=a=>n.amount=a),step:"0.01",min:"0",required:"",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"0.00"},null,512),[[i,n.amount]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Payment Method *",-1)),s(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>n.payment_method=a),required:"",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},e[21]||(e[21]=[t("option",{value:""},"Pilih Payment Method",-1),t("option",{value:"cash"},"Cash",-1),t("option",{value:"transfer"},"Transfer",-1),t("option",{value:"check"},"Check",-1)]),512),[[S,n.payment_method]])]),n.payment_method==="transfer"||n.payment_method==="check"?(d(),x("div",J,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Pilih Bank "),t("span",{class:"text-red-500"},"*")],-1)),C(_(h),{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=a=>m.value=a),options:v.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Cari dan pilih bank...",label:"display_name","track-by":"id",onSelect:N,onRemove:B,class:"w-full",required:""},{noOptions:f(()=>e[23]||(e[23]=[t("span",null,"Tidak ada bank ditemukan",-1)])),noResult:f(()=>e[24]||(e[24]=[t("span",null,"Tidak ada bank ditemukan",-1)])),_:1},8,["modelValue","options"]),t("p",K,"Cari dan pilih bank dari master data bank untuk "+y(n.payment_method==="transfer"?"Transfer":"Check"),1)])):V("",!0),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Payment Date *",-1)),s(t("input",{type:"date","onUpdate:modelValue":e[7]||(e[7]=a=>n.payment_date=a),required:"",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[i,n.payment_date]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Due Date",-1)),s(t("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=a=>n.due_date=a),class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[i,n.due_date]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Reference Number",-1)),s(t("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=a=>n.reference_number=a),class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Nomor referensi"},null,512),[[i,n.reference_number]])])]),t("div",Q,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),s(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=a=>n.description=a),rows:"3",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Deskripsi payment"},null,512),[[i,n.description]])]),t("div",z,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notes",-1)),s(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=a=>n.notes=a),rows:"3",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Catatan tambahan"},null,512),[[i,n.notes]])])]),t("div",X,[t("button",{type:"button",onClick:w,class:"bg-gray-500 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," Batal "),t("button",{type:"submit",disabled:r.value,class:"bg-gradient-to-r from-green-500 to-green-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold disabled:opacity-50"},[r.value?(d(),x("i",Z)):V("",!0),u(" "+y(r.value?"Menyimpan...":"Update Payment"),1)],8,Y)])],32)])]),_:1}))}};export{pe as default};
