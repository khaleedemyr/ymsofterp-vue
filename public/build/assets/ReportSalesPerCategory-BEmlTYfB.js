import{r as p,c as S,w as j,A as K,B as s,C as O,D as t,L as l,E as D,H as g,J as W,F as m,M as c,N as r,I as y,G as E,l as G,W as H}from"./vendor-vue-g7iCcTkf.js";import{A as z}from"./AppLayout-Cbd4awZb.js";import"./vendor-utils-CpgP2uT4.js";import"./app-BGYKUG_N.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-BnNxTHIx.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const Y={class:"w-full min-h-screen bg-gray-50 py-4 px-0"},q={class:"w-full flex flex-wrap gap-3 items-center mb-4 px-2"},Q={class:"flex items-center gap-2"},X=["value"],Z={class:"flex items-center gap-2"},$=["value"],ee={class:"flex items-center gap-2"},te=["value"],ae={class:"flex items-center gap-2"},se=["value"],le={class:"flex items-center gap-2"},re=["value"],oe=["disabled"],ne={key:0,class:"animate-spin mr-2"},ue={key:1,class:"mr-2"},de={class:"bg-white rounded-xl shadow-lg overflow-x-auto w-full px-2"},ie={class:"min-w-full border border-gray-300"},pe={key:0},be={class:"px-4 py-2 border border-gray-200"},ge=["rowspan"],me={key:1,style:{display:"none"}},ce=["rowspan"],ye={key:3,style:{display:"none"}},ve={class:"px-4 py-2 border border-gray-200"},xe={class:"px-4 py-2 border border-gray-200 text-right"},fe={key:0},he={class:"bg-gray-50 font-bold"},ke={class:"px-6 py-3 text-right"},we={key:0,class:"flex justify-between items-center mt-4"},Ce={class:"text-sm text-gray-600"},Ne={class:"flex gap-1"},Se=["disabled"],Ae={class:"px-2"},De=["disabled"],_e={__name:"ReportSalesPerCategory",props:{report:Array,warehouses:Array,categories:Array,years:Array,filters:Object,total:Number,perPage:Number,page:Number},setup(n){const i=n,M=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],v=p(i.filters.search||""),x=p(i.filters.warehouse||""),f=p(i.filters.category||""),h=p(i.filters.tahun||""),k=p(i.filters.bulan||""),b=p(i.perPage||25),d=p(i.page||1),w=p(!1),P=S(()=>(d.value-1)*b.value),I=S(()=>Math.min(P.value+i.report.length,i.total)),C=S(()=>Math.ceil(i.total/b.value)||1);function U(){d.value>1&&(d.value--,A())}function R(){d.value<C.value&&(d.value++,A())}j([v,x,f,h,k,b],()=>{d.value=1});function A(){w.value=!0,H.get("/report-sales-per-category",{search:v.value,warehouse:x.value,category:f.value,tahun:h.value,bulan:k.value,perPage:b.value,page:d.value},{preserveState:!0,preserveScroll:!0,onFinish:()=>w.value=!1})}const _=S(()=>i.report.reduce((o,e)=>o+(Number(e.nilai)||0),0));function T(o){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o||0)}function V(o,e,a,u){return e===0?!0:o[e][a]!==o[e-1][a]||o[e][u]!==o[e-1][u]}function B(o,e,a,u){const J=o[e][a],L=o[e][u];let F=1;for(let N=e+1;N<o.length&&(o[N][a]===J&&o[N][u]===L);N++)F++;return F}return(o,e)=>(s(),K(z,null,{default:O(()=>[t("div",Y,[e[22]||(e[22]=t("h1",{class:"text-2xl font-bold mb-6"},"Report Penjualan per Category",-1)),t("div",q,[g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),type:"text",placeholder:"Cari gudang, kategori...",class:"px-4 py-2 border border-gray-300 rounded-lg flex-1 min-w-[180px] focus:ring-blue-500 focus:border-blue-500"},null,512),[[W,v.value]]),t("div",Q,[e[7]||(e[7]=t("label",{class:"text-sm"},"Gudang",-1)),g(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500 min-w-[140px]"},[e[6]||(e[6]=t("option",{value:""},"Semua Gudang",-1)),(s(!0),l(m,null,c(n.warehouses,a=>(s(),l("option",{key:a.name,value:a.name},r(a.name),9,X))),128))],512),[[y,x.value]])]),t("div",Z,[e[9]||(e[9]=t("label",{class:"text-sm"},"Kategori",-1)),g(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>f.value=a),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500 min-w-[140px]"},[e[8]||(e[8]=t("option",{value:""},"Semua Kategori",-1)),(s(!0),l(m,null,c(n.categories,a=>(s(),l("option",{key:a.name,value:a.name},r(a.name),9,$))),128))],512),[[y,f.value]])]),t("div",ee,[e[11]||(e[11]=t("label",{class:"text-sm"},"Tahun",-1)),g(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>h.value=a),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500 min-w-[100px]"},[e[10]||(e[10]=t("option",{value:""},"Semua Tahun",-1)),(s(!0),l(m,null,c(n.years,a=>(s(),l("option",{key:a,value:a},r(a),9,te))),128))],512),[[y,h.value]])]),t("div",ae,[e[13]||(e[13]=t("label",{class:"text-sm"},"Bulan",-1)),g(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>k.value=a),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500 min-w-[100px]"},[e[12]||(e[12]=t("option",{value:""},"Semua Bulan",-1)),(s(),l(m,null,c(M,(a,u)=>t("option",{key:u,value:u+1},r(a),9,se)),64))],512),[[y,k.value]])]),t("div",le,[e[14]||(e[14]=t("label",{class:"text-sm"},"Tampilkan",-1)),g(t("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>b.value=a),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500 min-w-[80px]"},[(s(),l(m,null,c([10,25,50,100],a=>t("option",{key:a,value:a},r(a),9,re)),64))],512),[[y,b.value]]),e[15]||(e[15]=t("span",{class:"text-sm"},"data",-1))]),t("button",{onClick:A,disabled:w.value,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md font-semibold hover:bg-blue-700"},[w.value?(s(),l("span",ne,e[16]||(e[16]=[t("i",{class:"fas fa-spinner"},null,-1)]))):(s(),l("span",ue,e[17]||(e[17]=[t("i",{class:"fas fa-sync-alt"},null,-1)]))),e[18]||(e[18]=E(" Load Data "))],8,oe)]),t("div",de,[t("table",ie,[e[21]||(e[21]=t("thead",null,[t("tr",{class:"bg-yellow-300 text-gray-900"},[t("th",{class:"px-4 py-2 border border-gray-300"},"Gudang"),t("th",{class:"px-4 py-2 border border-gray-300"},"Bulan"),t("th",{class:"px-4 py-2 border border-gray-300"},"Tahun"),t("th",{class:"px-4 py-2 border border-gray-300"},"Kategori"),t("th",{class:"px-4 py-2 border border-gray-300 text-right"},"Nilai")])],-1)),t("tbody",null,[n.report.length?D("",!0):(s(),l("tr",pe,e[19]||(e[19]=[t("td",{colspan:"5",class:"text-center py-10 text-gray-400"},"Tidak ada data.",-1)]))),(s(!0),l(m,null,c(n.report,(a,u)=>(s(),l("tr",{key:a.gudang+"-"+a.bulan+"-"+a.tahun+"-"+a.category},[t("td",be,r(a.gudang),1),V(n.report,u,"bulan","tahun")?(s(),l("td",{key:0,rowspan:B(n.report,u,"bulan","tahun"),class:"px-4 py-2 border border-gray-200 align-top"},r(M[a.bulan-1]),9,ge)):(s(),l("td",me)),V(n.report,u,"tahun","bulan")?(s(),l("td",{key:2,rowspan:B(n.report,u,"tahun","bulan"),class:"px-4 py-2 border border-gray-200 align-top"},r(a.tahun),9,ce)):(s(),l("td",ye)),t("td",ve,r(a.category),1),t("td",xe,r(T(a.nilai)),1)]))),128))]),n.report.length?(s(),l("tfoot",fe,[t("tr",he,[e[20]||(e[20]=t("td",{colspan:"4",class:"text-right px-6 py-3"},"Grand Total",-1)),t("td",ke,r(T(_.value)),1)])])):D("",!0)])]),n.total>0?(s(),l("div",we,[t("div",Ce," Menampilkan "+r(P.value+1)+" - "+r(I.value)+" dari "+r(n.total)+" data ",1),t("div",Ne,[t("button",{onClick:U,disabled:d.value===1,class:G(["px-3 py-1 rounded border text-sm",d.value===1?"bg-gray-200 text-gray-400":"bg-white text-blue-700 hover:bg-blue-50"])},"<",10,Se),t("span",Ae,"Halaman "+r(d.value)+" / "+r(C.value),1),t("button",{onClick:R,disabled:d.value===C.value,class:G(["px-3 py-1 rounded border text-sm",d.value===C.value?"bg-gray-200 text-gray-400":"bg-white text-blue-700 hover:bg-blue-50"])},">",10,De)])])):D("",!0)])]),_:1}))}};export{_e as default};
