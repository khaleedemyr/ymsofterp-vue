import{r as k,c as Fe,W as te,w as tt,a as st,j as lt,A as at,B as a,C as ot,D as e,L as o,E as u,G as i,H as w,J as j,I as de,F as D,M as E,N as r,l as U,O as N}from"./vendor-vue-g7iCcTkf.js";import{l as rt}from"./lodash-DB3HVzpp.js";import{S as y}from"./app-fC6wJyCz.js";import{A as it}from"./AppLayout-_5DIDCQX.js";import{a as X}from"./vendor-utils-CpgP2uT4.js";import{_ as nt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-OI-F7Vdc.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const dt={class:"w-full py-8 px-4"},ut={class:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-100"},pt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ct={class:"bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-100"},bt={class:"overflow-x-auto"},ft={class:"w-full min-w-full divide-y divide-gray-200"},xt={class:"bg-white divide-y divide-gray-200"},vt={key:0},gt={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900"},mt={class:"px-6 py-4 whitespace-nowrap"},yt={class:"flex items-center"},kt={class:"flex-shrink-0 h-10 w-10 rounded-full overflow-hidden bg-blue-100 flex items-center justify-center border-2 border-blue-200"},_t=["src","alt"],wt={key:1,class:"fa-solid fa-user text-blue-600"},ht={class:"ml-3"},Ct={class:"text-sm font-semibold text-gray-900"},Tt={class:"px-6 py-4 whitespace-nowrap"},At={class:"flex items-center gap-2"},Pt={key:0,class:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold border border-green-300",title:"File playback tersedia"},jt={class:"px-6 py-4"},$t={key:0,class:"flex flex-wrap gap-1 max-w-xs"},qt={key:0,class:"px-2 py-1 bg-gray-100 text-gray-600 rounded-lg text-xs font-semibold"},Mt={key:1,class:"text-gray-400 text-sm"},Vt={class:"px-6 py-4"},Bt={key:0},Dt={class:"text-sm font-medium text-gray-900"},Et={key:1},Ut={class:"text-sm font-medium text-gray-900"},St={key:0,class:"text-xs text-gray-500 mt-1"},Ft={key:1,class:"text-xs text-gray-500 mt-1"},Lt={class:"px-6 py-4"},Ot={class:"max-w-xs"},It=["title"],Rt={class:"px-6 py-4 whitespace-nowrap"},zt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},Nt={class:"px-6 py-4 whitespace-nowrap text-center"},Wt={class:"flex items-center justify-center gap-2"},Gt=["onClick"],Ht=["onClick"],Jt=["onClick"],Kt=["onClick"],Yt=["onClick","title","disabled"],Qt={key:0,class:"ml-1"},Xt=["onClick"],Zt={key:0,class:"bg-white px-6 py-4 border-t border-gray-200"},es={class:"flex items-center justify-between"},ts={class:"flex-1 flex justify-between sm:hidden"},ss=["disabled"],ls=["disabled"],as={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},os={class:"text-sm text-gray-700"},rs={class:"font-medium"},is={class:"font-medium"},ns={class:"font-medium"},ds={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},us=["disabled"],ps=["onClick"],cs=["disabled"],bs={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"},fs={class:"sticky top-0 bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center"},xs={class:"text-xl font-bold flex items-center gap-2"},vs={class:"p-6"},gs=["disabled"],ms={class:"text-xs text-gray-500 mt-1"},ys={key:0},ks={key:1},_s={class:"outlet-dropdown-container"},ws={class:"relative"},hs={class:"flex flex-wrap gap-2 flex-1"},Cs={key:0,class:"text-gray-400"},Ts=["onClick"],As={key:0,class:"absolute z-50 w-full mt-2 bg-white border-2 border-blue-200 rounded-xl shadow-2xl max-h-60 overflow-y-auto outlet-dropdown-container"},Ps={class:"p-3 border-b border-gray-200 sticky top-0 bg-white"},js={class:"p-2"},$s=["checked","onChange"],qs={class:"text-sm font-medium text-gray-700"},Ms={key:0,class:"px-3 py-2 text-sm text-gray-400 text-center"},Vs={class:"text-xs text-gray-500 mt-2"},Bs={key:0,class:"bg-blue-50 p-4 rounded-xl border-2 border-blue-200"},Ds={key:1,class:"bg-purple-50 p-4 rounded-xl border-2 border-purple-200"},Es={class:"space-y-4"},Us={class:"grid grid-cols-2 gap-4"},Ss=["min"],Fs={class:"grid grid-cols-2 gap-4"},Ls={class:"flex justify-end gap-3 pt-4 border-t border-gray-200"},Os=["disabled"],Is=["disabled"],Rs={key:0,class:"fa-solid fa-spinner fa-spin"},zs={key:1,class:"fa-solid fa-save"},Ns={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto"},Ws={class:"sticky top-0 bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center"},Gs={class:"p-6"},Hs={key:0,class:"space-y-6"},Js={class:"grid grid-cols-2 gap-4"},Ks={class:"bg-blue-50 p-4 rounded-xl border border-blue-200"},Ys={class:"flex items-center gap-3"},Qs={class:"flex-shrink-0 h-12 w-12 rounded-full overflow-hidden bg-blue-100 flex items-center justify-center border-2 border-blue-200"},Xs=["src","alt"],Zs={key:1,class:"fa-solid fa-user text-blue-600 text-xl"},el={class:"text-sm font-bold text-gray-900"},tl={class:"bg-blue-50 p-4 rounded-xl border border-blue-200"},sl={class:"bg-blue-50 p-4 rounded-xl border border-blue-200"},ll={class:"bg-blue-50 p-4 rounded-xl border border-blue-200"},al={class:"text-sm font-bold text-gray-900"},ol={class:"bg-gray-50 p-4 rounded-xl border border-gray-200"},rl={key:0,class:"flex flex-wrap gap-2"},il={key:1,class:"text-gray-400 text-sm"},nl={key:0,class:"bg-blue-50 p-4 rounded-xl border-2 border-blue-200"},dl={class:"text-sm font-bold text-gray-900"},ul={key:1,class:"bg-purple-50 p-4 rounded-xl border-2 border-purple-200 space-y-4"},pl={class:"text-sm font-bold text-gray-900"},cl={class:"grid grid-cols-2 gap-4"},bl={class:"text-sm font-bold text-gray-900"},fl={class:"text-sm font-bold text-gray-900"},xl={class:"grid grid-cols-2 gap-4"},vl={class:"text-sm font-bold text-gray-900"},gl={class:"text-sm font-bold text-gray-900"},ml={class:"grid grid-cols-2 gap-4"},yl={class:"text-sm font-bold text-gray-900"},kl={class:"text-sm font-bold text-gray-900"},_l={class:"text-sm text-gray-900 whitespace-pre-wrap"},wl={key:0,class:"bg-white p-4 rounded-lg border border-purple-300"},hl={class:"block text-xs font-semibold text-gray-500 mb-3"},Cl={class:"space-y-3"},Tl={key:0,class:"text-xs text-gray-500"},Al={key:1,class:"text-xs text-gray-500"},Pl={key:0,class:"ml-2"},jl={class:"mt-3 space-y-3"},$l={class:"p-3 bg-purple-50 border-b border-purple-200"},ql={class:"flex items-center justify-between"},Ml={class:"flex items-center gap-2"},Vl={class:"text-sm font-semibold text-gray-900"},Bl={key:0,class:"inline-flex items-center px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-semibold"},Dl={key:0,class:"p-3"},El=["src"],Ul={key:1,class:"p-6 text-center"},Sl={class:"bg-gray-50 p-4 rounded-xl border border-gray-200"},Fl={class:"text-sm text-gray-900 whitespace-pre-wrap"},Ll={key:2,class:"bg-green-50 p-4 rounded-xl border border-green-200"},Ol={class:"text-sm font-bold text-gray-900"},Il={key:0,class:"text-xs text-gray-500 mt-1"},Rl={key:1,class:"text-xs text-gray-500 mt-1"},zl={key:3,class:"bg-yellow-50 p-4 rounded-xl border border-yellow-200"},Nl={class:"text-sm text-gray-900 whitespace-pre-wrap"},Wl={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-2xl"},Gl={class:"p-6 space-y-4"},Hl={class:"bg-purple-50 p-4 rounded-xl border-2 border-purple-200"},Jl={class:"text-sm text-gray-700 mb-2"},Kl={class:"text-sm text-gray-700"},Yl={key:0,class:"mt-3 space-y-2"},Ql={class:"flex items-center gap-2 flex-1"},Xl={class:"flex-1 min-w-0"},Zl={class:"text-sm font-semibold text-gray-900 truncate"},ea={class:"text-xs text-gray-500"},ta=["onClick"],sa={class:"text-xs text-purple-700 font-semibold"},la=["min"],aa={class:"flex justify-end gap-3 pt-4 border-t"},oa=["disabled"],ra={key:0,class:"fa-solid fa-spinner fa-spin"},ia={key:1,class:"fa-solid fa-upload"},na={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto"},da={class:"p-6"},ua={key:0,class:"space-y-4"},pa={class:"bg-green-50 p-4 rounded-xl border-2 border-green-200"},ca={class:"text-sm text-gray-700 mb-2"},ba={class:"text-sm text-gray-700 mb-2"},fa={key:0,class:"text-sm text-gray-700 mb-2"},xa={key:1,class:"text-sm text-gray-700 mb-2"},va={key:0,class:"ml-2"},ga={class:"space-y-4"},ma={class:"text-lg font-bold text-gray-900"},ya={class:"p-4 bg-green-50 border-b border-green-200"},ka={class:"flex items-center justify-between"},_a={class:"flex items-center gap-3"},wa={class:"text-sm font-bold text-gray-900"},ha={class:"text-xs text-gray-500"},Ca={key:0,class:"inline-flex items-center px-3 py-1 bg-red-100 text-red-700 rounded-lg text-xs font-semibold"},Ta={key:0,class:"p-4"},Aa=["src"],Pa={key:1,class:"p-8 text-center"},ja={class:"text-sm text-gray-400 mt-1"},$a={__name:"Index",props:{requests:Object,outlets:Array,filters:Object,isITManager:Boolean,isITTeam:Boolean},setup(v){var me,ye,ke,_e;const S=v,M=k(((me=S.filters)==null?void 0:me.search)||""),C=k(((ye=S.filters)==null?void 0:ye.status)||"all"),T=k(((ke=S.filters)==null?void 0:ke.access_type)||"all"),W=k(((_e=S.filters)==null?void 0:_e.per_page)||15),se=k(!1),le=k(!1),Z=k("create"),n=k(null),K=k(!1),ue=k(!1),V=k(null),A=k([]),ee=k(!1),G=k(""),pe=k(!1),m=k(null),_=k([]),H=k(!1),J=k(""),d=k({access_type:"live_view",reason:"",outlet_ids:[],email:"",area:"",date_from:"",date_to:"",time_from:"",time_to:"",incident_description:""}),be=Fe(()=>{if(!J.value)return S.outlets||[];const l=J.value.toLowerCase();return(S.outlets||[]).filter(t=>t.nama_outlet.toLowerCase().includes(l))});Fe(()=>_.value.map(l=>{var p;const t=(p=S.outlets)==null?void 0:p.find(b=>b.id_outlet===l);return(t==null?void 0:t.nama_outlet)||l}));function Le(l){const t=_.value.indexOf(l);t>-1?_.value.splice(t,1):_.value.push(l),d.value.outlet_ids=[..._.value]}function Oe(l){const t=_.value.indexOf(l);t>-1&&(_.value.splice(t,1),d.value.outlet_ids=[..._.value])}const Ie=rt.debounce(()=>{te.get("/cctv-access-requests",{search:M.value,status:C.value,access_type:T.value,per_page:W.value},{preserveState:!0,replace:!0})},400);function Re(){Ie()}function ae(l){if(!l)return;let t=1;try{let b=l;l.startsWith("/")?b=window.location.origin+l:l.startsWith("http")||(b=window.location.origin+"/"+l);const c=new URL(b).searchParams.get("page");c&&(t=parseInt(c))}catch{const g=l.match(/[?&]page=(\d+)/);g&&(t=parseInt(g[1]))}(isNaN(t)||t<1)&&(t=1);const p={page:t,per_page:W.value||15};M.value&&(p.search=M.value),C.value&&C.value!=="all"&&(p.status=C.value),T.value&&T.value!=="all"&&(p.access_type=T.value),te.get("/cctv-access-requests",p,{preserveState:!1,preserveScroll:!1,replace:!0})}function ze(l){if(!l||l<1)return;const t={page:l,per_page:W.value||15};M.value&&(t.search=M.value),C.value&&C.value!=="all"&&(t.status=C.value),T.value&&T.value!=="all"&&(t.access_type=T.value),te.get("/cctv-access-requests",t,{preserveState:!1,preserveScroll:!1,replace:!0})}function Ne(){Z.value="create",n.value=null,_.value=[],J.value="",d.value={access_type:"live_view",reason:"",outlet_ids:[],email:"",area:"",date_from:"",date_to:"",time_from:"",time_to:"",incident_description:""},se.value=!0}function We(l){Z.value="edit",n.value=l;const t=Array.isArray(l.outlet_ids)?l.outlet_ids:l.outlet_ids?[l.outlet_ids]:[];_.value=[...t],J.value="",d.value={access_type:l.access_type,reason:l.reason,outlet_ids:t,email:l.email||"",area:l.area||"",date_from:l.date_from||"",date_to:l.date_to||"",time_from:l.time_from||"",time_to:l.time_to||"",incident_description:l.incident_description||""},se.value=!0}function oe(){se.value=!1,n.value=null,_.value=[],J.value="",H.value=!1,d.value={access_type:"live_view",reason:"",outlet_ids:[],email:"",area:"",date_from:"",date_to:"",time_from:"",time_to:"",incident_description:""}}function Ge(l){V.value=l,A.value=[],G.value="",ue.value=!0}function re(){ue.value=!1,V.value=null,A.value=[],G.value=""}function He(l){var c;const t=Array.from(l.target.files);if(t.length===0)return;const p=(c=V.value)!=null&&c.playback_file_path?Array.isArray(V.value.playback_file_path)?V.value.playback_file_path.length:1:0;if(p+t.length>5){y.fire("Error",`Maksimal 5 file playback. Anda sudah memiliki ${p} file.`,"error"),l.target.value="";return}const b=[],g=["video/mp4","video/avi","video/quicktime","video/x-msvideo","video/x-ms-wmv","video/x-flv","video/webm"];for(const x of t){if(!g.includes(x.type)){y.fire("Error",`File "${x.name}" harus berupa video (mp4, avi, mov, wmv, flv, webm)`,"error"),l.target.value="";return}if(x.size>100*1024*1024){y.fire("Error",`File "${x.name}" ukuran maksimal 100MB`,"error"),l.target.value="";return}b.push(x)}A.value=[...A.value,...b],l.target.value=""}function Je(l){A.value.splice(l,1)}function Ke(l){m.value=l,pe.value=!0}function fe(){pe.value=!1,m.value=null}async function Ye(){var b,g,c;if(A.value.length===0){y.fire("Error","Pilih minimal satu file playback","error");return}const l=h(V.value);if(l.length+A.value.length>5){y.fire("Error",`Maksimal 5 file playback. Anda sudah memiliki ${l.length} file.`,"error");return}if(!G.value){y.fire("Error","Tanggal valid until harus diisi","error");return}const t=new Date;t.setHours(0,0,0,0);const p=new Date(G.value);if(p.setHours(0,0,0,0),p<=t){y.fire("Error","Tanggal valid until harus setelah hari ini","error");return}ee.value=!0;try{const x=new FormData;A.value.forEach(Q=>{x.append("files[]",Q)}),x.append("valid_until",G.value);const P=await X.post(`/api/cctv-access-requests/${V.value.id}/upload-playback`,x,{headers:{"Content-Type":"multipart/form-data"}});if(P.data&&P.data.success)y.fire("Berhasil",P.data.message||"File playback berhasil diupload","success"),re(),ne();else{const Q=((b=P.data)==null?void 0:b.message)||"Gagal mengupload file playback";y.fire("Error",Q,"error")}}catch(x){console.error("Error uploading playback file:",x);const P=((c=(g=x.response)==null?void 0:g.data)==null?void 0:c.message)||x.message||"Gagal mengupload file playback";y.fire("Error",P,"error")}finally{ee.value=!1}}async function Qe(){var l,t,p,b,g;if(!d.value.outlet_ids||d.value.outlet_ids.length===0){y.fire("Error","Pilih minimal satu outlet","error");return}if(d.value.access_type==="live_view"&&!d.value.email){y.fire("Error","Email harus diisi untuk Live View","error");return}K.value=!0;try{let c;const x={access_type:d.value.access_type,reason:d.value.reason,outlet_ids:d.value.outlet_ids};d.value.access_type==="live_view"?x.email=d.value.email:(x.area=d.value.area,x.date_from=d.value.date_from,x.date_to=d.value.date_to,x.time_from=d.value.time_from,x.time_to=d.value.time_to,x.incident_description=d.value.incident_description),Z.value==="create"?c=await X.post("/api/cctv-access-requests",x):c=await X.put(`/api/cctv-access-requests/${n.value.id}`,x),(l=c.data)!=null&&l.success&&(y.fire("Berhasil",c.data.message,"success"),ne(),oe())}catch(c){let x="Gagal menyimpan data";if((p=(t=c.response)==null?void 0:t.data)!=null&&p.message)x=c.response.data.message;else if((g=(b=c.response)==null?void 0:b.data)!=null&&g.errors){const P=c.response.data.errors;x=Object.values(P).flat().join(", ")}y.fire("Error",x,"error")}finally{K.value=!1}}async function Xe(l){var t,p,b;try{const g=await X.get(`/api/cctv-access-requests/${l.id}`);(t=g.data)!=null&&t.success&&(n.value=g.data.data,le.value=!0)}catch(g){y.fire("Error",((b=(p=g.response)==null?void 0:p.data)==null?void 0:b.message)||"Gagal mengambil detail request","error")}}async function Ze(l){var p,b,g;if((await y.fire({title:"Batalkan Request?",text:"Yakin ingin membatalkan request ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Batalkan!",cancelButtonText:"Batal"})).isConfirmed)try{const c=await X.delete(`/api/cctv-access-requests/${l.id}`);(p=c.data)!=null&&p.success&&(y.fire("Berhasil",c.data.message,"success"),ne())}catch(c){y.fire("Error",((g=(b=c.response)==null?void 0:b.data)==null?void 0:g.message)||"Gagal membatalkan request","error")}}async function et(l){var p,b,g;const{value:t}=await y.fire({title:"Cabut Akses",input:"textarea",inputLabel:"Alasan Pencabutan *",inputPlaceholder:"Masukkan alasan pencabutan akses...",inputAttributes:{"aria-label":"Masukkan alasan pencabutan"},showCancelButton:!0,confirmButtonText:"Cabut",cancelButtonText:"Batal",inputValidator:c=>{if(!c)return"Alasan pencabutan harus diisi"}});if(t)try{const c=await X.post(`/api/cctv-access-requests/${l.id}/revoke`,{revocation_reason:t});(p=c.data)!=null&&p.success&&(y.fire("Berhasil",c.data.message,"success"),ne())}catch(c){y.fire("Error",((g=(b=c.response)==null?void 0:b.data)==null?void 0:g.message)||"Gagal mencabut akses","error")}}function xe(l){return{pending:"bg-yellow-100 text-yellow-800 border border-yellow-300",approved:"bg-green-100 text-green-800 border border-green-300",rejected:"bg-red-100 text-red-800 border border-red-300",revoked:"bg-orange-100 text-orange-800 border border-orange-300"}[l]||"bg-gray-100 text-gray-800 border border-gray-300"}function ve(l){return{pending:"Menunggu Approval",approved:"Disetujui",rejected:"Ditolak",revoked:"Dicabut"}[l]||l}function Y(l){return l?new Date(l).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function ie(l){return l?l.substring(0,5):"-"}function B(l){return l?new Date(l).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"}function h(l){return!l||!l.playback_file_path?[]:Array.isArray(l.playback_file_path)?l.playback_file_path:typeof l.playback_file_path=="string"?[l.playback_file_path]:[]}function $(l){if(!l||l.access_type!=="playback"||h(l).length===0||!l.valid_until)return!1;const p=new Date;p.setHours(0,0,0,0);const b=new Date(l.valid_until);return b.setHours(0,0,0,0),p>b}function ce(l){var p;const t=(p=S.outlets)==null?void 0:p.find(b=>b.id_outlet===l);return(t==null?void 0:t.nama_outlet)||l}function ne(){te.reload({preserveState:!0,replace:!0})}tt([C,T,W],()=>{const l={page:1};M.value&&(l.search=M.value),C.value&&C.value!=="all"&&(l.status=C.value),T.value&&T.value!=="all"&&(l.access_type=T.value),l.per_page=W.value||15,te.get("/cctv-access-requests",l,{preserveState:!0,replace:!0})});function ge(l){H.value&&!l.target.closest(".outlet-dropdown-container")&&(H.value=!1)}return st(()=>{document.addEventListener("click",ge)}),lt(()=>{document.removeEventListener("click",ge)}),(l,t)=>(a(),at(it,null,{default:ot(()=>{var p,b,g,c,x,P,Q,we,he,Ce,Te,Ae,Pe,je,$e,qe,Me,Ve,Be;return[e("div",dt,[e("div",{class:"flex justify-between items-center mb-6"},[t[25]||(t[25]=e("h1",{class:"text-3xl font-bold text-gray-800 flex items-center gap-3"},[e("i",{class:"fa-solid fa-video text-blue-600"}),e("span",null,"CCTV Access Request")],-1)),e("button",{onClick:Ne,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold flex items-center gap-2"},t[24]||(t[24]=[e("i",{class:"fa-solid fa-plus"},null,-1),i(" Buat Request ")]))]),e("div",ut,[e("div",pt,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-search mr-2 text-blue-500"}),i("Search ")],-1)),w(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>M.value=s),onInput:Re,placeholder:"Cari alasan atau nama user...",class:"w-full px-4 py-2.5 border-2 border-blue-200 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,544),[[j,M.value]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-filter mr-2 text-blue-500"}),i("Status ")],-1)),w(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>C.value=s),class:"w-full px-4 py-2.5 border-2 border-blue-200 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[27]||(t[27]=[e("option",{value:"all"},"Semua Status",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1),e("option",{value:"revoked"},"Revoked",-1)]),512),[[de,C.value]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-video mr-2 text-blue-500"}),i("Jenis Akses ")],-1)),w(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>T.value=s),class:"w-full px-4 py-2.5 border-2 border-blue-200 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[29]||(t[29]=[e("option",{value:"all"},"Semua",-1),e("option",{value:"live_view"},"Live View",-1),e("option",{value:"playback"},"Playback",-1)]),512),[[de,T.value]])]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-list mr-2 text-blue-500"}),i("Per Page ")],-1)),w(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>W.value=s),class:"w-full px-4 py-2.5 border-2 border-blue-200 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[31]||(t[31]=[e("option",{value:"10"},"10",-1),e("option",{value:"15"},"15",-1),e("option",{value:"25"},"25",-1),e("option",{value:"50"},"50",-1)]),512),[[de,W.value]])])])]),e("div",ct,[e("div",bt,[e("table",ft,[t[48]||(t[48]=e("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tl-2xl"},"No"),e("th",{class:"px-6 py-4 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"User"),e("th",{class:"px-6 py-4 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Jenis Akses"),e("th",{class:"px-6 py-4 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Outlet"),e("th",{class:"px-6 py-4 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Email/Area"),e("th",{class:"px-6 py-4 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Alasan"),e("th",{class:"px-6 py-4 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-4 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Tanggal"),e("th",{class:"px-6 py-4 text-center text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tr-2xl"},"Aksi")])],-1)),e("tbody",xt,[!v.requests||!v.requests.data||v.requests.data.length===0?(a(),o("tr",vt,t[33]||(t[33]=[e("td",{colspan:"9",class:"px-6 py-10 text-center text-gray-400"},[e("i",{class:"fa-solid fa-inbox text-4xl mb-2 block"}),i(" Tidak ada data request ")],-1)]))):(a(!0),o(D,{key:1},E(v.requests.data,(s,f)=>{var q,F,L,O,I,R,De,Ee,Ue,Se;return a(),o("tr",{key:s.id,class:"hover:bg-blue-50 transition-all"},[e("td",gt,r((v.requests.current_page-1)*v.requests.per_page+f+1),1),e("td",mt,[e("div",yt,[e("div",kt,[(q=s.user)!=null&&q.avatar||(F=s.user)!=null&&F.avatar_path?(a(),o("img",{key:0,src:`/storage/${s.user.avatar||s.user.avatar_path}`,alt:((L=s.user)==null?void 0:L.nama_lengkap)||"User",class:"w-full h-full object-cover"},null,8,_t)):(a(),o("i",wt))]),e("div",ht,[e("div",Ct,r(((O=s.user)==null?void 0:O.nama_lengkap)||"-"),1)])])]),e("td",Tt,[e("div",At,[e("span",{class:U([s.access_type==="live_view"?"bg-blue-100 text-blue-700 border border-blue-300":"bg-purple-100 text-purple-700 border border-purple-300","px-3 py-1.5 rounded-full text-xs font-bold shadow-sm"])},[e("i",{class:U(s.access_type==="live_view"?"fa-solid fa-eye mr-1":"fa-solid fa-play mr-1")},null,2),i(" "+r(s.access_type==="live_view"?"Live View":"Playback"),1)],2),s.access_type==="playback"&&h(s).length>0?(a(),o("span",Pt,[t[34]||(t[34]=e("i",{class:"fa-solid fa-video mr-1"},null,-1)),i(" "+r(h(s).length)+" file ",1)])):u("",!0)])]),e("td",jt,[s.outlet_ids&&Array.isArray(s.outlet_ids)&&s.outlet_ids.length>0?(a(),o("div",$t,[(a(!0),o(D,null,E(s.outlet_ids.slice(0,3),z=>(a(),o("span",{key:z,class:"px-2 py-1 bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 rounded-lg text-xs font-semibold border border-blue-200"},r(ce(z)),1))),128)),s.outlet_ids.length>3?(a(),o("span",qt," +"+r(s.outlet_ids.length-3)+" lagi ",1)):u("",!0)])):(a(),o("span",Mt,"-"))]),e("td",Vt,[s.access_type==="live_view"?(a(),o("div",Bt,[t[36]||(t[36]=e("div",{class:"text-xs text-gray-500 mb-1"},"Email:",-1)),e("div",Dt,[t[35]||(t[35]=e("i",{class:"fa-solid fa-envelope mr-1 text-blue-500"},null,-1)),i(" "+r(s.email||"-"),1)])])):(a(),o("div",Et,[t[40]||(t[40]=e("div",{class:"text-xs text-gray-500 mb-1"},"Area:",-1)),e("div",Ut,[t[37]||(t[37]=e("i",{class:"fa-solid fa-map-marker-alt mr-1 text-purple-500"},null,-1)),i(" "+r(s.area||"-"),1)]),s.date_from&&s.date_to?(a(),o("div",St,[t[38]||(t[38]=e("i",{class:"fa-solid fa-calendar mr-1 text-purple-500"},null,-1)),i(" "+r(B(s.date_from))+" - "+r(B(s.date_to)),1)])):u("",!0),s.time_from&&s.time_to?(a(),o("div",Ft,[t[39]||(t[39]=e("i",{class:"fa-solid fa-clock mr-1 text-purple-500"},null,-1)),i(" "+r(ie(s.time_from))+" - "+r(ie(s.time_to)),1)])):u("",!0)]))]),e("td",Lt,[e("div",Ot,[e("div",{class:"text-sm text-gray-900 line-clamp-2",title:s.reason},r(s.reason),9,It)])]),e("td",Rt,[e("span",{class:U([xe(s.status),"px-3 py-1.5 rounded-full text-xs font-bold shadow-sm"])},r(ve(s.status)),3)]),e("td",zt,r(Y(s.created_at)),1),e("td",Nt,[e("div",Wt,[e("button",{onClick:z=>Xe(s),class:"inline-flex items-center px-3 py-1.5 bg-blue-100 text-blue-700 hover:bg-blue-200 rounded-lg text-xs font-semibold transition shadow-sm",title:"Detail"},t[41]||(t[41]=[e("i",{class:"fa-solid fa-eye mr-1"},null,-1),i(" Detail ")]),8,Gt),s.status==="pending"&&s.user_id===((R=(I=l.$page.props.auth)==null?void 0:I.user)==null?void 0:R.id)?(a(),o("button",{key:0,onClick:z=>We(s),class:"inline-flex items-center px-3 py-1.5 bg-yellow-100 text-yellow-700 hover:bg-yellow-200 rounded-lg text-xs font-semibold transition shadow-sm",title:"Edit"},t[42]||(t[42]=[e("i",{class:"fa-solid fa-edit mr-1"},null,-1),i(" Edit ")]),8,Ht)):u("",!0),s.status==="pending"&&s.user_id===((Ee=(De=l.$page.props.auth)==null?void 0:De.user)==null?void 0:Ee.id)?(a(),o("button",{key:1,onClick:z=>Ze(s),class:"inline-flex items-center px-3 py-1.5 bg-red-100 text-red-700 hover:bg-red-200 rounded-lg text-xs font-semibold transition shadow-sm",title:"Batalkan"},t[43]||(t[43]=[e("i",{class:"fa-solid fa-times mr-1"},null,-1),i(" Batal ")]),8,Jt)):u("",!0),s.status==="approved"&&v.isITManager?(a(),o("button",{key:2,onClick:z=>et(s),class:"inline-flex items-center px-3 py-1.5 bg-orange-100 text-orange-700 hover:bg-orange-200 rounded-lg text-xs font-semibold transition shadow-sm",title:"Cabut Akses"},t[44]||(t[44]=[e("i",{class:"fa-solid fa-ban mr-1"},null,-1),i(" Revoke ")]),8,Kt)):u("",!0),s.status==="approved"&&s.access_type==="playback"&&v.isITTeam?(a(),o("button",{key:3,onClick:z=>Ge(s),class:"inline-flex items-center px-3 py-1.5 bg-purple-100 text-purple-700 hover:bg-purple-200 rounded-lg text-xs font-semibold transition shadow-sm",title:h(s).length>=5?"Sudah mencapai maksimal 5 file":"Upload Playback",disabled:h(s).length>=5},[t[45]||(t[45]=e("i",{class:"fa-solid fa-upload mr-1"},null,-1)),t[46]||(t[46]=i(" Upload Playback ")),h(s).length>0?(a(),o("span",Qt,"("+r(h(s).length)+"/5)",1)):u("",!0)],8,Yt)):u("",!0),s.access_type==="playback"&&h(s).length>0&&(v.isITTeam||s.user_id===((Se=(Ue=l.$page.props.auth)==null?void 0:Ue.user)==null?void 0:Se.id))?(a(),o("button",{key:4,onClick:z=>Ke(s),class:"inline-flex items-center px-3 py-1.5 bg-green-100 text-green-700 hover:bg-green-200 rounded-lg text-xs font-semibold transition shadow-sm",title:"Lihat Playback"},t[47]||(t[47]=[e("i",{class:"fa-solid fa-video mr-1"},null,-1),i(" Lihat Playback ")]),8,Xt)):u("",!0)])])])}),128))])])]),v.requests&&v.requests.last_page>1?(a(),o("div",Zt,[e("div",es,[e("div",ts,[e("button",{onClick:t[4]||(t[4]=s=>{var f;return ae((f=v.requests)==null?void 0:f.prev_page_url)}),disabled:!((p=v.requests)!=null&&p.prev_page_url),class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,ss),e("button",{onClick:t[5]||(t[5]=s=>{var f;return ae((f=v.requests)==null?void 0:f.next_page_url)}),disabled:!((b=v.requests)!=null&&b.next_page_url),class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,ls)]),e("div",as,[e("div",null,[e("p",os,[t[49]||(t[49]=i(" Menampilkan ")),e("span",rs,r(((g=v.requests)==null?void 0:g.from)||0),1),t[50]||(t[50]=i(" sampai ")),e("span",is,r(((c=v.requests)==null?void 0:c.to)||0),1),t[51]||(t[51]=i(" dari ")),e("span",ns,r(((x=v.requests)==null?void 0:x.total)||0),1),t[52]||(t[52]=i(" hasil "))])]),e("div",null,[e("nav",ds,[e("button",{onClick:t[6]||(t[6]=s=>{var f;return ae((f=v.requests)==null?void 0:f.prev_page_url)}),disabled:!((P=v.requests)!=null&&P.prev_page_url),class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},t[53]||(t[53]=[e("i",{class:"fa-solid fa-chevron-left"},null,-1)]),8,us),(a(!0),o(D,null,E(Array.from({length:((Q=v.requests)==null?void 0:Q.last_page)||0},(s,f)=>f+1),s=>{var f;return a(),o("span",{key:s,onClick:q=>ze(s),class:U([s===((f=v.requests)==null?void 0:f.current_page)?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 border text-sm font-medium cursor-pointer"])},r(s),11,ps)}),128)),e("button",{onClick:t[7]||(t[7]=s=>{var f;return ae((f=v.requests)==null?void 0:f.next_page_url)}),disabled:!((we=v.requests)!=null&&we.next_page_url),class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},t[54]||(t[54]=[e("i",{class:"fa-solid fa-chevron-right"},null,-1)]),8,cs)])])])])])):u("",!0)]),se.value?(a(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",onClick:N(oe,["self"])},[e("div",bs,[e("div",fs,[e("h3",xs,[t[55]||(t[55]=e("i",{class:"fa-solid fa-video"},null,-1)),i(" "+r(Z.value==="create"?"Buat Request CCTV Access":"Edit Request"),1)]),e("button",{onClick:oe,class:"text-white hover:text-gray-200 transition"},t[56]||(t[56]=[e("i",{class:"fa-solid fa-times text-xl"},null,-1)]))]),e("div",vs,[e("form",{onSubmit:N(Qe,["prevent"]),class:"space-y-6"},[e("div",null,[t[58]||(t[58]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-video mr-2 text-blue-500"}),i("Jenis Akses * ")],-1)),w(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>d.value.access_type=s),required:"",disabled:Z.value==="edit",class:"w-full px-4 py-3 border-2 border-blue-200 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition font-medium"},t[57]||(t[57]=[e("option",{value:"live_view"},"Live View",-1),e("option",{value:"playback"},"Playback",-1)]),8,gs),[[de,d.value.access_type]]),e("p",ms,[d.value.access_type==="live_view"?(a(),o("span",ys,"Akses untuk melihat CCTV secara langsung")):(a(),o("span",ks,"Akses untuk melihat rekaman CCTV (Hanya untuk tim IT)"))])]),e("div",_s,[t[61]||(t[61]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-store mr-2 text-blue-500"}),i("Pilih Outlet * ")],-1)),e("div",ws,[e("div",{onClick:t[9]||(t[9]=s=>H.value=!H.value),class:"w-full px-4 py-3 border-2 border-blue-200 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition cursor-pointer bg-white flex items-center justify-between min-h-[48px]"},[e("div",hs,[_.value.length===0?(a(),o("span",Cs,"Pilih outlet...")):u("",!0),(a(!0),o(D,null,E(_.value,s=>(a(),o("span",{key:s,class:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-lg text-sm font-semibold"},[i(r(ce(s))+" ",1),e("button",{type:"button",onClick:N(f=>Oe(s),["stop"]),class:"text-blue-600 hover:text-blue-800"},t[59]||(t[59]=[e("i",{class:"fa-solid fa-times text-xs"},null,-1)]),8,Ts)]))),128))]),e("i",{class:U(["fa-solid transition-transform",H.value?"fa-chevron-up":"fa-chevron-down","text-gray-400"])},null,2)]),H.value?(a(),o("div",As,[e("div",Ps,[w(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>J.value=s),type:"text",placeholder:"Cari outlet...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400",onClick:t[11]||(t[11]=N(()=>{},["stop"]))},null,512),[[j,J.value]])]),e("div",js,[(a(!0),o(D,null,E(be.value,s=>(a(),o("label",{key:s.id_outlet,class:"flex items-center px-3 py-2 hover:bg-blue-50 rounded-lg cursor-pointer",onClick:t[12]||(t[12]=N(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:_.value.includes(s.id_outlet),onChange:f=>Le(s.id_outlet),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 mr-3 w-4 h-4"},null,40,$s),e("span",qs,r(s.nama_outlet),1)]))),128)),be.value.length===0?(a(),o("div",Ms," Tidak ada outlet ditemukan ")):u("",!0)])])):u("",!0)]),e("p",Vs,[t[60]||(t[60]=e("i",{class:"fa-solid fa-info-circle mr-1"},null,-1)),i(" Pilih satu atau lebih outlet yang ingin diakses ("+r(_.value.length)+" dipilih) ",1)])]),d.value.access_type==="live_view"?(a(),o("div",Bs,[e("div",null,[t[62]||(t[62]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-envelope mr-2 text-blue-500"}),i("Email * ")],-1)),w(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>d.value.email=s),type:"email",required:"",class:"w-full px-4 py-3 border-2 border-blue-200 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"contoh@email.com"},null,512),[[j,d.value.email]]),t[63]||(t[63]=e("p",{class:"text-xs text-gray-500 mt-1"}," Email yang akan digunakan untuk akses CCTV Live View ",-1))])])):u("",!0),d.value.access_type==="playback"?(a(),o("div",Ds,[e("div",Es,[e("div",null,[t[64]||(t[64]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-map-marker-alt mr-2 text-purple-500"}),i("Area * ")],-1)),w(e("input",{"onUpdate:modelValue":t[14]||(t[14]=s=>d.value.area=s),type:"text",required:"",class:"w-full px-4 py-3 border-2 border-purple-200 rounded-xl shadow-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition",placeholder:"Contoh: Parkir Belakang, Lobi Utama, dll"},null,512),[[j,d.value.area]])]),e("div",Us,[e("div",null,[t[65]||(t[65]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-calendar mr-2 text-purple-500"}),i("Tanggal Mulai * ")],-1)),w(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>d.value.date_from=s),type:"date",required:"",class:"w-full px-4 py-3 border-2 border-purple-200 rounded-xl shadow-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition"},null,512),[[j,d.value.date_from]])]),e("div",null,[t[66]||(t[66]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-calendar mr-2 text-purple-500"}),i("Tanggal Selesai * ")],-1)),w(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>d.value.date_to=s),type:"date",required:"",min:d.value.date_from,class:"w-full px-4 py-3 border-2 border-purple-200 rounded-xl shadow-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition"},null,8,Ss),[[j,d.value.date_to]])])]),e("div",Fs,[e("div",null,[t[67]||(t[67]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-clock mr-2 text-purple-500"}),i("Waktu Mulai * ")],-1)),w(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>d.value.time_from=s),type:"time",required:"",class:"w-full px-4 py-3 border-2 border-purple-200 rounded-xl shadow-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition"},null,512),[[j,d.value.time_from]])]),e("div",null,[t[68]||(t[68]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-clock mr-2 text-purple-500"}),i("Waktu Selesai * ")],-1)),w(e("input",{"onUpdate:modelValue":t[18]||(t[18]=s=>d.value.time_to=s),type:"time",required:"",class:"w-full px-4 py-3 border-2 border-purple-200 rounded-xl shadow-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition"},null,512),[[j,d.value.time_to]])])]),e("div",null,[t[69]||(t[69]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-file-alt mr-2 text-purple-500"}),i("Deskripsi Kejadian * ")],-1)),w(e("textarea",{"onUpdate:modelValue":t[19]||(t[19]=s=>d.value.incident_description=s),required:"",rows:"4",class:"w-full px-4 py-3 border-2 border-purple-200 rounded-xl shadow-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition resize-none",placeholder:"Jelaskan kejadian yang ingin dilihat di CCTV..."},null,512),[[j,d.value.incident_description]])])])])):u("",!0),e("div",null,[t[70]||(t[70]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-comment-dots mr-2 text-blue-500"}),i("Alasan Permintaan * ")],-1)),w(e("textarea",{"onUpdate:modelValue":t[20]||(t[20]=s=>d.value.reason=s),required:"",rows:"4",class:"w-full px-4 py-3 border-2 border-blue-200 rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition resize-none",placeholder:"Jelaskan alasan permintaan akses CCTV..."},null,512),[[j,d.value.reason]])]),e("div",Ls,[e("button",{type:"button",onClick:oe,disabled:K.value,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition shadow-sm"}," Batal ",8,Os),e("button",{type:"submit",disabled:K.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-700 text-white rounded-xl hover:from-blue-600 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed font-semibold transition shadow-lg flex items-center gap-2"},[K.value?(a(),o("i",Rs)):(a(),o("i",zs)),e("span",null,r(K.value?"Menyimpan...":"Simpan"),1)],8,Is)])],32)])])])):u("",!0),le.value?(a(),o("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",onClick:t[22]||(t[22]=N(s=>le.value=!1,["self"]))},[e("div",Ns,[e("div",Ws,[t[72]||(t[72]=e("h3",{class:"text-xl font-bold flex items-center gap-2"},[e("i",{class:"fa-solid fa-info-circle"}),i(" Detail Request ")],-1)),e("button",{onClick:t[21]||(t[21]=s=>le.value=!1),class:"text-white hover:text-gray-200 transition"},t[71]||(t[71]=[e("i",{class:"fa-solid fa-times text-xl"},null,-1)]))]),e("div",Gs,[n.value?(a(),o("div",Hs,[e("div",Js,[e("div",Ks,[t[73]||(t[73]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},"User",-1)),e("div",Ys,[e("div",Qs,[(he=n.value.user)!=null&&he.avatar||(Ce=n.value.user)!=null&&Ce.avatar_path?(a(),o("img",{key:0,src:`/storage/${n.value.user.avatar||n.value.user.avatar_path}`,alt:((Te=n.value.user)==null?void 0:Te.nama_lengkap)||"User",class:"w-full h-full object-cover"},null,8,Xs)):(a(),o("i",Zs))]),e("p",el,r(((Ae=n.value.user)==null?void 0:Ae.nama_lengkap)||"-"),1)])]),e("div",tl,[t[74]||(t[74]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-1"},"Jenis Akses",-1)),e("span",{class:U([n.value.access_type==="live_view"?"bg-blue-100 text-blue-700 border border-blue-300":"bg-purple-100 text-purple-700 border border-purple-300","px-3 py-1.5 rounded-full text-xs font-bold shadow-sm inline-block"])},r(n.value.access_type==="live_view"?"Live View":"Playback"),3)]),e("div",sl,[t[75]||(t[75]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-1"},"Status",-1)),e("span",{class:U([xe(n.value.status),"px-3 py-1.5 rounded-full text-xs font-bold shadow-sm inline-block"])},r(ve(n.value.status)),3)]),e("div",ll,[t[76]||(t[76]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-1"},"Tanggal Request",-1)),e("p",al,r(Y(n.value.created_at)),1)])]),e("div",ol,[t[77]||(t[77]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},"Outlet yang Diminta",-1)),n.value.outlet_ids&&Array.isArray(n.value.outlet_ids)&&n.value.outlet_ids.length>0?(a(),o("div",rl,[(a(!0),o(D,null,E(n.value.outlet_ids,s=>(a(),o("span",{key:s,class:"px-3 py-1.5 bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 rounded-lg text-sm font-semibold border border-blue-200"},r(ce(s)),1))),128))])):(a(),o("span",il,"-"))]),n.value.access_type==="live_view"?(a(),o("div",nl,[t[78]||(t[78]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},[e("i",{class:"fa-solid fa-envelope mr-2"}),i("Email ")],-1)),e("p",dl,r(n.value.email||"-"),1)])):u("",!0),n.value.access_type==="playback"?(a(),o("div",ul,[e("div",null,[t[79]||(t[79]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},[e("i",{class:"fa-solid fa-map-marker-alt mr-2"}),i("Area ")],-1)),e("p",pl,r(n.value.area||"-"),1)]),e("div",cl,[e("div",null,[t[80]||(t[80]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},[e("i",{class:"fa-solid fa-calendar mr-2"}),i("Tanggal Mulai ")],-1)),e("p",bl,r(B(n.value.date_from)||"-"),1)]),e("div",null,[t[81]||(t[81]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},[e("i",{class:"fa-solid fa-calendar mr-2"}),i("Tanggal Selesai ")],-1)),e("p",fl,r(B(n.value.date_to)||"-"),1)])]),e("div",xl,[e("div",null,[t[82]||(t[82]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},[e("i",{class:"fa-solid fa-calendar mr-2"}),i("Tanggal Mulai ")],-1)),e("p",vl,r(B(n.value.date_from)||"-"),1)]),e("div",null,[t[83]||(t[83]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},[e("i",{class:"fa-solid fa-calendar mr-2"}),i("Tanggal Selesai ")],-1)),e("p",gl,r(B(n.value.date_to)||"-"),1)])]),e("div",ml,[e("div",null,[t[84]||(t[84]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},"Waktu Mulai",-1)),e("p",yl,r(ie(n.value.time_from)||"-"),1)]),e("div",null,[t[85]||(t[85]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},"Waktu Selesai",-1)),e("p",kl,r(ie(n.value.time_to)||"-"),1)])]),e("div",null,[t[86]||(t[86]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},"Deskripsi Kejadian",-1)),e("p",_l,r(n.value.incident_description||"-"),1)]),h(n.value).length>0?(a(),o("div",wl,[e("label",hl,[t[87]||(t[87]=e("i",{class:"fa-solid fa-file-video mr-2 text-purple-500"},null,-1)),i("File Playback ("+r(h(n.value).length)+" file) ",1)]),e("div",Cl,[n.value.playback_uploaded_at?(a(),o("div",Tl," Diupload pada: "+r(Y(n.value.playback_uploaded_at)),1)):u("",!0),n.value.playback_uploaded_by?(a(),o("div",Al," Oleh: "+r(((Pe=n.value.playback_uploaded_by)==null?void 0:Pe.nama_lengkap)||"-"),1)):u("",!0),n.value.valid_until?(a(),o("div",{key:2,class:U(["text-xs",$(n.value)?"text-red-600 font-semibold":"text-gray-500"])},[i(" Valid until: "+r(B(n.value.valid_until))+" ",1),$(n.value)?(a(),o("span",Pl,t[88]||(t[88]=[e("i",{class:"fa-solid fa-exclamation-triangle"},null,-1),i(" Expired ")]))):u("",!0)],2)):u("",!0),e("div",jl,[(a(!0),o(D,null,E(h(n.value),(s,f)=>{var q,F,L,O,I,R;return a(),o("div",{key:f,class:"bg-white rounded-lg border border-purple-200 overflow-hidden"},[e("div",$l,[e("div",ql,[e("div",Ml,[t[89]||(t[89]=e("i",{class:"fa-solid fa-video text-purple-500"},null,-1)),e("span",Vl,"File "+r(f+1),1)]),$(n.value)&&n.value.user_id===((F=(q=l.$page.props.auth)==null?void 0:q.user)==null?void 0:F.id)?(a(),o("span",Bl,t[90]||(t[90]=[e("i",{class:"fa-solid fa-lock mr-1"},null,-1),i(" Expired ")]))):u("",!0)])]),!$(n.value)&&(v.isITTeam||n.value.user_id===((O=(L=l.$page.props.auth)==null?void 0:L.user)==null?void 0:O.id))?(a(),o("div",Dl,[e("video",{src:`/cctv-access-requests/${n.value.id}/playback/${f}`,controls:"",class:"w-full rounded-lg shadow-sm",preload:"metadata"}," Browser Anda tidak mendukung video player. ",8,El)])):$(n.value)&&n.value.user_id===((R=(I=l.$page.props.auth)==null?void 0:I.user)==null?void 0:R.id)?(a(),o("div",Ul,t[91]||(t[91]=[e("i",{class:"fa-solid fa-lock text-2xl text-gray-400 mb-2"},null,-1),e("p",{class:"text-xs text-gray-500"},"File playback sudah expired",-1)]))):u("",!0)])}),128))])])])):u("",!0)])):u("",!0),e("div",Sl,[t[92]||(t[92]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},"Alasan Permintaan",-1)),e("p",Fl,r(n.value.reason||"-"),1)]),n.value.it_manager?(a(),o("div",Ll,[t[93]||(t[93]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},"IT Manager",-1)),e("p",Ol,r(((je=n.value.it_manager)==null?void 0:je.nama_lengkap)||"-"),1),n.value.approved_at?(a(),o("p",Il," Disetujui pada: "+r(Y(n.value.approved_at)),1)):u("",!0),n.value.rejected_at?(a(),o("p",Rl," Ditolak pada: "+r(Y(n.value.rejected_at)),1)):u("",!0)])):u("",!0),n.value.approval_notes?(a(),o("div",zl,[t[94]||(t[94]=e("label",{class:"block text-xs font-semibold text-gray-500 mb-2"},"Catatan Approval",-1)),e("p",Nl,r(n.value.approval_notes),1)])):u("",!0)])):u("",!0)])])])):u("",!0)]),ue.value?(a(),o("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",onClick:N(re,["self"])},[e("div",Wl,[e("div",{class:"sticky top-0 bg-gradient-to-r from-purple-500 to-purple-700 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center"},[t[96]||(t[96]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("i",{class:"fa-solid fa-upload"}),i(" Upload File Playback ")],-1)),e("button",{onClick:re,class:"text-white hover:text-gray-200 transition"},t[95]||(t[95]=[e("i",{class:"fa-solid fa-times text-xl"},null,-1)]))]),e("div",Gl,[e("div",Hl,[e("p",Jl,[t[97]||(t[97]=e("strong",null,"Request ID:",-1)),i(" #"+r(($e=V.value)==null?void 0:$e.id),1)]),e("p",Kl,[t[98]||(t[98]=e("strong",null,"User:",-1)),i(" "+r(((Me=(qe=V.value)==null?void 0:qe.user)==null?void 0:Me.nama_lengkap)||"-"),1)])]),e("div",null,[t[101]||(t[101]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-file-video mr-2 text-purple-500"}),i("Pilih File Playback * (Maksimal 5 file) ")],-1)),e("input",{type:"file",onChange:He,accept:"video/mp4,video/avi,video/quicktime,video/x-msvideo,video/x-ms-wmv,video/x-flv,video/webm",multiple:"",class:"w-full px-4 py-3 border-2 border-purple-200 rounded-xl shadow-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition"},null,32),t[102]||(t[102]=e("p",{class:"text-xs text-gray-500 mt-2"}," Format yang didukung: MP4, AVI, MOV, WMV, FLV, WEBM (Maksimal 100MB per file, maksimal 5 file) ",-1)),A.value.length>0?(a(),o("div",Yl,[(a(!0),o(D,null,E(A.value,(s,f)=>(a(),o("div",{key:f,class:"flex items-center justify-between p-3 bg-purple-50 rounded-lg border border-purple-200"},[e("div",Ql,[t[99]||(t[99]=e("i",{class:"fa-solid fa-video text-purple-500"},null,-1)),e("div",Xl,[e("p",Zl,r(s.name),1),e("p",ea,r((s.size/1024/1024).toFixed(2))+" MB",1)])]),e("button",{onClick:q=>Je(f),class:"ml-2 p-1.5 text-red-600 hover:bg-red-100 rounded-lg transition",title:"Hapus file"},t[100]||(t[100]=[e("i",{class:"fa-solid fa-times"},null,-1)]),8,ta)]))),128)),e("p",sa," Total: "+r(A.value.length)+" file dipilih ",1)])):u("",!0)]),e("div",null,[t[103]||(t[103]=e("label",{class:"block text-sm font-bold text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-calendar-times mr-2 text-purple-500"}),i("Valid Until (Berlaku Sampai) * ")],-1)),w(e("input",{"onUpdate:modelValue":t[23]||(t[23]=s=>G.value=s),type:"date",required:"",min:new Date().toISOString().split("T")[0],class:"w-full px-4 py-3 border-2 border-purple-200 rounded-xl shadow-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition"},null,8,la),[[j,G.value]]),t[104]||(t[104]=e("p",{class:"text-xs text-gray-500 mt-2"}," Setelah tanggal ini, user pemohon tidak dapat melihat atau mengunduh file playback ",-1))]),e("div",aa,[e("button",{onClick:re,class:"px-6 py-2 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition font-semibold"}," Batal "),e("button",{onClick:Ye,disabled:A.value.length===0||ee.value,class:"px-6 py-2 bg-gradient-to-r from-purple-500 to-purple-700 text-white rounded-xl hover:from-purple-600 hover:to-purple-800 transition font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[ee.value?(a(),o("i",ra)):(a(),o("i",ia)),i(" "+r(ee.value?"Mengupload...":`Upload (${A.value.length} file)`),1)],8,oa)])])])])):u("",!0),pe.value?(a(),o("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",onClick:N(fe,["self"])},[e("div",na,[e("div",{class:"sticky top-0 bg-gradient-to-r from-green-500 to-green-700 text-white px-6 py-4 rounded-t-2xl flex justify-between items-center"},[t[106]||(t[106]=e("h2",{class:"text-xl font-bold flex items-center gap-2"},[e("i",{class:"fa-solid fa-video"}),i(" File Playback ")],-1)),e("button",{onClick:fe,class:"text-white hover:text-gray-200 transition"},t[105]||(t[105]=[e("i",{class:"fa-solid fa-times text-xl"},null,-1)]))]),e("div",da,[m.value?(a(),o("div",ua,[e("div",pa,[e("p",ca,[t[107]||(t[107]=e("strong",null,"Request ID:",-1)),i(" #"+r(m.value.id),1)]),e("p",ba,[t[108]||(t[108]=e("strong",null,"User:",-1)),i(" "+r(((Ve=m.value.user)==null?void 0:Ve.nama_lengkap)||"-"),1)]),m.value.playback_uploaded_at?(a(),o("p",fa,[t[109]||(t[109]=e("strong",null,"Diupload pada:",-1)),i(" "+r(Y(m.value.playback_uploaded_at)),1)])):u("",!0),m.value.playback_uploaded_by?(a(),o("p",xa,[t[110]||(t[110]=e("strong",null,"Oleh:",-1)),i(" "+r(((Be=m.value.playback_uploaded_by)==null?void 0:Be.nama_lengkap)||"-"),1)])):u("",!0),m.value.valid_until?(a(),o("p",{key:2,class:U(["text-sm",$(m.value)?"text-red-600 font-semibold":"text-gray-700"])},[t[112]||(t[112]=e("strong",null,"Valid until:",-1)),i(" "+r(B(m.value.valid_until))+" ",1),$(m.value)?(a(),o("span",va,t[111]||(t[111]=[e("i",{class:"fa-solid fa-exclamation-triangle"},null,-1),i(" Expired ")]))):u("",!0)],2)):u("",!0)]),e("div",ga,[e("h3",ma,[t[113]||(t[113]=e("i",{class:"fa-solid fa-file-video mr-2 text-green-500"},null,-1)),i(" Daftar File ("+r(h(m.value).length)+" file) ",1)]),(a(!0),o(D,null,E(h(m.value),(s,f)=>{var q,F,L,O,I,R;return a(),o("div",{key:f,class:"bg-white rounded-xl border-2 border-green-200 overflow-hidden"},[e("div",ya,[e("div",ka,[e("div",_a,[t[114]||(t[114]=e("div",{class:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center"},[e("i",{class:"fa-solid fa-video text-green-600"})],-1)),e("div",null,[e("p",wa,"File "+r(f+1),1),e("p",ha,r(s.split("/").pop()),1)])]),$(m.value)&&m.value.user_id===((F=(q=l.$page.props.auth)==null?void 0:q.user)==null?void 0:F.id)?(a(),o("span",Ca,t[115]||(t[115]=[e("i",{class:"fa-solid fa-lock mr-1"},null,-1),i(" Expired ")]))):u("",!0)])]),!$(m.value)&&(v.isITTeam||m.value.user_id===((O=(L=l.$page.props.auth)==null?void 0:L.user)==null?void 0:O.id))?(a(),o("div",Ta,[e("video",{src:`/cctv-access-requests/${m.value.id}/playback/${f}`,controls:"",class:"w-full rounded-lg shadow-lg",preload:"metadata"}," Browser Anda tidak mendukung video player. ",8,Aa)])):$(m.value)&&m.value.user_id===((R=(I=l.$page.props.auth)==null?void 0:I.user)==null?void 0:R.id)?(a(),o("div",Pa,[t[116]||(t[116]=e("i",{class:"fa-solid fa-lock text-4xl text-gray-400 mb-3"},null,-1)),t[117]||(t[117]=e("p",{class:"text-gray-500 font-semibold"},"File playback sudah expired",-1)),e("p",ja,"Valid until: "+r(B(m.value.valid_until)),1)])):u("",!0)])}),128))])])):u("",!0)])])])):u("",!0)]}),_:1}))}},Ia=nt($a,[["__scopeId","data-v-c911f96c"]]);export{Ia as default};
