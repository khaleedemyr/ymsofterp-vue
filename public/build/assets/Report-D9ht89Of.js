import{r as b,c as vt,w as lt,a as It,A as Kt,B as o,C as Jt,D as e,L as l,E as h,G as p,H as j,F as E,M as L,N as n,I as O,J as N,l as M,O as Ot,W as $t,n as Vt}from"./vendor-vue-g7iCcTkf.js";import{A as zt}from"./AppLayout-zB0hvXOw.js";import{S as c}from"./app-BgZdqVzD.js";import{a as B}from"./vendor-utils-CpgP2uT4.js";import{_ as Rt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-C4ea0y0B.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const Ht={class:"w-full min-h-[60vh] h-[calc(100vh-150px)] flex flex-col justify-start items-stretch py-4"},Yt={key:0,class:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-50"},Ft={class:"bg-white rounded-2xl shadow-xl p-6 mb-6"},qt={class:"flex gap-4 items-center flex-wrap"},Wt=["value"],Qt=["value"],Xt=["value"],Zt={class:"flex flex-col"},te={class:"relative flex-1 min-w-[300px]"},ee=["disabled"],ae=["disabled"],se=["disabled"],oe=["disabled"],le=["disabled"],ne={key:0,class:"mt-4 flex items-center gap-2"},re={key:0,class:"text-sm text-gray-600"},ie={class:"flex-1 w-full"},de={key:0,class:"w-full"},ue={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},pe={class:"bg-gradient-to-br from-blue-400 to-blue-600 text-white p-4 rounded-xl shadow-lg"},xe={class:"text-2xl font-bold"},ce={class:"bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-xl shadow-lg"},me={class:"text-2xl font-bold"},ge={class:"bg-gradient-to-br from-red-400 to-red-600 text-white p-4 rounded-xl shadow-lg"},fe={class:"text-2xl font-bold"},ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-11 gap-4 mb-6"},_e={class:"bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-xl shadow-lg"},be={class:"text-2xl font-bold"},ve={class:"bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-xl shadow-lg"},he={class:"text-2xl font-bold"},ke={class:"bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-xl shadow-lg"},we={class:"text-2xl font-bold"},je={class:"bg-gradient-to-br from-red-400 to-red-600 text-white p-4 rounded-xl shadow-lg"},De={class:"text-2xl font-bold"},Ce={class:"bg-gradient-to-br from-red-400 to-red-600 text-white p-4 rounded-xl shadow-lg"},Pe={class:"text-2xl font-bold"},Te={class:"bg-gradient-to-br from-red-400 to-red-600 text-white p-4 rounded-xl shadow-lg"},Be={class:"text-2xl font-bold"},Se={class:"bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-xl shadow-lg"},Ee={class:"text-2xl font-bold"},Ae={class:"bg-gradient-to-br from-purple-400 to-purple-600 text-white p-4 rounded-xl shadow-lg"},Le={class:"text-2xl font-bold"},Ne={class:"bg-gradient-to-br from-indigo-400 to-indigo-600 text-white p-4 rounded-xl shadow-lg"},Me={class:"text-2xl font-bold"},Ue={class:"bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-xl shadow-lg"},Ge={class:"text-2xl font-bold"},Ie={class:"bg-gradient-to-br from-red-400 to-red-600 text-white p-4 rounded-xl shadow-lg"},Ke={class:"text-2xl font-bold"},Je={class:"bg-gradient-to-br from-red-400 to-red-600 text-white p-4 rounded-xl shadow-lg"},Oe={class:"text-2xl font-bold"},$e={class:"bg-gradient-to-br from-yellow-400 to-yellow-600 text-white p-4 rounded-xl shadow-lg"},Ve={class:"text-2xl font-bold"},ze={class:"bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-xl shadow-lg"},Re={class:"text-2xl font-bold"},He={class:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6 flex justify-between items-center"},Ye={class:"text-blue-800 font-semibold"},Fe={key:0,class:"text-blue-600 text-sm"},qe={class:"overflow-x-auto table-container"},We={class:"w-full min-w-[1200px] divide-y divide-blue-200 bg-white rounded-2xl shadow-2xl animate-fade-in-up"},Qe={class:"bg-gradient-to-r from-blue-600 to-green-400 text-white sticky top-0 z-10",style:{position:"sticky",top:"0"}},Xe={class:"bg-white divide-y divide-gray-200"},Ze={class:"px-4 py-3 text-center text-sm font-medium text-gray-700"},ta={class:"px-4 py-3 text-center"},ea=["onClick"],aa={class:"px-4 py-3 text-sm font-medium text-gray-900"},sa={class:"px-4 py-3 text-sm text-gray-900"},oa={class:"flex items-center gap-2 flex-wrap"},la={class:"font-semibold"},na={key:0,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},ra={key:1,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"},ia={key:2,class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},da={key:0,class:"text-xs text-gray-500 mt-1"},ua={key:1,class:"text-xs text-gray-500 mt-1"},pa={key:2,class:"text-xs text-red-600 mt-1 font-medium"},xa={key:3,class:"text-xs text-purple-600 mt-1 font-medium"},ca={class:"px-4 py-3 text-sm text-gray-700"},ma={class:"px-4 py-3 text-sm text-gray-700"},ga={class:"px-4 py-3 text-sm text-center font-bold text-purple-600"},fa={class:"px-4 py-3 text-sm text-center font-bold text-green-600"},ya={class:"px-4 py-3 text-sm text-center font-bold text-green-600"},_a={class:"px-4 py-3 text-sm text-center font-bold text-red-600"},ba={class:"text-xs text-gray-600 mt-1"},va={class:"px-4 py-3 text-sm text-center font-bold"},ha={key:0,class:"text-green-600"},ka={key:1,class:"text-gray-400"},wa={class:"px-4 py-3 text-sm text-center font-bold"},ja={key:0,class:"text-green-600"},Da={key:1,class:"text-gray-400"},Ca={class:"text-xs text-blue-600 mt-1"},Pa={class:"px-4 py-3 text-sm text-center font-bold"},Ta={key:0,class:"text-green-600"},Ba={key:1,class:"text-gray-400"},Sa={class:"text-xs text-blue-600 mt-1"},Ea={class:"px-4 py-3 text-sm text-center font-bold text-blue-600"},Aa={class:"px-4 py-3 text-sm text-center font-bold text-red-600"},La={class:"px-4 py-3 text-sm text-center font-bold"},Na={key:0,class:"text-green-600"},Ma={key:1,class:"text-gray-400"},Ua={class:"px-4 py-3 text-sm text-center font-bold"},Ga={key:0,class:"text-green-600"},Ia={key:1,class:"text-gray-400"},Ka={class:"px-4 py-3 text-sm text-center font-bold"},Ja={key:0,class:"text-green-600 font-bold"},Oa={key:1,class:"text-gray-400"},$a={class:"px-4 py-3 text-sm text-center font-bold"},Va={key:0,class:"text-red-600"},za={key:1,class:"text-gray-400"},Ra={class:"px-4 py-3 text-sm text-center font-bold"},Ha={key:0,class:"text-red-600"},Ya={key:1,class:"text-gray-400"},Fa={class:"px-4 py-3 text-sm text-center font-bold"},qa={key:0,class:"text-red-600 font-bold"},Wa={key:1,class:"text-gray-400"},Qa={class:"px-4 py-3 text-sm text-center font-bold"},Xa={key:0,class:"text-red-600 font-bold"},Za={key:1,class:"text-gray-400"},ts={class:"px-4 py-3 text-sm text-center font-bold"},es={key:0,class:"text-red-600 font-bold"},as={key:1,class:"text-gray-400"},ss={class:"px-4 py-3 text-sm text-center font-bold text-green-600"},os={class:"px-4 py-3 text-sm text-center font-bold text-green-600"},ls=["onClick"],ns={class:"px-4 py-3 text-sm text-center font-bold text-red-600"},rs=["onClick"],is={class:"px-4 py-3 text-sm text-center font-bold text-red-600"},ds={class:"px-4 py-3 text-sm text-center font-bold text-red-600"},us={class:"px-4 py-3 text-sm text-center font-bold text-red-600"},ps={class:"px-4 py-3 text-sm text-center font-bold text-green-600 bg-green-50 rounded-lg"},xs={class:"px-4 py-3 text-sm text-center"},cs=["onUpdate:modelValue","onChange"],ms={class:"px-4 py-3 text-sm text-center"},gs={class:"flex items-center justify-center gap-2"},fs=["onClick"],ys=["onClick"],_s=["onClick"],bs={key:0,class:"bg-blue-50 border-l-4 border-blue-400"},vs={colspan:"21",class:"px-4 py-4"},hs={key:0,class:"flex items-center justify-center py-8"},ks={key:1,class:"space-y-4"},ws={class:"flex items-center gap-2 mb-4"},js={class:"text-lg font-semibold text-blue-800"},Ds={class:"ml-auto text-sm text-gray-600"},Cs={key:0,class:"ml-4 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},Ps={key:1,class:"ml-4 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},Ts={key:2,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800"},Bs={key:3,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},Ss={key:4,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},Es={key:5,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800"},As={key:6,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},Ls={key:7,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800"},Ns={key:8,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},Ms={key:9,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800"},Us={key:10,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},Gs={key:11,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800"},Is={key:12,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-100 text-red-800"},Ks={key:13,class:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800"},Js={class:"overflow-x-auto"},Os={class:"w-full text-sm border border-gray-200 rounded-lg"},$s={class:"bg-white"},Vs={class:"px-3 py-2 font-medium"},zs={class:"px-3 py-2 text-center font-mono"},Rs={key:0,class:"text-gray-500 font-semibold"},Hs={key:1},Ys={class:"px-3 py-2 text-center font-mono"},Fs={key:0,class:"text-gray-500 font-semibold"},qs={key:1},Ws={class:"px-3 py-2 text-center"},Qs={key:0,class:"text-gray-500 font-semibold"},Xs={key:1,class:"flex flex-col text-xs"},Zs={class:"text-green-600 font-semibold"},to={class:"text-red-600 font-semibold"},eo={class:"px-3 py-2 text-center"},ao={key:0,class:"text-gray-500 font-semibold"},so={key:1,class:"text-red-600 font-semibold"},oo={key:2,class:"text-green-600"},lo={class:"px-3 py-2 text-center"},no={key:0,class:"text-gray-500 font-semibold"},ro={key:1,class:"text-green-600 font-semibold"},io={key:2,class:"text-gray-500"},uo={class:"px-3 py-2 text-center"},po={key:0,class:"text-purple-600 font-semibold"},xo={key:1,class:"text-gray-500 font-semibold"},co={key:2,class:"text-gray-500"},mo={class:"px-3 py-2 text-center"},go={key:0,class:"text-blue-600 font-bold"},fo={key:1,class:"text-gray-500 font-semibold"},yo={key:2,class:"text-gray-500"},_o={class:"px-3 py-2 text-center text-xs"},bo={key:0,class:"text-gray-500 font-semibold"},vo={key:1},ho={key:0,class:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-full"},ko={key:1,class:"px-2 py-1 text-xs bg-green-500 text-white rounded-full font-semibold"},wo={key:2,class:"px-2 py-1 text-xs bg-red-500 text-white rounded-full font-bold"},jo={key:3,class:"px-2 py-1 text-xs bg-orange-100 text-orange-700 rounded-full"},Do={key:4,class:"px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full"},Co={key:2,class:"text-center py-8 text-gray-500"},Po={key:1,class:"flex flex-col items-center justify-center h-full text-gray-500"},To={class:"text-xl font-semibold mb-2"},Bo={class:"text-gray-400"},So={key:2,class:"flex flex-col items-center justify-center h-full text-gray-500"},Eo={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ao={class:"bg-white rounded-2xl p-6 w-full max-w-2xl mx-4"},Lo={class:"flex items-center justify-between mb-6"},No={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Mo={class:"w-full p-3 bg-gray-100 rounded-lg border"},Uo={class:"font-semibold text-gray-800"},Go={class:"text-gray-600 ml-2"},Io={class:"flex justify-end gap-3 pt-4"},Ko={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Jo={class:"bg-white rounded-2xl p-6 w-full max-w-4xl mx-4"},Oo={class:"flex items-center justify-between mb-6"},$o={class:"text-xl font-bold text-gray-800"},Vo={key:0,class:"overflow-x-auto"},zo={class:"min-w-full bg-white border border-gray-200 rounded-lg"},Ro={class:"divide-y divide-gray-200"},Ho={class:"px-4 py-3 text-sm text-gray-900"},Yo={class:"px-4 py-3 text-sm text-center"},Fo={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},qo={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"},Wo={class:"px-4 py-3 text-sm text-gray-600"},Qo={class:"px-4 py-3 text-sm text-center"},Xo=["onClick"],Zo={key:1,class:"text-center py-8 text-gray-500"},tl={class:"flex justify-end pt-4"},el={__name:"Report",props:{outlets:Array,months:Array,years:Array,payrollData:Array,leaveTypes:Array,statistics:Object,filter:Object},setup($){var ut,pt,xt,ct,mt,gt,ft;const x=$,f=b(((ut=x.filter)==null?void 0:ut.outlet_id)||""),g=b(((pt=x.filter)==null?void 0:pt.month)||new Date().getMonth()+1),m=b(((xt=x.filter)==null?void 0:xt.year)||new Date().getFullYear()),P=b(((ct=x.filter)==null?void 0:ct.service_charge)||""),U=b(((mt=x.filter)==null?void 0:mt.lb_amount)||""),G=b(((gt=x.filter)==null?void 0:gt.deviasi_amount)||""),T=b(((ft=x.filter)==null?void 0:ft.city_ledger_amount)||""),tt=b(!1),Y=b(!1),C=b(!1),S=b(""),v=b(null),k=b(null),K=b(new Set),I=b({}),et=b({}),V=b(!1),F=b(!1),at=b([]),q=b(""),ht=b(null),_=b({user_id:"",outlet_id:"",payroll_period_month:"",payroll_period_year:"",item_type:"earn",item_name:"",item_amount:"",item_description:"",gajian_type:"gajian1"}),W=s=>s.toString().padStart(2,"0");function kt(s,t){const r=t.toLowerCase().replace(/\s+/g,"_")+"_days";return console.log("getLeaveDays",{leaveTypeName:t,key:r,itemHasKey:s[r]!==void 0,itemKeyValue:s[r],izinCutiBreakdown:s.izin_cuti_breakdown,izinCutiBreakdownHasKey:s.izin_cuti_breakdown&&s.izin_cuti_breakdown[r]!==void 0,izinCutiBreakdownValue:s.izin_cuti_breakdown&&s.izin_cuti_breakdown[r],allItemKeys:Object.keys(s).filter(i=>i.includes("_days"))}),s[r]!==void 0&&s[r]!==null?s[r]||0:s.izin_cuti_breakdown&&s.izin_cuti_breakdown[r]!==void 0&&s.izin_cuti_breakdown[r]!==null&&s.izin_cuti_breakdown[r]||0}function Q(){!f.value||!g.value||!m.value||(tt.value=!0,$t.get("/payroll/report",{outlet_id:f.value,month:W(g.value),year:m.value,service_charge:P.value||null,lb_amount:U.value||null,deviasi_amount:G.value||null,city_ledger_amount:T.value||null},{preserveState:!0,replace:!0,onFinish:async()=>{await Vt(),tt.value=!1,await J(),x.payrollData&&x.payrollData.length>0&&x.payrollData.forEach(s=>{s.payment_method||(s.payment_method="transfer")})}}))}async function wt(){if(!f.value||!g.value||!m.value){c.fire("Peringatan","Pilih outlet, bulan, dan tahun terlebih dahulu","warning");return}Y.value=!0;try{const s=`/payroll/report/export?outlet_id=${f.value}&month=${W(g.value)}&year=${m.value}&service_charge=${P.value||0}&lb_amount=${U.value||0}&deviasi_amount=${G.value||0}&city_ledger_amount=${T.value||0}`;window.open(s,"_blank")}catch(s){console.error("Error exporting:",s),c.fire("Error","Terjadi kesalahan saat export data","error")}finally{Y.value=!1}}const u=s=>new Intl.NumberFormat("id-ID").format(s),st=s=>s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"2-digit",day:"2-digit"}):"",z=vt(()=>{if(!x.payrollData||x.payrollData.length===0)return[];const s=x.payrollData.filter(r=>r.is_mutated_employee);if(s.length>0&&console.log("Frontend - Mutated employees in payrollData:",s.map(r=>({user_id:r.user_id,nama_lengkap:r.nama_lengkap,hari_kerja:r.hari_kerja,is_mutated_employee:r.is_mutated_employee,mutation_effective_date:r.mutation_effective_date,mutation_outlet_to:r.mutation_outlet_to}))),!S.value||S.value.trim()==="")return x.payrollData;const t=S.value.toLowerCase().trim();return x.payrollData.filter(r=>{const i=(r.nik||"").toLowerCase(),y=(r.nama_lengkap||"").toLowerCase(),D=(r.divisi||"").toLowerCase(),A=(r.jabatan||"").toLowerCase();return i.includes(t)||y.includes(t)||D.includes(t)||A.includes(t)})}),w=vt(()=>{const s=z.value;return!s||s.length===0?{totalGajiPokok:0,totalTunjangan:0,totalGajiLembur:0,totalUangMakan:0,totalServiceChargeByPoint:0,totalServiceChargeProRate:0,totalServiceCharge:0,totalBPJSJKN:0,totalBPJSTK:0,totalPHBonus:0,totalPotonganTelat:0,totalPotonganAlpha:0,totalPotonganUnpaidLeave:0,totalGaji:0}:{totalGajiPokok:s.reduce((t,r)=>t+Number(r.gaji_pokok),0),totalTunjangan:s.reduce((t,r)=>t+Number(r.tunjangan),0),totalGajiLembur:s.reduce((t,r)=>t+Number(r.gaji_lembur),0),totalUangMakan:s.reduce((t,r)=>t+Number(r.uang_makan),0),totalServiceChargeByPoint:s.reduce((t,r)=>t+Number(r.service_charge_by_point||0),0),totalServiceChargeProRate:s.reduce((t,r)=>t+Number(r.service_charge_pro_rate||0),0),totalServiceCharge:s.reduce((t,r)=>t+Number(r.service_charge||0),0),totalBPJSJKN:s.reduce((t,r)=>t+Number(r.bpjs_jkn),0),totalBPJSTK:s.reduce((t,r)=>t+Number(r.bpjs_tk),0),totalPHBonus:s.reduce((t,r)=>t+Number(r.ph_bonus||0),0),totalPotonganTelat:s.reduce((t,r)=>t+Number(r.potongan_telat||0),0),totalPotonganAlpha:s.reduce((t,r)=>t+Number(r.potongan_alpha||0),0),totalPotonganUnpaidLeave:s.reduce((t,r)=>t+Number(r.potongan_unpaid_leave||0),0),totalGaji:s.reduce((t,r)=>t+Number(r.total_gaji),0)}});lt(()=>x.filter,s=>{f.value=(s==null?void 0:s.outlet_id)||"",g.value=(s==null?void 0:s.month)||new Date().getMonth()+1,m.value=(s==null?void 0:s.year)||new Date().getFullYear(),P.value=(s==null?void 0:s.service_charge)||"",U.value=(s==null?void 0:s.lb_amount)||"",G.value=(s==null?void 0:s.deviasi_amount)||"",T.value=(s==null?void 0:s.city_ledger_amount)||""},{immediate:!0});async function nt(){if(!(!f.value||!g.value||!m.value))try{const s=await B.get(route("payroll.report.service-charge"),{params:{outlet_id:f.value,month:W(g.value),year:m.value}});if(s.data.success){const t=s.data.service_charge||0;P.value=parseFloat(t).toFixed(2)}}catch(s){console.error("Error loading service charge:",s)}}async function rt(){if(!(!f.value||!g.value||!m.value))try{const s=await B.get(route("payroll.report.city-ledger-amount"),{params:{outlet_id:f.value,month:W(g.value),year:m.value}});if(s.data.success){const t=s.data.city_ledger_amount||0;T.value=parseFloat(t).toFixed(2)}}catch(s){console.error("Error loading city ledger amount:",s)}}function jt(){if(P.value){const s=parseFloat(P.value);isNaN(s)||(P.value=s.toFixed(2))}}function Dt(){if(T.value){const s=parseFloat(T.value);isNaN(s)||(T.value=s.toFixed(2))}}lt(()=>x.payrollData,s=>{s&&s.length>0&&s.forEach(t=>{t.payment_method||(t.payment_method="transfer")})},{immediate:!0,deep:!0});async function it(s){K.value.has(s)?(K.value.delete(s),delete I.value[s]):(K.value.add(s),await Ct(s))}async function Ct(s){var t,r;if(!I.value[s]){et.value[s]=!0;try{let i,y;if(g.value===1)i=new Date(m.value-1,11,26),y=new Date(m.value,0,25);else{const H=g.value-2,ot=g.value-1;i=new Date(m.value,H,26),y=new Date(m.value,ot,25)}const D=i.getFullYear(),A=i.getMonth(),X=i.getDate();i=new Date(D,A,X,0,0,0,0);const Z=y.getFullYear(),a=y.getMonth(),R=y.getDate();y=new Date(Z,a,R,23,59,59,999);const d=H=>{const ot=H.getFullYear(),Ut=String(H.getMonth()+1).padStart(2,"0"),Gt=String(H.getDate()).padStart(2,"0");return`${ot}-${Ut}-${Gt}`},yt=d(i),_t=d(y);console.log("Fetching attendance detail:",{userId:s,outletId:f.value,startDate:yt,endDate:_t});const bt=await B.get("/payroll/report/attendance-detail",{params:{user_id:s,outlet_id:f.value,start_date:yt,end_date:_t}});console.log("Attendance detail response:",bt.data),I.value[s]=bt.data}catch(i){console.error("Error fetching attendance detail:",i),console.error("Error details:",{message:i.message,response:(t=i.response)==null?void 0:t.data,status:(r=i.response)==null?void 0:r.status}),I.value[s]=[]}finally{et.value[s]=!1}}}function Pt(s,t){_.value.user_id=s,_.value.outlet_id=f.value,_.value.payroll_period_month=parseInt(g.value),_.value.payroll_period_year=parseInt(m.value),V.value=!0}function dt(s,t){const r=x.payrollData.find(i=>i.user_id===s);r&&r.custom_items&&(at.value=r.custom_items.filter(i=>i.item_type===t),q.value=t,ht.value=s,F.value=!0)}async function Tt(){var s,t;try{const r={..._.value,user_id:parseInt(_.value.user_id),outlet_id:parseInt(_.value.outlet_id),payroll_period_month:parseInt(_.value.payroll_period_month),payroll_period_year:parseInt(_.value.payroll_period_year),item_amount:parseFloat(_.value.item_amount)},i=await B.post("/payroll/report/custom-item/add",r);i.data.success?(c.fire("Sukses",i.data.message,"success"),V.value=!1,St(),await Q()):c.fire("Error",i.data.message,"error")}catch(r){console.error("Error adding custom item:",r),(t=(s=r.response)==null?void 0:s.data)!=null&&t.message?c.fire("Error",r.response.data.message,"error"):c.fire("Error","Terjadi kesalahan saat menambah custom item","error")}}async function Bt(s){try{if((await c.fire({title:"Konfirmasi",text:"Apakah Anda yakin ingin menghapus item ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed){const r=await B.delete("/payroll/report/custom-item/delete",{data:{item_id:s}});r.data.success?(c.fire("Sukses",r.data.message,"success"),await Q()):c.fire("Error",r.data.message,"error")}}catch(t){console.error("Error deleting custom item:",t),c.fire("Error","Terjadi kesalahan saat menghapus custom item","error")}}function St(){_.value={user_id:_.value.user_id,outlet_id:f.value,payroll_period_month:parseInt(g.value),payroll_period_year:parseInt(m.value),item_type:"earn",item_name:"",item_amount:"",item_description:"",gajian_type:"gajian1"}}async function Et(s){try{const{value:t}=await c.fire({title:"Pilih Jenis Slip Gaji",text:"Pilih slip gaji yang ingin dilihat",icon:"question",showCancelButton:!0,confirmButtonText:"Lihat",cancelButtonText:"Batal",input:"select",inputOptions:{gajian1:"Gajian 1 (Akhir Bulan)",gajian2:"Gajian 2 (Tanggal 8)"},inputPlaceholder:"Pilih jenis slip gaji",inputValidator:r=>{if(!r)return"Pilih jenis slip gaji terlebih dahulu"}});if(t){const r=`/payroll/report/show?user_id=${s.user_id}&outlet_id=${f.value}&month=${g.value}&year=${m.value}&type=${t}`;window.open(r,"_blank")}}catch(t){console.error("Error showing payroll:",t),c.fire("Error","Terjadi kesalahan saat menampilkan payroll","error")}}async function J(){if(!f.value||!g.value||!m.value){v.value=null,k.value=null;return}try{const s=await B.get("/payroll/report/status",{params:{outlet_id:parseInt(f.value),month:parseInt(g.value),year:parseInt(m.value)}});s.data.success&&s.data.exists?(v.value=s.data.status,k.value=s.data.payroll_id):(v.value=null,k.value=null)}catch(s){console.error("Error checking payroll status:",s),v.value=null,k.value=null}}async function At(){var t,r;if(!f.value||!g.value||!m.value){c.fire("Peringatan","Pilih outlet, bulan, dan tahun terlebih dahulu","warning");return}if(!x.payrollData||x.payrollData.length===0){c.fire("Peringatan","Tidak ada data payroll untuk di-generate","warning");return}if((await c.fire({title:"Generate Payroll?",text:"Apakah Anda yakin ingin menyimpan payroll ini ke database?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Generate!",cancelButtonText:"Batal"})).isConfirmed){C.value=!0;try{const i=await B.post("/payroll/report/generate",{outlet_id:f.value,month:parseInt(g.value),year:parseInt(m.value),service_charge:P.value||0,lb_amount:U.value||0,deviasi_amount:G.value||0,city_ledger_amount:T.value||0,payroll_data:x.payrollData});i.data.success?(c.fire("Sukses",i.data.message,"success"),k.value=i.data.payroll_id,v.value="generated",await J(),x.payrollData&&x.payrollData.length>0&&x.payrollData.forEach(y=>{y.payment_method||(y.payment_method="transfer")}),await Q()):c.fire("Error",i.data.message,"error")}catch(i){console.error("Error generating payroll:",i),c.fire("Error",((r=(t=i.response)==null?void 0:t.data)==null?void 0:r.message)||"Terjadi kesalahan saat generate payroll","error")}finally{C.value=!1}}}async function Lt(s,t){var r,i;if(v.value!=="generated"){const y=x.payrollData.find(D=>D.user_id===s);y&&(y.payment_method=t);return}if(!k.value){c.fire("Peringatan","Payroll belum di-generate","warning");return}console.log("Updating payment method:",{userId:s,paymentMethod:t,payrollId:k.value});try{const y=await B.post("/payroll/report/update-payment-method",{payroll_id:k.value,user_id:s,payment_method:t});if(console.log("Update payment method response:",y.data),y.data.success){const D=x.payrollData.find(A=>A.user_id===s);D&&(D.payment_method=t),console.log("Payment method updated successfully")}else c.fire("Error",y.data.message||"Gagal mengupdate payment method","error")}catch(y){console.error("Error updating payment method:",y),c.fire("Error",((i=(r=y.response)==null?void 0:r.data)==null?void 0:i.message)||"Terjadi kesalahan saat mengupdate payment method","error")}}async function Nt(){var t,r;if(!k.value){c.fire("Peringatan","Payroll belum di-generate","warning");return}if(!x.payrollData||x.payrollData.length===0){c.fire("Peringatan","Tidak ada data payroll untuk di-update","warning");return}if((await c.fire({title:"Edit Payroll?",text:"Apakah Anda yakin ingin mengupdate payroll ini?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Update!",cancelButtonText:"Batal"})).isConfirmed){C.value=!0;try{const i=await B.post("/payroll/report/edit",{payroll_id:k.value,service_charge:P.value||0,lb_amount:U.value||0,deviasi_amount:G.value||0,city_ledger_amount:T.value||0,payroll_data:x.payrollData});i.data.success?(c.fire("Sukses",i.data.message,"success"),await J()):c.fire("Error",i.data.message,"error")}catch(i){console.error("Error editing payroll:",i),c.fire("Error",((r=(t=i.response)==null?void 0:t.data)==null?void 0:r.message)||"Terjadi kesalahan saat edit payroll","error")}finally{C.value=!1}}}async function Mt(){var t,r;if(!k.value){c.fire("Peringatan","Payroll belum di-generate","warning");return}if((await c.fire({title:"Rollback Payroll?",text:"Apakah Anda yakin ingin menghapus payroll yang sudah di-generate? Tindakan ini tidak dapat dibatalkan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed){C.value=!0;try{const i=await B.post("/payroll/report/rollback",{payroll_id:k.value});i.data.success?(c.fire("Sukses",i.data.message,"success"),k.value=null,v.value=null,await J()):c.fire("Error",i.data.message,"error")}catch(i){console.error("Error rolling back payroll:",i),c.fire("Error",((r=(t=i.response)==null?void 0:t.data)==null?void 0:r.message)||"Terjadi kesalahan saat rollback payroll","error")}finally{C.value=!1}}}return lt([f,g,m],async([s,t,r],[i,y,D])=>{s&&t&&r&&(J(),(s!==i||t!==y||r!==D)&&await Promise.all([nt(),rt()]))}),It(()=>{f.value&&g.value&&m.value&&(J(),nt(),rt())}),(s,t)=>(o(),Kt(zt,{title:"Payroll"},{default:Jt(()=>{var r,i,y,D,A,X,Z;return[e("div",Ht,[tt.value?(o(),l("div",Yt,t[17]||(t[17]=[e("div",{class:"animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-blue-500"},null,-1)]))):h("",!0),t[118]||(t[118]=e("h1",{class:"text-2xl font-bold text-blue-800 mb-6 flex items-center gap-2"},[e("i",{class:"fa-solid fa-file-invoice-dollar text-green-500"}),p(" Payroll ")],-1)),e("div",Ft,[e("div",qt,[j(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>f.value=a),class:"form-input rounded-xl shadow-lg w-80",autofocus:""},[t[18]||(t[18]=e("option",{value:""},"Pilih Outlet",-1)),(o(!0),l(E,null,L(x.outlets,a=>(o(),l("option",{key:a.id,value:a.id},n(a.name),9,Wt))),128))],512),[[O,f.value]]),j(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>g.value=a),class:"form-input rounded-xl shadow-lg w-60"},[t[19]||(t[19]=e("option",{value:""},"Pilih Bulan",-1)),(o(!0),l(E,null,L(x.months,a=>(o(),l("option",{key:a.id,value:a.id},n(a.name),9,Qt))),128))],512),[[O,g.value]]),j(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>m.value=a),class:"form-input rounded-xl shadow-lg w-40"},[t[20]||(t[20]=e("option",{value:""},"Pilih Tahun",-1)),(o(!0),l(E,null,L(x.years,a=>(o(),l("option",{key:a.id,value:a.id},n(a.name),9,Xt))),128))],512),[[O,m.value]]),j(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>P.value=a),type:"number",step:"0.01",min:"0",placeholder:"Service Charge",class:"form-input rounded-xl shadow-lg w-48",onBlur:jt},null,544),[[N,P.value]]),j(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>U.value=a),type:"number",step:"0.01",min:"0",placeholder:"L & B Amount",class:"form-input rounded-xl shadow-lg w-48"},null,512),[[N,U.value]]),j(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>G.value=a),type:"number",step:"0.01",min:"0",placeholder:"Deviasi Amount",class:"form-input rounded-xl shadow-lg w-48"},null,512),[[N,G.value]]),e("div",Zt,[j(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>T.value=a),type:"number",step:"0.01",min:"0",placeholder:"City Ledger Amount",class:"form-input rounded-xl shadow-lg w-48",onBlur:Dt},null,544),[[N,T.value]]),t[21]||(t[21]=e("p",{class:"text-xs text-gray-500 mt-1 w-48"},[e("i",{class:"fa-solid fa-info-circle mr-1"}),p(" Diambil dari: Orders (City Ledger) + MAC Wrong Maker ")],-1))]),e("div",te,[j(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>S.value=a),type:"text",placeholder:"Cari NIK, Nama, Divisi, atau Jabatan...",class:"form-input rounded-xl shadow-lg w-full pl-10 pr-4"},null,512),[[N,S.value]]),t[22]||(t[22]=e("i",{class:"fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"},null,-1))]),e("button",{onClick:Q,class:"bg-gradient-to-br from-green-400 to-blue-500 text-white px-6 py-2 rounded-xl shadow-xl hover:scale-105 hover:shadow-2xl transition-all duration-300 font-bold",disabled:!f.value||!g.value||!m.value},t[23]||(t[23]=[e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),p(" Lihat Data ")]),8,ee),e("button",{onClick:wt,class:"bg-gradient-to-br from-yellow-400 to-orange-400 text-white px-6 py-2 rounded-xl shadow-xl hover:scale-105 hover:shadow-2xl transition-all duration-300 font-bold",disabled:!f.value||!g.value||!m.value||Y.value},[t[24]||(t[24]=e("i",{class:"fa-solid fa-file-export"},null,-1)),p(" "+n(Y.value?"Exporting...":"Export Excel"),1)],8,ae),!v.value||v.value==="draft"?(o(),l("button",{key:0,onClick:At,class:"bg-gradient-to-br from-green-400 to-green-600 text-white px-6 py-2 rounded-xl shadow-xl hover:scale-105 hover:shadow-2xl transition-all duration-300 font-bold",disabled:!f.value||!g.value||!m.value||C.value||!$.payrollData||$.payrollData.length===0},[t[25]||(t[25]=e("i",{class:"fa-solid fa-save"},null,-1)),p(" "+n(C.value?"Generating...":"Generate Payroll"),1)],8,se)):h("",!0),v.value==="generated"?(o(),l("button",{key:1,onClick:Nt,class:"bg-gradient-to-br from-blue-400 to-blue-600 text-white px-6 py-2 rounded-xl shadow-xl hover:scale-105 hover:shadow-2xl transition-all duration-300 font-bold",disabled:!f.value||!g.value||!m.value||C.value||!$.payrollData||$.payrollData.length===0},[t[26]||(t[26]=e("i",{class:"fa-solid fa-edit"},null,-1)),p(" "+n(C.value?"Updating...":"Edit Payroll"),1)],8,oe)):h("",!0),v.value==="generated"?(o(),l("button",{key:2,onClick:Mt,class:"bg-gradient-to-br from-red-400 to-red-600 text-white px-6 py-2 rounded-xl shadow-xl hover:scale-105 hover:shadow-2xl transition-all duration-300 font-bold",disabled:!k.value||C.value||v.value==="locked"},[t[27]||(t[27]=e("i",{class:"fa-solid fa-undo"},null,-1)),p(" "+n(C.value?"Rolling back...":"Rollback Payroll"),1)],8,le)):h("",!0)]),v.value?(o(),l("div",ne,[e("span",{class:M(["px-4 py-2 rounded-lg font-semibold text-sm",{"bg-yellow-100 text-yellow-800":v.value==="draft","bg-green-100 text-green-800":v.value==="generated","bg-red-100 text-red-800":v.value==="locked"}])},[t[28]||(t[28]=e("i",{class:"fa-solid fa-info-circle mr-2"},null,-1)),p(" Status: "+n(v.value==="draft"?"Draft":v.value==="generated"?"Generated":"Locked"),1)],2),v.value==="locked"?(o(),l("span",re,t[29]||(t[29]=[e("i",{class:"fa-solid fa-lock mr-1"},null,-1),p(" Payroll sudah di-lock dan tidak bisa di-edit atau di-rollback ")]))):h("",!0)])):h("",!0)]),e("div",ie,[z.value&&z.value.length>0?(o(),l("div",de,[e("div",ue,[e("div",pe,[t[30]||(t[30]=e("div",{class:"text-sm font-medium"},"TOTAL MP",-1)),e("div",xe,n(((r=x.statistics)==null?void 0:r.total_mp)||0),1)]),e("div",ce,[t[31]||(t[31]=e("div",{class:"text-sm font-medium"},"TOTAL MP AKTIF",-1)),e("div",me,n(((i=x.statistics)==null?void 0:i.total_mp_aktif)||0),1)]),e("div",ge,[t[32]||(t[32]=e("div",{class:"text-sm font-medium"},"TOTAL MP RESIGN",-1)),e("div",fe,n(((y=x.statistics)==null?void 0:y.total_mp_resign)||0),1)])]),e("div",ye,[e("div",_e,[t[33]||(t[33]=e("div",{class:"text-sm font-medium"},"Total Gaji Pokok",-1)),e("div",be,n(u(w.value.totalGajiPokok)),1)]),e("div",ve,[t[34]||(t[34]=e("div",{class:"text-sm font-medium"},"Total Tunjangan",-1)),e("div",he,n(u(w.value.totalTunjangan)),1)]),e("div",ke,[t[35]||(t[35]=e("div",{class:"text-sm font-medium"},"Total Gaji Lembur",-1)),e("div",we,n(u(w.value.totalGajiLembur)),1)]),e("div",je,[t[36]||(t[36]=e("div",{class:"text-sm font-medium"},"Total Potongan Telat",-1)),e("div",De,n(u(w.value.totalPotonganTelat)),1)]),e("div",Ce,[t[37]||(t[37]=e("div",{class:"text-sm font-medium"},"Total Potongan Alpha",-1)),e("div",Pe,n(u(w.value.totalPotonganAlpha)),1)]),e("div",Te,[t[38]||(t[38]=e("div",{class:"text-sm font-medium"},"Total Potongan Unpaid Leave",-1)),e("div",Be,n(u(w.value.totalPotonganUnpaidLeave)),1)]),e("div",Se,[t[39]||(t[39]=e("div",{class:"text-sm font-medium"},"Total Uang Makan",-1)),e("div",Ee,n(u(w.value.totalUangMakan)),1)]),e("div",Ae,[t[40]||(t[40]=e("div",{class:"text-sm font-medium"},"Total SC By Point",-1)),e("div",Le,n(u(w.value.totalServiceChargeByPoint)),1)]),e("div",Ne,[t[41]||(t[41]=e("div",{class:"text-sm font-medium"},"Total SC Pro Rate",-1)),e("div",Me,n(u(w.value.totalServiceChargeProRate)),1)]),e("div",Ue,[t[42]||(t[42]=e("div",{class:"text-sm font-medium"},"Total Service Charge",-1)),e("div",Ge,n(u(w.value.totalServiceCharge)),1)]),e("div",Ie,[t[43]||(t[43]=e("div",{class:"text-sm font-medium"},"Total BPJS JKN",-1)),e("div",Ke,n(u(w.value.totalBPJSJKN)),1)]),e("div",Je,[t[44]||(t[44]=e("div",{class:"text-sm font-medium"},"Total BPJS TK",-1)),e("div",Oe,n(u(w.value.totalBPJSTK)),1)]),e("div",$e,[t[45]||(t[45]=e("div",{class:"text-sm font-medium"},"Total PH Bonus",-1)),e("div",Ve,n(u(w.value.totalPHBonus)),1)]),e("div",ze,[t[46]||(t[46]=e("div",{class:"text-sm font-medium"},"Total Gaji",-1)),e("div",Re,n(u(w.value.totalGaji)),1)])]),e("div",He,[e("div",Ye,[t[47]||(t[47]=e("i",{class:"fa-solid fa-calendar-days mr-2"},null,-1)),p(" Periode: "+n((D=x.payrollData[0])==null?void 0:D.periode),1)]),S.value?(o(),l("div",Fe,[t[48]||(t[48]=e("i",{class:"fa-solid fa-filter mr-2"},null,-1)),p(" Menampilkan "+n(z.value.length)+" dari "+n(((A=x.payrollData)==null?void 0:A.length)||0)+" karyawan ",1)])):h("",!0)]),e("div",qe,[e("table",We,[e("thead",Qe,[e("tr",null,[t[49]||(t[49]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider w-12"},"No",-1)),t[50]||(t[50]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider w-12"},null,-1)),t[51]||(t[51]=e("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"NIK",-1)),t[52]||(t[52]=e("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Nama Karyawan",-1)),t[53]||(t[53]=e("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Jabatan",-1)),t[54]||(t[54]=e("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Divisi",-1)),t[55]||(t[55]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Point",-1)),t[56]||(t[56]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Gaji Pokok",-1)),t[57]||(t[57]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Tunjangan",-1)),t[58]||(t[58]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Menit Telat",-1)),t[59]||(t[59]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Jam Lembur",-1)),t[60]||(t[60]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Gaji Lembur",-1)),t[61]||(t[61]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Uang Makan",-1)),t[62]||(t[62]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Hari Kerja",-1)),t[63]||(t[63]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Total Alpha",-1)),(o(!0),l(E,null,L(x.leaveTypes,a=>(o(),l("th",{key:a.id,class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},n(a.name),1))),128)),t[64]||(t[64]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"SC By Point",-1)),t[65]||(t[65]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"SC Pro Rate",-1)),t[66]||(t[66]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Total SC",-1)),t[67]||(t[67]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"BPJS JKN",-1)),t[68]||(t[68]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"BPJS TK",-1)),t[69]||(t[69]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"L & B",-1)),t[70]||(t[70]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Deviasi",-1)),t[71]||(t[71]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"City Ledger",-1)),t[72]||(t[72]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"PH Bonus",-1)),t[73]||(t[73]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Custom Earnings",-1)),t[74]||(t[74]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Custom Deductions",-1)),t[75]||(t[75]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Potongan Telat",-1)),t[76]||(t[76]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Potongan Alpha",-1)),t[77]||(t[77]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Potongan Unpaid Leave",-1)),t[78]||(t[78]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Total Gaji",-1)),t[79]||(t[79]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Payment Method",-1)),t[80]||(t[80]=e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Aksi",-1))])]),e("tbody",Xe,[(o(!0),l(E,null,L(z.value,(a,R)=>(o(),l(E,{key:a.user_id},[e("tr",{class:M([R%2===0?"bg-white":"bg-gray-50","hover:bg-blue-50 transition-colors"])},[e("td",Ze,n(R+1),1),e("td",ta,[e("button",{onClick:d=>it(a.user_id),class:M(["w-6 h-6 rounded-full bg-blue-100 hover:bg-blue-200 text-blue-600 flex items-center justify-center transition-all duration-200 expand-button",{expanded:K.value.has(a.user_id)}])},[e("i",{class:M(K.value.has(a.user_id)?"fa fa-chevron-up":"fa fa-chevron-down")},null,2)],10,ea)]),e("td",aa,n(a.nik),1),e("td",sa,[e("div",oa,[e("span",la,n(a.nama_lengkap),1),a.is_new_employee?(o(),l("span",na," Karyawan Baru ")):h("",!0),a.is_mutated_employee?(o(),l("span",ra," Mutasi ")):h("",!0),a.resignation_date?(o(),l("span",ia," Resign ")):h("",!0)]),a.no_rekening?(o(),l("div",da,n(a.no_rekening),1)):h("",!0),a.tanggal_masuk?(o(),l("div",ua," Join: "+n(st(a.tanggal_masuk)),1)):h("",!0),a.resignation_date?(o(),l("div",pa," Resign: "+n(st(a.resignation_date)),1)):h("",!0),a.is_mutated_employee&&a.mutation_effective_date?(o(),l("div",xa," Mutasi: "+n(st(a.mutation_effective_date))+" â†’ "+n(a.mutation_outlet_to),1)):h("",!0)]),e("td",ca,n(a.jabatan),1),e("td",ma,n(a.divisi),1),e("td",ga,n(a.point||0),1),e("td",fa,n(u(a.gaji_pokok)),1),e("td",ya,n(u(a.tunjangan)),1),e("td",_a,[p(n(a.total_telat)+" ",1),e("div",ba,n(u(a.gaji_per_menit))+"/menit ",1)]),e("td",va,[a.master_data&&a.master_data.ot==1?(o(),l("span",ha,n(a.total_lembur),1)):(o(),l("span",ka,[p(n(a.total_lembur)+" ",1),t[81]||(t[81]=e("span",{class:"text-xs text-red-500 ml-1"},"(OT Disabled)",-1))]))]),e("td",wa,[a.master_data&&a.master_data.ot==1?(o(),l("span",ja,n(u(a.gaji_lembur)),1)):(o(),l("span",Da,[p(n(u(a.gaji_lembur))+" ",1),t[82]||(t[82]=e("span",{class:"text-xs text-red-500 ml-1"},"(OT Disabled)",-1))])),e("div",Ca,n(u(a.nominal_lembur_per_jam))+"/jam ",1)]),e("td",Pa,[a.master_data&&a.master_data.um==1?(o(),l("span",Ta,n(u(a.uang_makan)),1)):(o(),l("span",Ba,[p(n(u(a.uang_makan))+" ",1),t[83]||(t[83]=e("span",{class:"text-xs text-red-500 ml-1"},"(UM Disabled)",-1))])),e("div",Sa,n(u(a.nominal_uang_makan))+"/hari ",1)]),e("td",Ea,n(a.hari_kerja||0),1),e("td",Aa,n(a.total_alpha||0),1),(o(!0),l(E,null,L(x.leaveTypes,d=>(o(),l("td",{key:d.id,class:"px-4 py-3 text-sm text-center font-bold text-green-600"},n(kt(a,d.name)||0),1))),128)),e("td",La,[a.master_data&&a.master_data.sc==1?(o(),l("span",Na,n(u(a.service_charge_by_point||0)),1)):(o(),l("span",Ma,[p(n(u(0))+" ",1),t[84]||(t[84]=e("span",{class:"text-xs text-red-500 ml-1"},"(SC Disabled)",-1))]))]),e("td",Ua,[a.master_data&&a.master_data.sc==1?(o(),l("span",Ga,n(u(a.service_charge_pro_rate||0)),1)):(o(),l("span",Ia,[p(n(u(0))+" ",1),t[85]||(t[85]=e("span",{class:"text-xs text-red-500 ml-1"},"(SC Disabled)",-1))]))]),e("td",Ka,[a.master_data&&a.master_data.sc==1?(o(),l("span",Ja,n(u(a.service_charge||0)),1)):(o(),l("span",Oa,[p(n(u(0))+" ",1),t[86]||(t[86]=e("span",{class:"text-xs text-red-500 ml-1"},"(SC Disabled)",-1))]))]),e("td",$a,[a.master_data&&a.master_data.bpjs_jkn==1?(o(),l("span",Va,n(u(a.bpjs_jkn)),1)):(o(),l("span",za,[p(n(u(a.bpjs_jkn))+" ",1),t[87]||(t[87]=e("span",{class:"text-xs text-red-500 ml-1"},"(JKN Disabled)",-1))]))]),e("td",Ra,[a.master_data&&a.master_data.bpjs_tk==1?(o(),l("span",Ha,n(u(a.bpjs_tk)),1)):(o(),l("span",Ya,[p(n(u(a.bpjs_tk))+" ",1),t[88]||(t[88]=e("span",{class:"text-xs text-red-500 ml-1"},"(TK Disabled)",-1))]))]),e("td",Fa,[a.master_data&&a.master_data.lb==1?(o(),l("span",qa,n(u(a.lb_total||0)),1)):(o(),l("span",Wa,[p(n(u(0))+" ",1),t[89]||(t[89]=e("span",{class:"text-xs text-red-500 ml-1"},"(L & B Disabled)",-1))]))]),e("td",Qa,[a.master_data&&a.master_data.deviasi==1?(o(),l("span",Xa,n(u(a.deviasi_total||0)),1)):(o(),l("span",Za,[p(n(u(0))+" ",1),t[90]||(t[90]=e("span",{class:"text-xs text-red-500 ml-1"},"(Deviasi Disabled)",-1))]))]),e("td",ts,[a.master_data&&a.master_data.city_ledger==1?(o(),l("span",es,n(u(a.city_ledger_total||0)),1)):(o(),l("span",as,[p(n(u(0))+" ",1),t[91]||(t[91]=e("span",{class:"text-xs text-red-500 ml-1"},"(City Ledger Disabled)",-1))]))]),e("td",ss,n(u(a.ph_bonus||0)),1),e("td",os,[p(n(u(a.custom_earnings))+" ",1),a.custom_items&&a.custom_items.length>0?(o(),l("button",{key:0,onClick:d=>dt(a.user_id,"earn"),class:"ml-2 text-xs text-blue-600 hover:text-blue-800"},t[92]||(t[92]=[e("i",{class:"fa fa-eye"},null,-1)]),8,ls)):h("",!0)]),e("td",ns,[p(n(u(a.custom_deductions))+" ",1),a.custom_items&&a.custom_items.length>0?(o(),l("button",{key:0,onClick:d=>dt(a.user_id,"deduction"),class:"ml-2 text-xs text-blue-600 hover:text-blue-800"},t[93]||(t[93]=[e("i",{class:"fa fa-eye"},null,-1)]),8,rs)):h("",!0)]),e("td",is,n(u(a.potongan_telat||0)),1),e("td",ds,n(u(a.potongan_alpha||0)),1),e("td",us,n(u(a.potongan_unpaid_leave||0)),1),e("td",ps,n(u(a.total_gaji)),1),e("td",xs,[j(e("select",{"onUpdate:modelValue":d=>a.payment_method=d,onChange:d=>Lt(a.user_id,d.target.value),class:M(["px-3 py-2 rounded-lg text-sm font-semibold border-2 focus:outline-none focus:ring-2 focus:ring-offset-2 min-w-[120px] appearance-none bg-no-repeat bg-right pr-8 cursor-pointer hover:shadow-md transition-all",(a.payment_method||"transfer")==="transfer"?"bg-blue-100 text-blue-800 border-blue-300 focus:ring-blue-500":"bg-purple-100 text-purple-800 border-purple-300 focus:ring-purple-500"]),style:{"background-image":"url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 24 24\\' fill=\\'none\\' stroke=\\'currentColor\\' stroke-width=\\'2\\' stroke-linecap=\\'round\\' stroke-linejoin=\\'round\\'%3e%3cpolyline points=\\'6 9 12 15 18 9\\'%3e%3c/polyline%3e%3c/svg%3e')","background-position":"right 0.5rem center","background-size":"1em 1em"}},t[94]||(t[94]=[e("option",{value:"transfer"},"Transfer",-1),e("option",{value:"cash"},"Cash",-1)]),42,cs),[[O,a.payment_method]])]),e("td",ms,[e("div",gs,[e("button",{onClick:d=>Pt(a.user_id,a.nama_lengkap),class:"bg-gradient-to-br from-purple-400 to-purple-600 text-white px-3 py-1 rounded-lg text-xs hover:scale-105 transition-all duration-200 font-bold"},t[95]||(t[95]=[e("i",{class:"fa fa-plus mr-1"},null,-1),p(" Custom ")]),8,fs),e("button",{onClick:d=>it(a.user_id),class:"bg-gradient-to-br from-blue-400 to-blue-600 text-white px-3 py-1 rounded-lg text-xs hover:scale-105 transition-all duration-200 font-bold"},t[96]||(t[96]=[e("i",{class:"fa fa-eye mr-1"},null,-1),p(" Detail ")]),8,ys),e("button",{onClick:d=>Et(a),class:"bg-gradient-to-br from-blue-400 to-blue-600 text-white px-3 py-1 rounded-lg text-xs hover:scale-105 transition-all duration-200 font-bold mr-1"},t[97]||(t[97]=[e("i",{class:"fa fa-eye mr-1"},null,-1),p(" View ")]),8,_s)])])],2),K.value.has(a.user_id)?(o(),l("tr",bs,[e("td",vs,[et.value[a.user_id]?(o(),l("div",hs,t[98]||(t[98]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"},null,-1),e("span",{class:"ml-2 text-blue-600"},"Loading detail attendance...",-1)]))):I.value[a.user_id]&&I.value[a.user_id].length>0?(o(),l("div",ks,[e("div",ws,[t[113]||(t[113]=e("i",{class:"fa fa-calendar-check text-blue-600"},null,-1)),e("h4",js,"Detail Attendance - "+n(a.nama_lengkap),1),e("div",Ds,[a.master_data&&a.master_data.ot==1?(o(),l("span",Cs,t[99]||(t[99]=[e("i",{class:"fa fa-check-circle mr-1"},null,-1),p(" OT Enabled ")]))):(o(),l("span",Ps,t[100]||(t[100]=[e("i",{class:"fa fa-times-circle mr-1"},null,-1),p(" OT Disabled ")]))),a.master_data&&a.master_data.um==1?(o(),l("span",Ts,t[101]||(t[101]=[e("i",{class:"fa fa-check-circle mr-1"},null,-1),p(" UM Enabled ")]))):(o(),l("span",Bs,t[102]||(t[102]=[e("i",{class:"fa fa-times-circle mr-1"},null,-1),p(" UM Disabled ")]))),a.master_data&&a.master_data.bpjs_jkn==1?(o(),l("span",Ss,t[103]||(t[103]=[e("i",{class:"fa fa-check-circle mr-1"},null,-1),p(" JKN Enabled ")]))):(o(),l("span",Es,t[104]||(t[104]=[e("i",{class:"fa fa-times-circle mr-1"},null,-1),p(" JKN Disabled ")]))),a.master_data&&a.master_data.bpjs_tk==1?(o(),l("span",As,t[105]||(t[105]=[e("i",{class:"fa fa-check-circle mr-1"},null,-1),p(" TK Enabled ")]))):(o(),l("span",Ls,t[106]||(t[106]=[e("i",{class:"fa fa-times-circle mr-1"},null,-1),p(" TK Disabled ")]))),a.master_data&&a.master_data.lb==1?(o(),l("span",Ns,t[107]||(t[107]=[e("i",{class:"fa fa-check-circle mr-1"},null,-1),p(" L & B Enabled ")]))):(o(),l("span",Ms,t[108]||(t[108]=[e("i",{class:"fa fa-times-circle mr-1"},null,-1),p(" L & B Disabled ")]))),a.master_data&&a.master_data.deviasi==1?(o(),l("span",Us,t[109]||(t[109]=[e("i",{class:"fa fa-check-circle mr-1"},null,-1),p(" Deviasi Enabled ")]))):(o(),l("span",Gs,t[110]||(t[110]=[e("i",{class:"fa fa-times-circle mr-1"},null,-1),p(" Deviasi Disabled ")]))),a.master_data&&a.master_data.city_ledger==1?(o(),l("span",Is,t[111]||(t[111]=[e("i",{class:"fa fa-check-circle mr-1"},null,-1),p(" City Ledger Enabled ")]))):(o(),l("span",Ks,t[112]||(t[112]=[e("i",{class:"fa fa-times-circle mr-1"},null,-1),p(" City Ledger Disabled ")])))])]),e("div",Js,[e("table",Os,[t[114]||(t[114]=e("thead",{class:"bg-blue-100"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left border-b"},"Tanggal"),e("th",{class:"px-3 py-2 text-center border-b"},"Jam Masuk"),e("th",{class:"px-3 py-2 text-center border-b"},"Jam Keluar"),e("th",{class:"px-3 py-2 text-center border-b"},"IN/OUT"),e("th",{class:"px-3 py-2 text-center border-b"},"Telat (menit)"),e("th",{class:"px-3 py-2 text-center border-b"},"Lembur (jam)"),e("th",{class:"px-3 py-2 text-center border-b"},"OT dari EO"),e("th",{class:"px-3 py-2 text-center border-b"},"Total Lembur"),e("th",{class:"px-3 py-2 text-center border-b"},"Shift"),e("th",{class:"px-3 py-2 text-center border-b"},"Status")])],-1)),e("tbody",$s,[(o(!0),l(E,null,L(I.value[a.user_id],d=>(o(),l("tr",{key:d.tanggal,class:M(["border-b hover:bg-gray-50",d.is_off?"bg-gray-100":"",d.is_alpha?"bg-red-100":"",d.is_approved_absent?"bg-green-100":""])},[e("td",Vs,n(d.tanggal),1),e("td",zs,[d.is_off?(o(),l("span",Rs,"OFF")):(o(),l("span",Hs,n(d.jam_masuk||"-"),1))]),e("td",Ys,[d.is_off?(o(),l("span",Fs,"OFF")):(o(),l("span",qs,n(d.jam_keluar||"-"),1))]),e("td",Ws,[d.is_off?(o(),l("span",Qs,"OFF")):(o(),l("div",Xs,[e("span",Zs,n(d.total_masuk)+" IN",1),e("span",to,n(d.total_keluar)+" OUT",1)]))]),e("td",eo,[d.is_off?(o(),l("span",ao,"OFF")):d.telat>0?(o(),l("span",so,n(d.telat),1)):(o(),l("span",oo,"0"))]),e("td",lo,[d.is_off?(o(),l("span",no,"OFF")):d.lembur>0?(o(),l("span",ro,n(Math.floor(d.lembur||0)),1)):(o(),l("span",io,"0"))]),e("td",uo,[d.extra_off_overtime>0?(o(),l("span",po,n(Math.floor(d.extra_off_overtime||0)),1)):d.is_off&&!d.extra_off_overtime?(o(),l("span",xo,"OFF")):(o(),l("span",co,"0"))]),e("td",mo,[(d.total_lembur||d.lembur||d.extra_off_overtime)>0?(o(),l("span",go,n(Math.floor(d.total_lembur||d.lembur||d.extra_off_overtime||0)),1)):d.is_off?(o(),l("span",fo,"OFF")):(o(),l("span",yo,"0"))]),e("td",_o,[d.is_off?(o(),l("span",bo,"OFF")):(o(),l("span",vo,n(d.shift_name||"-"),1))]),e("td",{class:M(["px-3 py-2 text-center",d.is_alpha?"bg-red-200":d.is_approved_absent?"bg-green-100":""])},[d.is_off?(o(),l("span",ho," ðŸ“… OFF ")):d.is_approved_absent?(o(),l("span",ko," âœ“ "+n(d.approved_absent_name||"Izin/Cuti"),1)):d.is_alpha?(o(),l("span",wo," âš  ALPHA ")):d.is_cross_day?(o(),l("span",jo," ðŸŒ™ Cross-day ")):(o(),l("span",Do," âœ“ Normal "))],2)],2))),128))])])])])):(o(),l("div",Co,t[115]||(t[115]=[e("i",{class:"fa fa-info-circle text-2xl mb-2"},null,-1),e("p",null,"Tidak ada data attendance untuk periode ini",-1)])))])])):h("",!0)],64))),128))])])])])):f.value&&g.value&&m.value?(o(),l("div",Po,[t[116]||(t[116]=e("i",{class:"fa-solid fa-file-invoice-dollar text-6xl mb-4 text-gray-300"},null,-1)),e("h3",To,n(S.value?"Tidak ada data payroll yang sesuai dengan pencarian":"Tidak ada data payroll"),1),e("p",Bo,n(S.value?`Tidak ada data yang cocok dengan pencarian "${S.value}"`:"Data payroll untuk outlet, bulan, dan tahun yang dipilih tidak ditemukan."),1)])):(o(),l("div",So,t[117]||(t[117]=[e("i",{class:"fa-solid fa-filter text-6xl mb-4 text-gray-300"},null,-1),e("h3",{class:"text-xl font-semibold mb-2"},"Pilih Filter",-1),e("p",{class:"text-gray-400"},"Silakan pilih outlet, bulan, dan tahun untuk melihat data payroll.",-1)])))])]),V.value?(o(),l("div",Eo,[e("div",Ao,[e("div",Lo,[t[120]||(t[120]=e("h3",{class:"text-xl font-bold text-gray-800"},"Tambah Custom Item",-1)),e("button",{onClick:t[8]||(t[8]=a=>V.value=!1),class:"text-gray-500 hover:text-gray-700"},t[119]||(t[119]=[e("i",{class:"fa fa-times text-xl"},null,-1)]))]),e("form",{onSubmit:Ot(Tt,["prevent"]),class:"space-y-4"},[e("div",No,[e("div",null,[t[121]||(t[121]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Karyawan",-1)),e("div",Mo,[e("span",Uo,n(((X=x.payrollData.find(a=>a.user_id==_.value.user_id))==null?void 0:X.nama_lengkap)||"Karyawan tidak ditemukan"),1),e("span",Go," ("+n(((Z=x.payrollData.find(a=>a.user_id==_.value.user_id))==null?void 0:Z.nik)||"N/A")+") ",1)])]),e("div",null,[t[123]||(t[123]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipe Item",-1)),j(e("select",{"onUpdate:modelValue":t[9]||(t[9]=a=>_.value.item_type=a),required:"",class:"w-full form-input rounded-lg"},t[122]||(t[122]=[e("option",{value:"earn"},"Earnings (Penghasilan)",-1),e("option",{value:"deduction"},"Deduction (Pengurangan)",-1)]),512),[[O,_.value.item_type]])]),e("div",null,[t[125]||(t[125]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Gajian",-1)),j(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>_.value.gajian_type=a),required:"",class:"w-full form-input rounded-lg"},t[124]||(t[124]=[e("option",{value:"gajian1"},"Gajian 1 (Gaji Akhir Bulan)",-1),e("option",{value:"gajian2"},"Gajian 2 (Gaji Tanggal 8)",-1)]),512),[[O,_.value.gajian_type]])]),e("div",null,[t[126]||(t[126]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nama Item",-1)),j(e("input",{"onUpdate:modelValue":t[11]||(t[11]=a=>_.value.item_name=a),type:"text",required:"",class:"w-full form-input rounded-lg",placeholder:"Contoh: Bonus, Potongan, dll"},null,512),[[N,_.value.item_name]])]),e("div",null,[t[127]||(t[127]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Jumlah",-1)),j(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>_.value.item_amount=a),type:"number",required:"",min:"0",step:"0.01",class:"w-full form-input rounded-lg",placeholder:"0"},null,512),[[N,_.value.item_amount,void 0,{number:!0}]])])]),e("div",null,[t[128]||(t[128]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Deskripsi (Opsional)",-1)),j(e("textarea",{"onUpdate:modelValue":t[13]||(t[13]=a=>_.value.item_description=a),rows:"3",class:"w-full form-input rounded-lg",placeholder:"Deskripsi item..."},null,512),[[N,_.value.item_description]])]),e("div",Io,[e("button",{type:"button",onClick:t[14]||(t[14]=a=>V.value=!1),class:"px-4 py-2 text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300"}," Batal "),t[129]||(t[129]=e("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Tambah Item ",-1))])],32)])])):h("",!0),F.value?(o(),l("div",Ko,[e("div",Jo,[e("div",Oo,[e("h3",$o," Detail "+n(q.value==="earn"?"Earnings":"Deductions"),1),e("button",{onClick:t[15]||(t[15]=a=>F.value=!1),class:"text-gray-500 hover:text-gray-700"},t[130]||(t[130]=[e("i",{class:"fa fa-times text-xl"},null,-1)]))]),at.value.length>0?(o(),l("div",Vo,[e("table",zo,[t[132]||(t[132]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Nama Item"),e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Jumlah"),e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Gajian"),e("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Deskripsi"),e("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Aksi")])],-1)),e("tbody",Ro,[(o(!0),l(E,null,L(at.value,a=>(o(),l("tr",{key:a.id,class:"hover:bg-gray-50"},[e("td",Ho,n(a.item_name),1),e("td",{class:M(["px-4 py-3 text-sm text-center font-bold",q.value==="earn"?"text-green-600":"text-red-600"])},n(u(a.item_amount)),3),e("td",Yo,[a.gajian_type==="gajian2"?(o(),l("span",Fo," Gajian 2 (Tgl 8) ")):(o(),l("span",qo," Gajian 1 (Akhir Bulan) "))]),e("td",Wo,n(a.item_description||"-"),1),e("td",Qo,[e("button",{onClick:R=>Bt(a.id),class:"text-red-600 hover:text-red-800"},t[131]||(t[131]=[e("i",{class:"fa fa-trash"},null,-1)]),8,Xo)])]))),128))])])])):(o(),l("div",Zo,[t[133]||(t[133]=e("i",{class:"fa fa-inbox text-4xl mb-4"},null,-1)),e("p",null,"Tidak ada "+n(q.value==="earn"?"earnings":"deductions")+" untuk ditampilkan",1)])),e("div",tl,[e("button",{onClick:t[16]||(t[16]=a=>F.value=!1),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"}," Tutup ")])])])):h("",!0)]}),_:1}))}},xl=Rt(el,[["__scopeId","data-v-e0b50826"]]);export{xl as default};
