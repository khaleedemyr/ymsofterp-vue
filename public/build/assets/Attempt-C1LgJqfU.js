import{r as d,c as k,a as E,j as $,A as M,B as a,C as N,D as t,L as o,E as v,N as s,O as D,l as L,F as j,M as O,H as P,a6 as V,G as h,W}from"./vendor-vue-g7iCcTkf.js";import{A as G}from"./AppLayout-D8A3r8FT.js";import{a as U}from"./vendor-utils-CpgP2uT4.js";import{S as b}from"./app-3SxMownK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-BaUvls0f.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const F={class:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-8"},H={class:"max-w-4xl mx-auto px-4"},K={class:"bg-white rounded-2xl shadow-xl p-6 mb-6"},R={class:"flex items-center justify-between mb-4"},J={class:"text-2xl font-bold text-slate-800"},X={class:"text-slate-600 mt-1"},Y={class:"text-right"},Z={class:"text-sm text-slate-500"},tt={class:"text-sm text-slate-500"},et={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},st={class:"text-blue-700 text-sm"},it={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},at={class:"flex items-center"},ot={class:"text-slate-600"},lt={key:0},nt={key:1},rt={key:2},ut={class:"flex items-center"},dt={class:"text-slate-600"},ct={class:"flex items-center"},mt={class:"text-slate-600"},vt={key:0},bt={key:1},ft={class:"bg-white rounded-2xl shadow-xl p-6"},pt={key:0,class:"mb-6"},_t={class:"flex items-center justify-between"},xt={class:"text-sm text-slate-600"},ht={class:"flex items-center space-x-2"},gt={key:0,class:"mt-2 text-center text-red-600 font-semibold"},yt={key:1,class:"mb-8"},qt={class:"border-b border-slate-200 pb-4 mb-4"},kt={class:"flex items-start justify-between mb-3"},wt={class:"text-lg font-semibold text-slate-800"},zt={class:"text-sm text-slate-500"},St={class:"text-slate-700 mb-4"},jt={class:"space-y-3"},Tt=["id","name","value"],Qt=["for"],Ct={class:"flex justify-between items-center pt-6 border-t border-slate-200"},It={class:"flex items-center space-x-4"},At=["disabled"],Bt={class:"flex items-center space-x-4"},Et={class:"text-sm text-slate-500"},$t=["disabled"],Mt={key:0,class:"fas fa-spinner fa-spin mr-2"},Nt={key:1,class:"fas fa-check mr-2"},Kt={__name:"Attempt",props:{attempt:Object,quiz:Object},setup(i){const r=i,f=d({}),p=d(!1),T=d(new Date),w=d(null),l=d(0),c=d(null),_=d(0),g=d(!1),u=k(()=>r.quiz.questions[l.value]),x=k(()=>r.quiz.time_limit_type==="per_question"),Q=k(()=>r.quiz.time_per_question_seconds||10),C=n=>n.toLocaleTimeString("id-ID"),I=n=>{const e=Math.floor(n/60),m=n%60;return`${e.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}`},y=()=>{x.value&&(_.value=Q.value,g.value=!1,c.value=setInterval(()=>{_.value--,_.value<=0&&(g.value=!0,clearInterval(c.value),setTimeout(()=>{l.value<r.quiz.questions.length-1?q():S()},1e3))},1e3))},z=()=>{c.value&&(clearInterval(c.value),c.value=null)},q=()=>{l.value<r.quiz.questions.length-1&&(z(),l.value++,y())},A=()=>{l.value>0&&(z(),l.value--,y())},S=async()=>{var n;if(!p.value){b.fire({title:"Sabar Bu Ghea....",text:"Antosan sakedap Bu Ghea, Nuju loding",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{b.showLoading()}}),p.value=!0;try{console.log("Submitting quiz with answers:",f.value),console.log("Attempt ID:",r.attempt.id);const e=await U.post("/api/quiz/submit-attempt",{attempt_id:r.attempt.id,answers:f.value});console.log("Submit response:",e.data),e.data.result?(console.log("Quiz submitted successfully, redirecting to results..."),b.close(),W.visit(`/lms/quiz/results/${r.attempt.id}`)):(console.error("No result in response:",e.data),b.close(),b.fire({icon:"error",title:"Error!",text:"Terjadi kesalahan saat mengirim quiz"}))}catch(e){console.error("Error submitting quiz:",e),console.error("Error response:",(n=e.response)==null?void 0:n.data),b.close(),b.fire({icon:"error",title:"Error!",text:"Terjadi kesalahan saat mengirim quiz"})}finally{p.value=!1}}};return E(()=>{r.attempt.answers&&r.attempt.answers.forEach(n=>{f.value[n.question_id]=n.selected_option_id}),x.value&&y()}),$(()=>{w.value&&clearInterval(w.value),c.value&&clearInterval(c.value)}),(n,e)=>(a(),M(G,{title:"Quiz Attempt"},{default:N(()=>[t("div",F,[t("div",H,[t("div",K,[t("div",R,[t("div",null,[t("h1",J,s(i.quiz.title),1),t("p",X,s(i.quiz.description),1)]),t("div",Y,[t("div",Z,"Attempt #"+s(i.attempt.attempt_number),1),t("div",tt,s(C(T.value)),1)])]),i.quiz.instructions?(a(),o("div",et,[e[1]||(e[1]=t("h3",{class:"font-semibold text-blue-800 mb-2"},"Instruksi:",-1)),t("p",st,s(i.quiz.instructions),1)])):v("",!0),t("div",it,[t("div",at,[e[2]||(e[2]=t("i",{class:"fas fa-clock text-slate-500 mr-2"},null,-1)),t("span",ot,[i.quiz.time_limit_type==="total"?(a(),o("span",lt," Waktu: "+s(i.quiz.time_limit_minutes)+" menit ",1)):i.quiz.time_limit_type==="per_question"?(a(),o("span",nt,s(i.quiz.time_per_question_seconds)+" detik/pertanyaan ",1)):(a(),o("span",rt,"Tidak ada batas waktu"))])]),t("div",ut,[e[3]||(e[3]=t("i",{class:"fas fa-target text-slate-500 mr-2"},null,-1)),t("span",dt,"Nilai minimum: "+s(i.quiz.passing_score)+"%",1)]),t("div",ct,[e[4]||(e[4]=t("i",{class:"fas fa-redo text-slate-500 mr-2"},null,-1)),t("span",mt,[i.quiz.max_attempts?(a(),o("span",vt,"Maksimal "+s(i.quiz.max_attempts)+" percobaan",1)):(a(),o("span",bt,"Percobaan tidak terbatas"))])])])]),t("div",ft,[t("form",{onSubmit:D(S,["prevent"])},[x.value?(a(),o("div",pt,[t("div",_t,[t("div",xt," Pertanyaan "+s(l.value+1)+" dari "+s(i.quiz.questions.length),1),t("div",ht,[e[5]||(e[5]=t("i",{class:"fas fa-clock text-slate-500"},null,-1)),t("span",{class:L(["text-lg font-bold",_.value<=10?"text-red-600":"text-slate-800"])},s(I(_.value)),3)])]),g.value?(a(),o("div",gt," Waktu habis! Pindah ke pertanyaan berikutnya... ")):v("",!0)])):v("",!0),u.value?(a(),o("div",yt,[t("div",qt,[t("div",kt,[t("h3",wt," Pertanyaan "+s(l.value+1),1),t("span",zt,s(u.value.points)+" poin",1)]),t("p",St,s(u.value.question_text),1)]),t("div",jt,[(a(!0),o(j,null,O(u.value.options,m=>(a(),o("div",{key:m.id,class:"flex items-center"},[P(t("input",{id:`question_${u.value.id}_option_${m.id}`,name:`question_${u.value.id}`,value:m.id,"onUpdate:modelValue":e[0]||(e[0]=B=>f.value[u.value.id]=B),type:"radio",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 focus:ring-2"},null,8,Tt),[[V,f.value[u.value.id]]]),t("label",{for:`question_${u.value.id}_option_${m.id}`,class:"ml-3 text-sm text-slate-700 cursor-pointer"},s(m.option_text),9,Qt)]))),128))])])):v("",!0),t("div",Ct,[t("div",It,[x.value?v("",!0):(a(),o(j,{key:0},[t("button",{type:"button",onClick:A,disabled:l.value===0,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},e[6]||(e[6]=[t("i",{class:"fas fa-arrow-left mr-2"},null,-1),h(" Sebelumnya ")]),8,At),l.value<i.quiz.questions.length-1?(a(),o("button",{key:0,type:"button",onClick:q,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e[7]||(e[7]=[h(" Selanjutnya "),t("i",{class:"fas fa-arrow-right ml-2"},null,-1)]))):v("",!0)],64)),x.value&&l.value<i.quiz.questions.length-1?(a(),o("button",{key:1,type:"button",onClick:q,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e[8]||(e[8]=[h(" Selanjutnya "),t("i",{class:"fas fa-arrow-right ml-2"},null,-1)]))):v("",!0)]),t("div",Bt,[t("div",Et,s(Object.keys(f.value).length)+" dari "+s(i.quiz.questions.length)+" pertanyaan dijawab ",1),t("button",{type:"submit",disabled:p.value,class:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(a(),o("i",Mt)):(a(),o("i",Nt)),h(" "+s(p.value?"Mengirim...":"Selesai Quiz"),1)],8,$t)])])],32)])])])]),_:1}))}};export{Kt as default};
