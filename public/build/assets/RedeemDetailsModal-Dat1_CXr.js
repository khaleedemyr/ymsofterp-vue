import{_ as h}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as m,w as b,L as n,E as x,B as i,D as t,G as d,N as o,F as w,M as D}from"./vendor-vue-g7iCcTkf.js";import"./vendor-utils-CpgP2uT4.js";const N={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},R={class:"flex min-h-full items-center justify-center p-4"},j={class:"relative w-full max-w-4xl max-h-[90vh] bg-white rounded-xl shadow-xl flex flex-col"},I={class:"flex items-center justify-between p-6 border-b border-gray-200"},T={class:"text-xl font-semibold text-gray-900 flex items-center gap-2"},M={key:0,class:"p-8 text-center"},S={key:1,class:"p-6 flex-1 overflow-hidden flex flex-col"},B={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 flex-shrink-0"},L={class:"bg-orange-50 rounded-lg p-4 border border-orange-200"},C={class:"flex items-center gap-3"},O={class:"text-2xl font-bold text-orange-900"},E={class:"bg-orange-50 rounded-lg p-4 border border-orange-200"},P={class:"flex items-center gap-3"},V={class:"text-2xl font-bold text-orange-900"},F={class:"bg-orange-50 rounded-lg p-4 border border-orange-200"},G={class:"flex items-center gap-3"},z={class:"text-lg font-bold text-orange-900"},U={class:"bg-gray-50 rounded-lg p-4 flex-1 overflow-hidden flex flex-col"},$={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2 flex-shrink-0"},q={key:0,class:"text-sm text-gray-500 font-normal"},A={key:0,class:"text-xs text-gray-500 mb-3 flex-shrink-0"},H={key:1,class:"text-center py-8 text-gray-500 flex-1 flex items-center justify-center"},J={key:2,class:"space-y-3 overflow-y-auto flex-1 pr-2 custom-scrollbar"},K={class:"flex items-center justify-between mb-3"},Q={class:"flex items-center gap-3"},W={class:"font-semibold text-gray-900"},X={class:"text-sm text-gray-600"},Y={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},Z={class:"ml-1 font-semibold text-gray-900"},tt={class:"ml-1 font-semibold text-gray-900"},et={class:"ml-1 text-gray-900"},st={class:"mt-3 pt-3 border-t border-gray-200"},at={class:"flex justify-between text-xs text-gray-500"},lt={__name:"RedeemDetailsModal",props:{isOpen:Boolean,cabangId:Number,cabangName:String,startDate:String,endDate:String},emits:["close"],setup(c,{emit:v}){const a=c,y=v,f=m(!1),r=m([]),g=m({total_redeem:0,total_points:0,total_value:0});function _(l){return l.toLocaleString("id-ID")}function k(l){return"Rp "+l.toLocaleString("id-ID")}function u(){y("close")}async function p(){if(a.cabangId){f.value=!0;try{const l=new URLSearchParams({cabang_id:a.cabangId});a.startDate&&l.append("start_date",a.startDate),a.endDate&&l.append("end_date",a.endDate);const s=await(await fetch(`/api/crm/redeem-details?${l}`)).json();r.value=s.redeem_details,g.value={total_redeem:s.total_redeem,total_points:s.total_points,total_value:s.total_value}}catch(l){console.error("Error loading redeem details:",l)}finally{f.value=!1}}}return b(()=>a.isOpen,l=>{l&&a.cabangId&&p()}),b([()=>a.startDate,()=>a.endDate],()=>{a.isOpen&&a.cabangId&&p()}),(l,e)=>c.isOpen?(i(),n("div",N,[t("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:u}),t("div",R,[t("div",j,[t("div",I,[t("div",null,[t("h3",T,[e[0]||(e[0]=t("i",{class:"fa-solid fa-coins text-orange-500"},null,-1)),d(" Detail Redeem - "+o(c.cabangName),1)]),e[1]||(e[1]=t("p",{class:"text-sm text-gray-600 mt-1"}," Menampilkan semua transaksi redeem untuk cabang ini ",-1))]),t("button",{onClick:u,class:"text-gray-400 hover:text-gray-600 transition-colors"},e[2]||(e[2]=[t("i",{class:"fa-solid fa-times text-xl"},null,-1)]))]),f.value?(i(),n("div",M,e[3]||(e[3]=[t("div",{class:"inline-flex items-center gap-2"},[t("i",{class:"fa-solid fa-spinner fa-spin text-blue-500"}),t("span",{class:"text-gray-600"},"Memuat data redeem...")],-1)]))):(i(),n("div",S,[t("div",B,[t("div",L,[t("div",C,[e[5]||(e[5]=t("div",{class:"bg-orange-100 p-2 rounded-lg"},[t("i",{class:"fa-solid fa-receipt text-orange-600"})],-1)),t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm font-medium text-orange-600"},"Total Redeem",-1)),t("p",O,o(g.value.total_redeem),1)])])]),t("div",E,[t("div",P,[e[7]||(e[7]=t("div",{class:"bg-orange-100 p-2 rounded-lg"},[t("i",{class:"fa-solid fa-coins text-orange-600"})],-1)),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm font-medium text-orange-600"},"Total Point",-1)),t("p",V,o(_(g.value.total_points)),1)])])]),t("div",F,[t("div",G,[e[9]||(e[9]=t("div",{class:"bg-orange-100 p-2 rounded-lg"},[t("i",{class:"fa-solid fa-money-bill-wave text-orange-600"})],-1)),t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm font-medium text-orange-600"},"Total Nilai",-1)),t("p",z,o(k(g.value.total_value)),1)])])])]),t("div",U,[t("h4",$,[e[10]||(e[10]=t("i",{class:"fa-solid fa-list text-gray-600"},null,-1)),e[11]||(e[11]=d(" Daftar Transaksi Redeem ")),r.value.length>0?(i(),n("span",q," ("+o(r.value.length)+" transaksi terbaru) ",1)):x("",!0)]),r.value.length>=50?(i(),n("p",A,e[12]||(e[12]=[t("i",{class:"fa-solid fa-info-circle mr-1"},null,-1),d(" Menampilkan 50 transaksi terbaru. Gunakan filter tanggal untuk melihat data lebih spesifik. ")]))):x("",!0),r.value.length===0?(i(),n("div",H,e[13]||(e[13]=[t("div",null,[t("i",{class:"fa-solid fa-coins text-4xl mb-4"}),t("p",null,"Tidak ada data redeem untuk cabang ini")],-1)]))):(i(),n("div",J,[(i(!0),n(w,null,D(r.value,s=>(i(),n("div",{key:s.id,class:"bg-white rounded-lg p-4 shadow-sm border border-gray-200"},[t("div",K,[t("div",Q,[e[14]||(e[14]=t("div",{class:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center"},[t("i",{class:"fa-solid fa-minus-circle text-orange-600"})],-1)),t("div",null,[t("h5",W,o(s.customer_name),1),t("p",X,"ID: "+o(s.customer_id),1)])]),e[15]||(e[15]=t("div",{class:"text-right"},[t("span",{class:"px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm font-medium"}," Redeem ")],-1))]),t("div",Y,[t("div",null,[e[16]||(e[16]=t("span",{class:"text-gray-500"},"Point Redeem:",-1)),t("span",Z,o(s.point_formatted),1)]),t("div",null,[e[17]||(e[17]=t("span",{class:"text-gray-500"},"Nilai Transaksi:",-1)),t("span",tt,o(s.jml_trans_formatted),1)]),t("div",null,[e[18]||(e[18]=t("span",{class:"text-gray-500"},"Bill Number:",-1)),t("span",et,o(s.bill_number),1)])]),t("div",st,[t("div",at,[t("span",null,[e[19]||(e[19]=t("i",{class:"fa-solid fa-calendar mr-1"},null,-1)),d(" "+o(s.created_at),1)]),t("span",null,[e[20]||(e[20]=t("i",{class:"fa-solid fa-clock mr-1"},null,-1)),d(" "+o(s.created_at_full),1)])])])]))),128))]))])])),t("div",{class:"flex justify-end gap-3 p-6 border-t border-gray-200 flex-shrink-0"},[t("button",{onClick:u,class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"}," Tutup ")])])])])):x("",!0)}},rt=h(lt,[["__scopeId","data-v-7057f36b"]]);export{rt as default};
