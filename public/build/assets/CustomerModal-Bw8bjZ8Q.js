import{r as c,w as B,L as o,E as y,B as a,D as t,H as u,J as d,G as x,F as N,M as j,O as M,I as E,N as g}from"./vendor-vue-g7iCcTkf.js";import{l as U}from"./lodash-DB3HVzpp.js";import"./vendor-utils-CpgP2uT4.js";const F={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"},O={class:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto"},K={class:"p-6"},_={key:0,class:"mb-6"},q={class:"flex gap-2 mb-4"},A={key:0,class:"text-center py-4"},D={key:1,class:"space-y-2"},J=["onClick"],P={class:"font-semibold text-gray-800"},R={class:"text-sm text-gray-500"},G={key:0},L={key:0,class:"text-sm text-gray-400 mt-1"},X={key:2,class:"text-center py-4 text-gray-500"},z={key:3,class:"text-center py-4 text-gray-500"},H={key:1},I={class:"grid grid-cols-2 gap-4"},Q={class:"grid grid-cols-2 gap-4"},$={class:"grid grid-cols-2 gap-4"},W={class:"flex justify-end gap-2 pt-4"},Y=["disabled"],Z={key:0},ee={key:1},ae={__name:"CustomerModal",props:{show:Boolean},emits:["close","customer-selected","customer-created"],setup(w,{emit:k}){const p=k,r=c(""),i=c([]),m=c(!1),f=c(!1),b=c(!1),l=c({code:"",name:"",phone:"",email:"",address:"",type:"customer",region:""}),C=U.debounce(async()=>{if(!r.value.trim()){i.value=[];return}f.value=!0;try{const e=await(await fetch("/retail-warehouse-sale/search-customers",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({search:r.value})})).json();i.value=e.customers||[]}catch(n){console.error("Error searching customers:",n)}finally{f.value=!1}},300);B(r,()=>{C()});function S(n){p("customer-selected",n)}function v(){m.value=!m.value,m.value&&(r.value="",i.value=[])}async function T(){if(!l.value.code||!l.value.name){alert("Kode dan nama customer harus diisi!");return}b.value=!0;try{const e=await(await fetch("/retail-warehouse-sale/store-customer",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(l.value)})).json();e.success?(p("customer-created",e.customer),h()):alert("Gagal membuat customer: "+e.message)}catch(n){console.error("Error creating customer:",n),alert("Terjadi kesalahan saat membuat customer")}finally{b.value=!1}}function h(){l.value={code:"",name:"",phone:"",email:"",address:"",type:"customer",region:""},m.value=!1}function V(){p("close"),r.value="",i.value=[],m.value=!1,h()}return(n,e)=>w.show?(a(),o("div",F,[t("div",O,[t("div",K,[t("div",{class:"flex justify-between items-center mb-6"},[e[9]||(e[9]=t("h3",{class:"text-2xl font-bold text-gray-900"},"Pilih Customer",-1)),t("button",{onClick:V,class:"text-gray-400 hover:text-gray-600"},e[8]||(e[8]=[t("i",{class:"fa-solid fa-times text-xl"},null,-1)]))]),m.value?(a(),o("div",H,[t("div",{class:"flex justify-between items-center mb-4"},[e[13]||(e[13]=t("h4",{class:"text-lg font-semibold text-gray-800"},"Buat Customer Baru",-1)),t("button",{onClick:v,class:"text-blue-500 hover:text-blue-700"},e[12]||(e[12]=[t("i",{class:"fa-solid fa-arrow-left mr-2"},null,-1),x(" Kembali ")]))]),t("form",{onSubmit:M(T,["prevent"]),class:"space-y-4"},[t("div",I,[t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Kode Customer *",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.code=s),type:"text",required:"",maxlength:"20",class:"w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[d,l.value.code]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nama Customer *",-1)),u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.value.name=s),type:"text",required:"",maxlength:"100",class:"w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[d,l.value.name]])])]),t("div",Q,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Nomor Telepon",-1)),u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.value.phone=s),type:"text",maxlength:"20",class:"w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[d,l.value.phone]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.email=s),type:"email",maxlength:"100",class:"w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[d,l.value.email]])])]),t("div",$,[t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tipe",-1)),u(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>l.value.type=s),class:"w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},e[18]||(e[18]=[t("option",{value:"customer"},"Customer",-1),t("option",{value:"branch"},"Branch",-1)]),512),[[E,l.value.type]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Region",-1)),u(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>l.value.region=s),type:"text",maxlength:"20",class:"w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[d,l.value.region]])])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Alamat",-1)),u(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=s=>l.value.address=s),rows:"3",class:"w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[d,l.value.address]])]),t("div",W,[t("button",{type:"button",onClick:v,class:"px-4 py-2 rounded-lg bg-gray-100 text-gray-700 font-semibold hover:bg-gray-200"}," Batal "),t("button",{type:"submit",disabled:b.value,class:"px-4 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 disabled:opacity-60"},[b.value?(a(),o("span",Z,"Menyimpan...")):(a(),o("span",ee,"Simpan Customer"))],8,Y)])],32)])):(a(),o("div",_,[t("div",q,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),type:"text",placeholder:"Cari customer berdasarkan nama, kode, atau nomor telepon...",class:"flex-1 rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[d,r.value]]),t("button",{onClick:v,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"},e[10]||(e[10]=[t("i",{class:"fa-solid fa-plus mr-2"},null,-1),x(" Baru ")]))]),f.value?(a(),o("div",A,e[11]||(e[11]=[t("i",{class:"fa-solid fa-spinner fa-spin text-blue-500"},null,-1),t("p",{class:"mt-2 text-gray-500"},"Mencari customer...",-1)]))):i.value.length>0?(a(),o("div",D,[(a(!0),o(N,null,j(i.value,s=>(a(),o("div",{key:s.id,onClick:te=>S(s),class:"p-3 border border-gray-200 rounded-lg hover:bg-blue-50 cursor-pointer transition"},[t("div",P,g(s.name),1),t("div",R,[x(" Kode: "+g(s.code)+" ",1),s.phone?(a(),o("span",G," | Telp: "+g(s.phone),1)):y("",!0)]),s.address?(a(),o("div",L,g(s.address),1)):y("",!0)],8,J))),128))])):r.value?(a(),o("div",X," Tidak ada customer ditemukan ")):(a(),o("div",z," Mulai mengetik untuk mencari customer "))]))])])])):y("",!0)}};export{ae as default};
