import{r as g,c as G,A as oe,B as o,C as D,D as t,L as r,x as M,G as c,H as I,F as k,M as h,N as i,I as P,a1 as R,l as W,E as y,_ as Y,O as re,W as ie}from"./vendor-vue-g7iCcTkf.js";import{A as ue}from"./AppLayout-CLYhXf-W.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./app-DdwtQE43.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-CauiUg4O.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const be={class:"max-w-6xl mx-auto py-8 relative"},ce={class:"flex gap-4 mb-6 items-center"},me={class:"flex-1"},fe=["value"],ve={class:"flex-1"},pe=["value"],xe={key:0,class:"bg-gradient-to-br from-blue-100 to-blue-300 rounded-3xl shadow-2xl p-6 animate-fade-in"},ge={key:1,class:"bg-gradient-to-br from-blue-100 to-blue-300 rounded-3xl shadow-2xl p-6 animate-fade-in"},ye={class:"flex items-center justify-between mb-4"},_e={class:"font-bold text-lg text-blue-700 min-w-[180px] text-center drop-shadow-md"},we={class:"grid grid-cols-7 gap-2 mb-2"},ke={key:0,class:"font-bold text-blue-700 mb-1 text-lg"},he={key:1,class:"text-xs text-red-600 font-bold text-center mb-1"},De={key:2,class:"flex flex-col gap-1 w-full"},Ce=["onMouseenter","onClick"],Se={class:"block truncate"},Ae={class:"block text-[11px] font-normal"},Me={key:0,class:"flex items-center gap-1"},je={key:1},Fe={class:"font-bold text-blue-700 mb-1"},Oe={key:0},Te={class:"text-red-600 font-bold mb-1"},Le={key:0},Be={key:1},Je={key:1},$e={key:0},Ke={key:1},Ee={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-30"},Ve={__name:"Calendar",props:{outlets:Array,divisions:Array,users:Array,calendar:Object,filter:Object,holidays:Array,absentCalendar:Object},setup(j){var K,E,V,N;const v=j,C=g(((K=v.filter)==null?void 0:K.outlet_id)||""),S=g(((E=v.filter)==null?void 0:E.division_id)||""),d=g(((V=v.filter)==null?void 0:V.month)||new Date().getMonth()+1),p=g(((N=v.filter)==null?void 0:N.year)||new Date().getFullYear()),q=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],B=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];g([]);const F=g(null),O=g(!1),A=g(!1),Q=G(()=>Array.isArray(v.holidays)?v.holidays:[]);function _(a){const e=u(a);return Q.value.find(s=>s.date===e)}function J(a){F.value=a}function X(){F.value=null}function Z(a){const e=new Date(a);return B[e.getDay()]}function u(a){const e=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0"),b=String(a.getDate()).padStart(2,"0");return`${e}-${s}-${b}`}function T(){O.value=!0,A.value=!0,ie.get("/user-shifts/calendar",{outlet_id:C.value,division_id:S.value,month:d.value,year:p.value},{preserveState:!0,replace:!0,onFinish:()=>{O.value=!1}})}function ee(){d.value===1?(d.value=12,p.value--):d.value--,A.value&&T()}function te(){d.value===12?(d.value=1,p.value++):d.value++,A.value&&T()}const le=G(()=>{const a=new Date(p.value,d.value-1,1),e=new Date(p.value,d.value,0),s=a.getDay(),b=e.getDate(),l=[];let m=1;for(let n=0;n<6;n++){const w=[];for(let f=0;f<7;f++)n===0&&f<s||m>b?w.push(null):(w.push(new Date(p.value,d.value-1,m)),m++);l.push(w)}return l});function se(a){var s;const e=((s=v.calendar)==null?void 0:s[a])||{};return Object.values(e)}function $(a){var e;return((e=v.absentCalendar)==null?void 0:e[a])||[]}function L(a,e){return $(a).some(b=>b.user_id===e)}function x(a,e){return $(a).find(b=>b.user_id===e)}function ae(a,e=!1){return e?"bg-red-500 text-white border-2 border-red-600":a?a.toLowerCase().includes("off")?"bg-gray-400 text-white":a.toLowerCase().includes("malam")?"bg-blue-600 text-white":a.toLowerCase().includes("pagi")?"bg-yellow-400 text-gray-900":a.toLowerCase().includes("siang")?"bg-green-400 text-white":"bg-blue-200 text-blue-900":"bg-gray-300 text-gray-600"}function ne(){const a={outlet_id:C.value,division_id:S.value,month:d.value,year:p.value},e=Object.entries(a).map(([s,b])=>`${s}=${encodeURIComponent(b||"")}`).join("&");window.open(`/user-shifts/calendar/export-excel?${e}`,"_blank")}return(a,e)=>(o(),oe(ue,{title:"Kalender Jadwal Shift Karyawan"},{default:D(()=>[t("div",be,[e[22]||(e[22]=t("h1",{class:"text-2xl font-bold text-blue-800 mb-6 flex items-center gap-2"},[t("i",{class:"fa-solid fa-calendar-days text-blue-500"}),c(" Kalender Jadwal Shift Karyawan ")],-1)),t("div",ce,[t("div",me,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Outlet",-1)),I(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>C.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[4]||(e[4]=t("option",{value:""},"Semua Outlet",-1)),(o(!0),r(k,null,h(j.outlets,s=>(o(),r("option",{key:s.id,value:s.id},i(s.name),9,fe))),128))],512),[[P,C.value]])]),t("div",ve,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Divisi",-1)),I(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>S.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[e[6]||(e[6]=t("option",{value:""},"Semua Divisi",-1)),(o(!0),r(k,null,h(j.divisions,s=>(o(),r("option",{key:s.id,value:s.id},i(s.name),9,pe))),128))],512),[[P,S.value]])]),t("div",{class:"flex items-end"},[t("button",{onClick:T,class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg"},e[8]||(e[8]=[t("i",{class:"fa-solid fa-eye mr-2"},null,-1),c("Tampilkan ")]))])]),A.value?(o(),r("div",ge,[t("div",ye,[t("button",{onClick:ee,class:"bg-blue-100 text-blue-700 px-3 py-2 rounded shadow hover:bg-blue-200 transition"},e[10]||(e[10]=[t("i",{class:"fa-solid fa-chevron-left"},null,-1)])),t("div",_e,i(q[d.value-1])+" "+i(p.value),1),t("button",{onClick:te,class:"bg-blue-100 text-blue-700 px-3 py-2 rounded shadow hover:bg-blue-200 transition"},e[11]||(e[11]=[t("i",{class:"fa-solid fa-chevron-right"},null,-1)])),t("div",{class:"flex gap-2"},[t("button",{onClick:ne,class:"bg-green-600 text-white px-4 py-2 rounded-lg shadow hover:bg-green-700 transition font-bold text-sm"},e[12]||(e[12]=[t("i",{class:"fa-solid fa-file-excel"},null,-1),c(" Export to Excel ")]))])]),t("div",we,[(o(),r(k,null,h(B,s=>t("div",{key:s,class:"text-center font-bold text-blue-800 text-lg uppercase drop-shadow-sm"},i(s),1)),64))]),M(R,{name:"calendar-fade",tag:"div",class:"grid grid-cols-7 gap-4"},{default:D(()=>[(o(!0),r(k,null,h(le.value,(s,b)=>(o(),r("div",{key:b,class:"contents"},[(o(!0),r(k,null,h(s,(l,m)=>(o(),r("div",{key:m,class:W(["relative min-h-[110px] rounded-2xl shadow-2xl flex flex-col items-center justify-start p-2 calendar-cell-3d animate-pop-in",[l?"hover:scale-105 transition-transform duration-300":"bg-transparent shadow-none",l&&_(l)?"bg-red-200 border-red-400":"",l&&!_(l)&&m===0?"bg-red-100":"",l&&!_(l)&&m===6?"bg-blue-100":"",l&&!_(l)&&m!==0&&m!==6?"bg-white":""]])},[l?(o(),r("div",ke,i(l.getDate()),1)):y("",!0),l&&_(l)?(o(),r("div",he,i(_(l).name),1)):y("",!0),l?(o(),r("div",De,[M(R,{name:"shift-badge-fade",tag:"div"},{default:D(()=>[(o(!0),r(k,null,h(se(u(l)),n=>{var w;return o(),r("div",{key:n.user_id,class:W(["rounded-xl px-2 py-1 mb-1 font-semibold text-xs shadow shift-badge-3d animate-bounce-in cursor-pointer relative",ae(n.shift_name,L(u(l),n.user_id))]),onMouseenter:f=>J(u(l)+"-"+n.user_id),onMouseleave:e[3]||(e[3]=f=>X()),onClick:f=>J(u(l)+"-"+n.user_id)},[t("span",Se,i(n.nama_lengkap),1),t("span",Ae,[L(u(l),n.user_id)?(o(),r("span",Me,[e[13]||(e[13]=t("i",{class:"fa-solid fa-user-xmark text-xs"},null,-1)),c(" "+i(((w=x(u(l),n.user_id))==null?void 0:w.leave_type_name)||"ABSENT"),1)])):(o(),r("span",je,i(n.shift_name||"OFF"),1))]),M(Y,{name:"fade"},{default:D(()=>{var f,z,H,U;return[F.value===u(l)+"-"+n.user_id?(o(),r("div",{key:0,class:"absolute z-50 left-1/2 -translate-x-1/2 -top-2 translate-y-[-100%] bg-white text-gray-800 rounded-xl shadow-lg px-4 py-2 text-xs font-normal border border-blue-200 animate-fade-in min-w-[180px]",onClick:e[2]||(e[2]=re(()=>{},["stop"]))},[t("div",Fe,i(n.nama_lengkap),1),t("div",null,[e[14]||(e[14]=c("Hari: ")),t("b",null,i(Z(u(l))),1)]),t("div",null,[e[15]||(e[15]=c("Tanggal: ")),t("b",null,i(u(l)),1)]),L(u(l),n.user_id)?(o(),r("div",Oe,[t("div",Te,[e[16]||(e[16]=t("i",{class:"fa-solid fa-user-xmark mr-1"},null,-1)),c(" "+i(((f=x(u(l),n.user_id))==null?void 0:f.leave_type_name)||"ABSENT"),1)]),(z=x(u(l),n.user_id))!=null&&z.reason?(o(),r("div",Le,[e[17]||(e[17]=c(" Alasan: ")),t("b",null,i(x(u(l),n.user_id).reason),1)])):y("",!0),((H=x(u(l),n.user_id))==null?void 0:H.date_from)!==((U=x(u(l),n.user_id))==null?void 0:U.date_to)?(o(),r("div",Be,[e[18]||(e[18]=c(" Periode: ")),t("b",null,i(x(u(l),n.user_id).date_from)+" - "+i(x(u(l),n.user_id).date_to),1)])):y("",!0)])):(o(),r("div",Je,[n.time_start&&n.time_end?(o(),r("div",$e,[e[19]||(e[19]=c("Jam Kerja: ")),t("b",null,i(n.time_start)+" - "+i(n.time_end),1)])):(o(),r("div",Ke,e[20]||(e[20]=[c("Jam Kerja: "),t("b",null,"OFF",-1)])))]))])):y("",!0)]}),_:2},1024)],42,Ce)}),128))]),_:2},1024)])):y("",!0)],2))),128))]))),128))]),_:1})])):(o(),r("div",xe,e[9]||(e[9]=[t("div",{class:"text-center py-12"},[t("i",{class:"fa-solid fa-calendar-days text-6xl text-blue-500 mb-4"}),t("h3",{class:"text-xl font-bold text-blue-800 mb-2"},"Kalender Jadwal Shift"),t("p",{class:"text-blue-600"},'Pilih filter dan klik "Tampilkan" untuk melihat jadwal shift')],-1)]))),M(Y,{name:"fade"},{default:D(()=>[O.value?(o(),r("div",Ee,e[21]||(e[21]=[t("div",{class:"flex flex-col items-center gap-4"},[t("svg",{class:"animate-spin h-12 w-12 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),t("div",{class:"text-blue-700 font-bold text-lg animate-pulse"},"Memuat jadwal shift...")],-1)]))):y("",!0)]),_:1})])]),_:1}))}},qe=de(Ve,[["__scopeId","data-v-86db7979"]]);export{qe as default};
