import{r as f,P as O,c as S,W as $,A as v,B as n,C as U,D as e,L as l,E as x,G as h,O as J,H as T,J as M,F as w,M as _,N as d,l as L,Q as R,S as W}from"./vendor-vue-g7iCcTkf.js";import{A as Y}from"./AppLayout-Cg9_BqdS.js";import{l as q}from"./lodash-DB3HVzpp.js";import z from"./AnnouncementCreateModal-D5DZY4h1.js";import Q from"./AnnouncementDetailModal-ujYajybV.js";import K from"./AnnouncementEditModal-CFrjq-cT.js";import{a as X}from"./vendor-utils-CpgP2uT4.js";import{S as p}from"./app-CL3toCqm.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DcALjTaB.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const ee={class:"max-w-7xl mx-auto py-8 px-2"},te={class:"flex justify-between items-center mb-6"},se={class:"bg-white rounded-2xl shadow-2xl overflow-x-auto transition-all"},ne={class:"w-full min-w-full divide-y divide-gray-200"},ae={key:0},le={class:"px-6 py-3"},oe={class:"px-6 py-3 font-medium"},re={class:"px-6 py-3"},ie={class:"px-6 py-3"},ue={class:"px-6 py-3"},de={class:"flex flex-wrap gap-1"},ce={class:"px-6 py-3"},fe={class:"flex flex-wrap gap-2"},xe=["href"],pe={class:"px-6 py-3"},me={class:"flex gap-2"},be=["onClick"],ge=["onClick"],ye=["onClick","disabled"],ve={key:0,class:"fa fa-spinner fa-spin mr-1"},he={key:1,class:"fa fa-trash mr-1"},we=["onClick","disabled"],ke={key:0,class:"fa fa-spinner fa-spin mr-1"},Ce={key:1,class:"fa fa-check mr-1"},Ae={key:0,class:"mt-6 flex items-center justify-between"},Be={class:"text-sm text-gray-700 dark:text-gray-300"},De={class:"flex items-center space-x-2"},_e=["innerHTML"],Te={__name:"Index",props:{announcements:[Array,Object],users:Array,jabatans:Array,divisis:Array,levels:Array,outlets:Array},setup(r){const u=r,i=f({search:"",startDate:"",endDate:""}),m=f(!1),k=f(!1),b=f(!1),C=f(null);O({title:"",content:"",image:null,files:[],targets:[]});const A=f(!1),B=f(!1),g=S(()=>u.announcements&&u.announcements.data?u.announcements.data:u.announcements||[]),y=S(()=>u.announcements&&typeof u.announcements=="object"?{from:u.announcements.from||0,to:u.announcements.to||0,total:u.announcements.total||0,links:u.announcements.links||[]}:{from:0,to:0,total:0,links:[]}),D=q.debounce(()=>{$.get(route("announcement.index"),i.value,{preserveState:!0,replace:!0})},400);function j(){D()}function P(){i.value={search:"",startDate:"",endDate:""},j()}async function E(o){var s,c;if((await p.fire({title:"Hapus Announcement?",text:"Apakah Anda yakin ingin menghapus pengumuman ini?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed){B.value=!0;try{await $.delete(route("announcement.destroy",o)),await p.fire({title:"Berhasil!",text:"Pengumuman berhasil dihapus!",icon:"success",confirmButtonColor:"#3085d6"})}catch(a){await p.fire({title:"Gagal!",text:"Gagal menghapus pengumuman: "+(((c=(s=a.response)==null?void 0:s.data)==null?void 0:c.error)||a.message),icon:"error",confirmButtonColor:"#3085d6"})}finally{B.value=!1}}}function F(o){C.value=o,k.value=!0}function H(o){C.value=o,b.value=!0}function N(){D(),b.value=!1}function V(){D(),m.value=!1}function G(o){if(!o)return"-";const t=new Date(o);return isNaN(t)?o:t.toLocaleDateString("id-ID")}async function I(o){var s,c;if((await p.fire({title:"Publish Announcement?",text:"Apakah Anda yakin ingin mempublish pengumuman ini?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Publish!",cancelButtonText:"Batal"})).isConfirmed){A.value=!0;try{await X.post(route("announcement.publish",o)),D(),await p.fire({title:"Berhasil!",text:"Pengumuman berhasil dipublish dan notifikasi dikirim!",icon:"success",confirmButtonColor:"#3085d6"})}catch(a){await p.fire({title:"Gagal!",text:"Gagal publish: "+(((c=(s=a.response)==null?void 0:s.data)==null?void 0:c.error)||a.message),icon:"error",confirmButtonColor:"#3085d6"})}finally{A.value=!1}}}return(o,t)=>(n(),v(Y,null,{default:U(()=>[e("div",ee,[e("div",te,[t[7]||(t[7]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-bullhorn text-blue-500"}),h(" Announcement ")],-1)),e("button",{onClick:t[0]||(t[0]=s=>m.value=!0),class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Buat Announcement ")]),e("form",{onSubmit:J(j,["prevent"]),class:"flex flex-wrap gap-2 mb-4 items-center"},[T(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.value.search=s),type:"text",placeholder:"Cari judul announcement...",class:"border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-200",style:{"min-width":"200px"}},null,512),[[M,i.value.search]]),T(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.startDate=s),type:"date",class:"border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-200"},null,512),[[M,i.value.startDate]]),t[8]||(t[8]=e("span",{class:"text-gray-400"},"-",-1)),T(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>i.value.endDate=s),type:"date",class:"border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-200"},null,512),[[M,i.value.endDate]]),t[9]||(t[9]=e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded font-semibold hover:bg-blue-600 transition"},"Cari",-1)),i.value.search||i.value.startDate||i.value.endDate?(n(),l("button",{key:0,type:"button",onClick:P,class:"ml-2 bg-gray-200 text-gray-700 px-3 py-2 rounded hover:bg-gray-300 transition"},"Reset")):x("",!0)],32),e("div",se,[e("table",ne,[t[16]||(t[16]=e("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tl-2xl"},"No"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Judul"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Tanggal"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Target"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"File"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tr-2xl"},"Aksi")])],-1)),e("tbody",null,[!g.value||!g.value.length?(n(),l("tr",ae,t[10]||(t[10]=[e("td",{colspan:"7",class:"text-center py-10 text-blue-300"},"Tidak ada data Announcement.",-1)]))):x("",!0),(n(!0),l(w,null,_(g.value,(s,c)=>(n(),l("tr",{key:s.id,class:"hover:bg-blue-50 transition shadow-sm"},[e("td",le,d(c+1),1),e("td",oe,d(s.title),1),e("td",re,d(G(s.created_at)),1),e("td",ie,[e("span",{class:L([s.status==="Publish"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500","px-2 py-1 rounded-full text-xs font-bold"])},d(s.status),3)]),e("td",ue,[e("div",de,[(n(!0),l(w,null,_(s.targets,a=>(n(),l("span",{key:a.id,class:"bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs"},d(a.target_type)+": "+d(a.target_name||a.target_id),1))),128))])]),e("td",ce,[e("div",fe,[(n(!0),l(w,null,_(s.files,a=>(n(),l("span",{key:a.id,class:"flex items-center text-xs"},[t[11]||(t[11]=e("i",{class:"fa fa-file mr-1 text-gray-400"},null,-1)),e("a",{href:`/storage/${a.file_path}`,target:"_blank",class:"text-blue-600 hover:underline"},d(a.file_name),9,xe)]))),128))])]),e("td",pe,[e("div",me,[e("button",{onClick:a=>F(s),class:"inline-flex items-center btn btn-xs bg-blue-100 text-blue-800 hover:bg-blue-200 rounded px-2 py-1 font-semibold transition"},t[12]||(t[12]=[e("i",{class:"fa fa-eye mr-1"},null,-1),h(" Detail ")]),8,be),e("button",{onClick:a=>H(s),class:"inline-flex items-center btn btn-xs bg-yellow-100 text-yellow-800 hover:bg-yellow-200 rounded px-2 py-1 font-semibold transition"},t[13]||(t[13]=[e("i",{class:"fa fa-edit mr-1"},null,-1),h(" Edit ")]),8,ge),e("button",{onClick:a=>E(s.id),disabled:B.value,class:"inline-flex items-center btn btn-xs bg-red-100 text-red-800 hover:bg-red-200 rounded px-2 py-1 font-semibold transition disabled:opacity-50"},[B.value?(n(),l("i",ve)):(n(),l("i",he)),t[14]||(t[14]=h(" Delete "))],8,ye),s.status==="DRAFT"?(n(),l("button",{key:0,onClick:a=>I(s.id),disabled:A.value,class:"inline-flex items-center btn btn-xs bg-green-100 text-green-800 hover:bg-green-200 rounded px-2 py-1 font-semibold transition disabled:opacity-50"},[A.value?(n(),l("i",ke)):(n(),l("i",Ce)),t[15]||(t[15]=h(" Publish "))],8,we)):x("",!0)])])]))),128))])])]),g.value&&g.value.length>0&&y.value.links.length>0?(n(),l("div",Ae,[e("div",Be," Menampilkan "+d(y.value.from)+" sampai "+d(y.value.to)+" dari "+d(y.value.total)+" data ",1),e("div",De,[(n(!0),l(w,null,_(y.value.links,s=>(n(),l(w,{key:s.label},[s.url?(n(),v(R(W),{key:0,href:s.url,innerHTML:s.label,class:L(["px-3 py-2 text-sm border rounded-md transition-colors cursor-pointer",s.active?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-700"])},null,8,["href","innerHTML","class"])):(n(),l("span",{key:1,innerHTML:s.label,class:"px-3 py-2 text-sm border rounded-md transition-colors opacity-50 cursor-not-allowed bg-gray-100 text-gray-500 border-gray-300"},null,8,_e))],64))),128))])])):x("",!0),m.value?(n(),v(z,{key:1,show:m.value,users:r.users,jabatans:r.jabatans,divisis:r.divisis,levels:r.levels,outlets:r.outlets,onClose:t[4]||(t[4]=s=>m.value=!1),onSuccess:V},null,8,["show","users","jabatans","divisis","levels","outlets"])):x("",!0),k.value?(n(),v(Q,{key:2,show:k.value,announcement:C.value,onClose:t[5]||(t[5]=s=>k.value=!1)},null,8,["show","announcement"])):x("",!0),b.value?(n(),v(K,{key:3,show:b.value,announcement:C.value,users:r.users,jabatans:r.jabatans,divisis:r.divisis,levels:r.levels,outlets:r.outlets,onClose:t[6]||(t[6]=s=>b.value=!1),onSuccess:N},null,8,["show","announcement","users","jabatans","divisis","levels","outlets"])):x("",!0)])]),_:1}))}},Ue=Z(Te,[["__scopeId","data-v-e97e7088"]]);export{Ue as default};
