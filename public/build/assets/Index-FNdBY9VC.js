import{r as b,c as H,w as I,a as Q,A as Y,B as r,C as T,D as t,G as d,x as P,Q as $,S as V,H as w,J as B,L as n,E as h,I as q,F as m,M as D,N as c,l as y}from"./vendor-vue-g7iCcTkf.js";import{A as z}from"./AppLayout-IVexHyAO.js";import{a as N}from"./vendor-utils-CpgP2uT4.js";import{S as _}from"./app-V2AeMLhf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-BZZ_tA4T.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const J={class:"max-w-5xl mx-auto py-8 px-2"},K={class:"flex items-center justify-between mb-6"},O={class:"flex gap-2"},W={class:"bg-white rounded-xl shadow-xl p-6"},X={class:"mb-6 space-y-4"},Z={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},F={class:"md:col-span-1"},ee={class:"relative"},te={class:"mb-4 flex items-center justify-between"},ae={class:"flex items-center gap-2"},se={key:0,class:"text-sm text-gray-600"},le={class:"overflow-x-auto"},oe={class:"min-w-full divide-y divide-gray-200"},re={key:0,class:"bg-gray-50"},ne={key:1,class:"bg-gray-50"},ie={class:"px-4 py-2"},ue={class:"px-4 py-2"},de={class:"px-4 py-2"},be={class:"px-4 py-2"},ce={class:"px-4 py-2"},fe=["onClick"],ge={class:"mt-4 flex items-center justify-between"},pe={class:"text-sm text-gray-600"},ve={class:"flex items-center gap-2"},xe=["disabled"],me={class:"flex items-center gap-1"},ye=["onClick","disabled"],ke=["disabled"],we={key:0,class:"px-2 text-gray-500"},he=["onClick","disabled"],_e={key:1,class:"px-2 text-gray-500"},Ce=["disabled"],Te=["disabled"],je={__name:"Index",setup(Be){const S=b([]),p=b(""),v=b(""),x=b(""),l=b(1),f=b(10),M=b(0),i=b(1),u=b(!1),C=H(()=>{let s=S.value;if(p.value){const e=p.value.toLowerCase();s=s.filter(a=>a.outlet_name&&a.outlet_name.toLowerCase().includes(e)||a.user_name&&a.user_name.toLowerCase().includes(e))}return v.value&&(s=s.filter(e=>{if(!e.tanggal)return!1;const a=new Date(e.tanggal),o=new Date(v.value);return o.setHours(0,0,0,0),a>=o})),x.value&&(s=s.filter(e=>{if(!e.tanggal)return!1;const a=new Date(e.tanggal),o=new Date(x.value);return o.setHours(23,59,59,999),a<=o})),s});I([l,f],()=>{k()});async function k(){u.value=!0;try{const s=await N.get("/api/stock-cut/logs",{params:{page:l.value,per_page:f.value}});S.value=s.data.data||[],M.value=s.data.total||0,i.value=s.data.last_page||1,l.value=s.data.current_page||1}catch(s){console.error("Error loading logs:",s),_.fire({icon:"error",title:"Error",text:"Gagal memuat data logs"})}finally{u.value=!1}}Q(()=>{k()});function E(){p.value="",v.value="",x.value="",l.value=1,k()}function g(s){s>=1&&s<=i.value&&(l.value=s)}function U(s){f.value=s,l.value=1}function j(){const s=[],e=Math.max(2,l.value-1),a=Math.min(i.value-1,l.value+1);for(let o=e;o<=a;o++)o>1&&o<i.value&&s.push(o);return s}function R(s){return!s||s==="all"||s===""?"Semua Type":s==="food"?"Food":s==="beverages"?"Beverages":s}function A(s){return!s||s==="all"||s===""?"bg-purple-100 text-purple-800":s==="food"?"bg-orange-100 text-orange-800":s==="beverages"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}async function G(s){var a,o;if((await _.fire({title:"Konfirmasi Rollback",text:"Yakin ingin rollback potong stock ini? Tindakan ini tidak dapat dibatalkan.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Rollback",cancelButtonText:"Batal"})).isConfirmed)try{await N.delete(`/stock-cut/${s}`),_.fire({icon:"success",title:"Berhasil",text:"Rollback berhasil dilakukan",timer:2e3,showConfirmButton:!1}),await k()}catch(L){console.error("Error rollback:",L),_.fire({icon:"error",title:"Error",text:((o=(a=L.response)==null?void 0:a.data)==null?void 0:o.error)||"Gagal melakukan rollback"})}}return(s,e)=>(r(),Y(z,null,{default:T(()=>[t("div",J,[t("div",K,[e[11]||(e[11]=t("h1",{class:"text-2xl font-bold flex items-center gap-2"},[t("i",{class:"fa-solid fa-scissors text-blue-500"}),d(" Log Potong Stock ")],-1)),t("div",O,[P($(V),{href:s.route("stock-cut.form"),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"},{default:T(()=>e[9]||(e[9]=[t("i",{class:"fa-solid fa-plus mr-1"},null,-1),d(" Tambah Potong Stock ")])),_:1},8,["href"]),P($(V),{href:s.route("stock-cut.menu-cost"),class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition"},{default:T(()=>e[10]||(e[10]=[t("i",{class:"fa-solid fa-calculator mr-1"},null,-1),d(" Report Cost Menu ")])),_:1},8,["href"])])]),t("div",W,[t("div",X,[t("div",Z,[t("div",F,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cari",-1)),t("div",ee,[w(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>p.value=a),placeholder:"Cari outlet atau user...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[B,p.value]]),e[12]||(e[12]=t("i",{class:"fa-solid fa-search absolute left-3 top-3 text-gray-400"},null,-1))])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Dari",-1)),w(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>v.value=a),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[B,v.value]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Sampai",-1)),w(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=a=>x.value=a),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[B,x.value]])])]),t("div",{class:"flex justify-end"},[t("button",{onClick:E,class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition text-sm"},e[16]||(e[16]=[t("i",{class:"fa-solid fa-rotate-left mr-1"},null,-1),d(" Reset Filter ")]))])]),t("div",te,[t("div",ae,[e[18]||(e[18]=t("label",{class:"text-sm text-gray-700"},"Tampilkan:",-1)),w(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>f.value=a),onChange:e[4]||(e[4]=a=>U(f.value)),class:"border border-gray-300 rounded-lg px-3 py-1 text-sm focus:ring-blue-500 focus:border-blue-500"},e[17]||(e[17]=[t("option",{value:10},"10",-1),t("option",{value:25},"25",-1),t("option",{value:50},"50",-1),t("option",{value:100},"100",-1)]),544),[[q,f.value]]),e[19]||(e[19]=t("span",{class:"text-sm text-gray-600"},"per halaman",-1))]),u.value?(r(),n("div",se,e[20]||(e[20]=[t("i",{class:"fa-solid fa-spinner fa-spin mr-2"},null,-1),d(" Memuat data... ")]))):h("",!0)]),t("div",le,[t("table",oe,[e[24]||(e[24]=t("thead",null,[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"Tanggal"),t("th",{class:"px-4 py-2 text-left"},"Outlet"),t("th",{class:"px-4 py-2 text-left"},"Type"),t("th",{class:"px-4 py-2 text-left"},"User"),t("th",{class:"px-4 py-2 text-left"},"Aksi")])],-1)),t("tbody",null,[u.value?(r(),n("tr",re,e[21]||(e[21]=[t("td",{colspan:"5",class:"px-4 py-8 text-center text-gray-500"},[t("i",{class:"fa-solid fa-spinner fa-spin text-4xl mb-2 block"}),d(" Memuat data... ")],-1)]))):C.value.length===0?(r(),n("tr",ne,e[22]||(e[22]=[t("td",{colspan:"5",class:"px-4 py-8 text-center text-gray-500"},[t("i",{class:"fa-solid fa-inbox text-4xl mb-2 block"}),d(" Tidak ada data yang ditemukan ")],-1)]))):(r(!0),n(m,{key:2},D(C.value,a=>(r(),n("tr",{key:a.id,class:"hover:bg-gray-50"},[t("td",ie,c(a.tanggal),1),t("td",ue,c(a.outlet_name),1),t("td",de,[t("span",{class:y(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",A(a.type_filter)])},c(R(a.type_filter)),3)]),t("td",be,c(a.user_name),1),t("td",ce,[t("button",{onClick:o=>G(a.id),class:"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition"},e[23]||(e[23]=[t("i",{class:"fa-solid fa-undo"},null,-1),d(" Undo ")]),8,fe)])]))),128))])])]),t("div",ge,[t("div",pe," Menampilkan "+c(C.value.length)+" dari "+c(M.value)+" data ",1),t("div",ve,[t("button",{onClick:e[5]||(e[5]=a=>g(l.value-1)),disabled:l.value===1||u.value,class:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition"},e[25]||(e[25]=[t("i",{class:"fa-solid fa-chevron-left"},null,-1),d(" Sebelumnya ")]),8,xe),t("div",me,[i.value<=7?(r(!0),n(m,{key:0},D(i.value,a=>(r(),n("button",{key:a,onClick:o=>g(a),class:y(["px-3 py-1 border rounded-lg transition",l.value===a?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-50"]),disabled:u.value},c(a),11,ye))),128)):(r(),n(m,{key:1},[t("button",{onClick:e[6]||(e[6]=a=>g(1)),class:y(["px-3 py-1 border rounded-lg transition",l.value===1?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-50"]),disabled:u.value}," 1 ",10,ke),l.value>3?(r(),n("span",we,"...")):h("",!0),(r(!0),n(m,null,D(j(),a=>(r(),n(m,{key:a},[a>1&&a<i.value?(r(),n("button",{key:0,onClick:o=>g(a),class:y(["px-3 py-1 border rounded-lg transition",l.value===a?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-50"]),disabled:u.value},c(a),11,he)):h("",!0)],64))),128)),l.value<i.value-2?(r(),n("span",_e,"...")):h("",!0),t("button",{onClick:e[7]||(e[7]=a=>g(i.value)),class:y(["px-3 py-1 border rounded-lg transition",l.value===i.value?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-50"]),disabled:u.value},c(i.value),11,Ce)],64))]),t("button",{onClick:e[8]||(e[8]=a=>g(l.value+1)),disabled:l.value===i.value||u.value,class:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition"},e[26]||(e[26]=[d(" Selanjutnya "),t("i",{class:"fa-solid fa-chevron-right"},null,-1)]),8,Te)])])])])]),_:1}))}};export{je as default};
