import{A as C}from"./AppLayout-BPJiQqtf.js";import{c as f,A as j,B as n,C as F,D as t,G as b,N as o,L as i,E as y,l as I,F as g,M as v,W as K}from"./vendor-vue-g7iCcTkf.js";import{S as _}from"./app-l4d6TH2E.js";import"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DspUIAzb.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const L={class:"max-w-4xl w-full mx-auto py-8 px-2"},q={class:"bg-white rounded-2xl shadow-2xl p-6 mb-8"},E={class:"flex flex-wrap gap-6 mb-4"},W={class:"font-mono font-bold text-blue-700 text-lg"},M={class:"font-semibold"},V={class:"font-semibold"},G={class:"font-semibold"},H={key:0,class:"mt-1 text-xs text-green-700"},J={key:0},U={key:1},Q={key:0},$={class:"text-xs text-gray-500"},z={key:1,class:"text-gray-400 italic"},P={class:"font-semibold"},X={class:"mb-2"},Y={class:"font-semibold"},Z={class:"mt-4"},tt={class:"space-y-8"},et={class:"font-bold text-blue-700 text-lg mb-2 flex items-center gap-2"},st={class:"overflow-x-auto"},rt={class:"w-full min-w-full divide-y divide-gray-200"},ot={class:"px-4 py-2"},at={class:"px-4 py-2"},lt={class:"px-4 py-2"},nt={class:"px-4 py-2"},it={class:"px-4 py-2 font-semibold"},dt={class:"font-bold text-blue-700 text-lg mb-2 flex items-center gap-2"},ut={class:"overflow-x-auto"},pt={class:"w-full min-w-full divide-y divide-gray-200"},ct={class:"px-4 py-2"},xt={class:"px-4 py-2"},ft={class:"px-4 py-2"},bt={class:"px-4 py-2"},mt={class:"px-4 py-2 font-semibold"},yt={class:"bg-blue-100 font-bold"},gt={colspan:"4",class:"text-right"},vt={class:"text-right font-bold text-xl mt-8"},Rt={__name:"Show",props:{order:Object,user:Object,itemsBySupplier:Array,supplierHeaders:Array},setup(p){const s=p;function c(r){return r?"Rp "+Number(r).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}):"Rp 0"}function B(r){return{Monday:"Senin",Tuesday:"Selasa",Wednesday:"Rabu",Thursday:"Kamis",Friday:"Jumat",Saturday:"Sabtu",Sunday:"Minggu"}[r]||r}const h=f(()=>{if(!s.order.items)return{};const r={};return s.order.items.forEach(e=>{var l;const a=((l=e.category)==null?void 0:l.name)||"-";r[a]||(r[a]=[]),r[a].push(e)}),r}),O=f(()=>{const r={};return Object.entries(h.value).forEach(([e,a])=>{r[e]=a.reduce((l,m)=>l+(Number(m.subtotal)||0),0)}),r}),A=f(()=>{var r;return((r=s.order.items)==null?void 0:r.reduce((e,a)=>e+(Number(a.subtotal)||0),0))||0}),D=f(()=>!s.itemsBySupplier||!s.itemsBySupplier.length?0:s.itemsBySupplier.reduce((r,e)=>r+e.items.reduce((a,l)=>a+(Number(l.subtotal)||0),0),0)),w=f(()=>{var r,e;return((r=s.user)==null?void 0:r.id_role)==="5af56935b011a"&&((e=s.user)==null?void 0:e.status)==="A"}),T=(r,e)=>{if(!r||!e)return!1;const a=r.id_jabatan,l=r.status;switch(e){case"Kitchen":return[163,174,180,345,346,347,348,349].includes(a)&&l==="A";case"Bar":return[175,182,323].includes(a)&&l==="A";case"Service":return[176,322,164,321].includes(a)&&l==="A";default:return!1}},R=f(()=>{var r,e,a;if(s.order.fo_mode==="RO Supplier"){const l=((r=s.user)==null?void 0:r.id_jabatan)===163&&((e=s.user)==null?void 0:e.status)==="A";return s.order.status==="submitted"&&(l||w.value)}if(s.order.fo_mode==="RO Khusus"&&s.order.status==="submitted"){const l=(a=s.order.warehouse_outlet)==null?void 0:a.name;return w.value||T(s.user,l)}return!1});async function N(){const{value:r}=await _.fire({title:"Approve Request Order (RO)?",input:"textarea",inputLabel:"Catatan (opsional)",inputValue:"",showCancelButton:!0,confirmButtonText:"Approve",cancelButtonText:"Batal"});r!==void 0&&K.post(route("floor-order.approve",s.order.id),{notes:r},{onError:e=>{if(e.budget)_.fire({icon:"error",title:"Budget Terlampaui",html:e.budget,confirmButtonText:"OK"});else{const a=Object.values(e).join("<br>");_.fire({icon:"error",title:"Gagal Approve",html:a,confirmButtonText:"OK"})}}})}return(r,e)=>(n(),j(C,null,{default:F(()=>{var a,l,m,S,k;return[t("div",L,[t("button",{onClick:e[0]||(e[0]=u=>r.$inertia.visit("/floor-order")),class:"mb-6 text-blue-500 hover:underline flex items-center gap-2"},e[1]||(e[1]=[t("i",{class:"fa fa-arrow-left"},null,-1),b(" Kembali ke Daftar")])),t("div",q,[t("div",E,[t("div",null,[e[2]||(e[2]=t("div",{class:"text-xs text-gray-500"},"No. Request Order (RO)",-1)),t("div",W,o(s.order.order_number),1)]),t("div",null,[e[3]||(e[3]=t("div",{class:"text-xs text-gray-500"},"Tanggal",-1)),t("div",M,o(new Date(s.order.tanggal).toLocaleDateString("id-ID")),1)]),t("div",null,[e[4]||(e[4]=t("div",{class:"text-xs text-gray-500"},"Outlet",-1)),t("div",V,o((a=s.order.outlet)==null?void 0:a.nama_outlet),1)]),t("div",null,[e[5]||(e[5]=t("div",{class:"text-xs text-gray-500"},"Requester",-1)),t("div",G,o((l=s.order.requester)==null?void 0:l.nama_lengkap),1)]),t("div",null,[e[7]||(e[7]=t("div",{class:"text-xs text-gray-500"},"Status",-1)),t("span",{class:I([{"bg-gray-100 text-gray-700":s.order.status==="draft","bg-green-100 text-green-700":s.order.status==="approved"},"px-2 py-1 rounded-full text-xs font-semibold shadow"])},o(s.order.status),3),s.order.status==="approved"?(n(),i("div",H,[e[6]||(e[6]=b(" Disetujui oleh: ")),t("b",null,o(((m=s.order.approver)==null?void 0:m.nama_lengkap)||((S=s.order.approver)==null?void 0:S.name)||s.order.approval_by),1),s.order.approval_at?(n(),i("span",J,"pada "+o(new Date(s.order.approval_at).toLocaleString("id-ID")),1)):y("",!0),s.order.approval_notes?(n(),i("span",U,"- Note: "+o(s.order.approval_notes),1)):y("",!0)])):y("",!0)]),t("div",null,[e[9]||(e[9]=t("div",{class:"text-xs text-gray-500"},"Jadwal FO",-1)),s.order.fo_schedule?(n(),i("div",Q,[b(o(s.order.fo_schedule.fo_mode)+" - "+o(B(s.order.fo_schedule.day)),1),e[8]||(e[8]=t("br",null,null,-1)),t("span",$,o(s.order.fo_schedule.open_time)+" - "+o(s.order.fo_schedule.close_time),1)])):(n(),i("div",z,"-"))]),t("div",null,[e[10]||(e[10]=t("div",{class:"text-xs text-gray-500"},"Warehouse Outlet",-1)),t("div",P,o(((k=s.order.warehouse_outlet)==null?void 0:k.name)||"-"),1)])]),t("div",X,[e[11]||(e[11]=t("div",{class:"text-xs text-gray-500"},"Keterangan",-1)),t("div",Y,o(s.order.description||"-"),1)]),t("div",Z,[R.value?(n(),i("button",{key:0,onClick:N,class:"px-4 py-2 rounded bg-green-600 text-white font-semibold hover:bg-green-700"}," Approve ")):y("",!0)])]),t("div",tt,[p.itemsBySupplier&&p.itemsBySupplier.length?(n(!0),i(g,{key:0},v(p.itemsBySupplier,u=>(n(),i("div",{key:u.header.id,class:"bg-blue-50 rounded-xl shadow p-4 mb-8"},[t("h3",et,[e[12]||(e[12]=t("i",{class:"fa fa-truck"},null,-1)),b(" Supplier ID: "+o(u.header.supplier_id)+" | No. RO Supplier: "+o(u.header.supplier_fo_number),1)]),t("div",st,[t("table",rt,[e[13]||(e[13]=t("thead",{class:"bg-gradient-to-r from-blue-100 to-blue-200"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Item"),t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Qty"),t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Unit"),t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Harga"),t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Subtotal")])],-1)),t("tbody",null,[(n(!0),i(g,null,v(u.items,d=>(n(),i("tr",{key:d.id},[t("td",ot,o(d.item_name),1),t("td",at,o(d.qty),1),t("td",lt,o(d.unit),1),t("td",nt,o(c(d.price)),1),t("td",it,o(c(d.subtotal)),1)]))),128))])])])]))),128)):(n(!0),i(g,{key:1},v(h.value,(u,d)=>(n(),i("div",{key:d,class:"bg-blue-50 rounded-xl shadow p-4"},[t("h3",dt,[e[14]||(e[14]=t("i",{class:"fa fa-layer-group"},null,-1)),b(" "+o(d),1)]),t("div",ut,[t("table",pt,[e[15]||(e[15]=t("thead",{class:"bg-gradient-to-r from-blue-100 to-blue-200"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Item"),t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Qty"),t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Unit"),t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Harga"),t("th",{class:"px-4 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Subtotal")])],-1)),t("tbody",null,[(n(!0),i(g,null,v(u,x=>(n(),i("tr",{key:x.id},[t("td",ct,o(x.item_name),1),t("td",xt,o(x.qty),1),t("td",ft,o(x.unit),1),t("td",bt,o(c(x.price)),1),t("td",mt,o(c(x.subtotal)),1)]))),128)),t("tr",yt,[t("td",gt,"Total "+o(d),1),t("td",null,o(c(O.value[d])),1)])])])])]))),128))]),t("div",vt," Grand Total: "+o(c(p.itemsBySupplier&&p.itemsBySupplier.length?D.value:A.value)),1)])]}),_:1}))}};export{Rt as default};
