import{r as p,a as O,A as L,B as a,C,D as e,L as n,E,H as v,F as g,M as b,N as l,I as M,Q as B,G as W,l as G,O as I,J as R,V as Y}from"./vendor-vue-g7iCcTkf.js";import{A as K}from"./AppLayout-De2jf5tO.js";import{a as S}from"./vendor-utils-CpgP2uT4.js";import"./app-BSTQjgZq.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-vaJ7DgVJ.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const J={class:"py-12"},P={class:"max-w-full mx-auto sm:px-6 lg:px-8"},H={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6 mb-6"},$={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},j=["value"],z=["value"],Q={key:0,class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},q={key:1,class:"space-y-6"},D={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},X={class:"p-6"},Z={class:"overflow-x-auto"},ee={class:"w-full bg-gray-800 text-white"},te=["onClick"],se={class:"px-4 py-3 text-center"},le={class:"px-4 py-3"},re={class:"px-4 py-3 bg-green-600"},oe={class:"px-4 py-3 text-right bg-yellow-600"},ae={class:"px-4 py-3 text-center bg-yellow-600"},ne={class:"px-4 py-3 text-right"},de={class:"px-4 py-3 text-right bg-yellow-600"},ie={class:"px-4 py-3 text-right"},ue={class:"px-4 py-3 text-right"},ce={class:"px-4 py-3 text-right bg-yellow-600"},ge={class:"px-4 py-3 text-right"},pe={class:"px-4 py-3 text-right"},be={key:0,class:"bg-gray-900 border-b border-gray-700"},xe={colspan:"12",class:"px-4 py-4"},ye={class:"bg-gray-800 rounded-lg p-4"},_e={class:"text-lg font-semibold text-blue-400 mb-4"},ve={class:"overflow-x-auto"},me={class:"w-full bg-gray-700 text-white"},he={class:"border-b border-gray-600"},fe={class:"px-4 py-3 text-center bg-yellow-600 font-semibold"},we={class:"px-4 py-3 text-center bg-yellow-600 font-semibold"},ke={class:"border-b border-gray-600"},Ee={class:"px-4 py-3 text-center bg-yellow-600 font-semibold"},Ae={class:"px-4 py-3 text-center bg-yellow-600 font-semibold"},Te={class:"border-b border-gray-700 bg-gray-600 font-bold"},Ce={class:"px-4 py-3 text-right bg-yellow-600"},Me={class:"px-4 py-3 text-center bg-yellow-600"},Re={class:"px-4 py-3 text-right"},Se={class:"px-4 py-3 text-right bg-yellow-600"},Ve={class:"px-4 py-3 text-right"},Ne={class:"px-4 py-3 text-right"},Ue={class:"px-4 py-3 text-right bg-yellow-600"},Fe={class:"px-4 py-3 text-right"},Oe={class:"px-4 py-3 text-right"},Le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Be={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},We={class:"text-2xl font-bold text-red-600 bg-red-100 p-4 rounded-lg text-center"},Ge={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},Ie={class:"text-2xl font-bold text-red-600 bg-red-100 p-4 rounded-lg text-center"},Ye={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ke={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},Je={class:"mt-3"},Pe={class:"mb-4"},He={class:"mb-4"},$e={class:"mb-4"},je={class:"flex items-center"},ze={class:"flex justify-end space-x-3"},at={__name:"ReportDailyRevenueForecast",setup(Qe){const f=p(!1),d=p(null),x=p(new Date().getMonth()+1),y=p(new Date().getFullYear()),m=p(!1),_=p({}),c=p({weekday_target:0,weekend_target:0,auto_calculate:!0}),V=[{value:1,label:"Januari"},{value:2,label:"Februari"},{value:3,label:"Maret"},{value:4,label:"April"},{value:5,label:"Mei"},{value:6,label:"Juni"},{value:7,label:"Juli"},{value:8,label:"Agustus"},{value:9,label:"September"},{value:10,label:"Oktober"},{value:11,label:"November"},{value:12,label:"Desember"}],N=Array.from({length:5},(r,t)=>new Date().getFullYear()-2+t),o=r=>new Intl.NumberFormat("id-ID").format(r||0),U=r=>{_.value[r]=!_.value[r]},w=r=>r.daily_targets?[r.daily_targets[1],r.daily_targets[2],r.daily_targets[3],r.daily_targets[4],r.daily_targets[5]].filter(t=>t&&!t.is_weekend):[],k=r=>r.daily_targets?[r.daily_targets[6],r.daily_targets[0]].filter(t=>t&&t.is_weekend):[],A=r=>{const t=w(r);return t.length?{count:t.reduce((s,i)=>s+i.count,0),target_revenue:t.reduce((s,i)=>s+i.target_revenue*i.count,0)}:{count:0,target_revenue:0}},T=r=>{const t=k(r);return t.length?{count:t.reduce((s,i)=>s+i.count,0),target_revenue:t.reduce((s,i)=>s+i.target_revenue*i.count,0)}:{count:0,target_revenue:0}},h=async()=>{if(!(!x.value||!y.value)){f.value=!0;try{const r=await S.get("/api/report/daily-revenue-forecast",{params:{month:x.value,year:y.value}});d.value=r.data,_.value={},r.data.forecast_settings&&(c.value={weekday_target:r.data.forecast_settings.weekday_target,weekend_target:r.data.forecast_settings.weekend_target,auto_calculate:r.data.forecast_settings.auto_calculate})}catch(r){console.error("Error loading report:",r)}finally{f.value=!1}}},F=async()=>{try{await S.post("/api/report/daily-revenue-forecast/settings",{month:x.value,year:y.value,...c.value}),m.value=!1,await h()}catch(r){console.error("Error saving settings:",r)}};return O(async()=>{await h()}),(r,t)=>(a(),L(K,{title:"Daily Revenue Forecast & Actual MTD"},{header:C(()=>t[7]||(t[7]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Daily Revenue Forecast & Actual MTD ",-1)])),default:C(()=>[e("div",J,[e("div",P,[e("div",H,[e("div",$,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bulan",-1)),v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>x.value=s),onChange:h,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[(a(),n(g,null,b(V,s=>e("option",{key:s.value,value:s.value},l(s.label),9,j)),64))],544),[[M,x.value]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tahun",-1)),v(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),onChange:h,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[(a(!0),n(g,null,b(B(N),s=>(a(),n("option",{key:s,value:s},l(s),9,z))),128))],544),[[M,y.value]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Forecast Settings",-1)),e("button",{onClick:t[2]||(t[2]=s=>m.value=!0),class:"w-full px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"},t[10]||(t[10]=[e("i",{class:"fas fa-cog mr-2"},null,-1),W("Settings ")]))])])]),f.value?(a(),n("div",Q,t[12]||(t[12]=[e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e("span",{class:"ml-2 text-gray-600"},"Loading report...")],-1)]))):d.value?(a(),n("div",q,[e("div",D,[e("div",X,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"MTD REVENUE",-1)),e("div",Z,[e("table",ee,[t[20]||(t[20]=e("thead",null,[e("tr",{class:"bg-gray-700"},[e("th",{class:"px-4 py-3 text-left w-12"}),e("th",{class:"px-4 py-3 text-left w-16"},"NO"),e("th",{class:"px-4 py-3 text-left"},"OUTLET"),e("th",{class:"px-4 py-3 text-right"},"ACTUAL MTD"),e("th",{class:"px-4 py-3 text-center"},"COVER"),e("th",{class:"px-4 py-3 text-right"},"AVERAGE CHECK"),e("th",{class:"px-4 py-3 text-right"},"BUDGET MTD"),e("th",{class:"px-4 py-3 text-right"},"VARIANCE"),e("th",{class:"px-4 py-3 text-right"},"%"),e("th",{class:"px-4 py-3 text-right"},"PERF%"),e("th",{class:"px-4 py-3 text-right"},"AVERAGE REVENUE PER DAY"),e("th",{class:"px-4 py-3 text-right"},"TO BE ACHIEVED PER DAY")])],-1)),e("tbody",null,[(a(!0),n(g,null,b(d.value.outlets_data,(s,i)=>(a(),n(g,{key:s.outlet_name},[e("tr",{class:"border-b border-gray-700 hover:bg-gray-700 cursor-pointer",onClick:u=>U(i)},[e("td",se,[e("i",{class:G([_.value[i]?"fas fa-chevron-down":"fas fa-chevron-right","text-blue-400"])},null,2)]),e("td",le,l(i+1),1),e("td",re,l(s.outlet_name),1),e("td",oe,l(o(s.mtd_data.actual_mtd)),1),e("td",ae,l(o(s.mtd_data.cover_mtd)),1),e("td",ne,l(o(s.mtd_data.average_check)),1),e("td",de,l(o(s.monthly_budget)),1),e("td",ie,l(o(s.performance_metrics.variance)),1),e("td",ue,l(s.performance_metrics.variance_percentage)+"%",1),e("td",ce,l(s.performance_metrics.performance_percentage)+"%",1),e("td",ge,l(o(s.performance_metrics.average_revenue_per_day)),1),e("td",pe,l(o(s.performance_metrics.to_be_achieved_per_day)),1)],8,te),_.value[i]?(a(),n("tr",be,[e("td",xe,[e("div",ye,[e("h4",_e,"TARGET - "+l(s.outlet_name),1),e("div",ve,[e("table",me,[t[17]||(t[17]=e("thead",null,[e("tr",{class:"bg-gray-600"},[e("th",{class:"px-4 py-3 text-center",rowspan:"2"},"WEEKDAYS"),e("th",{class:"px-4 py-3 text-center",colspan:"5"},"WEEKDAYS"),e("th",{class:"px-4 py-3 text-center",rowspan:"2"},"TOTAL"),e("th",{class:"px-4 py-3 text-center",rowspan:"2"},"WEEKENDS"),e("th",{class:"px-4 py-3 text-center",colspan:"2"},"WEEKENDS"),e("th",{class:"px-4 py-3 text-center",rowspan:"2"},"TOTAL")]),e("tr",{class:"bg-gray-600"},[e("th",{class:"px-4 py-3 text-center bg-blue-400"},"SENIN"),e("th",{class:"px-4 py-3 text-center bg-blue-400"},"SELASA"),e("th",{class:"px-4 py-3 text-center bg-blue-400"},"RABU"),e("th",{class:"px-4 py-3 text-center bg-blue-400"},"KAMIS"),e("th",{class:"px-4 py-3 text-center bg-blue-400"},"JUMAT"),e("th",{class:"px-4 py-3 text-center bg-blue-600"},"SABTU"),e("th",{class:"px-4 py-3 text-center bg-blue-600"},"MINGGU")])],-1)),e("tbody",null,[e("tr",he,[t[13]||(t[13]=e("td",{class:"px-4 py-3 text-center bg-orange-600 font-semibold"},"Count",-1)),(a(!0),n(g,null,b(w(s),u=>(a(),n("td",{key:u.day_of_week,class:"px-4 py-3 text-center bg-orange-600"},l(u.count),1))),128)),e("td",fe,l(A(s).count),1),t[14]||(t[14]=e("td",{class:"px-4 py-3 text-center bg-orange-600 font-semibold"},null,-1)),(a(!0),n(g,null,b(k(s),u=>(a(),n("td",{key:u.day_of_week,class:"px-4 py-3 text-center bg-orange-600"},l(u.count),1))),128)),e("td",we,l(T(s).count),1)]),e("tr",ke,[t[15]||(t[15]=e("td",{class:"px-4 py-3 text-center bg-green-600 font-semibold"},"Target Revenue",-1)),(a(!0),n(g,null,b(w(s),u=>(a(),n("td",{key:u.day_of_week,class:"px-4 py-3 text-center bg-green-600"},l(o(u.target_revenue)),1))),128)),e("td",Ee,l(o(A(s).target_revenue)),1),t[16]||(t[16]=e("td",{class:"px-4 py-3 text-center bg-green-600 font-semibold"},null,-1)),(a(!0),n(g,null,b(k(s),u=>(a(),n("td",{key:u.day_of_week,class:"px-4 py-3 text-center bg-green-600"},l(o(u.target_revenue)),1))),128)),e("td",Ae,l(o(T(s).target_revenue)),1)])])])])])])])):E("",!0)],64))),128)),e("tr",Te,[t[18]||(t[18]=e("td",{class:"px-4 py-3",colspan:"2"},"TOTAL FB REVENUE",-1)),t[19]||(t[19]=e("td",{class:"px-4 py-3 bg-green-600"},null,-1)),e("td",Ce,l(o(d.value.total_actual_mtd)),1),e("td",Me,l(o(d.value.total_cover_mtd)),1),e("td",Re,l(o(d.value.total_average_check)),1),e("td",Se,l(o(d.value.total_budget_mtd)),1),e("td",Ve,l(o(d.value.total_variance)),1),e("td",Ne,l(d.value.total_variance_percentage)+"%",1),e("td",Ue,l(d.value.total_performance_percentage)+"%",1),e("td",Fe,l(o(d.value.total_average_revenue_per_day)),1),e("td",Oe,l(o(d.value.total_to_be_achieved_per_day)),1)])])])])])]),e("div",Le,[e("div",Be,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"MTD ACTUAL + TARGET",-1)),e("div",We,l(o(d.value.total_actual_mtd+d.value.total_budget_mtd)),1)]),e("div",Ge,[t[23]||(t[23]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"MTD PERF% ACTUAL VS TARGET",-1)),e("div",Ie,l(d.value.total_performance_percentage)+"% ",1)])])])):E("",!0)])]),m.value?(a(),n("div",Ye,[e("div",Ke,[e("div",Je,[t[28]||(t[28]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Forecast Settings",-1)),e("form",{onSubmit:I(F,["prevent"])},[e("div",Pe,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Weekday Target",-1)),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>c.value.weekday_target=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Target per hari weekday"},null,512),[[R,c.value.weekday_target]])]),e("div",He,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Weekend Target",-1)),v(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>c.value.weekend_target=s),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Target per hari weekend"},null,512),[[R,c.value.weekend_target]])]),e("div",$e,[e("label",je,[v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>c.value.auto_calculate=s),type:"checkbox",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[Y,c.value.auto_calculate]]),t[26]||(t[26]=e("span",{class:"ml-2 text-sm text-gray-700"},"Auto Calculate",-1))])]),e("div",ze,[e("button",{type:"button",onClick:t[6]||(t[6]=s=>m.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition"}," Cancel "),t[27]||(t[27]=e("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"}," Save ",-1))])],32)])])])):E("",!0)]),_:1}))}};export{at as default};
