import{r as m,c as ht,W as R,w as wt,a as _t,A as kt,B as o,C as Ct,D as t,L as l,E as c,G as v,N as d,H as w,J as X,Q as k,I as L,F as C,M as D,l as S,O as G,V as Ne}from"./vendor-vue-g7iCcTkf.js";import{l as Pt}from"./lodash-DB3HVzpp.js";import{S as f}from"./app-CZyV0iGJ.js";import{A as Dt}from"./AppLayout-Dr73aeKz.js";import{a as ee}from"./vendor-utils-CpgP2uT4.js";import{_ as St}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-DbuU0LgT.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const Et={class:"w-full py-8 px-4"},Bt={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},Tt={class:"rounded-xl shadow-lg p-6 border-l-4 border-blue-500 bg-white hover:shadow-xl transition-all"},Rt={class:"flex items-center justify-between"},Mt={class:"text-2xl font-bold text-gray-900"},Ot={class:"rounded-xl shadow-lg p-6 border-l-4 border-gray-500 bg-white hover:shadow-xl transition-all"},It={class:"flex items-center justify-between"},At={class:"text-2xl font-bold text-gray-900"},$t={class:"rounded-xl shadow-lg p-6 border-l-4 border-yellow-500 bg-white hover:shadow-xl transition-all"},Ft={class:"flex items-center justify-between"},Ut={class:"text-2xl font-bold text-gray-900"},jt={class:"rounded-xl shadow-lg p-6 border-l-4 border-green-500 bg-white hover:shadow-xl transition-all"},zt={class:"flex items-center justify-between"},qt={class:"text-2xl font-bold text-gray-900"},Nt={class:"flex flex-col gap-4 mb-6"},Ht={class:"flex flex-col md:flex-row gap-4"},Vt=["value"],Lt=["value"],Gt=["value"],Zt={class:"flex flex-col md:flex-row gap-4 items-end"},Yt={class:"flex items-center gap-2"},Kt={class:"flex items-center gap-2"},Wt={class:"bg-white rounded-xl shadow-lg overflow-hidden"},Jt={class:"overflow-x-auto"},Qt={class:"min-w-full divide-y divide-gray-200"},Xt={class:"bg-white divide-y divide-gray-200"},es={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ts={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ss=["title"],as={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},os={key:1,class:"text-gray-400"},ls={class:"px-6 py-4 text-sm text-gray-900"},ns={class:"flex flex-col gap-1"},is={key:0,class:"text-gray-400"},rs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ds={class:"font-semibold text-green-600"},us={class:"px-6 py-4 text-sm text-gray-900"},cs={class:"flex flex-col gap-1"},ms={key:0,class:"flex flex-col gap-1 mt-1 max-h-32 overflow-y-auto"},fs={class:"text-xs font-medium text-gray-800"},xs={class:"flex items-center gap-1 flex-wrap"},gs={key:0,class:"text-xs text-gray-600 bg-white px-1.5 py-0.5 rounded border border-gray-200"},ps={key:1,class:"text-xs text-gray-600 bg-white px-1.5 py-0.5 rounded border border-gray-200"},ys={key:0,class:"text-xs text-gray-500 italic mt-1 px-1.5"},vs={key:1,class:"text-xs text-gray-400 italic"},bs={class:"px-6 py-4 whitespace-nowrap"},hs={class:"flex flex-col gap-1"},ws={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-gradient-to-r from-red-500 to-red-600 text-white shadow-md"},_s=["title"],ks={key:2,class:"mt-1"},Cs={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-1.5"},Ps={class:"flex items-center gap-1.5"},Ds={class:"text-xs"},Ss={class:"text-yellow-700 leading-tight"},Es={class:"px-6 py-4 whitespace-nowrap"},Bs={class:"flex flex-col gap-2"},Ts=["onClick"],Rs={class:"font-semibold"},Ms={key:1,class:"text-xs text-gray-400 italic"},Os=["onClick"],Is={class:"font-semibold"},As={key:3,class:"text-xs text-orange-500 italic"},$s={class:"px-6 py-4 whitespace-nowrap"},Fs={class:"flex justify-center"},Us=["onClick"],js=["onClick"],zs={key:2,class:"text-xs text-gray-400 italic"},qs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ns={class:"flex items-center"},Hs={class:"flex-shrink-0 h-8 w-8"},Vs=["onClick"],Ls=["src","alt"],Gs={key:1,class:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold border-2 border-gray-200"},Zs={class:"ml-3"},Ys={class:"text-sm font-medium text-gray-900"},Ks={class:"text-xs text-gray-500"},Ws={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Js={class:"text-xs text-gray-400 mt-0.5"},Qs={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Xs={class:"flex space-x-2"},ea=["onClick"],ta=["onClick"],sa={key:0,class:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center"},aa=["onClick"],oa=["onClick"],la=["onClick","disabled","title"],na={key:0,class:"text-center py-12"},ia={class:"mt-4 flex flex-col sm:flex-row justify-between items-center gap-4"},ra={class:"text-sm text-gray-600"},da={class:"flex rounded-lg shadow-sm -space-x-px","aria-label":"Pagination"},ua=["disabled"],ca=["disabled"],ma=["onClick","innerHTML"],fa=["innerHTML"],xa=["disabled"],ga=["disabled"],pa={key:0,class:"fixed inset-0 z-[100000] flex items-center justify-center bg-black/40"},ya={class:"bg-white rounded-xl shadow-lg w-full max-w-6xl p-6 relative"},va={class:"p-4",style:{height:"80vh"}},ba=["src"],ha={class:"relative max-w-4xl max-h-[90vh] p-4"},wa=["src"],_a={class:"mb-4"},ka={class:"text-sm text-gray-500 mt-1"},Ca={key:0,class:"space-y-3"},Pa={class:"flex items-start gap-3"},Da={class:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold flex-shrink-0"},Sa={class:"flex-1"},Ea={class:"font-semibold text-blue-900 mb-1"},Ba={class:"space-y-1 text-xs text-gray-600"},Ta={class:"flex items-center gap-2"},Ra={key:0,class:"flex items-center gap-2"},Ma={key:0,class:"text-gray-400"},Oa={key:1,class:"text-center py-8 text-gray-500"},Ia={class:"mb-4"},Aa={class:"text-sm text-gray-500 mt-1"},$a={key:0,class:"space-y-3"},Fa={class:"flex items-start gap-3"},Ua={class:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-bold flex-shrink-0"},ja={class:"flex-1"},za={class:"font-semibold text-green-900 mb-1"},qa={class:"space-y-1 text-xs text-gray-600"},Na={class:"flex items-center gap-2"},Ha={key:0,class:"flex items-center gap-2"},Va={key:0,class:"text-gray-400"},La={key:1,class:"text-center py-8 text-gray-500"},Ga={class:"space-y-4"},Za={class:"flex items-center"},Ya={class:"flex justify-end gap-2"},Ka=["disabled"],Wa={key:0,class:"fas fa-spinner fa-spin mr-2"},Ja=["src","alt"],Qa={class:"absolute bottom-4 left-4 right-4 text-center"},Xa={class:"text-white bg-black/50 px-3 py-1 rounded-lg text-sm"},eo={class:"mb-4"},to={class:"text-sm text-gray-500 mt-1"},so={class:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200"},ao={class:"mt-3"},oo={class:"flex items-center gap-2"},lo={key:0,class:"text-sm text-gray-600 flex items-center gap-2"},no={key:1,class:"text-sm text-gray-400"},io={class:"mt-3 flex items-center justify-between"},ro={class:"flex items-center"},uo=["disabled"],co={key:0,class:"fas fa-spinner fa-spin mr-2"},mo={key:1,class:"fas fa-paper-plane mr-2"},fo={key:0,class:"text-center py-8"},xo={key:1,class:"space-y-4"},go={class:"flex items-center justify-between mb-2"},po={class:"flex items-center space-x-2"},yo={class:"font-medium text-gray-900"},vo={key:0,class:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full"},bo={class:"flex items-center gap-2"},ho={class:"text-sm text-gray-500"},wo={key:0,class:"flex items-center gap-1"},_o=["onClick"],ko=["onClick"],Co={class:"text-gray-700 whitespace-pre-wrap"},Po={key:0,class:"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200"},Do={class:"flex items-center gap-3"},So={key:0,class:"flex-shrink-0"},Eo=["src","alt","onClick"],Bo={key:1,class:"flex-shrink-0"},To={class:"flex-1 min-w-0"},Ro={class:"text-sm font-medium text-gray-900 truncate"},Mo={class:"text-xs text-gray-500"},Oo={class:"flex items-center gap-2"},Io=["href","download"],Ao=["onClick"],$o={key:2,class:"text-center py-8 text-gray-500"},Fo={__name:"Index",props:{data:Object,filters:Object,filterOptions:Object,statistics:{type:Object,default:()=>({total:0,draft:0,submitted:0,approved:0})},auth:Object,canDelete:{type:Boolean,default:!1}},setup(x){var Ae,$e,Fe,Ue,je,ze,qe;const p=x,F=m(((Ae=p.filters)==null?void 0:Ae.search)||""),U=m((($e=p.filters)==null?void 0:$e.status)||"all"),j=m(((Fe=p.filters)==null?void 0:Fe.division)||"all"),z=m(((Ue=p.filters)==null?void 0:Ue.category)||"all"),te=m(((je=p.filters)==null?void 0:je.outlet)||"all"),q=m(((ze=p.filters)==null?void 0:ze.is_held)||"all"),He=()=>{var e;if((e=p.filters)!=null&&e.date_from)return p.filters.date_from;const a=new Date;return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-01`},Ve=()=>{var i;if((i=p.filters)!=null&&i.date_to)return p.filters.date_to;const a=new Date,e=new Date(a.getFullYear(),a.getMonth()+1,0);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},I=m(He()),A=m(Ve()),N=m(((qe=p.filters)==null?void 0:qe.per_page)||15),ne=m(!1),ke=m([]),ie=m(""),re=m(null),de=m(!1),ue=m(""),ce=m(!1),me=m(!1),b=m(null),fe=m(!1),E=m(null),P=m([]),M=m(""),H=m(!1),xe=m(!1),Z=m(!1),V=m(null),ge=m(null),pe=m(!1),_=m({}),Y=m(!1),ye=m(!1),$=m(null);function Le(a){return a.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)}function Ge(a){ue.value=a,de.value=!0}function Ce(){de.value=!1,ue.value=""}function Ze(a){b.value=a,ce.value=!0}function Pe(){ce.value=!1,b.value=null}function Ye(a){b.value=a,me.value=!0}function De(){me.value=!1,b.value=null}async function Ke(a){E.value=a,fe.value=!0,M.value="",H.value=!1,xe.value=!0,P.value=[];try{const e=await ee.get(`/purchase-requisitions/${a.id}/comments`);e.data.success&&(P.value=e.data.data,a.unread_comments_count>0&&(a.unread_comments_count=0))}catch(e){console.error("Error loading comments:",e),f.fire({title:"Error",text:"Failed to load comments",icon:"error",didOpen:()=>{const i=()=>{const n=document.querySelector(".swal2-container");n&&n.style.setProperty("z-index","999999","important")};i(),setTimeout(i,10)}})}finally{xe.value=!1}}function Se(){fe.value=!1,E.value=null,P.value=[],M.value="",H.value=!1,ve()}function We(a){const e=a.target.files[0];if(e){if(e.size>10*1024*1024){f.fire({title:"Error",text:"File size must be less than 10MB",icon:"error",didOpen:()=>{const i=()=>{const n=document.querySelector(".swal2-container");n&&n.style.setProperty("z-index","999999","important")};i(),setTimeout(i,10)}}),a.target.value="";return}V.value=e}}function ve(){V.value=null,ge.value&&(ge.value.value="")}async function Je(){var a,e;if(!(!M.value.trim()||!E.value)){Z.value=!0;try{const i=new FormData;i.append("comment",M.value),i.append("is_internal",H.value?"1":"0"),V.value&&i.append("attachment",V.value);const n=await ee.post(`/purchase-requisitions/${E.value.id}/comments`,i,{headers:{"Content-Type":"multipart/form-data"}});if(n.status===200||n.status===201){const r=await ee.get(`/purchase-requisitions/${E.value.id}/comments`);r.data.success&&(P.value=r.data.data),M.value="",H.value=!1,ve(),f.fire({title:"Success!",text:"Comment added successfully",icon:"success",timer:1500,showConfirmButton:!1,didOpen:()=>{const u=()=>{const s=document.querySelector(".swal2-container");s&&s.style.setProperty("z-index","999999","important")};u(),setTimeout(u,10)}})}}catch(i){console.error("Error adding comment:",i),f.fire({title:"Error",text:((e=(a=i.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to add comment",icon:"error",didOpen:()=>{const n=()=>{const r=document.querySelector(".swal2-container");r&&r.style.setProperty("z-index","999999","important")};n(),setTimeout(n,10)}})}finally{Z.value=!1}}}function Qe(a){_.value={id:a.id,comment:a.comment,is_internal:a.is_internal||!1},pe.value=!0}function se(){pe.value=!1,_.value={}}async function Xe(){var a,e,i;if(!(!((a=_.value.comment)!=null&&a.trim())||!E.value)){Y.value=!0;try{const n=await ee.put(`/purchase-requisitions/${E.value.id}/comments/${_.value.id}`,{comment:_.value.comment,is_internal:_.value.is_internal});if(n.data.success){const r=P.value.findIndex(u=>u.id===_.value.id);r!==-1&&(P.value[r]=n.data.data),se(),f.fire({title:"Success!",text:"Comment updated successfully",icon:"success",timer:1500,showConfirmButton:!1,didOpen:()=>{const u=()=>{const s=document.querySelector(".swal2-container");s&&s.style.setProperty("z-index","999999","important")};u(),setTimeout(u,10)}})}}catch(n){console.error("Error updating comment:",n),f.fire({title:"Error",text:((i=(e=n.response)==null?void 0:e.data)==null?void 0:i.message)||"Failed to update comment",icon:"error",didOpen:()=>{const r=()=>{const u=document.querySelector(".swal2-container");u&&u.style.setProperty("z-index","999999","important")};r(),setTimeout(r,10)}})}finally{Y.value=!1}}}function et(a){f.fire({title:"Delete Comment?",text:"Are you sure you want to delete this comment? This action cannot be undone.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#6B7280",confirmButtonText:"Yes, Delete!",cancelButtonText:"Cancel",reverseButtons:!0,allowOutsideClick:!1,didOpen:()=>{const e=()=>{const i=document.querySelector(".swal2-container");i&&(i.style.setProperty("z-index","999999","important"),i.style.setProperty("position","fixed","important"));const n=document.querySelector(".swal2-popup");n&&n.style.setProperty("z-index","999999","important");const r=document.querySelector(".swal2-backdrop-show");r&&r.style.setProperty("z-index","999998","important")};e(),setTimeout(e,10),setTimeout(e,50),setTimeout(e,100)}}).then(e=>{e.isConfirmed&&tt(a)})}async function tt(a){var e,i;try{(await ee.delete(`/purchase-requisitions/${E.value.id}/comments/${a.id}`)).data.success&&(P.value=P.value.filter(r=>r.id!==a.id),f.fire({title:"Deleted!",text:"Comment has been deleted",icon:"success",timer:1500,showConfirmButton:!1,didOpen:()=>{const r=()=>{const u=document.querySelector(".swal2-container");u&&(u.style.setProperty("z-index","999999","important"),u.style.setProperty("position","fixed","important"));const s=document.querySelector(".swal2-popup");s&&s.style.setProperty("z-index","999999","important");const g=document.querySelector(".swal2-backdrop-show");g&&g.style.setProperty("z-index","999998","important")};r(),setTimeout(r,10),setTimeout(r,50)}}))}catch(n){console.error("Error deleting comment:",n),f.fire({title:"Error",text:((i=(e=n.response)==null?void 0:e.data)==null?void 0:i.message)||"Failed to delete comment",icon:"error",didOpen:()=>{const r=()=>{const u=document.querySelector(".swal2-container");u&&(u.style.setProperty("z-index","999999","important"),u.style.setProperty("position","fixed","important"));const s=document.querySelector(".swal2-popup");s&&s.style.setProperty("z-index","999999","important");const g=document.querySelector(".swal2-backdrop-show");g&&g.style.setProperty("z-index","999998","important")};r(),setTimeout(r,10),setTimeout(r,50)}})}}function be(a){return a.attachment_path?`/storage/${a.attachment_path}`:""}function Ee(a){return a?a.startsWith("image/"):!1}function st(a){if(!a)return"fa-file text-gray-500";const e=a.split(".").pop().toLowerCase();return{pdf:"fa-file-pdf text-red-500",doc:"fa-file-word text-blue-500",docx:"fa-file-word text-blue-500",xls:"fa-file-excel text-green-500",xlsx:"fa-file-excel text-green-500",ppt:"fa-file-powerpoint text-orange-500",pptx:"fa-file-powerpoint text-orange-500",jpg:"fa-file-image text-purple-500",jpeg:"fa-file-image text-purple-500",png:"fa-file-image text-purple-500",gif:"fa-file-image text-purple-500",txt:"fa-file-alt text-gray-500",zip:"fa-file-archive text-yellow-500",rar:"fa-file-archive text-yellow-500"}[e]||"fa-file text-gray-500"}function at(a){if(!a)return"0 Bytes";const e=1024,i=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,n)).toFixed(2))+" "+i[n]}function Be(a){$.value=a,ye.value=!0}function Te(){ye.value=!1,$.value=null}const ot=ht(()=>$.value?be($.value):"");function Re(a){var e,i;if(a.approval_flows&&a.approval_flows.length>0){const n=a.approval_flows.find(r=>r.status==="PENDING");if(n)return((e=n.approver)==null?void 0:e.nama_lengkap)||"Unknown"}if(a.purchase_orders&&a.purchase_orders.length>0){for(const n of a.purchase_orders)if(n.approval_flows&&n.approval_flows.length>0){const r=n.approval_flows.find(u=>u.status==="PENDING");if(r)return`PO: ${((i=r.approver)==null?void 0:i.nama_lengkap)||"Unknown"}`}}return null}const h=Pt.debounce(()=>{R.get("/purchase-requisitions",{search:F.value,status:U.value,division:j.value,category:z.value,outlet:te.value,is_held:q.value,date_from:I.value,date_to:A.value,per_page:N.value},{preserveState:!0,replace:!0})},400);function he(){R.get("/purchase-requisitions",{search:F.value,status:U.value,division:j.value,category:z.value,outlet:te.value,is_held:q.value,date_from:I.value,date_to:A.value,per_page:N.value},{preserveState:!0,replace:!0})}function lt(){I.value="",A.value="",he()}function nt(){h()}function K(a){if(a){const e=new URL(a);e.searchParams.set("search",F.value),e.searchParams.set("status",U.value),e.searchParams.set("division",j.value),e.searchParams.set("category",z.value),e.searchParams.set("is_held",q.value),e.searchParams.set("date_from",I.value),e.searchParams.set("date_to",A.value),e.searchParams.set("per_page",N.value),R.visit(e.toString(),{preserveState:!0,replace:!0})}}function Me(){R.visit("/purchase-requisitions/create")}function it(a){R.visit(`/purchase-requisitions/${a.id}`)}function rt(a){R.visit(`/purchase-requisitions/${a.id}/edit`)}function we(a){var B,O,T,W,J,Q;const i=["DRAFT","SUBMITTED"].includes(a.status),n=a.status==="APPROVED",r=((O=(B=p.auth)==null?void 0:B.user)==null?void 0:O.id_role)==="5af56935b011a"||((W=(T=p.auth)==null?void 0:T.user)==null?void 0:W.division_id)==11,u=String(a.created_by),s=String((Q=(J=p.auth)==null?void 0:J.user)==null?void 0:Q.id),g=u===s;return n?r:r?i:i&&g}function dt(a){var i,n,r,u;const e=((n=(i=p.auth)==null?void 0:i.user)==null?void 0:n.id_role)==="5af56935b011a"||((u=(r=p.auth)==null?void 0:r.user)==null?void 0:u.division_id)==11;return a.status==="APPROVED"?e?"Hapus PR yang sudah di-approve":"Hanya bisa dihapus oleh user dengan role khusus atau division warehouse":e?"Hapus PR (Anda memiliki akses untuk menghapus semua PR)":"Hanya bisa dihapus jika status DRAFT atau SUBMITTED dan Anda adalah pembuat PR"}function ut(a){let e=a.status==="DRAFT"?"Draft":a.status==="SUBMITTED"?"Submitted (belum di-approve)":"Approved";a.status==="APPROVED"&&(e+=" (Hanya bisa dihapus oleh user dengan role khusus)"),f.fire({title:"Hapus Payment?",html:`
      <div class="text-left">
        <p class="mb-2"><strong>PR Number:</strong> ${a.pr_number}</p>
        <p class="mb-2"><strong>Title:</strong> ${a.title}</p>
        <p class="mb-2"><strong>Amount:</strong> ${Oe(a.amount)}</p>
        <p class="mb-2"><strong>Status:</strong> ${e}</p>
        <p class="text-red-600 font-semibold">Tindakan ini tidak dapat dibatalkan!</p>
      </div>
    `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#EF4444",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal",reverseButtons:!0}).then(i=>{i.isConfirmed&&R.delete(route("purchase-requisitions.destroy",a.id),{onStart:()=>{f.fire({title:"Menghapus...",text:"Sedang menghapus Payment",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{f.showLoading()}})},onSuccess:()=>{f.fire({title:"Berhasil!",text:"Payment berhasil dihapus",icon:"success",confirmButtonColor:"#10B981"})},onError:n=>{f.close(),console.error("Error deleting PR:",n);let r="Gagal menghapus Payment";n.message?r=n.message:n.error?r=n.error:typeof n=="string"&&(r=n),f.fire({title:"Error!",text:r,icon:"error",confirmButtonColor:"#EF4444"})},onFinish:()=>{}})})}function ct(a){return{DRAFT:"bg-gray-100 text-gray-800",SUBMITTED:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800",PROCESSED:"bg-blue-100 text-blue-800",COMPLETED:"bg-purple-100 text-purple-800",PAID:"bg-emerald-100 text-emerald-800"}[a]||"bg-gray-100 text-gray-800"}function mt(a){return{MARKETING:"bg-pink-100 text-pink-800",MAINTENANCE:"bg-orange-100 text-orange-800",ASSET:"bg-blue-100 text-blue-800",PROJECT_ENHANCEMENT:"bg-purple-100 text-purple-800"}[a]||"bg-gray-100 text-gray-800"}function ft(a){return a?{pr_ops:"Purchase Requisition",purchase_payment:"Payment Application",travel_application:"Travel Application",kasbon:"Kasbon"}[a]||a:"-"}function xt(a){return a&&{pr_ops:"bg-blue-100 text-blue-800",purchase_payment:"bg-green-100 text-green-800",travel_application:"bg-purple-100 text-purple-800",kasbon:"bg-orange-100 text-orange-800"}[a]||"bg-gray-100 text-gray-800"}function Oe(a){return a?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a):"-"}function ae(a){if(!a)return[];const e=[],i=new Map;return(a.mode==="pr_ops"||a.mode==="purchase_payment")&&a.items&&a.items.length>0&&a.items.forEach(n=>{n.category&&n.category.id&&(i.has(n.category.id)||(i.set(n.category.id,n.category),e.push(n.category)))}),e.length===0&&a.category&&a.category.id&&(i.has(a.category.id)||e.push(a.category)),e}function Ie(a){var e,i,n;if(!a)return[];if(a.mode==="pr_ops"||a.mode==="purchase_payment"){if(a.items&&a.items.length>0){const r=new Set;if(a.items.forEach(u=>{u.outlet&&u.outlet.nama_outlet&&r.add(u.outlet.nama_outlet)}),r.size>0)return Array.from(r).sort()}return(e=a.outlet)!=null&&e.nama_outlet?[a.outlet.nama_outlet]:[]}if(a.mode==="travel_application"){if(a.travel_outlets&&Array.isArray(a.travel_outlets)&&a.travel_outlets.length>0)return a.travel_outlets.sort();if(a.items&&a.items.length>0){const r=new Set;if(a.items.forEach(u=>{u.outlet&&u.outlet.nama_outlet&&r.add(u.outlet.nama_outlet)}),r.size>0)return Array.from(r).sort()}return(i=a.outlet)!=null&&i.nama_outlet?[a.outlet.nama_outlet]:[]}return(n=a.outlet)!=null&&n.nama_outlet?[a.outlet.nama_outlet]:[]}function oe(a){return a?new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"}function le(a){return a?new Date(a).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}function gt(a){f.fire({title:"Hold Purchase Requisition?",html:`
      <div class="text-left">
        <p class="mb-2"><strong>PR Number:</strong> ${a.pr_number}</p>
        <p class="mb-2"><strong>Title:</strong> ${a.title}</p>
        <p class="mb-4 text-gray-600">PR yang di-hold tidak dapat dibuat PO atau Payment sampai di-release.</p>
        <div class="mb-2">
          <label class="block text-sm font-medium text-gray-700 mb-1">Alasan Hold <span class="text-red-500">*</span>:</label>
          <textarea id="hold_reason" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" rows="3" placeholder="Masukkan alasan hold..." required></textarea>
        </div>
      </div>
    `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#F97316",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, Hold!",cancelButtonText:"Batal",reverseButtons:!0,preConfirm:()=>{const e=document.getElementById("hold_reason").value.trim();return!e||e===""?(f.showValidationMessage("Alasan hold harus diisi"),!1):{hold_reason:e}}}).then(e=>{var i;if(e.isConfirmed){const n=((i=e.value)==null?void 0:i.hold_reason)||"";R.post(route("purchase-requisitions.hold",a.id),{hold_reason:n},{onStart:()=>{f.fire({title:"Memproses...",text:"Sedang meng-hold PR",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{f.showLoading()}})},onSuccess:()=>{f.fire({title:"Berhasil!",text:"PR berhasil di-hold",icon:"success",confirmButtonColor:"#10B981"})},onError:r=>{f.close(),console.error("Error holding PR:",r);let u="Gagal meng-hold PR";r.message?u=r.message:r.error?u=r.error:typeof r=="string"&&(u=r),f.fire({title:"Error!",text:u,icon:"error",confirmButtonColor:"#EF4444"})}})}})}function pt(a){f.fire({title:"Release Purchase Requisition?",html:`
      <div class="text-left">
        <p class="mb-2"><strong>PR Number:</strong> ${a.pr_number}</p>
        <p class="mb-2"><strong>Title:</strong> ${a.title}</p>
        <p class="mb-2 text-gray-600">PR akan di-release dan dapat dibuat PO atau Payment kembali.</p>
        ${a.hold_reason?`<p class="mt-2 text-sm text-gray-500"><strong>Alasan Hold:</strong> ${a.hold_reason}</p>`:""}
      </div>
    `,icon:"question",showCancelButton:!0,confirmButtonColor:"#10B981",cancelButtonColor:"#6B7280",confirmButtonText:"Ya, Release!",cancelButtonText:"Batal",reverseButtons:!0}).then(e=>{e.isConfirmed&&R.post(route("purchase-requisitions.release",a.id),{},{onStart:()=>{f.fire({title:"Memproses...",text:"Sedang me-release PR",allowOutsideClick:!1,showConfirmButton:!1,didOpen:()=>{f.showLoading()}})},onSuccess:()=>{f.fire({title:"Berhasil!",text:"PR berhasil di-release",icon:"success",confirmButtonColor:"#10B981"})},onError:i=>{f.close(),console.error("Error releasing PR:",i);let n="Gagal me-release PR";i.message?n=i.message:i.error?n=i.error:typeof i=="string"&&(n=i),f.fire({title:"Error!",text:n,icon:"error",confirmButtonColor:"#EF4444"})}})})}async function yt(a){try{ke.value=[a];const e=a.id.toString();ie.value=`/purchase-requisitions/print-preview?ids=${encodeURIComponent(e)}`,ne.value=!0}catch(e){console.error("Error preparing print:",e),f.fire("Error","Gagal mempersiapkan print","error")}}function vt(){ne.value=!1,ie.value="",ke.value=[]}function bt(){re.value&&re.value.contentWindow.print()}return wt([F,U,j,z,q,N],()=>{h()}),_t(()=>{var e,i;!((e=p.filters)!=null&&e.date_from)&&!((i=p.filters)!=null&&i.date_to)&&he();const a=document.createElement("style");a.textContent=`
    /* SweetAlert harus selalu di atas semua modal */
    .swal2-container {
      z-index: 999999 !important;
      position: fixed !important;
    }
    .swal2-popup {
      z-index: 999999 !important;
      position: relative !important;
    }
    .swal2-backdrop-show {
      z-index: 999998 !important;
      position: fixed !important;
    }
  `,document.head.appendChild(a)}),(a,e)=>(o(),kt(Dt,{title:"Payment"},{default:Ct(()=>{var i,n,r,u;return[t("div",Et,[t("div",{class:"flex justify-between items-center mb-6"},[e[30]||(e[30]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-shopping-cart text-blue-500"}),v(" Payment ")],-1)),t("div",{class:"flex gap-3"},[t("button",{onClick:Me,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Buat Payment Baru ")])]),t("div",Bt,[t("div",Tt,[t("div",Rt,[t("div",null,[e[31]||(e[31]=t("p",{class:"text-sm font-medium text-gray-600"},"Total PR",-1)),t("p",Mt,d(x.statistics.total),1)]),e[32]||(e[32]=t("i",{class:"fa-solid fa-shopping-cart text-4xl text-blue-300"},null,-1))])]),t("div",Ot,[t("div",It,[t("div",null,[e[33]||(e[33]=t("p",{class:"text-sm font-medium text-gray-600"},"Draft",-1)),t("p",At,d(x.statistics.draft),1)]),e[34]||(e[34]=t("i",{class:"fa-solid fa-edit text-4xl text-gray-300"},null,-1))])]),t("div",$t,[t("div",Ft,[t("div",null,[e[35]||(e[35]=t("p",{class:"text-sm font-medium text-gray-600"},"Submitted",-1)),t("p",Ut,d(x.statistics.submitted),1)]),e[36]||(e[36]=t("i",{class:"fa-solid fa-paper-plane text-4xl text-yellow-300"},null,-1))])]),t("div",jt,[t("div",zt,[t("div",null,[e[37]||(e[37]=t("p",{class:"text-sm font-medium text-gray-600"},"Approved",-1)),t("p",qt,d(x.statistics.approved),1)]),e[38]||(e[38]=t("i",{class:"fa-solid fa-check-circle text-4xl text-green-300"},null,-1))])])]),t("div",Nt,[t("div",Ht,[w(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>F.value=s),onInput:nt,placeholder:"Cari semua kolom (PR number, title, creator, division, outlet, dll)...",class:"flex-1 px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,544),[[X,F.value]]),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>U.value=s),onChange:e[2]||(e[2]=(...s)=>k(h)&&k(h)(...s)),class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},e[39]||(e[39]=[t("option",{value:"all"},"Semua Status",-1),t("option",{value:"DRAFT"},"Draft",-1),t("option",{value:"SUBMITTED"},"Submitted",-1),t("option",{value:"APPROVED"},"Approved",-1),t("option",{value:"REJECTED"},"Rejected",-1),t("option",{value:"PROCESSED"},"Processed",-1),t("option",{value:"COMPLETED"},"Completed",-1),t("option",{value:"PAID"},"Paid",-1)]),544),[[L,U.value]]),w(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>j.value=s),onChange:e[4]||(e[4]=(...s)=>k(h)&&k(h)(...s)),class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},[e[40]||(e[40]=t("option",{value:"all"},"Semua Divisi",-1)),(o(!0),l(C,null,D(x.filterOptions.divisions,s=>(o(),l("option",{key:s.id,value:s.id},d(s.nama_divisi),9,Vt))),128))],544),[[L,j.value]]),w(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>z.value=s),onChange:e[6]||(e[6]=(...s)=>k(h)&&k(h)(...s)),class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},[e[41]||(e[41]=t("option",{value:"all"},"Semua Category",-1)),(o(!0),l(C,null,D(x.filterOptions.categories,s=>(o(),l("option",{key:s.id,value:s.id}," ["+d(s.division)+"] "+d(s.name),9,Lt))),128))],544),[[L,z.value]]),w(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>te.value=s),onChange:e[8]||(e[8]=(...s)=>k(h)&&k(h)(...s)),class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},[e[42]||(e[42]=t("option",{value:"all"},"Semua Outlet",-1)),(o(!0),l(C,null,D(x.filterOptions.outlets,s=>(o(),l("option",{key:s.id_outlet,value:s.id_outlet},d(s.nama_outlet),9,Gt))),128))],544),[[L,te.value]]),w(t("select",{"onUpdate:modelValue":e[9]||(e[9]=s=>q.value=s),onChange:e[10]||(e[10]=(...s)=>k(h)&&k(h)(...s)),class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},e[43]||(e[43]=[t("option",{value:"all"},"Semua Status Hold",-1),t("option",{value:"held"},"Hold",-1),t("option",{value:"not_held"},"Tidak Hold",-1)]),544),[[L,q.value]]),w(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>N.value=s),onChange:e[12]||(e[12]=(...s)=>k(h)&&k(h)(...s)),class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},e[44]||(e[44]=[t("option",{value:"15"},"15 Per Halaman",-1),t("option",{value:"30"},"30 Per Halaman",-1),t("option",{value:"50"},"50 Per Halaman",-1)]),544),[[L,N.value]])]),t("div",Zt,[t("div",Yt,[e[45]||(e[45]=t("label",{class:"text-sm font-medium text-gray-700 whitespace-nowrap"},"Dari Tanggal:",-1)),w(t("input",{type:"date","onUpdate:modelValue":e[13]||(e[13]=s=>I.value=s),class:"px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[X,I.value]])]),t("div",Kt,[e[46]||(e[46]=t("label",{class:"text-sm font-medium text-gray-700 whitespace-nowrap"},"Sampai Tanggal:",-1)),w(t("input",{type:"date","onUpdate:modelValue":e[14]||(e[14]=s=>A.value=s),class:"px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[X,A.value]])]),t("button",{onClick:he,class:"px-6 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 transition text-sm font-medium shadow-md hover:shadow-lg flex items-center gap-2"},e[47]||(e[47]=[t("i",{class:"fas fa-search mr-1"},null,-1),v(" Load Data ")])),I.value||A.value?(o(),l("button",{key:0,onClick:lt,class:"px-4 py-2 rounded-xl border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 transition text-sm font-medium"},e[48]||(e[48]=[t("i",{class:"fas fa-times mr-1"},null,-1),v(" Hapus Filter Tanggal ")]))):c("",!0)])]),t("div",Wt,[t("div",Jt,[t("table",Qt,[e[61]||(e[61]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"PR Number"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Division"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Mode"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"PO/Payment"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Hold/Release"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Creator"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Created"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",Xt,[(o(!0),l(C,null,D(x.data.data,s=>{var g,B,O,T,W,J,Q;return o(),l("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",es,d(s.pr_number),1),t("td",ts,[t("div",{class:"max-w-xs truncate",title:s.title},d(s.title),9,ss)]),t("td",as,[s.division?(o(),l("span",{key:0,class:S(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",mt(s.division.nama_divisi)])},d(s.division.nama_divisi),3)):(o(),l("span",os,"-"))]),t("td",ls,[t("div",ns,[(o(!0),l(C,null,D(Ie(s),(y,_e)=>(o(),l("span",{key:_e,class:"inline-block"},d(y),1))),128)),Ie(s).length===0?(o(),l("span",is,"-")):c("",!0)])]),t("td",rs,[t("span",ds,d(Oe(s.amount)),1)]),t("td",us,[t("div",cs,[t("span",{class:S(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",xt(s.mode)])},d(ft(s.mode)),3),ae(s).length>0?(o(),l("div",ms,[(o(!0),l(C,null,D(ae(s).slice(0,3),(y,_e)=>(o(),l("div",{key:_e,class:"flex flex-col gap-0.5 p-1.5 bg-blue-50 rounded border border-blue-100"},[t("span",fs,d(y.name),1),t("div",xs,[y.division?(o(),l("span",gs,d(y.division),1)):c("",!0),y.subcategory?(o(),l("span",ps,d(y.subcategory),1)):c("",!0)])]))),128)),ae(s).length>3?(o(),l("div",ys," +"+d(ae(s).length-3)+" category lainnya ",1)):c("",!0)])):(o(),l("span",vs,"No category"))])]),t("td",bs,[t("div",hs,[t("span",{class:S(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",ct(s.status)])},d(s.status),3),s.is_held?(o(),l("span",ws,e[49]||(e[49]=[t("i",{class:"fas fa-lock mr-1"},null,-1),v(" ON HOLD ")]))):c("",!0),s.is_held&&s.hold_reason?(o(),l("div",{key:1,class:"text-xs text-red-600 mt-1 italic",title:s.hold_reason},d(s.hold_reason.length>30?s.hold_reason.substring(0,30)+"...":s.hold_reason),9,_s)):c("",!0),Re(s)?(o(),l("div",ks,[t("div",Cs,[t("div",Ps,[e[51]||(e[51]=t("i",{class:"fas fa-clock text-yellow-600 text-xs"},null,-1)),t("div",Ds,[e[50]||(e[50]=t("p",{class:"font-medium text-yellow-800 leading-tight"},"Menunggu Approval",-1)),t("p",Ss,d(Re(s)),1)])])])])):c("",!0)])]),t("td",Es,[t("div",Bs,[s.has_po?(o(),l("button",{key:0,onClick:y=>Ze(s),class:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-bold bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-md hover:shadow-lg hover:from-blue-600 hover:to-blue-700 transition-all cursor-pointer",title:"Klik untuk melihat detail PO"},[e[52]||(e[52]=t("i",{class:"fas fa-file-invoice mr-2 text-lg"},null,-1)),t("span",Rs,"PO: "+d(s.po_count)+" "+d(s.po_count>1?"POs":"PO"),1)],8,Ts)):(o(),l("div",Ms,"Belum ada PO")),s.has_payment?(o(),l("button",{key:2,onClick:y=>Ye(s),class:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-bold bg-gradient-to-r from-green-500 to-green-600 text-white shadow-md hover:shadow-lg hover:from-green-600 hover:to-green-700 transition-all cursor-pointer",title:"Klik untuk melihat detail Payment"},[e[53]||(e[53]=t("i",{class:"fas fa-check-circle mr-2 text-lg"},null,-1)),t("span",Is,"Paid: "+d(s.payment_count)+" "+d(s.payment_count>1?"payments":"payment"),1)],8,Os)):s.has_po?(o(),l("div",As,"Belum dibayar")):c("",!0)])]),t("td",$s,[t("div",Fs,[!s.is_held&&s.status!=="PAID"&&!s.has_payment&&(s.status==="APPROVED"||s.status==="PROCESSED"||s.status==="SUBMITTED")?(o(),l("button",{key:0,onClick:y=>gt(s),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold bg-gradient-to-r from-orange-500 to-orange-600 text-white shadow-md hover:shadow-lg hover:from-orange-600 hover:to-orange-700 transition-all",title:"Hold PR"},e[54]||(e[54]=[t("i",{class:"fas fa-lock text-base"},null,-1),t("span",null,"Hold",-1)]),8,Us)):c("",!0),s.is_held&&s.status!=="PAID"&&!s.has_payment?(o(),l("button",{key:1,onClick:y=>pt(s),class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold bg-gradient-to-r from-green-500 to-green-600 text-white shadow-md hover:shadow-lg hover:from-green-600 hover:to-green-700 transition-all",title:"Release PR"},e[55]||(e[55]=[t("i",{class:"fas fa-unlock text-base"},null,-1),t("span",null,"Release",-1)]),8,js)):c("",!0),s.status==="PAID"||s.has_payment||s.is_held===!1&&!(s.status==="APPROVED"||s.status==="PROCESSED"||s.status==="SUBMITTED")?(o(),l("span",zs," - ")):c("",!0)])]),t("td",qs,[t("div",Ns,[t("div",Hs,[(g=s.creator)!=null&&g.avatar?(o(),l("div",{key:0,class:"w-8 h-8 rounded-full overflow-hidden cursor-pointer hover:scale-110 transition-transform border-2 border-gray-200",onClick:y=>Ge(`/storage/${s.creator.avatar}`)},[t("img",{src:`/storage/${s.creator.avatar}`,alt:((B=s.creator)==null?void 0:B.nama_lengkap)||"User",class:"w-full h-full object-cover"},null,8,Ls)],8,Vs)):(o(),l("div",Gs,d(Le(((O=s.creator)==null?void 0:O.nama_lengkap)||"U")),1))]),t("div",Zs,[t("div",Ys,d(((T=s.creator)==null?void 0:T.nama_lengkap)||"Unknown"),1),t("div",Ks,d(((W=s.creator)==null?void 0:W.email)||""),1)])])]),t("td",Ws,[t("div",null,d(oe(s.created_at)),1),t("div",Js,d(le(s.created_at)),1)]),t("td",Qs,[t("div",Xs,[t("button",{onClick:y=>it(s),class:"text-blue-600 hover:text-blue-900",title:"View Details"},e[56]||(e[56]=[t("i",{class:"fas fa-eye"},null,-1)]),8,ea),t("button",{onClick:y=>Ke(s),class:"relative text-indigo-600 hover:text-indigo-900",title:"Comments"},[e[57]||(e[57]=t("i",{class:"fas fa-comment"},null,-1)),s.unread_comments_count>0?(o(),l("span",sa,d(s.unread_comments_count>99?"99+":s.unread_comments_count),1)):c("",!0)],8,ta),s.status==="DRAFT"||s.status==="SUBMITTED"?(o(),l("button",{key:0,onClick:y=>rt(s),class:"text-green-600 hover:text-green-900",title:"Edit"},e[58]||(e[58]=[t("i",{class:"fas fa-edit"},null,-1)]),8,aa)):c("",!0),t("button",{onClick:y=>yt(s),class:"text-purple-600 hover:text-purple-900",title:"Print PDF"},e[59]||(e[59]=[t("i",{class:"fas fa-print"},null,-1)]),8,oa),s.status==="DRAFT"||s.status==="SUBMITTED"||s.status==="APPROVED"&&((Q=(J=p.auth)==null?void 0:J.user)==null?void 0:Q.id_role)==="5af56935b011a"?(o(),l("button",{key:1,onClick:y=>ut(s),disabled:!we(s),class:S(["text-red-600 hover:text-red-900",we(s)?"":"opacity-50 cursor-not-allowed"]),title:we(s)?"Delete":dt(s)},e[60]||(e[60]=[t("i",{class:"fas fa-trash"},null,-1)]),10,la)):c("",!0)])])])}),128))])])]),x.data.data.length===0?(o(),l("div",na,[e[63]||(e[63]=t("div",{class:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"},[t("i",{class:"fa-solid fa-shopping-cart text-3xl text-gray-400"})],-1)),e[64]||(e[64]=t("h3",{class:"text-lg font-medium text-gray-600 mb-2"},"No Payments Found",-1)),e[65]||(e[65]=t("p",{class:"text-gray-500 mb-6"},"Start by creating your first payment",-1)),t("button",{onClick:Me,class:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors"},e[62]||(e[62]=[t("i",{class:"fa-solid fa-plus mr-2"},null,-1),v(" Create New Payment ")]))])):c("",!0)]),t("div",ia,[t("div",ra," Menampilkan "+d(x.data.from||0)+" sampai "+d(x.data.to||0)+" dari "+d(x.data.total||0)+" payments ",1),t("nav",da,[t("button",{onClick:e[15]||(e[15]=s=>K(x.data.first_page_url)),disabled:!x.data.first_page_url,class:S(["px-3 py-2 text-sm border border-gray-300 rounded-l-lg transition-colors",x.data.first_page_url?"bg-white text-gray-700 hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"])}," First ",10,ua),t("button",{onClick:e[16]||(e[16]=s=>K(x.data.prev_page_url)),disabled:!x.data.prev_page_url,class:S(["px-3 py-2 text-sm border border-gray-300 transition-colors",x.data.prev_page_url?"bg-white text-gray-700 hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"])}," Previous ",10,ca),(o(!0),l(C,null,D(x.data.links,(s,g)=>(o(),l(C,{key:g},[s.url?(o(),l("button",{key:0,onClick:B=>K(s.url),class:S(["px-3 py-2 text-sm border border-gray-300 transition-colors",s.active?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 hover:bg-gray-50 border-gray-300"]),innerHTML:s.label},null,10,ma)):(o(),l("span",{key:1,class:"px-3 py-2 text-sm border border-gray-200 text-gray-400 bg-gray-50",innerHTML:s.label},null,8,fa))],64))),128)),t("button",{onClick:e[17]||(e[17]=s=>K(x.data.next_page_url)),disabled:!x.data.next_page_url,class:S(["px-3 py-2 text-sm border border-gray-300 transition-colors",x.data.next_page_url?"bg-white text-gray-700 hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"])}," Next ",10,xa),t("button",{onClick:e[18]||(e[18]=s=>K(x.data.last_page_url)),disabled:!x.data.last_page_url,class:S(["px-3 py-2 text-sm border border-gray-300 rounded-r-lg transition-colors",x.data.last_page_url?"bg-white text-gray-700 hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"])}," Last ",10,ga)])])]),ne.value?(o(),l("div",pa,[t("div",ya,[t("button",{onClick:vt,class:"absolute top-3 right-3 text-gray-400 hover:text-gray-600"},e[66]||(e[66]=[t("i",{class:"fas fa-times text-lg"},null,-1)])),t("div",{class:"flex justify-between items-center mb-4"},[e[68]||(e[68]=t("h3",{class:"text-lg font-medium"},"Preview Payment",-1)),t("div",{class:"flex gap-2"},[t("button",{onClick:bt,class:"px-3 py-1 text-sm bg-blue-100 text-blue-600 rounded hover:bg-blue-200 flex items-center gap-1"},e[67]||(e[67]=[t("i",{class:"fas fa-print"},null,-1),v(" Print ")]))])]),t("div",va,[t("iframe",{src:ie.value,class:"w-full h-full border-0",ref_key:"previewFrame",ref:re},null,8,ba)])])])):c("",!0),de.value?(o(),l("div",{key:1,class:"fixed inset-0 z-[100001] flex items-center justify-center bg-black/80",onClick:Ce},[t("div",ha,[t("button",{onClick:Ce,class:"absolute top-2 right-2 text-white hover:text-gray-300 z-10 bg-black/50 rounded-full p-2"},e[69]||(e[69]=[t("i",{class:"fas fa-times text-xl"},null,-1)])),t("img",{src:ue.value,alt:"Avatar",class:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl",onClick:e[19]||(e[19]=G(()=>{},["stop"]))},null,8,wa)])])):c("",!0),ce.value?(o(),l("div",{key:2,class:"fixed inset-0 z-[100002] flex items-center justify-center bg-black/40",onClick:Pe},[t("div",{class:"bg-white rounded-xl shadow-lg w-full max-w-2xl p-6 relative max-h-[90vh] overflow-y-auto",onClick:e[20]||(e[20]=G(()=>{},["stop"]))},[t("button",{onClick:Pe,class:"absolute top-3 right-3 text-gray-400 hover:text-gray-600"},e[70]||(e[70]=[t("i",{class:"fas fa-times text-lg"},null,-1)])),t("div",_a,[e[71]||(e[71]=t("h3",{class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},[t("i",{class:"fas fa-file-invoice text-blue-500"}),v(" Detail Purchase Order ")],-1)),t("p",ka,"PR Number: "+d((i=b.value)==null?void 0:i.pr_number),1)]),b.value&&b.value.po_details&&b.value.po_details.length>0?(o(),l("div",Ca,[(o(!0),l(C,null,D(b.value.po_details,(s,g)=>(o(),l("div",{key:g,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 hover:bg-blue-100 transition-colors"},[t("div",Pa,[t("div",Da,d(g+1),1),t("div",Sa,[t("div",Ea,d(s.number),1),e[74]||(e[74]=t("div",{class:"text-xs text-blue-600 mb-2"},"Purchase Order",-1)),t("div",Ba,[t("div",Ta,[e[72]||(e[72]=t("i",{class:"fas fa-calendar text-gray-400"},null,-1)),t("span",null,d(oe(s.created_at))+" "+d(le(s.created_at)),1)]),s.creator_name?(o(),l("div",Ra,[e[73]||(e[73]=t("i",{class:"fas fa-user text-gray-400"},null,-1)),t("span",null,d(s.creator_name),1),s.creator_email?(o(),l("span",Ma,"("+d(s.creator_email)+")",1)):c("",!0)])):c("",!0)])])])]))),128))])):(o(),l("div",Oa,e[75]||(e[75]=[t("i",{class:"fas fa-file-invoice text-4xl mb-4 text-gray-300"},null,-1),t("p",null,"Tidak ada Purchase Order",-1)])))])])):c("",!0),me.value?(o(),l("div",{key:3,class:"fixed inset-0 z-[100002] flex items-center justify-center bg-black/40",onClick:De},[t("div",{class:"bg-white rounded-xl shadow-lg w-full max-w-2xl p-6 relative max-h-[90vh] overflow-y-auto",onClick:e[21]||(e[21]=G(()=>{},["stop"]))},[t("button",{onClick:De,class:"absolute top-3 right-3 text-gray-400 hover:text-gray-600"},e[76]||(e[76]=[t("i",{class:"fas fa-times text-lg"},null,-1)])),t("div",Ia,[e[77]||(e[77]=t("h3",{class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},[t("i",{class:"fas fa-check-circle text-green-500"}),v(" Detail Payment ")],-1)),t("p",Aa,"PR Number: "+d((n=b.value)==null?void 0:n.pr_number),1)]),b.value&&b.value.payment_details&&b.value.payment_details.length>0?(o(),l("div",$a,[(o(!0),l(C,null,D(b.value.payment_details,(s,g)=>(o(),l("div",{key:g,class:"bg-green-50 border border-green-200 rounded-lg p-4 hover:bg-green-100 transition-colors"},[t("div",Fa,[t("div",Ua,d(g+1),1),t("div",ja,[t("div",za,d(s.payment_number),1),e[80]||(e[80]=t("div",{class:"text-xs text-green-600 mb-2"},"Non-Food Payment",-1)),t("div",qa,[t("div",Na,[e[78]||(e[78]=t("i",{class:"fas fa-calendar text-gray-400"},null,-1)),t("span",null,d(oe(s.created_at))+" "+d(le(s.created_at)),1)]),s.creator_name?(o(),l("div",Ha,[e[79]||(e[79]=t("i",{class:"fas fa-user text-gray-400"},null,-1)),t("span",null,d(s.creator_name),1),s.creator_email?(o(),l("span",Va,"("+d(s.creator_email)+")",1)):c("",!0)])):c("",!0)])])])]))),128))])):(o(),l("div",La,e[81]||(e[81]=[t("i",{class:"fas fa-check-circle text-4xl mb-4 text-gray-300"},null,-1),t("p",null,"Tidak ada Payment",-1)])))])])):c("",!0),pe.value?(o(),l("div",{key:4,class:"fixed inset-0 z-[100004] flex items-center justify-center bg-black/40",onClick:se},[t("div",{class:"bg-white rounded-xl shadow-lg w-full max-w-2xl p-6 relative",onClick:e[24]||(e[24]=G(()=>{},["stop"]))},[t("button",{onClick:se,class:"absolute top-3 right-3 text-gray-400 hover:text-gray-600"},e[82]||(e[82]=[t("i",{class:"fas fa-times text-lg"},null,-1)])),e[85]||(e[85]=t("div",{class:"mb-4"},[t("h3",{class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},[t("i",{class:"fas fa-edit text-blue-500"}),v(" Edit Comment ")])],-1)),t("div",Ga,[t("div",null,[e[83]||(e[83]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Comment",-1)),w(t("textarea",{"onUpdate:modelValue":e[22]||(e[22]=s=>_.value.comment=s),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your comment..."},null,512),[[X,_.value.comment]])]),t("div",null,[t("label",Za,[w(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>_.value.is_internal=s),type:"checkbox",class:"mr-2"},null,512),[[Ne,_.value.is_internal]]),e[84]||(e[84]=t("span",{class:"text-sm text-gray-600"},"Internal comment",-1))])]),t("div",Ya,[t("button",{onClick:se,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300"}," Cancel "),t("button",{onClick:Xe,disabled:!_.value.comment.trim()||Y.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},[Y.value?(o(),l("i",Wa)):c("",!0),v(" "+d(Y.value?"Updating...":"Update Comment"),1)],8,Ka)])])])])):c("",!0),ye.value?(o(),l("div",{key:5,class:"fixed inset-0 z-[100005] flex items-center justify-center bg-black/80",onClick:Te},[t("div",{class:"relative max-w-4xl max-h-[90vh] p-4",onClick:e[25]||(e[25]=G(()=>{},["stop"]))},[t("button",{onClick:Te,class:"absolute top-2 right-2 text-white hover:text-gray-300 z-10 bg-black/50 rounded-full p-2"},e[86]||(e[86]=[t("i",{class:"fas fa-times text-xl"},null,-1)])),$.value?(o(),l("img",{key:0,src:ot.value,alt:$.value.attachment_name,class:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl"},null,8,Ja)):c("",!0),t("div",Qa,[t("p",Xa,d((r=$.value)==null?void 0:r.attachment_name),1)])])])):c("",!0),fe.value?(o(),l("div",{key:6,class:"fixed inset-0 z-[100003] flex items-center justify-center bg-black/40",onClick:Se,style:{"z-index":"100003"}},[t("div",{class:"bg-white rounded-xl shadow-lg w-full max-w-3xl p-6 relative max-h-[90vh] overflow-y-auto",onClick:e[29]||(e[29]=G(()=>{},["stop"]))},[t("button",{onClick:Se,class:"absolute top-3 right-3 text-gray-400 hover:text-gray-600"},e[87]||(e[87]=[t("i",{class:"fas fa-times text-lg"},null,-1)])),t("div",eo,[e[88]||(e[88]=t("h3",{class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},[t("i",{class:"fas fa-comment text-indigo-500"}),v(" Comments ")],-1)),t("p",to,"PR Number: "+d((u=E.value)==null?void 0:u.pr_number),1)]),t("div",so,[w(t("textarea",{"onUpdate:modelValue":e[26]||(e[26]=s=>M.value=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Add a comment..."},null,512),[[X,M.value]]),t("div",ao,[e[92]||(e[92]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Attachment (Optional) ",-1)),t("div",oo,[t("input",{type:"file",ref_key:"attachmentInput",ref:ge,onChange:We,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",class:"hidden"},null,544),t("button",{onClick:e[27]||(e[27]=s=>a.$refs.attachmentInput.click()),type:"button",class:"px-3 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 text-sm"},e[89]||(e[89]=[t("i",{class:"fas fa-paperclip mr-2"},null,-1),v(" Choose File ")])),V.value?(o(),l("span",lo,[e[91]||(e[91]=t("i",{class:"fas fa-file"},null,-1)),v(" "+d(V.value.name)+" ",1),t("button",{onClick:ve,class:"text-red-500 hover:text-red-700"},e[90]||(e[90]=[t("i",{class:"fas fa-times"},null,-1)]))])):(o(),l("span",no,"No file selected"))]),e[93]||(e[93]=t("p",{class:"text-xs text-gray-500 mt-1"},"Max size: 10MB (Images, PDF, Word, Excel)",-1))]),t("div",io,[t("label",ro,[w(t("input",{"onUpdate:modelValue":e[28]||(e[28]=s=>H.value=s),type:"checkbox",class:"mr-2"},null,512),[[Ne,H.value]]),e[94]||(e[94]=t("span",{class:"text-sm text-gray-600"},"Internal comment",-1))]),t("button",{onClick:Je,disabled:!M.value.trim()||Z.value,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed"},[Z.value?(o(),l("i",co)):(o(),l("i",mo)),v(" "+d(Z.value?"Uploading...":"Add Comment"),1)],8,uo)])]),xe.value?(o(),l("div",fo,e[95]||(e[95]=[t("i",{class:"fas fa-spinner fa-spin text-4xl text-indigo-500 mb-4"},null,-1),t("p",{class:"text-gray-500"},"Loading comments...",-1)]))):P.value.length>0?(o(),l("div",xo,[(o(!0),l(C,null,D(P.value,s=>{var g,B,O;return o(),l("div",{key:s.id,class:"p-4 border border-gray-200 rounded-lg bg-white hover:bg-gray-50 transition-colors"},[t("div",go,[t("div",po,[t("span",yo,d(((g=s.user)==null?void 0:g.nama_lengkap)||"Unknown User"),1),s.is_internal?(o(),l("span",vo," Internal ")):c("",!0)]),t("div",bo,[t("span",ho,d(oe(s.created_at))+" "+d(le(s.created_at)),1),s.user_id===((O=(B=p.auth)==null?void 0:B.user)==null?void 0:O.id)?(o(),l("div",wo,[t("button",{onClick:T=>Qe(s),class:"text-blue-600 hover:text-blue-800 text-sm",title:"Edit comment"},e[96]||(e[96]=[t("i",{class:"fas fa-edit"},null,-1)]),8,_o),t("button",{onClick:T=>et(s),class:"text-red-600 hover:text-red-800 text-sm",title:"Delete comment"},e[97]||(e[97]=[t("i",{class:"fas fa-trash"},null,-1)]),8,ko)])):c("",!0)])]),t("p",Co,d(s.comment),1),s.attachment_path?(o(),l("div",Po,[t("div",Do,[Ee(s.attachment_mime_type)?(o(),l("div",So,[t("img",{src:be(s),alt:s.attachment_name,class:"w-24 h-24 object-cover rounded-lg border border-gray-300 cursor-pointer hover:opacity-80 transition-opacity",onClick:T=>Be(s)},null,8,Eo)])):(o(),l("div",Bo,[t("i",{class:S([st(s.attachment_name),"text-3xl"])},null,2)])),t("div",To,[t("p",Ro,d(s.attachment_name),1),t("p",Mo,d(at(s.attachment_size)),1)]),t("div",Oo,[t("a",{href:be(s),download:s.attachment_name,class:"px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm"},e[98]||(e[98]=[t("i",{class:"fas fa-download mr-1"},null,-1),v(" Download ")]),8,Io),Ee(s.attachment_mime_type)?(o(),l("button",{key:0,onClick:T=>Be(s),class:"px-3 py-1.5 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm"},e[99]||(e[99]=[t("i",{class:"fas fa-eye mr-1"},null,-1),v(" View ")]),8,Ao)):c("",!0)])])])):c("",!0)])}),128))])):(o(),l("div",$o,e[100]||(e[100]=[t("i",{class:"fas fa-comment text-4xl mb-4 text-gray-300"},null,-1),t("p",null,"No comments yet",-1)])))])])):c("",!0)]}),_:1}))}},Ko=St(Fo,[["__scopeId","data-v-71858b8a"]]);export{Ko as default};
