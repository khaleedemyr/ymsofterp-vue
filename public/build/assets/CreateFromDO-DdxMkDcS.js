import{r as m,w as Q,n as B,b as j,c as H,A as L,B as d,C as _,D as t,L as i,E as b,x as V,G as y,Q as A,S as E,N as o,F as O,M as C,l as F,H as q,Z as G,J as K,I as M,W as R}from"./vendor-vue-g7iCcTkf.js";import{A as U}from"./AppLayout-Cg9_BqdS.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./app-CL3toCqm.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-DcALjTaB.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const J={class:"max-w-7xl mx-auto py-8 px-2"},P={class:"flex justify-between items-center mb-6"},W={class:"bg-white rounded-2xl shadow-2xl p-6 mb-6"},Z={class:"grid grid-cols-2 gap-4"},$={class:"font-semibold"},X={class:"font-semibold"},Y={class:"font-semibold"},ee={class:"font-semibold"},te={class:"bg-white rounded-2xl shadow-2xl p-6 mb-6"},se={class:"overflow-x-auto"},le={class:"w-full min-w-full divide-y divide-gray-200"},ae={class:"px-6 py-3"},oe={class:"px-6 py-3"},re={class:"px-6 py-3"},de={class:"px-6 py-3"},ie={class:"px-6 py-3"},ne={class:"bg-white rounded-2xl shadow-2xl p-6 mb-6"},ue={class:"mb-4"},ce={class:"flex gap-2"},me={key:0,class:"text-red-600 font-semibold mb-2"},pe={class:"flex justify-end"},ve=["disabled"],fe={key:0,class:"animate-spin mr-2"},xe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"},be={class:"bg-white rounded-xl shadow-lg p-6 relative w-full max-w-md"},ye={key:0,class:"mb-2"},ge=["value"],we={__name:"CreateFromDO",props:{deliveryOrder:{type:Object,default:()=>({items:[]})}},setup(u){const c=u,n=m(""),r=m(""),f=m(!1),p=m(!1);let a=null;const g=m([]),v=m("");Q(p,async l=>{if(l)if(await B(),window.Html5Qrcode)w();else{const e=document.createElement("script");e.src="https://unpkg.com/html5-qrcode",e.onload=w,document.body.appendChild(e)}});async function w(){var l;if(window.Html5Qrcode)try{const e=await window.Html5Qrcode.getCameras();g.value=e;const s=e.find(x=>x.label.toLowerCase().includes("back")||x.label.toLowerCase().includes("belakang"));v.value=(s==null?void 0:s.id)||((l=e[0])==null?void 0:l.id)||"",h()}catch{r.value="Tidak dapat mengakses kamera"}}function h(){!window.Html5Qrcode||!v.value||(a&&a.stop().then(()=>a.clear()),a=new window.Html5Qrcode("qr-reader"),a.start(v.value,{fps:10,qrbox:250},l=>{n.value=l,p.value=!1,a.stop().then(()=>a.clear()),k()},l=>{}))}function D(){h()}function S(){p.value=!1,a&&a.stop().then(()=>a.clear()).catch(()=>{})}j(()=>{a&&a.stop().then(()=>a.clear()).catch(()=>{})});function I(l){return l?new Date(l).toLocaleDateString("id-ID"):"-"}function k(){var e;if(r.value="",!((e=c.deliveryOrder)!=null&&e.items)){r.value="Data DO tidak valid.";return}const l=c.deliveryOrder.items.find(s=>s.barcode===n.value);if(!l){r.value="Item tidak ditemukan dalam DO.",n.value="";return}if(l.received_qty>=l.qty){r.value="Item sudah diterima semua.",n.value="";return}l.received_qty=(l.received_qty||0)+1,n.value=""}const T=H(()=>{var l,e;return(e=(l=c.deliveryOrder)==null?void 0:l.items)!=null&&e.length?c.deliveryOrder.items.every(s=>(s.received_qty||0)>=s.qty):!1});async function N(){f.value=!0;try{if(!(await fetch("/api/outlet-food-good-receives",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({delivery_order_id:c.deliveryOrder.id,items:c.deliveryOrder.items.map(e=>({id:e.id,received_qty:e.received_qty||0}))})})).ok){r.value="Terjadi kesalahan server.";return}R.visit(route("outlet-food-good-receives.index"))}catch{r.value="Terjadi kesalahan server."}finally{f.value=!1}}return(l,e)=>(d(),L(U,null,{default:_(()=>[t("div",J,[t("div",P,[e[4]||(e[4]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-truck text-blue-500"}),y(" Proses Good Receive ")],-1)),V(A(E),{href:l.route("outlet-food-good-receives.index"),class:"bg-gray-200 text-gray-700 px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},{default:_(()=>e[3]||(e[3]=[y(" Kembali ")])),_:1},8,["href"])]),t("div",W,[e[9]||(e[9]=t("h2",{class:"text-xl font-bold text-blue-700 mb-4"},"Informasi Delivery Order",-1)),t("div",Z,[t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-600"},"Nomor DO",-1)),t("p",$,o(u.deliveryOrder.number),1)]),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-600"},"Tanggal DO",-1)),t("p",X,o(I(u.deliveryOrder.date)),1)]),t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-600"},"Outlet",-1)),t("p",Y,o(u.deliveryOrder.outlet_name),1)]),t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-600"},"Status",-1)),t("p",ee,o(u.deliveryOrder.status),1)])])]),t("div",te,[e[11]||(e[11]=t("h2",{class:"text-xl font-bold text-blue-700 mb-4"},"Daftar Item",-1)),t("div",se,[t("table",le,[e[10]||(e[10]=t("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tl-2xl"},"No"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Nama Item"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Qty DO"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Qty Diterima"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tr-2xl"},"Status")])],-1)),t("tbody",null,[(d(!0),i(O,null,C(u.deliveryOrder.items,(s,x)=>(d(),i("tr",{key:s.id,class:"hover:bg-blue-50"},[t("td",ae,o(x+1),1),t("td",oe,o(s.name),1),t("td",re,o(s.qty),1),t("td",de,o(s.received_qty||0),1),t("td",ie,[t("span",{class:F(s.received_qty>=s.qty?"text-green-700 font-bold":"text-yellow-700 font-bold")},o(s.received_qty>=s.qty?"Selesai":"Belum Selesai"),3)])]))),128))])])])]),t("div",ne,[e[16]||(e[16]=t("h2",{class:"text-xl font-bold text-blue-700 mb-4"},"Scan Item",-1)),t("div",ue,[e[13]||(e[13]=t("label",{class:"block text-sm font-semibold mb-1"},"Barcode Item",-1)),t("div",ce,[q(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),type:"text",class:"w-full border rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Scan barcode item...",onKeyup:G(k,["enter"])},null,544),[[K,n.value]]),t("button",{onClick:e[1]||(e[1]=s=>p.value=!0),class:"bg-green-500 text-white px-3 py-2 rounded flex items-center gap-1"},e[12]||(e[12]=[t("i",{class:"fa fa-camera"},null,-1),y(" Scan dari Kamera ")]))])]),r.value?(d(),i("div",me,o(r.value),1)):b("",!0),t("div",pe,[t("button",{onClick:N,disabled:!T.value||f.value,class:"px-4 py-2 rounded-md bg-blue-600 text-white font-semibold hover:bg-blue-700 flex items-center"},[f.value?(d(),i("span",fe,e[14]||(e[14]=[t("i",{class:"fas fa-spinner"},null,-1)]))):b("",!0),e[15]||(e[15]=y(" Simpan GR "))],8,ve)])]),p.value?(d(),i("div",xe,[t("div",be,[g.value.length>1?(d(),i("div",ye,[q(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>v.value=s),onChange:D,class:"border rounded px-2 py-1"},[(d(!0),i(O,null,C(g.value,s=>(d(),i("option",{key:s.id,value:s.id},o(s.label),9,ge))),128))],544),[[M,v.value]])])):b("",!0),e[17]||(e[17]=t("div",{id:"qr-reader",style:{width:"100%"}},null,-1)),t("button",{onClick:S,class:"mt-4 bg-gray-300 px-4 py-2 rounded"},"Tutup")])])):b("",!0)])]),_:1}))}},Ne=z(we,[["__scopeId","data-v-54819e02"]]);export{Ne as default};
