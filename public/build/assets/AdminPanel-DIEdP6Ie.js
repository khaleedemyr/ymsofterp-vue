import{r as p,c as W,a as ye,j as xe,A as fe,B as a,C as he,D as e,L as r,E as u,G as h,N as i,l as x,H as m,J as P,I as M,F as w,M as I,Z as be,O as _e,X as ke,n as we}from"./vendor-vue-g7iCcTkf.js";import{A as Ce}from"./AppLayout-IyEgvQ-G.js";import{a as $}from"./vendor-utils-CpgP2uT4.js";import"./app-5sHs3Z-e.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-C59QAxMM.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const je={class:"py-6"},Me={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ie={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},$e={class:"p-6"},Le={class:"flex items-center justify-between"},Pe={class:"flex items-center gap-4"},Se={class:"text-sm text-gray-500"},Fe={class:"font-medium"},Ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},Be={class:"p-6"},Ee={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},Te={class:"lg:col-span-2"},Ue={class:"relative"},Ve={class:"flex items-center gap-4"},ze={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},De={class:"p-6"},He={class:"space-y-4"},Re=["onClick"],Oe={class:"flex items-start justify-between"},Ne={class:"flex-1 min-w-0"},qe={class:"flex items-center gap-2 mb-2"},We={class:"font-semibold text-gray-900 truncate"},Ge={class:"text-sm text-gray-600 mb-1"},Je={class:"flex items-center gap-3 mb-2 text-xs text-gray-500"},Ke={key:0,class:"flex items-center gap-1"},Qe={key:1,class:"flex items-center gap-1"},Xe={key:2,class:"flex items-center gap-1"},Ze={class:"text-sm text-gray-700 truncate"},Ye={class:"flex items-center gap-4 mt-2 text-xs text-gray-500"},et={key:0,class:"text-green-600"},tt={key:0,class:"bg-red-500 text-white text-xs rounded-full h-6 w-6 flex items-center justify-center font-bold"},st={key:0,class:"text-center py-8 text-gray-500"},ot={key:0,class:"mt-6 flex items-center justify-between"},at={class:"text-sm text-gray-700"},rt={class:"flex items-center space-x-2"},lt=["disabled"],nt=["onClick"],it={key:1,class:"px-3 py-2 text-sm text-gray-500"},ut=["disabled"],dt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ct={class:"bg-white rounded-lg w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col"},pt={class:"p-6 border-b border-gray-200"},gt={class:"flex items-center justify-between"},vt={class:"text-xl font-semibold text-gray-900"},mt={class:"text-sm text-gray-600 mt-1"},yt={class:"flex items-center gap-4 mt-2 text-xs text-gray-500"},xt={key:0,class:"flex items-center gap-1"},ft={key:1,class:"flex items-center gap-1"},ht={key:2,class:"flex items-center gap-1"},bt={class:"flex items-center gap-2"},_t={class:"flex-1 overflow-y-auto p-6 space-y-4"},kt={class:"max-w-xs lg:max-w-md"},wt={class:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center flex-shrink-0"},Ct=["src"],jt={key:1,class:"text-xs font-medium text-gray-600"},Mt={class:"text-sm"},It={key:1,class:"mt-2"},$t={key:0,class:"relative"},Lt=["src","onClick","alt"],Pt={key:1,class:"flex items-center gap-2 p-2 bg-white bg-opacity-20 rounded"},St={class:"text-xs flex-1 truncate"},Ft=["href"],At={class:"text-xs mt-1 opacity-75"},Bt={class:"p-6 border-t border-gray-200"},Et={key:0,class:"mb-4"},Tt={class:"flex flex-wrap gap-2"},Ut={key:0,class:"relative"},Vt=["src","onClick"],zt={key:1,class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Dt={class:"text-xs text-gray-700"},Ht=["onClick"],Rt={class:"flex gap-2"},Ot=["disabled"],Nt={key:0,class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},qt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Wt={class:"relative max-w-4xl max-h-full p-4"},Gt=["src"],Jt={key:2,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50"},Kt={class:"relative bg-white rounded-lg p-6 max-w-md w-full mx-4"},Qt={class:"mb-4"},Xt={ref:"cameraVideo",autoplay:"",playsinline:"",class:"w-full h-64 bg-gray-200 rounded-lg object-cover"},Zt={key:0,class:"w-full h-64 bg-gray-200 rounded-lg flex items-center justify-center"},Yt=["src"],es={class:"flex gap-2 justify-center"},gs={__name:"AdminPanel",setup(ts){const g=p([]),n=p(null),C=p([]),f=p(""),L=p(!1),S=p(!1),F=p(!1),A=p(!1),B=p(""),c=p(null),E=p(null),y=p([]),T=p(!1),v=p(null),b=p(null),d=p({status:"all",priority:"all",search:"",dateFrom:"",dateTo:"",perPage:15,page:1}),G=W(()=>{var o;return((o=c.value)==null?void 0:o.total)||0}),V=W(()=>g.value),j=async()=>{try{S.value=!0;const o=new URLSearchParams;Object.keys(d.value).forEach(s=>{d.value[s]&&d.value[s]!=="all"&&o.append(s,d.value[s])});const t=await $.get(`/api/support/admin/conversations?${o.toString()}`);t.data.data?(g.value=t.data.data,c.value=t.data.pagination):(g.value=t.data,c.value=null)}catch(o){console.error("Error fetching conversations:",o)}finally{S.value=!1}},J=()=>{E.value&&clearTimeout(E.value),E.value=setTimeout(()=>{d.value.page=1,_()},500)},_=()=>{d.value.page=1,j()},K=()=>{d.value={status:"all",priority:"all",search:"",dateFrom:"",dateTo:"",perPage:15,page:1},j()},U=o=>{o>=1&&o<=c.value.last_page&&(d.value.page=o,j())},Q=()=>{if(!c.value)return[];const o=c.value.current_page,t=c.value.last_page,s=[];if(t<=7)for(let l=1;l<=t;l++)s.push(l);else if(o<=4){for(let l=1;l<=5;l++)s.push(l);s.push("..."),s.push(t)}else if(o>=t-3){s.push(1),s.push("...");for(let l=t-4;l<=t;l++)s.push(l)}else{s.push(1),s.push("...");for(let l=o-1;l<=o+1;l++)s.push(l);s.push("..."),s.push(t)}return s},X=async o=>{n.value=o,F.value=!0,await Z(o.id)},Z=async o=>{try{const t=await $.get(`/api/support/conversations/${o}/messages`);C.value=t.data,C.value.forEach(s=>{s.file_path&&console.log("Message with file_path:",{id:s.id,file_path:s.file_path,file_path_type:typeof s.file_path,is_array:Array.isArray(s.file_path),parsed:q(s.file_path)})})}catch(t){console.error("Error fetching messages:",t)}},z=async()=>{if(!(!f.value.trim()&&y.value.length===0||!n.value)){L.value=!0;try{const o=new FormData;o.append("message",f.value||"File attachment"),y.value.forEach((l,k)=>{o.append(`files[${k}]`,l)});const t=await $.post(`/api/support/admin/conversations/${n.value.id}/reply`,o,{headers:{"Content-Type":"multipart/form-data"}});C.value.push(t.data),f.value="",y.value=[];const s=g.value.findIndex(l=>l.id===n.value.id);s!==-1&&(g.value[s].last_message=t.data.message,g.value[s].last_message_at=t.data.created_at,g.value[s].last_sender_name=t.data.sender_name,g.value[s].last_sender_type=t.data.sender_type)}catch(o){console.error("Error sending reply:",o)}finally{L.value=!1}}},Y=o=>{Array.from(o.target.files).forEach(s=>{s.size<=10*1024*1024?y.value.push(s):alert(`File ${s.name} is too large. Maximum size is 10MB.`)}),o.target.value=""},ee=o=>{y.value.splice(o,1)},D=o=>URL.createObjectURL(o),te=async()=>{try{const o=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});b.value=o,T.value=!0,await we();const t=document.querySelector("video");t&&(t.srcObject=o)}catch(o){console.error("Error accessing camera:",o),alert("Unable to access camera. Please check permissions.")}},se=()=>{const o=document.querySelector("video");if(o){const t=document.createElement("canvas");t.width=o.videoWidth,t.height=o.videoHeight,t.getContext("2d").drawImage(o,0,0),v.value=t.toDataURL("image/jpeg")}},oe=()=>{v.value&&fetch(v.value).then(o=>o.blob()).then(o=>{const t=new File([o],`camera_${Date.now()}.jpg`,{type:"image/jpeg"});y.value.push(t),H()})},ae=()=>{v.value=null},H=()=>{b.value&&(b.value.getTracks().forEach(o=>o.stop()),b.value=null),T.value=!1,v.value=null},re=async()=>{try{await $.put(`/api/support/admin/conversations/${n.value.id}/status`,{status:n.value.status,priority:n.value.priority});const o=g.value.findIndex(t=>t.id===n.value.id);o!==-1&&(g.value[o].status=n.value.status)}catch(o){console.error("Error updating status:",o)}},le=async()=>{try{await $.put(`/api/support/admin/conversations/${n.value.id}/status`,{status:n.value.status,priority:n.value.priority});const o=g.value.findIndex(t=>t.id===n.value.id);o!==-1&&(g.value[o].priority=n.value.priority)}catch(o){console.error("Error updating priority:",o)}},ne=()=>{F.value=!1,n.value=null,C.value=[],f.value=""},ie=async()=>{await j()},R=o=>{B.value=o,A.value=!0},O=()=>{A.value=!1,B.value=""},N=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),ue=o=>new Date(o).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),de=o=>({open:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800",pending:"bg-yellow-100 text-yellow-800"})[o]||"bg-gray-100 text-gray-800",ce=o=>({low:"bg-blue-100 text-blue-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800",pe=o=>o?o.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2):"?",ge=o=>`${{"Bug Report":"ðŸ›","Feature Request":"ðŸ’¡","Technical Support":"ðŸ”§","Data Issue":"ðŸ“Š","Login Problem":"ðŸ”","Permission Issue":"ðŸ‘¤","Report Error":"ðŸ“‹","Performance Issue":"âš¡","Integration Problem":"ðŸ”—","Training Request":"ðŸŽ“","General Question":"â“",Other:"ðŸ“"}[o]||"ðŸ“"} ${o}`,q=o=>{if(!o)return[];if(Array.isArray(o))return o;if(typeof o=="string")try{const t=JSON.parse(o);if(Array.isArray(t))return t;if(t&&typeof t=="object")return[t]}catch(t){return console.error("Error parsing file_path:",t,o),[{original_name:"attachment",file_path:o,file_size:0,mime_type:"application/octet-stream"}]}return[]},ve=o=>{console.error("Error loading attachment image:",o.target.src),o.target.style.display="none"},me=o=>{const t=[".jpg",".jpeg",".png",".gif",".bmp",".webp"],s=o.toLowerCase().substring(o.lastIndexOf("."));return t.includes(s)};return ye(()=>{j()}),xe(()=>{b.value&&b.value.getTracks().forEach(o=>o.stop())}),(o,t)=>(a(),fe(Ce,null,{default:he(()=>[e("div",je,[e("div",Me,[e("div",Ie,[e("div",$e,[e("div",Le,[t[15]||(t[15]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Live Support Admin Panel"),e("p",{class:"text-gray-600 mt-1"},"Manage customer support conversations")],-1)),e("div",Pe,[e("div",Se,[e("span",Fe,i(G.value),1),t[13]||(t[13]=h(" conversations "))]),e("button",{onClick:ie,class:x(["bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors",{"animate-spin":S.value}])},t[14]||(t[14]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]),2)])])])]),e("div",Ae,[e("div",Be,[e("div",Ee,[e("div",Te,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),e("div",Ue,[m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>d.value.search=s),onInput:J,type:"text",placeholder:"Search conversations, users, messages...",class:"w-full px-3 py-2 pl-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[P,d.value.search]]),t[16]||(t[16]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date From",-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>d.value.dateFrom=s),onChange:_,type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[P,d.value.dateFrom]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date To",-1)),m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value.dateTo=s),onChange:_,type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[P,d.value.dateTo]])])]),e("div",Ve,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>d.value.status=s),onChange:_,class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t[20]||(t[20]=[e("option",{value:"all"},"All Status",-1),e("option",{value:"open"},"Open",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"closed"},"Closed",-1)]),544),[[M,d.value.status]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),m(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>d.value.priority=s),onChange:_,class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t[22]||(t[22]=[e("option",{value:"all"},"All Priority",-1),e("option",{value:"low"},"Low",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"high"},"High",-1),e("option",{value:"urgent"},"Urgent",-1)]),544),[[M,d.value.priority]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Per Page",-1)),m(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>d.value.perPage=s),onChange:_,class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},t[24]||(t[24]=[e("option",{value:"10"},"10",-1),e("option",{value:"15"},"15",-1),e("option",{value:"25"},"25",-1),e("option",{value:"50"},"50",-1)]),544),[[M,d.value.perPage]])]),e("div",{class:"flex items-end"},[e("button",{onClick:K,class:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"}," Clear Filters ")])])])]),e("div",ze,[e("div",De,[e("div",He,[(a(!0),r(w,null,I(V.value,s=>{var l;return a(),r("div",{key:s.id,onClick:k=>X(s),class:x(["border border-gray-200 rounded-lg p-4 cursor-pointer hover:bg-gray-50 transition-colors",{"ring-2 ring-blue-500 bg-blue-50":((l=n.value)==null?void 0:l.id)===s.id}])},[e("div",Oe,[e("div",Ne,[e("div",qe,[e("h3",We,i(ge(s.subject)),1),e("span",{class:x([de(s.status),"text-xs px-2 py-1 rounded-full"])},i(s.status),3),e("span",{class:x([ce(s.priority),"text-xs px-2 py-1 rounded-full"])},i(s.priority),3)]),e("p",Ge,i(s.customer_name)+" ("+i(s.customer_email)+")",1),e("div",Je,[s.customer_outlet?(a(),r("span",Ke,[t[26]||(t[26]=e("i",{class:"fas fa-store"},null,-1)),h(" "+i(s.customer_outlet),1)])):u("",!0),s.customer_divisi?(a(),r("span",Qe,[t[27]||(t[27]=e("i",{class:"fas fa-building"},null,-1)),h(" "+i(s.customer_divisi),1)])):u("",!0),s.customer_jabatan?(a(),r("span",Xe,[t[28]||(t[28]=e("i",{class:"fas fa-user-tie"},null,-1)),h(" "+i(s.customer_jabatan),1)])):u("",!0)]),e("p",Ze,i(s.last_message),1),e("div",Ye,[e("span",null,"Created: "+i(N(s.created_at)),1),e("span",null,"Last: "+i(N(s.last_message_at)),1),s.last_sender_type==="admin"?(a(),r("span",et," Replied by: "+i(s.last_sender_name),1)):u("",!0)])]),s.unread_count>0?(a(),r("div",tt,i(s.unread_count),1)):u("",!0)])],10,Re)}),128)),V.value.length===0?(a(),r("div",st,t[29]||(t[29]=[e("svg",{class:"w-12 h-12 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),e("p",null,"No conversations found",-1)]))):u("",!0)]),c.value&&c.value.last_page>1?(a(),r("div",ot,[e("div",at," Showing "+i(c.value.from)+" to "+i(c.value.to)+" of "+i(c.value.total)+" results ",1),e("div",rt,[e("button",{onClick:t[6]||(t[6]=s=>U(c.value.current_page-1)),disabled:c.value.current_page<=1,class:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,lt),(a(!0),r(w,null,I(Q(),s=>(a(),r(w,{key:s},[s!=="..."?(a(),r("button",{key:0,onClick:l=>U(s),class:x(["px-3 py-2 text-sm font-medium rounded-md",s===c.value.current_page?"bg-blue-500 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"])},i(s),11,nt)):(a(),r("span",it,"..."))],64))),128)),e("button",{onClick:t[7]||(t[7]=s=>U(c.value.current_page+1)),disabled:c.value.current_page>=c.value.last_page,class:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,ut)])])):u("",!0)])])])]),F.value&&n.value?(a(),r("div",dt,[e("div",ct,[e("div",pt,[e("div",gt,[e("div",null,[e("h2",vt,i(n.value.subject),1),e("p",mt,i(n.value.customer_name)+" ("+i(n.value.customer_email)+") ",1),e("div",yt,[n.value.customer_outlet?(a(),r("span",xt,[t[30]||(t[30]=e("i",{class:"fas fa-store"},null,-1)),h(" "+i(n.value.customer_outlet),1)])):u("",!0),n.value.customer_divisi?(a(),r("span",ft,[t[31]||(t[31]=e("i",{class:"fas fa-building"},null,-1)),h(" "+i(n.value.customer_divisi),1)])):u("",!0),n.value.customer_jabatan?(a(),r("span",ht,[t[32]||(t[32]=e("i",{class:"fas fa-user-tie"},null,-1)),h(" "+i(n.value.customer_jabatan),1)])):u("",!0)])]),e("div",bt,[m(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>n.value.status=s),onChange:re,class:"px-3 py-1 border border-gray-300 rounded-md text-sm"},t[33]||(t[33]=[e("option",{value:"open"},"Open",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"closed"},"Closed",-1)]),544),[[M,n.value.status]]),m(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>n.value.priority=s),onChange:le,class:"px-3 py-1 border border-gray-300 rounded-md text-sm"},t[34]||(t[34]=[e("option",{value:"low"},"Low",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"high"},"High",-1),e("option",{value:"urgent"},"Urgent",-1)]),544),[[M,n.value.priority]]),e("button",{onClick:ne,class:"text-gray-500 hover:text-gray-700"},t[35]||(t[35]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])]),e("div",_t,[(a(!0),r(w,null,I(C.value,s=>(a(),r("div",{key:s.id,class:x(["flex",s.sender_type==="admin"?"justify-end":"justify-start"])},[e("div",kt,[e("div",{class:x(["flex items-end gap-2",s.sender_type==="admin"?"flex-row-reverse":"flex-row"])},[e("div",wt,[s.sender_avatar?(a(),r("img",{key:0,src:`/storage/${s.sender_avatar}`,class:"w-8 h-8 rounded-full object-cover",alt:"Avatar"},null,8,Ct)):(a(),r("span",jt,i(pe(s.sender_name)),1))]),e("div",{class:x(["rounded-lg px-3 py-2",s.sender_type==="admin"?"bg-blue-500 text-white":"bg-gray-200 text-gray-800"])},[s.sender_type==="admin"&&s.sender_name?(a(),r("div",{key:0,class:x(["text-xs font-medium mb-1",s.sender_type==="admin"?"text-blue-100":"text-gray-600"])},i(s.sender_name),3)):u("",!0),e("p",Mt,i(s.message),1),s.file_path?(a(),r("div",It,[(a(!0),r(w,null,I(q(s.file_path),(l,k)=>(a(),r("div",{key:`file-${s.id}-${k}`,class:"mb-2"},[l&&l.original_name&&l.file_path&&me(l.original_name)?(a(),r("div",$t,[e("img",{src:`/storage/${l.file_path}`,onClick:ss=>R(`/storage/${l.file_path}`),class:"max-w-full h-32 object-cover rounded cursor-pointer hover:opacity-80 transition-opacity border border-gray-300",alt:l.original_name||"Attachment",onError:ve},null,40,Lt)])):l&&l.original_name&&l.file_path?(a(),r("div",Pt,[t[37]||(t[37]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("span",St,i(l.original_name),1),e("a",{href:`/storage/${l.file_path}`,target:"_blank",class:"text-xs hover:underline"},t[36]||(t[36]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)]),8,Ft)])):u("",!0)]))),128))])):u("",!0),e("p",At,i(ue(s.created_at)),1)],2)],2)])],2))),128))]),e("div",Bt,[y.value.length>0?(a(),r("div",Et,[e("div",Tt,[(a(!0),r(w,null,I(y.value,(s,l)=>(a(),r("div",{key:l,class:"flex items-center gap-2 bg-gray-100 p-2 rounded-lg"},[s.type.startsWith("image/")?(a(),r("div",Ut,[e("img",{src:D(s),onClick:k=>R(D(s)),class:"w-8 h-8 object-cover rounded cursor-pointer hover:opacity-80 transition-opacity",alt:"Thumbnail"},null,8,Vt)])):(a(),r("svg",zt,t[38]||(t[38]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)]))),e("span",Dt,i(s.name),1),e("button",{onClick:k=>ee(l),class:"text-red-500 hover:text-red-700"},t[39]||(t[39]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ht)]))),128))])])):u("",!0),e("div",Rt,[e("input",{ref:"fileInput",onChange:Y,type:"file",multiple:"",accept:"image/*,.pdf,.doc,.docx,.txt,.xlsx,.xls",class:"hidden"},null,544),e("button",{onClick:t[10]||(t[10]=s=>o.$refs.fileInput.click()),class:"flex-shrink-0 px-3 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"},t[40]||(t[40]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})],-1)])),e("button",{onClick:te,class:"flex-shrink-0 px-3 py-2 text-gray-600 hover:text-gray-800 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"},t[41]||(t[41]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])),m(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>f.value=s),onKeyup:be(z,["enter"]),type:"text",placeholder:"Type your reply...",class:"flex-1 min-w-0 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[P,f.value]]),e("button",{onClick:z,disabled:!f.value.trim()&&y.value.length===0||L.value,class:"flex-shrink-0 bg-blue-500 text-white px-3 py-2 rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed"},[L.value?(a(),r("svg",Nt,t[42]||(t[42]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(a(),r("svg",qt,t[43]||(t[43]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"},null,-1)])))],8,Ot)])])])])):u("",!0),A.value?(a(),r("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:O},[e("div",Wt,[e("button",{onClick:O,class:"absolute top-2 right-2 text-white text-2xl hover:text-gray-300 z-10"},t[44]||(t[44]=[e("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),e("img",{src:B.value,class:"max-w-full max-h-full object-contain rounded-lg",onClick:t[12]||(t[12]=_e(()=>{},["stop"])),alt:"Full size image"},null,8,Gt)])])):u("",!0),T.value?(a(),r("div",Jt,[e("div",Kt,[e("div",{class:"flex items-center justify-between mb-4"},[t[46]||(t[46]=e("h3",{class:"text-lg font-semibold"},"Capture Photo",-1)),e("button",{onClick:H,class:"text-gray-500 hover:text-gray-700"},t[45]||(t[45]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",Qt,[m(e("video",Xt,null,512),[[ke,!v.value]]),v.value?(a(),r("div",Zt,[e("img",{src:v.value,class:"w-full h-full object-cover rounded-lg",alt:"Captured photo"},null,8,Yt)])):u("",!0)]),e("div",es,[v.value?u("",!0):(a(),r("button",{key:0,onClick:se,class:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600"}," Capture ")),v.value?(a(),r("button",{key:1,onClick:oe,class:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600"}," Use Photo ")):u("",!0),v.value?(a(),r("button",{key:2,onClick:ae,class:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600"}," Retake ")):u("",!0)])])])):u("",!0)]),_:1}))}};export{gs as default};
