import{r as g,w as k,L as u,E as x,B as f,D as s,G as n,N as d,O as S,H as p,J as c}from"./vendor-vue-g7iCcTkf.js";import{S as m}from"./app-Bb65-N1P.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";const h={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},C={class:"bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},j={class:"flex justify-between items-center mb-6"},B={key:0,class:"mb-6 p-4 bg-gray-50 rounded-lg"},M={class:"grid grid-cols-2 gap-4 text-sm"},O={class:"font-medium ml-2"},E={class:"font-medium ml-2"},N={class:"font-medium ml-2"},V={class:"font-medium ml-2"},$={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},D={class:"grid grid-cols-2 gap-4"},I={class:"bg-green-50 border border-green-200 rounded-lg p-4"},K={class:"grid grid-cols-2 gap-4"},T={class:"bg-purple-50 border border-purple-200 rounded-lg p-4"},P={class:"grid grid-cols-2 gap-4"},U={class:"flex justify-end space-x-4 pt-4 border-t"},H=["disabled"],J={key:0,class:"fa fa-spinner fa-spin"},G={key:1,class:"fa-solid fa-save"},F={__name:"SaldoModal",props:{show:Boolean,user:Object},emits:["close","success"],setup(o,{emit:y}){const r=o,b=y,i=g(!1),t=g({cuti:"",public_holiday:"",extra_off:"",notes:""});k(()=>r.show,a=>{a&&r.user&&v()});async function v(){try{t.value.cuti=r.user.cuti||0;const a=await fetch(`/api/users/${r.user.id}/extra-off-balance`);if(a.ok){const l=await a.json();t.value.extra_off=l.balance||0}const e=await fetch(`/api/users/${r.user.id}/public-holiday-balance`);if(e.ok){const l=await e.json();t.value.public_holiday=l.balance||0}}catch(a){console.error("Error loading current saldo:",a)}}async function w(){if(r.user){if(t.value.cuti===""&&t.value.public_holiday===""&&t.value.extra_off===""){m.fire({icon:"warning",title:"Peringatan",text:"Minimal isi salah satu saldo!",confirmButtonColor:"#f59e0b"});return}i.value=!0;try{const a=await fetch(`/api/users/${r.user.id}/update-saldo`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({cuti:t.value.cuti,public_holiday:t.value.public_holiday,extra_off:t.value.extra_off,notes:t.value.notes})}),e=await a.json();if(a.ok&&e.success)m.fire({icon:"success",title:"Berhasil!",text:e.message,confirmButtonColor:"#10b981"}),b("success",e.message),b("close");else throw new Error(e.message||"Gagal menyimpan saldo")}catch(a){m.fire({icon:"error",title:"Error",text:a.message,confirmButtonColor:"#ef4444"})}finally{i.value=!1}}}return(a,e)=>o.show?(f(),u("div",h,[s("div",C,[s("div",j,[e[7]||(e[7]=s("h2",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[s("i",{class:"fa-solid fa-coins text-purple-500"}),n(" Input Saldo Karyawan ")],-1)),s("button",{onClick:e[0]||(e[0]=l=>a.$emit("close")),class:"text-gray-400 hover:text-gray-600 transition-colors"},e[6]||(e[6]=[s("i",{class:"fa-solid fa-times text-xl"},null,-1)]))]),o.user?(f(),u("div",B,[e[12]||(e[12]=s("h3",{class:"font-semibold text-gray-800 mb-2"},"Data Karyawan",-1)),s("div",M,[s("div",null,[e[8]||(e[8]=s("span",{class:"text-gray-600"},"Nama:",-1)),s("span",O,d(o.user.nama_lengkap),1)]),s("div",null,[e[9]||(e[9]=s("span",{class:"text-gray-600"},"NIK:",-1)),s("span",E,d(o.user.nik),1)]),s("div",null,[e[10]||(e[10]=s("span",{class:"text-gray-600"},"Jabatan:",-1)),s("span",N,d(o.user.nama_jabatan||"-"),1)]),s("div",null,[e[11]||(e[11]=s("span",{class:"text-gray-600"},"Outlet:",-1)),s("span",V,d(o.user.nama_outlet||"-"),1)])])])):x("",!0),s("form",{onSubmit:S(w,["prevent"]),class:"space-y-6"},[s("div",$,[e[15]||(e[15]=s("h4",{class:"font-semibold text-blue-800 mb-3 flex items-center gap-2"},[s("i",{class:"fa-solid fa-calendar-days"}),n(" Saldo Cuti ")],-1)),s("div",D,[s("div",null,[e[13]||(e[13]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Saldo Cuti Saat Ini",-1)),p(s("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=l=>t.value.cuti=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan saldo cuti",min:"0",step:"0.5"},null,512),[[c,t.value.cuti]])]),e[14]||(e[14]=s("div",{class:"flex items-end"},[s("span",{class:"text-sm text-gray-600"},"hari")],-1))])]),s("div",I,[e[18]||(e[18]=s("h4",{class:"font-semibold text-green-800 mb-3 flex items-center gap-2"},[s("i",{class:"fa-solid fa-calendar-check"}),n(" Saldo Public Holiday ")],-1)),s("div",K,[s("div",null,[e[16]||(e[16]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Saldo PH Saat Ini",-1)),p(s("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=l=>t.value.public_holiday=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Masukkan saldo public holiday",min:"0",step:"0.5"},null,512),[[c,t.value.public_holiday]])]),e[17]||(e[17]=s("div",{class:"flex items-end"},[s("span",{class:"text-sm text-gray-600"},"hari")],-1))])]),s("div",T,[e[21]||(e[21]=s("h4",{class:"font-semibold text-purple-800 mb-3 flex items-center gap-2"},[s("i",{class:"fa-solid fa-clock"}),n(" Saldo Extra Off ")],-1)),s("div",P,[s("div",null,[e[19]||(e[19]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Saldo Extra Off Saat Ini",-1)),p(s("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=l=>t.value.extra_off=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Masukkan saldo extra off",min:"0",step:"0.5"},null,512),[[c,t.value.extra_off]])]),e[20]||(e[20]=s("div",{class:"flex items-end"},[s("span",{class:"text-sm text-gray-600"},"hari")],-1))])]),s("div",null,[e[22]||(e[22]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Keterangan (Opsional)",-1)),p(s("textarea",{"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.notes=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",rows:"3",placeholder:"Masukkan keterangan jika ada..."},null,512),[[c,t.value.notes]])]),s("div",U,[s("button",{type:"button",onClick:e[5]||(e[5]=l=>a.$emit("close")),class:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"}," Batal "),s("button",{type:"submit",disabled:i.value,class:"px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center gap-2"},[i.value?(f(),u("i",J)):(f(),u("i",G)),n(" "+d(i.value?"Menyimpan...":"Simpan Saldo"),1)],8,H)])],32)])])):x("",!0)}};export{F as default};
