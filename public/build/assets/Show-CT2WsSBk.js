import{r as g,P as T,a as A,j as M,A as P,B as r,C as _,D as e,L as u,E as x,N as l,x as B,Q as v,S as $,G as n,F as z,M as F}from"./vendor-vue-g7iCcTkf.js";import{A as G}from"./AppLayout-BE0dNalr.js";import{U as K}from"./UserSearchDropdown-hwY_4x37.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./app-C51E4rvH.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-D219A2Up.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const q={class:"space-y-6"},H={class:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-700 p-8 text-white shadow-2xl"},R={class:"relative z-10"},Q={class:"flex items-center justify-between"},J={class:"text-4xl font-bold mb-2 animate-fade-in-up"},W={class:"text-blue-100 text-lg"},X={class:"hidden md:flex items-center gap-4"},Y={class:"flex gap-2"},Z=["href"],ee={class:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-xl border border-white/20 p-6 animate-fade-in-up animation-delay-200"},te={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},se={class:"space-y-4"},ie={class:"space-y-3"},le={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-3 backdrop-blur-sm"},oe={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-3 backdrop-blur-sm"},ne={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-3 backdrop-blur-sm"},ae={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-3 backdrop-blur-sm"},de={class:"space-y-4"},re={class:"space-y-3"},ce={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-3 backdrop-blur-sm"},ue={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-3 backdrop-blur-sm"},me={class:"space-y-4"},fe={class:"space-y-3"},be={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-3 backdrop-blur-sm"},ge={key:0,class:"mt-6 p-4 bg-blue-50 rounded-xl border border-blue-200"},xe={class:"text-sm text-gray-700"},pe={class:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-xl border border-white/20 p-6 animate-fade-in-up animation-delay-400"},he={class:"flex items-center justify-between mb-6"},ve={class:"flex items-center gap-3"},we={class:"text-sm text-gray-600 bg-white/50 rounded-lg px-3 py-1 backdrop-blur-sm"},ye=["href"],ke={id:"document-viewer",class:"w-full rounded-xl overflow-hidden shadow-lg",style:{height:"600px"}},_e={id:"fallback-viewer",class:"w-full h-full hidden"},Be={class:"fallback-content w-full h-full bg-gray-100 rounded-xl flex items-center justify-center"},De={class:"text-center"},Ee=["href"],Ie={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm overflow-y-auto h-full w-full z-50 animate-fade-in"},Oe={class:"relative top-20 mx-auto p-8 border w-96 shadow-2xl rounded-2xl bg-white/90 backdrop-blur-xl border-white/20"},Se={class:"mt-3"},je={class:"space-y-4"},Le={key:0,class:"space-y-2"},Ue={class:"flex-1"},Ve={class:"font-semibold text-gray-900"},Ce={class:"text-sm text-gray-600"},Te={class:"text-xs text-gray-500"},Ae={class:"flex items-center gap-2 ml-4"},Me=["value","onChange"],Pe=["onClick"],$e={class:"relative"},ze={class:"flex justify-end space-x-3 mt-8"},Fe=["disabled"],Ge={key:0,class:"fas fa-spinner fa-spin mr-2"},Ke={key:1,class:"fas fa-share mr-2"},Ne={__name:"Show",props:{document:{type:Object,required:!0},canEdit:{type:Boolean,required:!0},canAdmin:{type:Boolean,required:!0},onlyOfficeUrl:{type:String,required:!0}},setup(o){const d=o,b=g(!1),m=g([]),p=g(null),f=g(""),c=T({shared_users:[]}),D=s=>new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),E=s=>{if(s===0)return"0 Bytes";const t=1024,i=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,a)).toFixed(2))+" "+i[a]},I=s=>{m.value.some(t=>t.id===s.id)||(m.value.push(s),c.shared_users.push({user_id:s.id,permission:"view"}))},w=s=>{m.value=m.value.filter(t=>t.id!==s.id),c.shared_users=c.shared_users.filter(t=>t.user_id!==s.id)},O=s=>{const t=c.shared_users.find(i=>i.user_id===s);return t?t.permission:"view"},S=(s,t)=>{const i=c.shared_users.find(a=>a.user_id===s);i&&(i.permission=t)},j=()=>{c.post(route("shared-documents.share",d.document.id),{onSuccess:()=>{b.value=!1}})};A(async()=>{if(f.value=`${window.location.origin}/shared-documents/${d.document.id}/download`,L(),await new Promise(t=>setTimeout(t,1500)),await V()&&window.DocsAPI){console.log("Initializing OnlyOffice editor with document:",d.document);const t={document:{fileType:d.document.file_type,key:d.document.id.toString(),title:d.document.title,url:f.value},documentType:C(d.document.file_type),editorConfig:{mode:d.canEdit?"edit":"view",callbackUrl:`${window.location.origin}/shared-documents/${d.document.id}/callback`,user:{id:window.userId||"1",name:window.userName||"User"},customization:{chat:!1,comments:!0,compactToolbar:!1,feedback:!1,forcesave:!0,submitForm:!1}},height:"600px",width:"100%"};console.log("OnlyOffice config:",t);try{p.value=new window.DocsAPI.DocEditor("onlyoffice-editor",t),h(),U()}catch(i){console.error("OnlyOffice initialization failed:",i),h(),y()}}else console.log("OnlyOffice not available, using Google Docs Viewer"),h(),y()});const L=()=>{const s=document.getElementById("onlyoffice-editor"),t=document.getElementById("fallback-viewer"),i=document.getElementById("loading-viewer");s&&s.classList.add("hidden"),t&&t.classList.add("hidden"),i&&i.classList.remove("hidden")},h=()=>{const s=document.getElementById("loading-viewer");s&&s.classList.add("hidden")},U=()=>{const s=document.getElementById("onlyoffice-editor"),t=document.getElementById("fallback-viewer"),i=document.getElementById("loading-viewer");s&&s.classList.remove("hidden"),t&&t.classList.add("hidden"),i&&i.classList.add("hidden")},V=async()=>{try{const s=await fetch(`${window.location.origin}/web-apps/apps/api/documents/api.js`,{method:"HEAD",mode:"no-cors"});return!0}catch(s){return console.log("OnlyOffice server not available:",s),!1}},y=()=>{const s=document.getElementById("onlyoffice-editor"),t=document.getElementById("fallback-viewer"),i=document.getElementById("loading-viewer");s&&s.classList.add("hidden"),t&&t.classList.remove("hidden"),i&&i.classList.add("hidden");const a=t==null?void 0:t.querySelector(".fallback-content");a&&(a.innerHTML=`
            <div class="w-full h-full bg-gray-100 rounded-xl flex items-center justify-center">
                <div class="text-center">
                    <div class="w-16 h-16 mx-auto mb-4 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-file-alt text-2xl text-blue-500"></i>
                    </div>
                    <h3 class="text-lg font-medium text-gray-900 mb-2">Preview Dokumen</h3>
                    <p class="text-sm text-gray-500 mb-4">Menggunakan Google Docs Viewer</p>
                    <div class="space-y-2">
                        <a 
                            href="https://docs.google.com/viewer?url=${encodeURIComponent(f.value)}&embedded=true"
                            target="_blank"
                            class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors mr-2"
                        >
                            <i class="fas fa-external-link-alt mr-2"></i>
                            Buka di Tab Baru
                        </a>
                        <a 
                            href="${f.value}" 
                            download
                            class="inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
                        >
                            <i class="fas fa-download mr-2"></i>
                            Download
                        </a>
                    </div>
                </div>
            </div>
        `)};M(()=>{p.value&&p.value.destroyEditor()});const C=s=>{const t=["xlsx","xls"],i=["docx","doc"],a=["pptx","ppt"];return t.includes(s)?"spreadsheet":i.includes(s)?"text":a.includes(s)?"presentation":"text"};return(s,t)=>(r(),P(G,null,{default:_(()=>[e("div",q,[e("div",H,[t[6]||(t[6]=e("div",{class:"absolute inset-0 bg-black/10"},null,-1)),t[7]||(t[7]=e("div",{class:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16 blur-2xl"},null,-1)),t[8]||(t[8]=e("div",{class:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full translate-y-12 -translate-x-12 blur-xl"},null,-1)),e("div",R,[e("div",Q,[e("div",null,[e("h1",J,l(o.document.title),1),e("p",W,l(o.document.description||"Dokumen kolaboratif"),1)]),e("div",X,[t[5]||(t[5]=e("div",{class:"w-20 h-20 bg-white/20 rounded-2xl backdrop-blur-sm flex items-center justify-center"},[e("i",{class:"fas fa-file-alt text-3xl text-white"})],-1)),e("div",Y,[B(v($),{href:s.route("shared-documents.index"),class:"inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-xl text-white hover:bg-white/30 transition-all duration-300"},{default:_(()=>t[2]||(t[2]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),n(" Kembali ")])),_:1},8,["href"]),e("a",{href:f.value,download:"",class:"inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-xl text-white hover:bg-white/30 transition-all duration-300"},t[3]||(t[3]=[e("i",{class:"fas fa-download mr-2"},null,-1),n(" Download ")]),8,Z),o.canEdit?(r(),u("button",{key:0,onClick:t[0]||(t[0]=i=>b.value=!0),class:"inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-xl text-white hover:bg-white/30 transition-all duration-300"},t[4]||(t[4]=[e("i",{class:"fas fa-share mr-2"},null,-1),n(" Bagikan ")]))):x("",!0)])])])])]),e("div",ee,[e("div",te,[e("div",se,[t[13]||(t[13]=e("h3",{class:"text-lg font-semibold text-gray-900 flex items-center"},[e("i",{class:"fas fa-info-circle mr-2 text-blue-500"}),n(" Informasi Dokumen ")],-1)),e("div",ie,[e("div",le,[t[9]||(t[9]=e("i",{class:"fas fa-user mr-3 text-blue-500"},null,-1)),e("span",null,"Dibuat oleh: "+l(o.document.creator.name),1)]),e("div",oe,[t[10]||(t[10]=e("i",{class:"fas fa-calendar mr-3 text-green-500"},null,-1)),e("span",null,l(D(o.document.created_at)),1)]),e("div",ne,[t[11]||(t[11]=e("i",{class:"fas fa-file mr-3 text-purple-500"},null,-1)),e("span",null,l(o.document.filename),1)]),e("div",ae,[t[12]||(t[12]=e("i",{class:"fas fa-weight-hanging mr-3 text-orange-500"},null,-1)),e("span",null,l(E(o.document.file_size)),1)])])]),e("div",de,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold text-gray-900 flex items-center"},[e("i",{class:"fas fa-shield-alt mr-2 text-green-500"}),n(" Akses ")],-1)),e("div",re,[e("div",ce,[t[14]||(t[14]=e("i",{class:"fas fa-globe mr-3 text-blue-500"},null,-1)),e("span",null,l(o.document.is_public?"Publik":"Private"),1)]),e("div",ue,[t[15]||(t[15]=e("i",{class:"fas fa-users mr-3 text-purple-500"},null,-1)),e("span",null,l(o.document.permissions.length)+" user"+l(o.document.permissions.length!==1?"s":"")+" dibagikan",1)])])]),e("div",me,[t[18]||(t[18]=e("h3",{class:"text-lg font-semibold text-gray-900 flex items-center"},[e("i",{class:"fas fa-code-branch mr-2 text-indigo-500"}),n(" Versi ")],-1)),e("div",fe,[e("div",be,[t[17]||(t[17]=e("i",{class:"fas fa-layer-group mr-3 text-indigo-500"},null,-1)),e("span",null,l(o.document.versions.length)+" versi"+l(o.document.versions.length!==1?"s":""),1)])])])]),o.document.description?(r(),u("div",ge,[t[19]||(t[19]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-2 flex items-center"},[e("i",{class:"fas fa-align-left mr-2 text-blue-500"}),n(" Deskripsi ")],-1)),e("p",xe,l(o.document.description),1)])):x("",!0)]),e("div",pe,[e("div",he,[t[22]||(t[22]=e("h3",{class:"text-xl font-semibold text-gray-900 flex items-center"},[e("i",{class:"fas fa-edit mr-2 text-blue-500"}),n(" Editor Dokumen ")],-1)),e("div",ve,[e("span",we," Mode: "+l(o.canEdit?"Edit":"View"),1),t[21]||(t[21]=e("div",{class:"w-3 h-3 bg-green-500 rounded-full animate-pulse shadow-lg"},null,-1)),e("a",{href:f.value,download:"",class:"inline-flex items-center px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors"},t[20]||(t[20]=[e("i",{class:"fas fa-download mr-1"},null,-1),n(" Download ")]),8,ye)])]),e("div",ke,[t[27]||(t[27]=e("div",{id:"onlyoffice-editor",class:"w-full h-full"},null,-1)),e("div",_e,[e("div",Be,[e("div",De,[t[24]||(t[24]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gray-200 rounded-full flex items-center justify-center"},[e("i",{class:"fas fa-file-alt text-2xl text-gray-400"})],-1)),t[25]||(t[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Preview Tidak Tersedia",-1)),t[26]||(t[26]=e("p",{class:"text-sm text-gray-500 mb-4"},"Gunakan tombol download untuk membuka dokumen",-1)),e("a",{href:f.value,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",download:""},t[23]||(t[23]=[e("i",{class:"fas fa-download mr-2"},null,-1),n(" Download Dokumen ")]),8,Ee)])])]),t[28]||(t[28]=e("div",{id:"loading-viewer",class:"w-full h-full flex items-center justify-center bg-gray-50"},[e("div",{class:"text-center"},[e("div",{class:"w-8 h-8 mx-auto mb-4 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),e("p",{class:"text-sm text-gray-600"},"Memuat editor...")])],-1))])])]),b.value?(r(),u("div",Ie,[e("div",Oe,[e("div",Se,[t[33]||(t[33]=e("h3",{class:"text-xl font-bold text-gray-900 mb-6 flex items-center"},[e("i",{class:"fas fa-share mr-2 text-blue-500"}),n(" Bagikan Dokumen ")],-1)),e("div",je,[m.value.length>0?(r(),u("div",Le,[(r(!0),u(z,null,F(m.value,(i,a)=>(r(),u("div",{key:i.id,class:"flex items-center justify-between p-3 bg-blue-50 rounded-xl border border-blue-200"},[e("div",Ue,[e("div",Ve,l(i.nama_lengkap),1),e("div",Ce,l(i.email),1),e("div",Te,l(i.divisi||"Tidak ada divisi")+" • "+l(i.jabatan||"Tidak ada jabatan"),1)]),e("div",Ae,[e("select",{value:O(i.id),onChange:k=>S(i.id,k.target.value),class:"px-3 py-1 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300 bg-white/50 backdrop-blur-sm"},t[29]||(t[29]=[e("option",{value:"view"},"View",-1),e("option",{value:"edit"},"Edit",-1),e("option",{value:"admin"},"Admin",-1)]),40,Me),e("button",{type:"button",onClick:k=>w(i),class:"p-1 text-red-500 hover:text-red-700 transition-colors"},t[30]||(t[30]=[e("i",{class:"fas fa-times"},null,-1)]),8,Pe)])]))),128))])):x("",!0),e("div",$e,[B(K,{placeholder:"Cari user berdasarkan nama, email, divisi, atau jabatan...","selected-users":m.value,multiple:!0,onUserSelected:I,onUserRemoved:w},null,8,["selected-users"])]),t[31]||(t[31]=e("div",{class:"text-xs text-gray-500 bg-gray-50 rounded-lg p-3"},[e("div",{class:"flex items-start"},[e("i",{class:"fas fa-info-circle text-blue-500 mt-0.5 mr-2"}),e("div",null,[e("p",{class:"font-medium mb-1"},"Tips pencarian:"),e("ul",{class:"space-y-1"},[e("li",null,"• Ketik nama lengkap user"),e("li",null,"• Ketik email user"),e("li",null,"• Ketik nama divisi"),e("li",null,"• Ketik nama jabatan")])])])],-1))]),e("div",ze,[e("button",{onClick:t[1]||(t[1]=i=>b.value=!1),class:"px-6 py-3 border border-gray-300 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-all duration-300"}," Batal "),e("button",{onClick:j,disabled:v(c).processing,class:"px-6 py-3 border border-transparent rounded-xl shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 disabled:opacity-50 transition-all duration-300 transform hover:scale-105"},[v(c).processing?(r(),u("i",Ge)):(r(),u("i",Ke)),t[32]||(t[32]=n(" Bagikan "))],8,Fe)])])])])):x("",!0)]),_:1}))}},st=N(Ne,[["__scopeId","data-v-f96044c7"]]);export{st as default};
