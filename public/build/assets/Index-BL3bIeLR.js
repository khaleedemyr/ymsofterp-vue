import{a8 as F,A as B,B as r,C as A,D as t,x as R,G as I,L as l,H as M,F as u,M as p,N as i,I as S,J as T,E as k,l as L,r as x,P}from"./vendor-vue-g7iCcTkf.js";import{A as N}from"./AppLayout-Cg9_BqdS.js";import{_ as O}from"./Modal-BBL5yay4.js";import{_ as U}from"./Pagination-DElM3wPU.js";import{f as V}from"./utils-aNKEQRww.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./app-CL3toCqm.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-DcALjTaB.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const j={components:{AppLayout:N,Modal:O,Pagination:U},props:{stockBalances:Object,outlets:Array,products:Array,filters:Object},setup(d){const e=x(!1),a=x(null),o=x([]),g=x([]),m=x(null),y=x(null),v=x(!1),D=P({outlet_id:d.filters.outlet_id||"",product_id:d.filters.product_id||"",search:d.filters.search||""});return{showImportModal:e,selectedFile:a,previewData:o,previewHeaders:g,importResults:m,fileInput:y,form:D,filter:()=>{D.get(route("outlet-stock-balances.index"),{preserveState:!0,preserveScroll:!0})},downloadTemplate:()=>{window.location.href=route("outlet-stock-balances.download-template")},handleFileUpload:c=>{a.value=c.target.files[0],o.value=[],g.value=[],m.value=null},previewImport:async()=>{var w,_,b,h;if(!a.value)return;const c=new FormData;c.append("file",a.value);try{const n=await axios.post(route("outlet-stock-balances.preview-import"),c);n.data.success?(o.value=n.data.preview,o.value.length>0&&(g.value=Object.keys(o.value[0]))):m.value={success:!1,message:n.data.message||"Preview failed",errors:n.data.errors||[]}}catch(n){m.value={success:!1,message:((_=(w=n.response)==null?void 0:w.data)==null?void 0:_.message)||"Preview failed",errors:((h=(b=n.response)==null?void 0:b.data)==null?void 0:h.errors)||[]},console.error("Preview failed:",n)}},processImport:async()=>{var w,_,b,h;if(!a.value)return;v.value=!0;const c=new FormData;c.append("file",a.value);try{const n=await axios.post(route("outlet-stock-balances.import"),c);m.value=n.data,n.data.success&&setTimeout(()=>{window.location.reload()},2e3)}catch(n){m.value={success:!1,message:((_=(w=n.response)==null?void 0:w.data)==null?void 0:_.message)||"Import failed",errors:((h=(b=n.response)==null?void 0:b.data)==null?void 0:h.errors)||[]}}finally{v.value=!1}},closeImportModal:()=>{e.value=!1,a.value=null,o.value=[],g.value=[],m.value=null,y.value&&(y.value.value="")},formatDate:V,importLoading:v}}},G={class:"py-12"},H={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},q={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},Q={class:"mb-6 flex justify-between items-center"},Y={class:"flex space-x-4"},z=["disabled"],J={key:0,class:"animate-spin mr-2"},W={key:1,class:"mr-2"},K={class:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4"},X=["value"],Z=["value"],$={class:"overflow-x-auto"},tt={class:"min-w-full divide-y divide-gray-200"},et={class:"bg-white divide-y divide-gray-200"},st={class:"px-6 py-4 whitespace-nowrap"},ot={class:"text-sm font-medium text-gray-900"},rt={class:"text-sm text-gray-500"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},it={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},at={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},nt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},dt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},mt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ut={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},pt=["onClick"],xt=["onClick"],ft={class:"mt-4"},gt={class:"p-6"},yt={class:"mb-4"},vt={key:0,class:"mb-4"},wt={class:"overflow-x-auto"},_t={class:"min-w-full divide-y divide-gray-200"},bt={class:"bg-gray-50"},ht={class:"bg-white divide-y divide-gray-200"},kt={key:1,class:"mb-4"},Dt={class:"flex"},It={class:"flex-shrink-0"},Ct={class:"ml-3"},Ft={key:0,class:"mt-3"},At={class:"bg-red-50 border border-red-200 rounded-md p-3"},Mt={class:"flex items-center mb-2"},Lt={class:"text-sm font-medium text-red-800"},Rt={class:"max-h-40 overflow-y-auto"},St={class:"space-y-2"},Bt={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 mr-2 flex-shrink-0"},Tt={class:"text-red-700"},Pt={class:"mt-6 flex justify-end space-x-3"},Nt=["disabled"],Ot={key:0},Ut={key:1};function Vt(d,e,a,o,g,m){const y=F("Pagination"),v=F("Modal"),D=F("AppLayout");return r(),B(D,{title:"Saldo Awal Stok Outlet"},{header:A(()=>e[13]||(e[13]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Saldo Awal Stok Outlet ",-1)])),default:A(()=>[t("div",G,[t("div",H,[t("div",q,[t("div",Q,[t("div",Y,[t("button",{onClick:e[0]||(e[0]=(...s)=>o.downloadTemplate&&o.downloadTemplate(...s)),class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700"},e[14]||(e[14]=[t("i",{class:"fas fa-download mr-2"},null,-1),I(" Download Template ")])),t("button",{onClick:e[1]||(e[1]=s=>o.showImportModal=!0),class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700"},e[15]||(e[15]=[t("i",{class:"fas fa-file-import mr-2"},null,-1),I(" Import Data ")]))]),t("button",{onClick:e[2]||(e[2]=(...s)=>d.reloadData&&d.reloadData(...s)),disabled:d.loadingReload,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md font-semibold hover:bg-blue-700"},[d.loadingReload?(r(),l("span",J,e[16]||(e[16]=[t("i",{class:"fas fa-spinner"},null,-1)]))):(r(),l("span",W,e[17]||(e[17]=[t("i",{class:"fas fa-sync-alt"},null,-1)]))),e[18]||(e[18]=I(" Load Data "))],8,z)]),t("div",K,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Outlet",-1)),M(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.filters.outlet_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",onChange:e[4]||(e[4]=(...s)=>o.filter&&o.filter(...s))},[e[19]||(e[19]=t("option",{value:""},"All Outlets",-1)),(r(!0),l(u,null,p(a.outlets,s=>(r(),l("option",{key:s.id_outlet,value:s.id_outlet},i(s.nama_outlet),9,X))),128))],544),[[S,a.filters.outlet_id]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700"},"Product",-1)),M(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.filters.product_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",onChange:e[6]||(e[6]=(...s)=>o.filter&&o.filter(...s))},[e[21]||(e[21]=t("option",{value:""},"All Products",-1)),(r(!0),l(u,null,p(a.products,s=>(r(),l("option",{key:s.id,value:s.id},i(s.name),9,Z))),128))],544),[[S,a.filters.product_id]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700"},"Search",-1)),M(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=s=>a.filters.search=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Search by product name or code...",onInput:e[8]||(e[8]=(...s)=>o.filter&&o.filter(...s))},null,544),[[T,a.filters.search]])])]),t("div",$,[t("table",tt,[e[24]||(e[24]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nama Barang"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Warehouse Outlet"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"QTY SMALL"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"QTY MEDIUM"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"QTY LARGE"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"TANGGAL UPDATE"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Created By"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",et,[(r(!0),l(u,null,p(a.stockBalances.data,s=>(r(),l("tr",{key:s.id},[t("td",st,[t("div",ot,i(s.product_name),1),t("div",rt,i(s.product_code),1)]),t("td",lt,i(s.nama_outlet),1),t("td",it,i(s.warehouse_outlet_id),1),t("td",at,i(Number(s.qty_small).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}))+" "+i(s.unit_name_small),1),t("td",nt,i(Number(s.qty_medium).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}))+" "+i(s.unit_name_medium),1),t("td",dt,i(Number(s.qty_large).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}))+" "+i(s.unit_name_large),1),t("td",mt,i(o.formatDate(s.updated_at)),1),t("td",ct,i(s.creator_name||"-"),1),t("td",ut,[t("button",{onClick:f=>d.editBalance(s),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,pt),t("button",{onClick:f=>d.deleteBalance(s),class:"text-red-600 hover:text-red-900"}," Delete ",8,xt)])]))),128))])])]),t("div",ft,[R(y,{links:a.stockBalances.links},null,8,["links"])])])])]),R(v,{show:o.showImportModal,onClose:o.closeImportModal},{default:A(()=>[t("div",gt,[e[29]||(e[29]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Import Stock Balance",-1)),t("div",yt,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select File",-1)),t("input",{type:"file",ref:"fileInput",onChange:e[9]||(e[9]=(...s)=>o.handleFileUpload&&o.handleFileUpload(...s)),accept:".xlsx,.xls",class:"mt-1 block w-full"},null,544)]),o.previewData.length>0?(r(),l("div",vt,[e[26]||(e[26]=t("h3",{class:"text-md font-medium text-gray-900 mb-2"},"Preview Data",-1)),t("div",wt,[t("table",_t,[t("thead",bt,[t("tr",null,[(r(!0),l(u,null,p(o.previewHeaders,s=>(r(),l("th",{key:s,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},i(s),1))),128))])]),t("tbody",ht,[(r(!0),l(u,null,p(o.previewData,(s,f)=>(r(),l("tr",{key:f},[(r(!0),l(u,null,p(o.previewHeaders,C=>(r(),l("td",{key:C,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},i(s[C]),1))),128))]))),128))])])])])):k("",!0),o.importResults?(r(),l("div",kt,[t("div",{class:L(["rounded-md p-4",o.importResults.success?"bg-green-50":"bg-red-50"])},[t("div",Dt,[t("div",It,[t("i",{class:L(o.importResults.success?"fas fa-check-circle text-green-400":"fas fa-exclamation-circle text-red-400")},null,2)]),t("div",Ct,[t("h3",{class:L(["text-sm font-medium",o.importResults.success?"text-green-800":"text-red-800"])},i(o.importResults.message),3),o.importResults.errors&&o.importResults.errors.length>0?(r(),l("div",Ft,[t("div",At,[t("div",Mt,[e[27]||(e[27]=t("i",{class:"fas fa-exclamation-triangle text-red-500 mr-2"},null,-1)),t("span",Lt,i(o.importResults.errors.length)+" error ditemukan: ",1)]),t("div",Rt,[t("ul",St,[(r(!0),l(u,null,p(o.importResults.errors,(s,f)=>(r(),l("li",{key:f,class:"flex items-start text-sm"},[t("span",Bt," Row "+i(s.row),1),t("span",Tt,i(s.error),1)]))),128))])])])])):k("",!0)])])],2)])):k("",!0),t("div",Pt,[t("button",{onClick:e[10]||(e[10]=(...s)=>o.closeImportModal&&o.closeImportModal(...s)),class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25"}," Cancel "),o.selectedFile&&!o.importResults?(r(),l("button",{key:0,onClick:e[11]||(e[11]=(...s)=>o.previewImport&&o.previewImport(...s)),class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700"}," Preview ")):k("",!0),o.selectedFile&&!o.importResults?(r(),l("button",{key:1,onClick:e[12]||(e[12]=(...s)=>o.processImport&&o.processImport(...s)),class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700",disabled:o.importLoading},[o.importLoading?(r(),l("span",Ot,e[28]||(e[28]=[t("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),I(" Importing... ")]))):(r(),l("span",Ut," Import "))],8,Nt)):k("",!0)])])]),_:1},8,["show","onClose"])]),_:1})}const se=E(j,[["render",Vt]]);export{se as default};
