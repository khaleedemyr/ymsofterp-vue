import{$ as z,c,r as p,w as B,a as H,A as R,B as r,C as G,D as a,L as o,E as L,H as v,J as N,F as S,M as D,N as s,I as q,x as J,Q as X,G as I,l as M,W as Y}from"./vendor-vue-g7iCcTkf.js";import{A as Z}from"./AppLayout-BfEUsI4L.js";import{s as ee}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./app-DIuSMidk.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-CG_QM0dl.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const ae={class:"max-w-7xl mx-auto py-8 px-4"},le={class:"flex flex-wrap gap-3 mb-4 items-center"},se={class:"flex items-center gap-2"},re=["disabled"],oe=["value"],ne={class:"flex items-center gap-2"},ue=["value"],ie={class:"flex items-center gap-2"},de={class:"flex items-center gap-2"},pe=["value"],ce={class:"flex items-center gap-2"},me=["disabled"],ge={key:0,class:"animate-spin mr-2"},xe={key:1,class:"mr-2"},ve={key:0,class:"bg-red-50 border-l-4 border-red-400 text-red-800 p-4 rounded my-8 text-center font-semibold"},fe={key:1,class:"bg-blue-50 border-l-4 border-blue-400 text-blue-800 p-4 rounded my-8 text-center font-semibold"},be={class:"bg-white rounded-xl shadow-lg overflow-hidden"},ye={class:"overflow-x-auto"},_e={class:"min-w-full divide-y divide-gray-200"},he={class:"bg-white divide-y divide-gray-200"},ke={key:0},we={class:"px-6 py-4 whitespace-nowrap text-sm"},Se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700"},Ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700"},$e={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},De={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},Oe={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},Ve={class:"px-6 py-4 whitespace-nowrap text-sm"},Le={class:"px-6 py-4 whitespace-nowrap text-sm"},Ne={key:0,class:"flex justify-between items-center mt-4"},qe={class:"text-sm text-gray-600"},Ie={class:"flex gap-1"},Me=["disabled"],Ae={class:"px-2"},Ue=["disabled"],We={key:3,class:"bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 p-4 rounded my-8 text-center font-semibold"},Be={__name:"StockCard",props:{cards:Array,outlets:Array,items:Array,warehouse_outlets:Array,saldo_awal:Object,error:String,user_outlet_id:Number},setup(f){const b=f,P=z(),y=c(()=>{var l,e;return((e=(l=P.props.auth)==null?void 0:l.user)==null?void 0:e.id_outlet)||""}),_=p(""),m=p(25),n=p(1),u=p(""),i=p(""),g=p(""),h=p(!1),k=p(""),w=p(""),O=c(()=>String(y.value)==="1"),Q=c(()=>{let l=b.warehouse_outlets;return!O.value&&y.value&&(l=l.filter(e=>String(e.outlet_id)===String(y.value))),u.value&&(l=l.filter(e=>String(e.outlet_id)===String(u.value))),l});B(u,l=>{g.value=""}),H(()=>{!O.value&&y.value&&(u.value=String(y.value))});const x=c(()=>{let l=b.cards;if(u.value&&(l=l.filter(t=>{var $;return String(t.outlet_name)===String(($=b.outlets.find(K=>K.id==u.value))==null?void 0:$.name)})),g.value&&(l=l.filter(t=>String(t.warehouse_outlet_id)===String(g.value))),i.value&&(l=l.filter(t=>t.item_name===i.value.name)),k.value&&(l=l.filter(t=>new Date(t.date)>=new Date(k.value))),w.value&&(l=l.filter(t=>new Date(t.date)<=new Date(w.value))),!_.value)return l;const e=_.value.toLowerCase();return l.filter(t=>t.item_name&&t.item_name.toLowerCase().includes(e)||t.outlet_name&&t.outlet_name.toLowerCase().includes(e)||t.reference_type&&t.reference_type.toLowerCase().includes(e)||t.description&&t.description.toLowerCase().includes(e))}),C=c(()=>Math.ceil(x.value.length/m.value)||1),V=c(()=>(n.value-1)*m.value),A=c(()=>Math.min(V.value+m.value,x.value.length)),U=c(()=>x.value.slice(V.value,A.value));function T(){n.value>1&&n.value--}function E(){n.value<C.value&&n.value++}B([m,_],()=>{n.value=1});function d(l){return l==null?0:Number(l)%1===0?Number(l):Number(l).toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:2})}function W(l,e=null){return e==="in"?`${d(l.in_qty_small)} ${l.small_unit_name||""} | ${d(l.in_qty_medium)} ${l.medium_unit_name||""} | ${d(l.in_qty_large)} ${l.large_unit_name||""}`:e==="out"?`${d(l.out_qty_small)} ${l.small_unit_name||""} | ${d(l.out_qty_medium)} ${l.medium_unit_name||""} | ${d(l.out_qty_large)} ${l.large_unit_name||""}`:"-"}function F(l){return`${d(l.saldo_qty_small)} ${l.small_unit_name||""} | ${d(l.saldo_qty_medium)} ${l.medium_unit_name||""} | ${d(l.saldo_qty_large)} ${l.large_unit_name||""}`}function j(){var e;if(!i.value){alert("Silakan pilih barang terlebih dahulu!");return}h.value=!0;const l={item_id:((e=i.value)==null?void 0:e.id)||"",outlet_id:u.value||"",warehouse_outlet_id:g.value||"",from:k.value||"",to:w.value||""};Object.keys(l).forEach(t=>{l[t]||delete l[t]}),Y.get("/outlet-inventory/stock-card",l,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{h.value=!1},onError:t=>{h.value=!1,console.error("Error loading data:",t)}})}return(l,e)=>(r(),R(Z,null,{default:G(()=>[a("div",ae,[e[23]||(e[23]=a("h1",{class:"text-2xl font-bold mb-6"},"Kartu Stok Outlet (Stock Card)",-1)),a("div",le,[v(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),type:"text",placeholder:"Cari barang, outlet, referensi, keterangan...",class:"px-4 py-2 border border-gray-300 rounded-lg w-full md:w-64 focus:ring-blue-500 focus:border-blue-500"},null,512),[[N,_.value]]),a("div",se,[e[8]||(e[8]=a("label",{class:"text-sm"},"Outlet",-1)),v(a("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500",disabled:!O.value},[e[7]||(e[7]=a("option",{value:""},"Semua Outlet",-1)),(r(!0),o(S,null,D(f.outlets,t=>(r(),o("option",{key:t.id,value:t.id},s(t.name),9,oe))),128))],8,re),[[q,u.value]])]),a("div",ne,[e[10]||(e[10]=a("label",{class:"text-sm"},"Warehouse Outlet",-1)),v(a("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>g.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[e[9]||(e[9]=a("option",{value:""},"Semua Warehouse",-1)),(r(!0),o(S,null,D(Q.value,t=>(r(),o("option",{key:t.id,value:t.id},s(t.name),9,ue))),128))],512),[[q,g.value]])]),a("div",ie,[e[11]||(e[11]=a("label",{class:"text-sm"},"Barang",-1)),J(X(ee),{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value=t),options:f.items,searchable:!0,"close-on-select":!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih atau cari barang...","track-by":"name",label:"name","preselect-first":!1,class:"w-64"},null,8,["modelValue","options"])]),a("div",de,[e[12]||(e[12]=a("label",{class:"text-sm"},"Tampilkan",-1)),v(a("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>m.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[(r(),o(S,null,D([10,25,50,100],t=>a("option",{key:t,value:t},s(t),9,pe)),64))],512),[[q,m.value]]),e[13]||(e[13]=a("span",{class:"text-sm"},"data",-1))]),a("div",ce,[e[14]||(e[14]=a("label",{class:"text-sm"},"Periode",-1)),v(a("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=t=>k.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[N,k.value]]),e[15]||(e[15]=a("span",null,"-",-1)),v(a("input",{type:"date","onUpdate:modelValue":e[6]||(e[6]=t=>w.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[N,w.value]])]),a("button",{onClick:j,disabled:h.value,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md font-semibold hover:bg-blue-700"},[h.value?(r(),o("span",ge,e[16]||(e[16]=[a("i",{class:"fas fa-spinner"},null,-1)]))):(r(),o("span",xe,e[17]||(e[17]=[a("i",{class:"fas fa-sync-alt"},null,-1)]))),e[18]||(e[18]=I(" Load Data "))],8,me)]),b.error?(r(),o("div",ve,s(b.error),1)):i.value?i.value&&f.cards.length>0?(r(),o(S,{key:2},[a("div",be,[a("div",ye,[a("table",_e,[e[21]||(e[21]=a("thead",{class:"bg-gray-50 sticky top-0 z-10"},[a("tr",null,[a("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Tanggal"),a("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Outlet"),a("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Warehouse Outlet"),a("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Masuk (Qty)"),a("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Keluar (Qty)"),a("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Saldo (Qty)"),a("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Referensi"),a("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Keterangan")])],-1)),a("tbody",he,[x.value.length?L("",!0):(r(),o("tr",ke,e[20]||(e[20]=[a("td",{colspan:"7",class:"text-center py-10 text-gray-400"},"Tidak ada data kartu stok.",-1)]))),(r(!0),o(S,null,D(U.value,(t,$)=>(r(),o("tr",{key:t.id,class:M(["hover:bg-gray-50 transition",$===U.value.length-1?"bg-yellow-200 font-bold":""])},[a("td",we,s(t.date?new Date(t.date).toLocaleDateString("id-ID"):"-"),1),a("td",Se,s(t.outlet_name),1),a("td",Ce,s(t.warehouse_outlet_name||"-"),1),a("td",$e,s(W(t,"in")),1),a("td",De,s(W(t,"out")),1),a("td",Oe,s(F(t)),1),a("td",Ve,s(t.reference_type?t.reference_type+(t.reference_id?" #"+t.reference_id:""):"-"),1),a("td",Le,s(t.description||"-"),1)],2))),128))])])])]),x.value.length?(r(),o("div",Ne,[a("div",qe," Menampilkan "+s(V.value+1)+" - "+s(A.value)+" dari "+s(x.value.length)+" data ",1),a("div",Ie,[a("button",{onClick:T,disabled:n.value===1,class:M(["px-3 py-1 rounded border text-sm",n.value===1?"bg-gray-200 text-gray-400":"bg-white text-blue-700 hover:bg-blue-50"])},"<",10,Me),a("span",Ae,"Halaman "+s(n.value)+" / "+s(C.value),1),a("button",{onClick:E,disabled:n.value===C.value,class:M(["px-3 py-1 rounded border text-sm",n.value===C.value?"bg-gray-200 text-gray-400":"bg-white text-blue-700 hover:bg-blue-50"])},">",10,Ue)])])):L("",!0)],64)):i.value&&f.cards.length===0?(r(),o("div",We,e[22]||(e[22]=[a("i",{class:"fas fa-exclamation-triangle mr-2"},null,-1),I(" Tidak ada data kartu stok untuk item yang dipilih. Coba ubah filter outlet, warehouse outlet, atau periode tanggal. ")]))):L("",!0):(r(),o("div",fe,e[19]||(e[19]=[a("i",{class:"fas fa-info-circle mr-2"},null,-1),I(' Silakan pilih outlet, warehouse outlet, barang, dan periode tanggal, kemudian klik tombol "Load Data" untuk melihat kartu stok. ')])))])]),_:1}))}},Xe=te(Be,[["__scopeId","data-v-dc0ff73a"]]);export{Xe as default};
