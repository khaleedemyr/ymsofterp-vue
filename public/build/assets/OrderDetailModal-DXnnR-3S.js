import{c as p,L as i,B as a,D as r,N as l,E as d,F as u,M as f,O as L}from"./vendor-vue-g7iCcTkf.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";const F={class:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col relative animate-fadeIn overflow-hidden"},E={class:"bg-gradient-to-r from-slate-700 to-slate-800 text-white px-6 py-4 flex items-center justify-between shrink-0"},V={class:"text-slate-300 text-sm mt-0.5"},K={class:"overflow-y-auto flex-1 p-6 space-y-5"},R={class:"bg-slate-50 rounded-xl p-4"},z={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm"},T={class:"text-slate-500"},q={class:"text-slate-800 font-medium text-right"},J={key:0,class:"bg-violet-50 rounded-xl p-4"},U={class:"space-y-1.5"},W={class:"font-medium text-slate-700"},G={class:"font-semibold text-violet-800"},H={key:1,class:"bg-amber-50 rounded-xl p-4"},Q={class:"flex justify-between text-sm"},X={class:"font-semibold text-amber-900"},Y={key:0,class:"mt-1.5 text-sm text-slate-600"},Z={key:2,class:"bg-emerald-50 rounded-xl p-4"},tt={class:"text-lg font-bold text-emerald-900"},et={key:0,class:"mt-2 text-sm text-slate-700"},rt={class:"list-disc pl-5 space-y-0.5"},st={key:1,class:"mt-2 space-y-1 text-sm"},ot={class:"font-medium"},nt={key:3,class:"bg-sky-50 rounded-xl p-4"},it={class:"overflow-x-auto rounded-lg border border-sky-200 bg-white"},at={class:"min-w-full text-sm"},lt={class:"px-3 py-2"},dt={class:"px-3 py-2"},ut={class:"font-medium text-slate-800"},ct={key:0,class:"mt-1 space-y-1"},mt={key:1,class:"mt-1 text-xs text-amber-700"},ft={class:"px-3 py-2 text-right"},xt={class:"px-3 py-2 text-right"},pt={class:"px-3 py-2 text-right font-medium"},bt={key:4,class:"bg-blue-50 rounded-xl p-4"},yt={class:"flex flex-wrap gap-2"},gt={class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-100 text-blue-900 font-medium text-sm"},ht={key:0,class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-200/70 text-blue-900 text-sm"},_t={key:1,class:"text-slate-600 text-sm"},kt={__name:"OrderDetailModal",props:{order:{type:Object,required:!0}},setup(n){const b=n,P=["nomor","paid_number","nama_outlet","kode_outlet","table","cashier","waiters","mode","pax","created_at","total","discount","service","grand_total","status","member_name"];function M(t){return{created_at:"Waktu",waiters:"Waiter",mode:"Mode",nomor:"No. Order",paid_number:"Paid Number",table:"Meja",pax:"Pax",total:"Subtotal",discount:"Diskon",cashback:"Cashback",dpp:"DPP",pb1:"PB1",service:"Service",grand_total:"Grand Total",status:"Status",kode_outlet:"Kode Outlet",nama_outlet:"Nama Outlet",cashier:"Kasir",member_name:"Member"}[t]||t.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase())}function j(t,e){return t.match(/total|discount|cashback|service|pb1|grand|dpp|rounding/i)&&typeof e=="number"?e.toLocaleString("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}):t==="created_at"?e?new Date(e).toLocaleString("id-ID"):"-":e===""||e==null?"-":e}function m(t){if(typeof t=="number")return t.toLocaleString("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0});if(t==null||t==="")return"-";const e=Number(t);return isNaN(e)?String(t):e.toLocaleString("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0})}function A(t){const e=Number(t.amount)||0,s=Number(t.change)||0;return e-s}function k(t){const e=t==null?void 0:t.notes;if(e==null)return"";const s=String(e).trim();return!s||s.toLowerCase()==="null"?"":s}function w(t){if(Array.isArray(t==null?void 0:t.modifiers_formatted)&&t.modifiers_formatted.length)return t.modifiers_formatted.map(o=>String(o??"").trim()).filter(Boolean);const e=t==null?void 0:t.modifiers;if(e==null)return[];if(Array.isArray(e))return e.map(o=>x(o)).filter(Boolean);const s=String(e).trim();if(!s||s.toLowerCase()==="null")return[];try{const o=JSON.parse(s);if(Array.isArray(o))return o.map(c=>x(c)).filter(Boolean);if(o&&typeof o=="object"){const c=[];return Object.entries(o).forEach(([h,_])=>{if(Array.isArray(_)){_.forEach($=>{const N=x($);N&&c.push(`${h}: ${N}`)});return}const S=x(_);c.push(S?`${h}: ${S}`:h)}),c.filter(Boolean)}const y=x(o);return y?[y]:[]}catch{return[s]}}function x(t){return t==null?"":typeof t=="string"?t.trim():typeof t=="number"||typeof t=="boolean"?String(t):typeof t=="object"?t.name?String(t.name):t.label?String(t.label):t.option_name?String(t.option_name):t.option?String(t.option):t.title?String(t.title):Object.values(t).map(e=>e==null?"":String(e).trim()).filter(Boolean).join(" - "):""}function O(t){return!t||typeof t!="object"?!0:!t.name&&!t.code&&t.id==null&&t.value==null}const I=p(()=>{const t=b.order.manual_discount_amount;return t!=null&&String(t).replace(/\D/g,"")!==""&&Number(t)>0}),v=p(()=>parseFloat(b.order.discount)||0),B=p(()=>v.value>0),D=p(()=>{var s;const t=(g.value||[]).map(o=>String((o==null?void 0:o.promo_name)??"").trim()).filter(Boolean),e=(((s=b.order)==null?void 0:s.promo_names)||[]).map(o=>String(o??"").trim()).filter(Boolean);return Array.from(new Set([...t,...e]))}),g=p(()=>{const t=b.order.promo_discount_info;if(!t||typeof t!="string")return[];const e=t.trim();if(!e||e[0]!=="{"&&e[0]!=="[")return[];try{const s=JSON.parse(t);if(s&&Array.isArray(s.promos))return s.promos.map(o=>({promo_name:o.promo_name||o.name||"Promo",discount_amount:o.discount_amount??o.amount??0}))}catch{return[]}return[]});return(t,e)=>(a(),i("div",{class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e[1]||(e[1]=L(s=>t.$emit("close"),["self"]))},[r("div",F,[r("div",E,[r("div",null,[e[2]||(e[2]=r("h2",{class:"text-lg font-bold"},"Detail Order",-1)),r("p",V,l(n.order.nomor)+l(n.order.paid_number?` · ${n.order.paid_number}`:""),1)]),r("button",{type:"button",onClick:e[0]||(e[0]=s=>t.$emit("close")),class:"p-2 rounded-lg text-slate-300 hover:bg-white/10 hover:text-white transition","aria-label":"Tutup"},e[3]||(e[3]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),r("div",K,[r("section",R,[e[4]||(e[4]=r("h3",{class:"text-sm font-semibold text-slate-600 uppercase tracking-wide mb-3"},"Info Transaksi",-1)),r("div",z,[(a(),i(u,null,f(P,s=>(a(),i(u,{key:s},[n.order[s]!==void 0&&n.order[s]!==null?(a(),i(u,{key:0},[r("span",T,l(M(s)),1),r("span",q,l(j(s,n.order[s])),1)],64)):d("",!0)],64))),64))])]),n.order.payments&&n.order.payments.length?(a(),i("section",J,[e[5]||(e[5]=r("h3",{class:"text-sm font-semibold text-violet-700 uppercase tracking-wide mb-2"},"Pembayaran",-1)),r("div",U,[(a(!0),i(u,null,f(n.order.payments,(s,o)=>(a(),i("div",{key:o,class:"flex justify-between items-center text-sm bg-white/60 rounded-lg px-3 py-2"},[r("span",W,l(s.payment_code||s.payment_type||"Payment"),1),r("span",G,l(m(A(s))),1)]))),128))])])):d("",!0),I.value?(a(),i("section",H,[e[7]||(e[7]=r("div",{class:"flex items-center justify-between mb-2"},[r("h3",{class:"text-sm font-semibold text-amber-800 uppercase tracking-wide"},"Diskon Manual"),r("span",{class:"inline-flex items-center px-2.5 py-1 rounded-full text-[11px] font-semibold bg-amber-200 text-amber-900"},"MANUAL")],-1)),r("div",Q,[e[6]||(e[6]=r("span",{class:"text-slate-600"},"Nominal",-1)),r("span",X,l(m(n.order.manual_discount_amount)),1)]),n.order.manual_discount_reason?(a(),i("div",Y," Alasan: "+l(n.order.manual_discount_reason),1)):d("",!0)])):d("",!0),B.value?(a(),i("section",Z,[e[9]||(e[9]=r("div",{class:"flex items-center justify-between mb-1"},[r("h3",{class:"text-sm font-semibold text-emerald-800 uppercase tracking-wide"},"Diskon Promo"),r("span",{class:"inline-flex items-center px-2.5 py-1 rounded-full text-[11px] font-semibold bg-emerald-200 text-emerald-900"},"PROMO")],-1)),r("p",tt,l(m(v.value)),1),D.value.length?(a(),i("div",et,[e[8]||(e[8]=r("div",{class:"font-medium mb-1"},"Promo:",-1)),r("ul",rt,[(a(!0),i(u,null,f(D.value,(s,o)=>(a(),i("li",{key:`promo-name-${o}`},l(s),1))),128))])])):d("",!0),g.value.length?(a(),i("div",st,[(a(!0),i(u,null,f(g.value,(s,o)=>(a(),i("div",{key:o,class:"flex justify-between text-slate-700"},[r("span",null,l(s.promo_name),1),r("span",ot,l(m(s.discount_amount)),1)]))),128))])):d("",!0)])):d("",!0),n.order.items&&n.order.items.length?(a(),i("section",nt,[e[11]||(e[11]=r("h3",{class:"text-sm font-semibold text-sky-800 uppercase tracking-wide mb-3"},"Item Pesanan",-1)),r("div",it,[r("table",at,[e[10]||(e[10]=r("thead",null,[r("tr",{class:"bg-sky-100 text-sky-900"},[r("th",{class:"px-3 py-2.5 text-left font-semibold"},"No"),r("th",{class:"px-3 py-2.5 text-left font-semibold"},"Nama Item"),r("th",{class:"px-3 py-2.5 text-right font-semibold"},"Qty"),r("th",{class:"px-3 py-2.5 text-right font-semibold"},"Harga"),r("th",{class:"px-3 py-2.5 text-right font-semibold"},"Subtotal")])],-1)),r("tbody",null,[(a(!0),i(u,null,f(n.order.items,(s,o)=>(a(),i("tr",{key:s.id||o,class:"border-t border-sky-100 hover:bg-sky-50/50"},[r("td",lt,l(o+1),1),r("td",dt,[r("div",ut,l(s.item_name||"-"),1),w(s).length?(a(),i("div",ct,[(a(!0),i(u,null,f(w(s),(y,c)=>(a(),i("div",{key:`mod-${o}-${c}`,class:"text-xs text-slate-600"}," • Modifier: "+l(y),1))),128))])):d("",!0),k(s)?(a(),i("div",mt," • Notes: "+l(k(s)),1)):d("",!0)]),r("td",ft,l(s.qty??0),1),r("td",xt,l(m(s.price??0)),1),r("td",pt,l(m(s.subtotal??0)),1)]))),128))])])])])):d("",!0),n.order.promo&&!O(n.order.promo)?(a(),i("section",bt,[e[12]||(e[12]=r("h3",{class:"text-sm font-semibold text-blue-800 uppercase tracking-wide mb-2"},"Promo Diterapkan",-1)),r("div",yt,[r("span",gt,l(n.order.promo.name||n.order.promo.code||"Promo"),1),n.order.promo.code?(a(),i("span",ht,l(n.order.promo.code),1)):d("",!0),n.order.promo.type?(a(),i("span",_t,l(n.order.promo.type)+" "+l(n.order.promo.value!=null?`· ${n.order.promo.value}`:""),1)):d("",!0)])])):d("",!0)])])]))}},St=C(kt,[["__scopeId","data-v-2b4d3b7b"]]);export{St as default};
