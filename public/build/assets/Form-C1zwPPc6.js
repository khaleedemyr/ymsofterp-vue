import{c as nt,P as Ct,r as D,w as M,a as it,j as St,A as ut,B as n,C as At,D as l,G as dt,L as i,O as mt,E as c,H as f,Q as u,J as I,N as m,F as y,M as b,I as T,l as _t,Z as E,T as $t,Y as Tt,W as B,n as ct}from"./vendor-vue-g7iCcTkf.js";import{A as Bt}from"./AppLayout-Cke2dYBX.js";import{S as g}from"./app-AaUk6aDd.js";import{a as K}from"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DtjcyHN1.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const Nt={class:"max-w-5xl w-full mx-auto py-8 px-2"},jt={class:"flex items-center gap-2 mb-6"},Ut={class:"text-2xl font-bold text-gray-800 flex items-center gap-2 ml-4"},Vt={key:0},Mt={key:1},Et={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ft={key:0,class:"text-xs text-red-500 mt-1"},Ot=["disabled"],Pt=["value"],Lt={key:0,class:"text-xs text-red-500 mt-1"},Kt=["disabled"],Gt=["value"],Wt={key:0,class:"text-xs text-red-500 mt-1"},Ht=["value"],zt={key:0,class:"text-xs text-red-500 mt-1"},Qt=["disabled"],Rt=["value"],Yt={key:0,class:"text-xs text-red-500 mt-1"},Jt={key:0,class:"text-xs text-red-500 mt-1"},Xt={key:0,class:"bg-white rounded-xl border border-gray-200 p-4"},Zt={class:"mb-4"},te={class:"relative"},ee={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},oe=["onClick"],se={class:"font-medium"},le={class:"text-sm text-gray-600"},re={key:0,class:"text-xs text-blue-600 font-medium"},ae={key:0,class:"space-y-2"},ne={key:0,class:"flex items-center justify-between p-3 rounded-md bg-gray-50 border border-gray-200"},ie={class:"flex items-center space-x-3"},ue={class:"flex items-center space-x-2"},de=["onClick"],me=["onClick"],_e={class:"flex items-center space-x-2"},ce={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},pe={class:"font-medium"},fe={class:"text-sm text-gray-600"},ge={key:0,class:"text-xs text-blue-600 font-medium"},he=["onClick"],ye={key:0,class:"text-red-600 text-sm mb-2"},be={class:"w-full min-w-full divide-y divide-gray-200"},ve={class:"px-3 py-2 min-w-[260px]"},ke={class:"relative"},xe=["id","onUpdate:modelValue","onInput","onFocus","onBlur","onKeydown"],we=["id"],De=["id","onMousedown"],Ie={class:"font-medium"},qe={class:"text-xs text-gray-500"},Ce={class:"text-sm text-gray-600"},Se={key:0,class:"absolute right-2 top-2"},Ae={key:1,class:"text-xs text-yellow-600 mt-1"},$e={key:2,class:"text-xs text-gray-500 mt-1"},Te={key:0,class:"text-xs text-red-500 mt-1"},Be={class:"px-3 py-2 min-w-[100px]"},Ne=["onUpdate:modelValue"],je={key:0,class:"text-xs text-red-500 mt-1"},Ue={class:"px-3 py-2 min-w-[100px]"},Ve=["onUpdate:modelValue","onChange"],Me=["value"],Ee=["onUpdate:modelValue"],Fe={key:2,class:"text-xs text-red-500 mt-1"},Oe={class:"px-3 py-2 min-w-[120px]"},Pe=["onUpdate:modelValue"],Le={class:"px-3 py-2"},Ke=["onClick","disabled"],Ge=["disabled"],We={class:"flex justify-end gap-2"},He=["disabled"],so={__name:"Form",props:{outlets_from:Array,outlets_to:Array,warehouse_outlets_from:Array,warehouse_outlets_to:Array,user_outlet_id:Number,items:Array,editData:Object},setup(N){var J,X,Z,tt,et,ot,st,lt;const _=N,q=nt(()=>!!_.editData),o=Ct({transfer_date:((J=_.editData)==null?void 0:J.transfer_date)||"",outlet_from_id:((X=_.editData)==null?void 0:X.outlet_from_id)||"",warehouse_outlet_from_id:((Z=_.editData)==null?void 0:Z.warehouse_outlet_from_id)||"",outlet_to_id:((tt=_.editData)==null?void 0:tt.outlet_to_id)||"",warehouse_outlet_to_id:((et=_.editData)==null?void 0:et.warehouse_outlet_to_id)||"",notes:((ot=_.editData)==null?void 0:ot.notes)||"",approvers:[],items:(lt=(st=_.editData)==null?void 0:st.items)!=null&&lt.length?JSON.parse(JSON.stringify(_.editData.items)):[{item_id:"",item_name:"",qty:"",unit:"",note:"",suggestions:[],showDropdown:!1,loading:!1,highlightedIndex:-1,available_units:[],selected_unit:"",_rowKey:Date.now()+"-"+Math.random()}]}),k=D(""),v=D([]),x=D(!1),F=D(null);async function G(s=""){if(!s||s.length<2){v.value=[],x.value=!1;return}try{const t=await K.get(route("outlet-transfer.approvers"),{params:{search:s},headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});t.data&&t.data.success?(v.value=t.data.users||[],x.value=v.value.length>0):(v.value=[],x.value=!1)}catch(t){console.error("Failed to load approvers:",t),v.value=[],x.value=!1}}function pt(){F.value&&clearTimeout(F.value),F.value=setTimeout(()=>{k.value.length>=2?G(k.value):(v.value=[],x.value=!1)},300)}function ft(s){!s||!s.id||(o.approvers.find(t=>t&&t.id===s.id)||o.approvers.push(s),k.value="",x.value=!1)}function gt(s){o.approvers.splice(s,1)}function W(s,t){const e=o.approvers.splice(s,1)[0];o.approvers.splice(t,0,e)}const j=D([]),U=D([]);M(()=>o.outlet_from_id,s=>{s?j.value=_.warehouse_outlets_from.filter(t=>t.outlet_id==s):j.value=[],o.warehouse_outlet_from_id=""}),M(()=>o.outlet_to_id,s=>{s?U.value=_.warehouse_outlets_to.filter(t=>t.outlet_id==s):U.value=[],o.warehouse_outlet_to_id=""}),it(()=>{_.user_outlet_id&&_.user_outlet_id!==1&&(o.outlet_from_id=_.user_outlet_id),_.editData&&(_.editData.outlet_from_id&&(j.value=_.warehouse_outlets_from.filter(s=>s.outlet_id==_.editData.outlet_from_id)),_.editData.outlet_to_id&&(U.value=_.warehouse_outlets_to.filter(s=>s.outlet_id==_.editData.outlet_to_id)))});const C=D([]);M(()=>o.items.length,s=>{Array.isArray(C.value)||(C.value=[]),C.value.length=s});function ht(){o.items.push({item_id:"",item_name:"",qty:"",unit:"",note:"",suggestions:[],showDropdown:!1,loading:!1,highlightedIndex:-1,available_units:[],selected_unit:"",_rowKey:Date.now()+"-"+Math.random()}),ct(()=>{setTimeout(()=>{const s=o.items.length-1;C.value[s]&&C.value[s].focus()},0)})}function yt(s){o.items.length!==1&&o.items.splice(s,1)}function bt(){var s,t,e,a,r,p,S,A;if(!q.value&&(o.approvers||[]).filter(d=>d&&d.id).map(d=>d.id).length===0){g.fire({icon:"error",title:"Gagal!",text:"Pilih minimal 1 approver sebelum menyimpan."});return}for(const[$,d]of o.items.entries()){console.log("DEBUG VALIDASI QTY",{item:d,stock:d.stock,qty:d.qty,unit:d.selected_unit||d.unit});const rt=Number(d.qty||0);let h=0;const w=d.selected_unit||d.unit;if(w===((s=d.stock)==null?void 0:s.unit_small))h=Number(((t=d.stock)==null?void 0:t.qty_small)||0);else if(w===((e=d.stock)==null?void 0:e.unit_medium))h=Number(((a=d.stock)==null?void 0:a.qty_medium)||0);else if(w===((r=d.stock)==null?void 0:r.unit_large))h=Number(((p=d.stock)==null?void 0:p.qty_large)||0);else if((S=d.stock)!=null&&S.qty_small&&((A=d.stock)!=null&&A.unit_small)){const L=Number(d.stock.qty_small||0),at=Number(d.stock.small_conversion_qty||1),qt=Number(d.stock.medium_conversion_qty||1);w===d.stock.unit_medium?h=Math.floor(L/at):w===d.stock.unit_large?h=Math.floor(L/(at*qt)):h=L}else h=0;if(console.log("Stock validation:",{unit:w,stock:h,qty:rt,item_stock:d.stock}),rt>h){g.fire({icon:"error",title:"Gagal!",text:`Qty item "${d.item_name}" melebihi stok di gudang asal untuk unit ${w} (${h})`});return}}if(g.fire({title:q.value?"Menyimpan Perubahan...":"Menyimpan Data...",text:"Mohon tunggu sebentar",allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{g.showLoading()}}),q.value)o.put(`/outlet-transfer/${_.editData.id}`,{onSuccess:()=>{g.fire({icon:"success",title:"Berhasil!",text:"Data berhasil diupdate",timer:1500,showConfirmButton:!1}).then(()=>{B.visit("/outlet-transfer")})},onError:()=>{g.fire({icon:"error",title:"Gagal!",text:"Terjadi kesalahan saat update data"})}});else{const $=(o.approvers||[]).filter(d=>d&&d.id).map(d=>d.id);o.transform(d=>({...d,approvers:$})),o.post("/outlet-transfer",{onSuccess:()=>{g.fire({icon:"success",title:"Berhasil!",text:"Data berhasil disimpan",timer:1500,showConfirmButton:!1}).then(()=>{B.visit("/outlet-transfer")})},onError:()=>{g.fire({icon:"error",title:"Gagal!",text:"Terjadi kesalahan saat menyimpan data"})}})}}function vt(){g.fire({title:"Hapus Data?",text:"Data transfer dan mutasi stok akan dihapus. Lanjutkan?",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&B.delete(`/outlet-transfer/${_.editData.id}`,{onSuccess:()=>{g.fire({icon:"success",title:"Berhasil!",text:"Data berhasil dihapus",timer:1500,showConfirmButton:!1}).then(()=>{B.visit("/outlet-transfer")})},onError:()=>{g.fire({icon:"error",title:"Gagal!",text:"Terjadi kesalahan saat menghapus data"})}})})}function H(){B.visit("/outlet-transfer")}async function kt(s,t){if(console.log("fetchItemSuggestions called",{idx:s,q:t,warehouse_outlet:o.warehouse_outlet_from_id}),!t||t.length<2||!o.warehouse_outlet_from_id){o.items[s].suggestions=[],o.items[s].highlightedIndex=-1;return}o.items[s].loading=!0;try{const e=await K.get("/items/search-for-outlet-transfer",{params:{q:t,warehouse_outlet_id:o.warehouse_outlet_from_id}});console.log("API response:",e.data);let a=Array.isArray(e.data)?e.data:[];o.items[s].suggestions=a.map(r=>({...r,available_units:[r.unit_small,r.unit_medium,r.unit_large].filter(Boolean),unit_small:r.unit_small,unit_medium:r.unit_medium,unit_large:r.unit_large,small_unit_id:r.small_unit_id,medium_unit_id:r.medium_unit_id,large_unit_id:r.large_unit_id})),o.items[s].showDropdown=!0,o.items[s].highlightedIndex=0,console.log("Suggestions:",o.items[s].suggestions)}catch(e){console.error("Error fetching suggestions:",e),o.items[s].suggestions=[],o.items[s].highlightedIndex=-1}finally{o.items[s].loading=!1}}async function z(s){const t=o.items[s];if(!(!t.item_id||!o.warehouse_outlet_from_id))try{const e=await K.get("/api/outlet-inventory/stock",{params:{item_id:t.item_id,warehouse_outlet_id:o.warehouse_outlet_from_id}});if(t.stock=e.data,console.log("Fetched stock data:",t.stock),t.stock&&t.stock.qty_small!=null&&t.stock.medium_conversion_qty&&t.stock.small_conversion_qty){const a=Number(t.stock.qty_small||0),r=Number(t.stock.small_conversion_qty||1),p=Number(t.stock.medium_conversion_qty||1),S=Math.floor(a/(r*p)),A=a%(r*p),$=Math.floor(A/r),d=A%r;t.stock_display={qty_large:S,qty_medium:$,qty_small:d}}else t.stock_display=null}catch(e){console.error("Error fetching stock:",e),t.stock={qty_small:0,qty_medium:0,qty_large:0,unit_small:"",unit_medium:"",unit_large:"",small_conversion_qty:1,medium_conversion_qty:1},t.stock_display=null}}function O(s){return s==null?0:Number(s)%1===0?Number(s):Number(s).toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:2})}function xt(s){if(!s.stock)return"Stok: 0";const t=Number(s.stock.qty_small||0),e=Number(s.stock.qty_medium||0),a=Number(s.stock.qty_large||0);let r="Stok: ";const p=[];return(t>0||s.stock.unit_small)&&p.push(`${O(t)} ${s.stock.unit_small||""}`),(e>0||s.stock.unit_medium)&&p.push(`${O(e)} ${s.stock.unit_medium||""}`),(a>0||s.stock.unit_large)&&p.push(`${O(a)} ${s.stock.unit_large||""}`),p.length===0?"Stok: 0":r+p.join(" | ")}M(()=>o.warehouse_outlet_from_id,s=>{o.items.forEach((t,e)=>{t.item_id&&s&&z(e)})});function Q(s,t){o.items[s].item_id=t.id,o.items[s].item_name=t.name,o.items[s].unit=t.unit_small||t.unit||"",o.items[s].selected_unit=t.unit_small||t.unit||"",o.items[s].available_units=[t.unit_small,t.unit_medium,t.unit_large].filter(Boolean),o.items[s].suggestions=[],o.items[s].showDropdown=!1,o.items[s].highlightedIndex=-1,o.warehouse_outlet_from_id&&ct(()=>{z(s)})}function R(s,t){const e=t.target.value;o.items[s].item_id="",o.items[s].item_name=e,o.items[s].showDropdown=!0,kt(s,e)}function wt(s){setTimeout(()=>{o.items[s].showDropdown=!1},200)}function V(s,t){const e=o.items[s];!e.showDropdown||!e.suggestions.length||(t.key==="ArrowDown"?(t.preventDefault(),e.highlightedIndex=(e.highlightedIndex+1)%e.suggestions.length):t.key==="ArrowUp"?(t.preventDefault(),e.highlightedIndex=(e.highlightedIndex-1+e.suggestions.length)%e.suggestions.length):t.key==="Enter"?(t.preventDefault(),e.highlightedIndex>=0&&e.suggestions[e.highlightedIndex]&&Q(s,e.suggestions[e.highlightedIndex])):t.key==="Escape"&&(e.showDropdown=!1))}function Dt(s,t){o.items[s].selected_unit=t.target.value,o.items[s].unit=t.target.value}function It(s){const e=document.querySelectorAll('input[placeholder="Cari nama item..."]')[s];if(!e)return{};const a=e.getBoundingClientRect();return{left:a.left+"px",top:a.bottom+"px",width:a.width+"px",position:"fixed",zIndex:9999}}function Y(s){if(s.key==="F1"){s.preventDefault();const e=`item-input-${o.items.length-1}`,a=document.getElementById(e);a&&(a.focus(),a.select(),a.style.outline="2px solid #2563eb",a.style.boxShadow="0 0 0 2px rgba(37, 99, 235, 0.2)",setTimeout(()=>{a.style.outline="",a.style.boxShadow=""},1e3))}}const P=nt(()=>o.outlet_from_id&&o.warehouse_outlet_from_id&&o.outlet_to_id&&o.warehouse_outlet_to_id&&o.warehouse_outlet_from_id!==o.warehouse_outlet_to_id);return it(()=>{if(window.addEventListener("keydown",Y),!o.transfer_date){const s=new Date,t=s.getFullYear(),e=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");o.transfer_date=`${t}-${e}-${a}`}}),St(()=>{window.removeEventListener("keydown",Y)}),(s,t)=>(n(),ut(Bt,null,{default:At(()=>[l("div",Nt,[l("div",jt,[l("button",{onClick:H,class:"text-blue-500 hover:underline"},t[8]||(t[8]=[l("i",{class:"fa fa-arrow-left"},null,-1),dt(" Kembali")])),l("h1",Ut,[t[9]||(t[9]=l("i",{class:"fa-solid fa-right-left text-blue-500"},null,-1)),q.value?(n(),i("span",Vt,"Edit Pindah Outlet")):(n(),i("span",Mt,"Tambah Pindah Outlet"))])]),l("form",{onSubmit:mt(bt,["prevent"]),class:"space-y-6"},[l("div",Et,[l("div",null,[t[10]||(t[10]=l("label",{class:"block text-sm font-medium text-gray-700"},"Tanggal",-1)),f(l("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=e=>u(o).transfer_date=e),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[I,u(o).transfer_date]]),u(o).errors.transfer_date?(n(),i("div",Ft,m(u(o).errors.transfer_date),1)):c("",!0)]),l("div",null,[t[12]||(t[12]=l("label",{class:"block text-sm font-medium text-gray-700"},"Outlet Asal",-1)),f(l("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>u(o).outlet_from_id=e),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:"",disabled:N.user_outlet_id!==1},[t[11]||(t[11]=l("option",{value:""},"Pilih Outlet Asal",-1)),(n(!0),i(y,null,b(N.outlets_from,e=>(n(),i("option",{key:e.id_outlet,value:e.id_outlet},m(e.nama_outlet),9,Pt))),128))],8,Ot),[[T,u(o).outlet_from_id]]),u(o).errors.outlet_from_id?(n(),i("div",Lt,m(u(o).errors.outlet_from_id),1)):c("",!0)]),l("div",null,[t[14]||(t[14]=l("label",{class:"block text-sm font-medium text-gray-700"},"Warehouse Outlet Asal",-1)),f(l("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>u(o).warehouse_outlet_from_id=e),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:"",disabled:!u(o).outlet_from_id},[t[13]||(t[13]=l("option",{value:""},"Pilih Warehouse Outlet Asal",-1)),(n(!0),i(y,null,b(j.value,e=>(n(),i("option",{key:e.id,value:e.id},m(e.name),9,Gt))),128))],8,Kt),[[T,u(o).warehouse_outlet_from_id]]),u(o).errors.warehouse_outlet_from_id?(n(),i("div",Wt,m(u(o).errors.warehouse_outlet_from_id),1)):c("",!0)]),l("div",null,[t[16]||(t[16]=l("label",{class:"block text-sm font-medium text-gray-700"},"Outlet Tujuan",-1)),f(l("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>u(o).outlet_to_id=e),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:""},[t[15]||(t[15]=l("option",{value:""},"Pilih Outlet Tujuan",-1)),(n(!0),i(y,null,b(N.outlets_to,e=>(n(),i("option",{key:e.id_outlet,value:e.id_outlet},m(e.nama_outlet),9,Ht))),128))],512),[[T,u(o).outlet_to_id]]),u(o).errors.outlet_to_id?(n(),i("div",zt,m(u(o).errors.outlet_to_id),1)):c("",!0)]),l("div",null,[t[18]||(t[18]=l("label",{class:"block text-sm font-medium text-gray-700"},"Warehouse Outlet Tujuan",-1)),f(l("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>u(o).warehouse_outlet_to_id=e),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:"",disabled:!u(o).outlet_to_id},[t[17]||(t[17]=l("option",{value:""},"Pilih Warehouse Outlet Tujuan",-1)),(n(!0),i(y,null,b(U.value,e=>(n(),i("option",{key:e.id,value:e.id},m(e.name),9,Rt))),128))],8,Qt),[[T,u(o).warehouse_outlet_to_id]]),u(o).errors.warehouse_outlet_to_id?(n(),i("div",Yt,m(u(o).errors.warehouse_outlet_to_id),1)):c("",!0)])]),l("div",null,[t[19]||(t[19]=l("label",{class:"block text-sm font-medium text-gray-700"},"Keterangan",-1)),f(l("textarea",{"onUpdate:modelValue":t[5]||(t[5]=e=>u(o).notes=e),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[I,u(o).notes]]),u(o).errors.notes?(n(),i("div",Jt,m(u(o).errors.notes),1)):c("",!0)]),q.value?c("",!0):(n(),i("div",Xt,[t[25]||(t[25]=l("h3",{class:"text-lg font-semibold text-gray-800 mb-2"},"Approval Flow",-1)),t[26]||(t[26]=l("p",{class:"text-sm text-gray-600 mb-4"}," Tambahkan approver berurutan dari terendah ke tertinggi. Approver terakhir akan eksekusi pindah stok saat approve terakhir. ",-1)),l("div",Zt,[l("div",te,[f(l("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>k.value=e),type:"text",placeholder:"Cari user berdasarkan nama, email, atau jabatan...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onInput:pt,onFocus:t[7]||(t[7]=e=>k.value.length>=2&&G(k.value))},null,544),[[I,k.value]]),x.value&&v.value.length>0?(n(),i("div",ee,[(n(!0),i(y,null,b(v.value,e=>(n(),i("div",{key:e.id,onClick:a=>ft(e),class:"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200 last:border-b-0"},[l("div",se,m(e.name),1),l("div",le,m(e.email),1),e.jabatan?(n(),i("div",re,m(e.jabatan),1)):c("",!0)],8,oe))),128))])):c("",!0)]),t[20]||(t[20]=l("p",{class:"mt-2 text-xs text-gray-500"},"Minimal 2 huruf untuk mencari approver.",-1))]),u(o).approvers.length>0?(n(),i("div",ae,[t[24]||(t[24]=l("h4",{class:"font-medium text-gray-700"},"Urutan Approval (Terendah â†’ Tertinggi):",-1)),(n(!0),i(y,null,b(u(o).approvers,(e,a)=>(n(),i(y,{key:(e==null?void 0:e.id)||a},[e&&e.id?(n(),i("div",ne,[l("div",ie,[l("div",ue,[a>0?(n(),i("button",{key:0,type:"button",onClick:r=>W(a,a-1),class:"p-1 text-gray-500 hover:text-gray-700",title:"Pindah ke atas"},t[21]||(t[21]=[l("i",{class:"fa fa-arrow-up"},null,-1)]),8,de)):c("",!0),a<u(o).approvers.length-1?(n(),i("button",{key:1,type:"button",onClick:r=>W(a,a+1),class:"p-1 text-gray-500 hover:text-gray-700",title:"Pindah ke bawah"},t[22]||(t[22]=[l("i",{class:"fa fa-arrow-down"},null,-1)]),8,me)):c("",!0)]),l("div",_e,[l("span",ce," Level "+m(a+1),1),l("div",null,[l("div",pe,m(e.name),1),l("div",fe,m(e.email),1),e.jabatan?(n(),i("div",ge,m(e.jabatan),1)):c("",!0)])])]),l("button",{type:"button",onClick:r=>gt(a),class:"p-1 text-red-500 hover:text-red-700",title:"Hapus Approver"},t[23]||(t[23]=[l("i",{class:"fa fa-times"},null,-1)]),8,he)])):c("",!0)],64))),128))])):c("",!0)])),l("div",null,[t[31]||(t[31]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Detail Item",-1)),P.value?c("",!0):(n(),i("div",ye," Pilih outlet asal, warehouse outlet asal, outlet tujuan, dan warehouse outlet tujuan terlebih dahulu, dan pastikan warehouse outlet asal dan tujuan tidak sama. ")),l("div",{class:_t(["overflow-x-auto",{"pointer-events-none opacity-60":!P.value}])},[l("table",be,[t[29]||(t[29]=l("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[l("tr",null,[l("th",{class:"px-3 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Item"),l("th",{class:"px-3 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Qty"),l("th",{class:"px-3 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Unit"),l("th",{class:"px-3 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Note"),l("th",{class:"px-3 py-2"})])],-1)),l("tbody",null,[(n(!0),i(y,null,b(u(o).items,(e,a)=>(n(),i("tr",{key:e._rowKey||a},[l("td",ve,[l("div",ke,[f(l("input",{id:`item-input-${a}`,type:"text","onUpdate:modelValue":r=>e.item_name=r,onInput:r=>R(a,r),onFocus:r=>R(a,r),onBlur:r=>wt(a),onKeydown:[E(r=>V(a,r),["down"]),E(r=>V(a,r),["up"]),E(r=>V(a,r),["enter"]),E(r=>V(a,r),["esc"])],class:"w-full rounded border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:"",autocomplete:"off",placeholder:"Cari nama item..."},null,40,xe),[[I,e.item_name]]),(n(),ut($t,{to:"body"},[e.showDropdown&&e.suggestions&&e.suggestions.length>0?(n(),i("div",{key:0,style:Tt(It(a)),id:`autocomplete-dropdown-${a}`,class:"fixed z-[9999] bg-white border border-blue-200 rounded shadow max-w-xs w-[260px] max-h-96 overflow-auto mt-1"},[(n(!0),i(y,null,b(e.suggestions,(r,p)=>(n(),i("div",{key:r.id,id:`autocomplete-item-${a}-${p}`,onMousedown:mt(S=>Q(a,r),["prevent"]),class:_t(["px-3 py-2 flex justify-between items-center cursor-pointer",e.highlightedIndex===p?"bg-blue-100":"hover:bg-blue-50"])},[l("div",null,[l("div",Ie,m(r.name),1),l("div",qe,m(r.sku),1)]),l("div",Ce,m(r.unit),1)],42,De))),128))],12,we)):c("",!0)])),e.loading?(n(),i("div",Se,t[27]||(t[27]=[l("i",{class:"fa fa-spinner fa-spin text-blue-400"},null,-1)]))):c("",!0),u(o).warehouse_outlet_from_id?c("",!0):(n(),i("div",Ae," Pilih warehouse outlet terlebih dahulu untuk mencari item. ")),e.stock?(n(),i("div",$e," Stok: "+m(xt(e)),1)):c("",!0)]),u(o).errors[`items.${a}.item_id`]?(n(),i("div",Te,m(u(o).errors[`items.${a}.item_id`]),1)):c("",!0)]),l("td",Be,[f(l("input",{type:"number",min:"0.01",step:"0.01","onUpdate:modelValue":r=>e.qty=r,class:"w-full rounded border-gray-300",required:""},null,8,Ne),[[I,e.qty]]),u(o).errors[`items.${a}.qty`]?(n(),i("div",je,m(u(o).errors[`items.${a}.qty`]),1)):c("",!0)]),l("td",Ue,[e.available_units&&e.available_units.length?f((n(),i("select",{key:0,"onUpdate:modelValue":r=>e.selected_unit=r,onChange:r=>Dt(a,r),class:"w-full rounded border-gray-300"},[(n(!0),i(y,null,b(e.available_units,r=>(n(),i("option",{key:r,value:r},m(r),9,Me))),128))],40,Ve)),[[T,e.selected_unit]]):f((n(),i("input",{key:1,type:"text","onUpdate:modelValue":r=>e.unit=r,class:"w-full rounded border-gray-300",required:""},null,8,Ee)),[[I,e.unit]]),u(o).errors[`items.${a}.unit`]?(n(),i("div",Fe,m(u(o).errors[`items.${a}.unit`]),1)):c("",!0)]),l("td",Oe,[f(l("input",{type:"text","onUpdate:modelValue":r=>e.note=r,class:"w-full rounded border-gray-300"},null,8,Pe),[[I,e.note]])]),l("td",Le,[l("button",{type:"button",onClick:r=>yt(a),class:"text-red-500 hover:text-red-700",disabled:u(o).items.length===1},t[28]||(t[28]=[l("i",{class:"fa fa-trash"},null,-1)]),8,Ke)])]))),128))])])],2),l("button",{type:"button",onClick:ht,class:"mt-2 px-3 py-1 rounded bg-blue-100 text-blue-700 font-semibold hover:bg-blue-200",disabled:!P.value},t[30]||(t[30]=[l("i",{class:"fa fa-plus"},null,-1),dt(" Tambah Item")]),8,Ge)]),l("div",We,[l("button",{type:"button",onClick:H,class:"px-4 py-2 rounded bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300"},"Batal"),q.value?(n(),i("button",{key:0,type:"button",onClick:vt,class:"px-4 py-2 rounded bg-red-600 text-white font-semibold hover:bg-red-700"},"Hapus")):c("",!0),l("button",{type:"submit",disabled:u(o).processing,class:"px-4 py-2 rounded bg-blue-600 text-white font-semibold hover:bg-blue-700 disabled:opacity-50"},"Simpan",8,He)])],32)])]),_:1}))}};export{so as default};
