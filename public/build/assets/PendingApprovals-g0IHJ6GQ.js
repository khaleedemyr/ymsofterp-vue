import{r as P,a as L,a8 as R,A as I,B as i,C as f,D as e,L as c,x as w,G as p,F as x,M as v,N as n,l as E}from"./vendor-vue-g7iCcTkf.js";import{A as T}from"./AppLayout-DkG6xw-a.js";import{a as y}from"./vendor-utils-CpgP2uT4.js";import{S as d}from"./app-5ZP5W-3z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-COEZdPkp.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const F={class:"w-full py-8 px-4"},S={class:"flex justify-between items-center mb-6"},V={key:0,class:"flex justify-center items-center py-8"},G={key:1,class:"text-center py-8"},$={key:2,class:"space-y-6"},J={class:"flex justify-between items-start mb-4"},q={class:"text-lg font-semibold text-gray-900"},M={class:"text-sm text-gray-600"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},z={class:"text-gray-900"},U={class:"text-lg font-semibold text-blue-600"},H={class:"text-gray-900"},K={class:"text-gray-900"},Q={class:"mb-4"},W={class:"space-y-2"},X={class:"flex items-center space-x-2"},Z={class:"text-sm font-medium"},ee={class:"text-xs text-gray-500"},te={class:"mb-4"},se={class:"text-sm font-medium text-gray-700 mb-2"},re={class:"max-h-32 overflow-y-auto"},ae={class:"text-sm text-gray-900"},oe={class:"text-sm text-gray-600"},ne={class:"flex space-x-2"},le=["onClick"],ie=["onClick"],_e={__name:"PendingApprovals",setup(ce){const u=P([]),m=P(!0),k=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),A=s=>new Date(s).toLocaleDateString("id-ID"),C=s=>({PENDING:"fas fa-clock text-orange-500",APPROVED:"fas fa-check text-green-500",REJECTED:"fas fa-times text-red-500"})[s]||"fas fa-question text-gray-500",D=s=>({PENDING:"bg-orange-100 text-orange-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",j=s=>({PENDING:"Pending",APPROVED:"Approved",REJECTED:"Rejected"})[s]||"Unknown",B=s=>{var l;const t=(l=s.approval_flows)==null?void 0:l.find(r=>r.status==="PENDING");return(t==null?void 0:t.approval_level)||0},g=async()=>{try{m.value=!0;const s=await y.get("/po-ops/pending-approvals");s.data.success&&(u.value=s.data.data)}catch(s){console.error("Error fetching pending approvals:",s),d.fire("Error","Failed to fetch pending approvals","error")}finally{m.value=!1}},O=async s=>{var l,r;const{value:t}=await d.fire({title:"Approve Purchase Order",input:"textarea",inputLabel:"Comments (optional)",inputPlaceholder:"Enter approval comments...",showCancelButton:!0,confirmButtonText:"Approve",confirmButtonColor:"#10b981",cancelButtonText:"Cancel",inputValidator:a=>Promise.resolve()});if(t!==void 0)try{const a=await y.post(`/po-ops/${s}/approve`,{approved:!0,comments:t||""});a.data.success?(d.fire("Success",a.data.message,"success"),await g()):d.fire("Error",a.data.message||"Failed to approve PO","error")}catch(a){console.error("Error approving PO:",a),d.fire("Error",((r=(l=a.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to approve PO","error")}},N=async s=>{var l,r;const{value:t}=await d.fire({title:"Reject Purchase Order",input:"textarea",inputLabel:"Rejection Reason",inputPlaceholder:"Enter rejection reason...",showCancelButton:!0,confirmButtonText:"Reject",confirmButtonColor:"#ef4444",cancelButtonText:"Cancel",inputValidator:a=>!a||a.trim()===""?"Please provide a rejection reason":Promise.resolve()});if(t!==void 0)try{const a=await y.post(`/po-ops/${s}/approve`,{approved:!1,comments:t});a.data.success?(d.fire("Success",a.data.message,"success"),await g()):d.fire("Error",a.data.message||"Failed to reject PO","error")}catch(a){console.error("Error rejecting PO:",a),d.fire("Error",((r=(l=a.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to reject PO","error")}};return L(()=>{g()}),(s,t)=>{const l=R("Link");return i(),I(T,{title:"Pending Approvals"},{default:f(()=>[e("div",F,[e("div",S,[t[1]||(t[1]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-clock text-orange-500"}),p(" Pending Approvals ")],-1)),w(l,{href:"/po-ops",class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:f(()=>t[0]||(t[0]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),p(" Back to PO List ")])),_:1})]),m.value?(i(),c("div",V,t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):u.value.length===0?(i(),c("div",G,t[3]||(t[3]=[e("i",{class:"fas fa-check-circle text-green-500 text-4xl mb-4"},null,-1),e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No Pending Approvals",-1),e("p",{class:"text-gray-600"},"You have no pending approvals at the moment.",-1)]))):(i(),c("div",$,[(i(!0),c(x,null,v(u.value,r=>{var a,b,_;return i(),c("div",{key:r.id,class:"bg-white rounded-xl shadow-lg p-6"},[e("div",J,[e("div",null,[e("h3",q,n(r.number),1),e("p",M,n(A(r.date)),1)]),t[4]||(t[4]=e("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800"}," Pending Approval ",-1))]),e("div",Y,[e("div",null,[t[5]||(t[5]=e("label",{class:"text-sm font-medium text-gray-600"},"Supplier",-1)),e("p",z,n(((a=r.supplier)==null?void 0:a.name)||"-"),1)]),e("div",null,[t[6]||(t[6]=e("label",{class:"text-sm font-medium text-gray-600"},"Grand Total",-1)),e("p",U,n(k(r.grand_total)),1)]),e("div",null,[t[7]||(t[7]=e("label",{class:"text-sm font-medium text-gray-600"},"Created By",-1)),e("p",H,n(((b=r.creator)==null?void 0:b.nama_lengkap)||"-"),1)]),e("div",null,[t[8]||(t[8]=e("label",{class:"text-sm font-medium text-gray-600"},"Your Approval Level",-1)),e("p",K,"Level "+n(B(r)),1)])]),e("div",Q,[t[9]||(t[9]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Approval Flow Status",-1)),e("div",W,[(i(!0),c(x,null,v(r.approval_flows,o=>{var h;return i(),c("div",{key:o.id,class:"flex items-center justify-between p-2 bg-gray-50 rounded"},[e("div",X,[e("i",{class:E([C(o.status),"text-sm"])},null,2),e("span",Z,n(((h=o.approver)==null?void 0:h.nama_lengkap)||"Unknown"),1),e("span",ee,"(Level "+n(o.approval_level)+")",1)]),e("span",{class:E([D(o.status),"text-xs px-2 py-1 rounded-full"])},n(j(o.status)),3)])}),128))])]),e("div",te,[e("h4",se,"Items ("+n(((_=r.items)==null?void 0:_.length)||0)+")",1),e("div",re,[(i(!0),c(x,null,v(r.items,o=>(i(),c("div",{key:o.id,class:"flex justify-between items-center py-1 border-b border-gray-100"},[e("span",ae,n(o.item_name),1),e("span",oe,n(o.quantity)+" "+n(o.unit),1)]))),128))])]),e("div",ne,[w(l,{href:`/po-ops/${r.id}`,class:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-center"},{default:f(()=>t[10]||(t[10]=[e("i",{class:"fas fa-eye mr-2"},null,-1),p(" View Details ")])),_:2},1032,["href"]),e("button",{onClick:o=>O(r.id),class:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"},t[11]||(t[11]=[e("i",{class:"fas fa-check mr-2"},null,-1),p(" Approve ")]),8,le),e("button",{onClick:o=>N(r.id),class:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700"},t[12]||(t[12]=[e("i",{class:"fas fa-times mr-2"},null,-1),p(" Reject ")]),8,ie)])])}),128))]))])]),_:1})}}};export{_e as default};
