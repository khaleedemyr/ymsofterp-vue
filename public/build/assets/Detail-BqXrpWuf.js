import{A as G}from"./AppLayout-BXpmQkyt.js";import{$ as N,c,A as $,B as l,C as I,D as t,L as n,E as f,G as p,N as i,l as v,F as h,M as _,W as x}from"./vendor-vue-g7iCcTkf.js";import{a as y}from"./vendor-utils-CpgP2uT4.js";import{S as u}from"./app-ErXbte2J.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-C0i_S3gs.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const L={class:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 md:px-8"},M={class:"w-full max-w-4xl bg-white rounded-2xl shadow-2xl p-8"},R={class:"flex justify-between items-center mb-8"},A={class:"flex gap-2"},H={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},V={class:"font-medium"},E={class:"font-medium"},O={class:"font-medium"},P={class:"font-medium"},W={class:"mb-8"},q={class:"overflow-x-auto"},z={class:"min-w-full divide-y divide-gray-200"},K={class:"bg-white divide-y divide-gray-200"},Q={class:"px-3 py-2"},U={class:"px-3 py-2"},Y={class:"px-3 py-2"},J={class:"px-3 py-2"},X={class:"px-3 py-2 text-right"},Z={class:"px-3 py-2 text-right font-bold"},tt={key:0,class:"mb-8"},et={class:"bg-gray-50 p-4 rounded-lg"},st={key:1,class:"mb-8"},at={class:"flex flex-wrap gap-3"},ot=["href"],it=["src"],rt={key:2,class:"flex justify-end gap-2"},yt={__name:"Detail",props:{retailFood:Object},setup(w){const a=w,b=N();c(()=>{var s,e;return((e=(s=b.props.auth)==null?void 0:s.user)==null?void 0:e.id_outlet)||""});const m=c(()=>{var s,e;return((e=(s=b.props.auth)==null?void 0:s.user)==null?void 0:e.role)||""}),k=c(()=>m.value==="admin"||m.value==="approver"),F=c(()=>m.value==="admin"||m.value==="approver"||m.value==="outlet"&&a.retailFood.status==="pending");function B(s){return s?new Date(s).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"}):""}function C(s){return{pending:"Menunggu Persetujuan",approved:"Disetujui",rejected:"Ditolak"}[s]||s}function g(s){return s?"Rp "+Number(s).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}):"Rp 0"}function D(){x.visit("/retail-food")}async function j(){var s,e;try{const o=await y.post(`/retail-food/${a.retailFood.id}/approve`);o.data.message&&(await u.fire({icon:"success",title:"Berhasil",text:o.data.message,timer:1500,showConfirmButton:!1}),x.reload())}catch(o){u.fire({icon:"error",title:"Gagal",text:((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Gagal menyetujui transaksi"})}}async function S(){var s,e;try{const o=await y.post(`/retail-food/${a.retailFood.id}/reject`);o.data.message&&(await u.fire({icon:"success",title:"Berhasil",text:o.data.message,timer:1500,showConfirmButton:!1}),x.reload())}catch(o){u.fire({icon:"error",title:"Gagal",text:((e=(s=o.response)==null?void 0:s.data)==null?void 0:e.message)||"Gagal menolak transaksi"})}}async function T(){var e,o;if((await u.fire({title:"Hapus Transaksi?",text:"Transaksi yang dihapus tidak dapat dikembalikan",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",confirmButtonColor:"#ef4444"})).isConfirmed)try{const d=await y.delete(`/retail-food/${a.retailFood.id}`);d.data.message&&(await u.fire({icon:"success",title:"Berhasil",text:d.data.message,timer:1500,showConfirmButton:!1}),x.visit("/retail-food"))}catch(d){u.fire({icon:"error",title:"Gagal",text:((o=(e=d.response)==null?void 0:e.data)==null?void 0:o.message)||"Gagal menghapus transaksi"})}}return(s,e)=>(l(),$(G,null,{default:I(()=>{var o,d;return[t("div",L,[t("div",M,[t("div",R,[e[2]||(e[2]=t("h1",{class:"text-2xl font-bold flex items-center gap-2 text-blue-700"},[t("i",{class:"fa-solid fa-store text-blue-500"}),p(" Detail Retail Food ")],-1)),t("div",A,[t("button",{onClick:D,class:"btn btn-ghost px-4 py-2 rounded-lg"},e[0]||(e[0]=[t("i",{class:"fa fa-arrow-left mr-2"},null,-1),p(" Kembali ")])),F.value?(l(),n("button",{key:0,onClick:T,class:"btn btn-error px-4 py-2 rounded-lg"},e[1]||(e[1]=[t("i",{class:"fa fa-trash mr-2"},null,-1),p(" Hapus ")]))):f("",!0)])]),t("div",H,[t("div",null,[e[3]||(e[3]=t("div",{class:"text-sm text-gray-500 mb-1"},"Tanggal",-1)),t("div",V,i(B(a.retailFood.transaction_date)),1)]),t("div",null,[e[4]||(e[4]=t("div",{class:"text-sm text-gray-500 mb-1"},"No Transaksi",-1)),t("div",E,i(a.retailFood.transaction_number),1)]),t("div",null,[e[5]||(e[5]=t("div",{class:"text-sm text-gray-500 mb-1"},"Outlet",-1)),t("div",O,i((o=a.retailFood.outlet)==null?void 0:o.nama_outlet),1)]),t("div",null,[e[6]||(e[6]=t("div",{class:"text-sm text-gray-500 mb-1"},"Status",-1)),t("div",null,[t("span",{class:v(["px-2 py-1 rounded text-xs font-medium",a.retailFood.status==="approved"?"bg-green-100 text-green-800":a.retailFood.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"])},i(C(a.retailFood.status)),3)])]),t("div",null,[e[7]||(e[7]=t("div",{class:"text-sm text-gray-500 mb-1"},"Metode Pembayaran",-1)),t("div",null,[t("span",{class:v(["px-2 py-1 rounded text-xs font-medium",a.retailFood.payment_method==="cash"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"])},i(a.retailFood.payment_method==="cash"?"Cash":"Contra Bon"),3)])]),t("div",null,[e[8]||(e[8]=t("div",{class:"text-sm text-gray-500 mb-1"},"Supplier",-1)),t("div",P,i(((d=a.retailFood.supplier)==null?void 0:d.name)||"-"),1)])]),t("div",W,[e[11]||(e[11]=t("div",{class:"text-sm text-gray-500 mb-2"},"Items",-1)),t("div",q,[t("table",z,[e[10]||(e[10]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Item"),t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Qty"),t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Unit"),t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Harga"),t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase"},"Subtotal")])],-1)),t("tbody",K,[(l(!0),n(h,null,_(a.retailFood.items,r=>(l(),n("tr",{key:r.id},[t("td",Q,i(r.item_name),1),t("td",U,i(r.qty),1),t("td",Y,i(r.unit),1),t("td",J,i(g(r.price)),1),t("td",X,i(g(r.subtotal)),1)]))),128))]),t("tfoot",null,[t("tr",null,[e[9]||(e[9]=t("td",{colspan:"4",class:"px-3 py-2 text-right font-bold"},"Total:",-1)),t("td",Z,i(g(a.retailFood.total_amount)),1)])])])])]),a.retailFood.notes?(l(),n("div",tt,[e[12]||(e[12]=t("div",{class:"text-sm text-gray-500 mb-1"},"Catatan",-1)),t("div",et,i(a.retailFood.notes),1)])):f("",!0),a.retailFood.invoices&&a.retailFood.invoices.length?(l(),n("div",st,[e[13]||(e[13]=t("div",{class:"text-sm text-gray-500 mb-1"},"Bon/Invoice",-1)),t("div",at,[(l(!0),n(h,null,_(a.retailFood.invoices,r=>(l(),n("div",{key:r.id,class:"w-32 h-32 border rounded overflow-hidden flex items-center justify-center bg-gray-50"},[t("a",{href:`/storage/${r.file_path}`,target:"_blank",rel:"noopener"},[t("img",{src:`/storage/${r.file_path}`,class:"object-contain w-full h-full hover:scale-110 transition-transform duration-200"},null,8,it)],8,ot)]))),128))])])):f("",!0),a.retailFood.status==="pending"&&k.value?(l(),n("div",rt,[t("button",{onClick:S,class:"btn btn-error px-6 py-2 rounded-lg"},e[14]||(e[14]=[t("i",{class:"fa fa-times mr-2"},null,-1),p(" Tolak ")])),t("button",{onClick:j,class:"btn btn-success px-6 py-2 rounded-lg"},e[15]||(e[15]=[t("i",{class:"fa fa-check mr-2"},null,-1),p(" Setujui ")]))])):f("",!0)])])]}),_:1}))}};export{yt as default};
