import{r as n,c as v,a as V,A as L,B as l,C as O,D as a,H as x,J as D,L as o,F as y,M as f,N as r,I as _,G as N,E as k}from"./vendor-vue-g7iCcTkf.js";import{A}from"./AppLayout-CLYhXf-W.js";import"./vendor-utils-CpgP2uT4.js";import"./app-DdwtQE43.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CauiUg4O.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const T={class:"max-w-4xl mx-auto py-8 px-4"},B={class:"flex flex-col md:flex-row md:items-center gap-4 mb-4"},R={class:"flex items-center gap-2"},F=["value"],K={class:"flex items-center gap-2"},M=["disabled"],U=["value"],W={class:"flex items-center gap-2"},E=["value"],G=["disabled"],I={key:0,class:"animate-spin mr-2"},j={key:1,class:"mr-2"},H={class:"bg-white rounded-xl shadow-lg overflow-x-auto"},J={class:"min-w-full divide-y divide-gray-200"},P={class:"bg-white divide-y divide-gray-200"},q={key:0},z={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Q={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},X={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Y={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},Z={key:0},$={class:"bg-gray-50 font-bold"},ee={class:"px-6 py-3 text-right"},pe={__name:"CategoryRecapReport",props:{recaps:Array,categories:Array,outlets:Array,warehouse_outlets:Array,user_outlet_id:[String,Number]},setup(d){const u=d,p=n(""),m=n(""),i=n(""),c=n(""),b=n(!1),h=v(()=>String(u.user_outlet_id)==="1");V(()=>{if(!h.value&&u.user_outlet_id){const s=u.outlets.find(e=>String(e.id_outlet)===String(u.user_outlet_id));s&&(i.value=s.nama_outlet)}});const g=v(()=>{let s=u.recaps;if(m.value&&(s=s.filter(t=>t.category_name===m.value)),i.value&&(s=s.filter(t=>t.outlet_name===i.value)),c.value&&(s=s.filter(t=>String(t.warehouse_outlet_id)===String(c.value))),!p.value)return s;const e=p.value.toLowerCase();return s.filter(t=>t.category_name&&t.category_name.toLowerCase().includes(e)||t.outlet_name&&t.outlet_name.toLowerCase().includes(e))}),S=v(()=>g.value.reduce((s,e)=>s+(Number(e.total_value)||0),0));function w(s){return!s||Number(s)===0?"-":Number(s).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}function C(){b.value=!0,window.location.reload()}return(s,e)=>(l(),L(A,null,{default:O(()=>[a("div",T,[e[16]||(e[16]=a("h1",{class:"text-2xl font-bold mb-6"},"Laporan Rekap Persediaan per Kategori Outlet",-1)),a("div",B,[x(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),type:"text",placeholder:"Cari kategori/outlet...",class:"px-4 py-2 border border-gray-300 rounded-lg w-full md:w-64 focus:ring-blue-500 focus:border-blue-500"},null,512),[[D,p.value]]),a("div",R,[e[5]||(e[5]=a("label",{class:"text-sm"},"Kategori",-1)),x(a("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>m.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[e[4]||(e[4]=a("option",{value:""},"Semua Kategori",-1)),(l(!0),o(y,null,f(d.categories,t=>(l(),o("option",{key:t.id,value:t.name},r(t.name),9,F))),128))],512),[[_,m.value]])]),a("div",K,[e[7]||(e[7]=a("label",{class:"text-sm"},"Outlet",-1)),x(a("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>i.value=t),disabled:!h.value,class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[e[6]||(e[6]=a("option",{value:""},"Semua Outlet",-1)),(l(!0),o(y,null,f(d.outlets,t=>(l(),o("option",{key:t.id_outlet,value:t.nama_outlet},r(t.nama_outlet),9,U))),128))],8,M),[[_,i.value]])]),a("div",W,[e[9]||(e[9]=a("label",{class:"text-sm"},"Warehouse Outlet",-1)),x(a("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>c.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[e[8]||(e[8]=a("option",{value:""},"Semua Warehouse",-1)),(l(!0),o(y,null,f(d.warehouse_outlets,t=>(l(),o("option",{key:t.id,value:t.id},r(t.name),9,E))),128))],512),[[_,c.value]])]),a("button",{onClick:C,disabled:b.value,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md font-semibold hover:bg-blue-700"},[b.value?(l(),o("span",I,e[10]||(e[10]=[a("i",{class:"fas fa-spinner"},null,-1)]))):(l(),o("span",j,e[11]||(e[11]=[a("i",{class:"fas fa-sync-alt"},null,-1)]))),e[12]||(e[12]=N(" Load Data "))],8,G)]),a("div",H,[a("table",J,[e[15]||(e[15]=a("thead",{class:"bg-gray-50"},[a("tr",null,[a("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Kategori"),a("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Outlet"),a("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Warehouse Outlet"),a("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Total Value")])],-1)),a("tbody",P,[g.value.length?k("",!0):(l(),o("tr",q,e[13]||(e[13]=[a("td",{colspan:"3",class:"text-center py-10 text-gray-400"},"Tidak ada data rekap kategori.",-1)]))),(l(!0),o(y,null,f(g.value,t=>(l(),o("tr",{key:t.category_name+"-"+t.outlet_name,class:"hover:bg-gray-50 transition"},[a("td",z,r(t.category_name||"-"),1),a("td",Q,r(t.outlet_name||"-"),1),a("td",X,r(t.warehouse_outlet_name||"-"),1),a("td",Y,r(w(t.total_value)),1)]))),128))]),g.value.length?(l(),o("tfoot",Z,[a("tr",$,[e[14]||(e[14]=a("td",{class:"text-right px-6 py-3",colspan:"3"},"Grand Total",-1)),a("td",ee,r(w(S.value)),1)])])):k("",!0)])])])]),_:1}))}};export{pe as default};
