import{r as f,A as g,B as n,C as b,D as e,G as c,Q as p,W as y,L as u,E as m,N as o,F as h,M as q,H as w,J as O}from"./vendor-vue-g7iCcTkf.js";import{a as k}from"./vendor-utils-CpgP2uT4.js";import{S as v}from"./app-xIQ7JztA.js";import{A as C}from"./AppLayout-BdiuRSin.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-LiNpoaCg.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const D={class:"w-full py-8 px-0"},S={class:"flex justify-between items-center mb-6"},B={class:"bg-white rounded-xl shadow-2xl w-full max-w-4xl mx-auto p-6"},G={key:0},V={class:"mb-4 p-4 border rounded bg-blue-50"},N={class:"text-sm mt-1"},R={class:"font-mono"},I={class:"text-sm"},M={class:"text-sm"},j={class:"text-sm"},F={class:"text-sm"},J={class:"mb-4"},Q={class:"overflow-x-auto"},T={class:"min-w-full divide-y divide-gray-200"},$={class:"bg-white divide-y divide-gray-200"},A={class:"px-4 py-2"},L={class:"px-4 py-2"},U={class:"px-4 py-2"},E={class:"flex items-center gap-2"},W=["onUpdate:modelValue","max"],H=["onClick"],K={key:0,class:"text-xs text-red-600"},z={class:"px-4 py-2"},P={class:"flex justify-end gap-2"},X=["disabled"],le={__name:"CreateFromDO",props:{deliveryOrder:{type:Object,required:!0}},setup(d){const l=d,a=f(!1),x=s=>{var t;return s.qty_error="",s.received_qty===null||s.received_qty===void 0?(s.qty_error="Jumlah harus diisi",!1):s.received_qty<0?(s.qty_error="Jumlah tidak boleh negatif",!1):s.received_qty>s.qty?(s.qty_error=`Jumlah tidak boleh melebihi ${s.qty}`,!1):((t=s.received_qty.toString().split(".")[1])==null?void 0:t.length)>2?(s.qty_error="Maksimal 2 angka di belakang koma",!1):!0},_=async()=>{var t,r;if(a.value=!0,!l.deliveryOrder.items.every(i=>x(i))){a.value=!1,await v.fire({icon:"error",title:"Validasi Gagal",text:"Mohon periksa kembali jumlah yang diterima"});return}try{console.log("Sending data:",{delivery_order_id:l.deliveryOrder.id,receive_date:new Date().toISOString().slice(0,10),items:l.deliveryOrder.items.map(i=>({item_id:i.item_id,qty_ordered:i.qty,qty_received:i.received_qty,unit_id:1}))}),await k.post("/good-receive-outlet-supplier/store-from-do",{delivery_order_id:l.deliveryOrder.id,receive_date:new Date().toISOString().slice(0,10),items:l.deliveryOrder.items.map(i=>({item_id:i.item_id,qty_ordered:i.qty,qty_received:i.received_qty,unit_id:1}))}),a.value=!1,await v.fire({icon:"success",title:"Berhasil",text:"Good Receive berhasil disimpan",timer:1500,showConfirmButton:!1}),y.visit("/good-receive-outlet-supplier")}catch(i){a.value=!1,await v.fire({icon:"error",title:"Gagal",text:((r=(t=i.response)==null?void 0:t.data)==null?void 0:r.message)||"Gagal simpan Good Receive"})}};return(s,t)=>(n(),g(C,null,{default:b(()=>[e("div",D,[e("div",S,[t[3]||(t[3]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-truck"}),c(" Buat Good Receive dari Delivery Order ")],-1)),e("button",{onClick:t[0]||(t[0]=r=>p(y).visit("/good-receive-outlet-supplier")),class:"bg-gray-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},t[2]||(t[2]=[e("i",{class:"fa-solid fa-arrow-left mr-2"},null,-1),c(" Kembali ")]))]),e("div",B,[d.deliveryOrder?(n(),u("div",G,[e("div",V,[t[5]||(t[5]=e("div",{class:"font-semibold text-blue-800"},"Info Delivery Order",-1)),e("div",N,[t[4]||(t[4]=c("Nomor DO: ")),e("span",R,o(d.deliveryOrder.number),1)]),e("div",I,"Tanggal: "+o(d.deliveryOrder.date),1),e("div",M,"Outlet: "+o(d.deliveryOrder.outlet_name),1),e("div",j,"RO GR Number: "+o(d.deliveryOrder.ro_gr_number),1),e("div",F,"RO Floor Order: "+o(d.deliveryOrder.ro_floor_order_number),1)]),e("div",J,[t[7]||(t[7]=e("div",{class:"font-semibold mb-2"},"Daftar Item",-1)),e("div",Q,[e("table",T,[t[6]||(t[6]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Item"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Qty Order"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Qty Terima"),e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Unit")])],-1)),e("tbody",$,[(n(!0),u(h,null,q(d.deliveryOrder.items,r=>(n(),u("tr",{key:r.id},[e("td",A,o(r.name),1),e("td",L,o(r.qty),1),e("td",U,[e("div",E,[w(e("input",{type:"number","onUpdate:modelValue":i=>r.received_qty=i,class:"w-24 px-2 py-1 border rounded",min:0,max:r.qty,step:"0.01"},null,8,W),[[O,r.received_qty]]),e("button",{type:"button",onClick:i=>r.received_qty=r.qty,class:"px-2 py-1 bg-gray-200 rounded text-xs font-bold"},"=",8,H)]),r.qty_error?(n(),u("div",K,o(r.qty_error),1)):m("",!0)]),e("td",z,o(r.unit_name),1)]))),128))])])])]),e("div",P,[e("button",{onClick:t[1]||(t[1]=r=>p(y).visit("/good-receive-outlet-supplier")),class:"px-4 py-2 text-gray-700 bg-gray-100 rounded hover:bg-gray-200"}," Batal "),e("button",{onClick:_,disabled:a.value,class:"px-4 py-2 text-white bg-blue-600 rounded hover:bg-blue-700 disabled:opacity-50"},o(a.value?"Menyimpan...":"Simpan"),9,X)])])):m("",!0)])])]),_:1}))}};export{le as default};
