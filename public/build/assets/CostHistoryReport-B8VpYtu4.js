import{r as c,c as x,w as M,A as R,B as l,C as A,D as t,L as n,E as C,H as v,J as I,F as d,M as b,N as r,I as _,G as L,l as P}from"./vendor-vue-g7iCcTkf.js";import{A as N}from"./AppLayout-D_GBiqpN.js";import"./vendor-utils-CpgP2uT4.js";import"./app-D3yJLFoH.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DW6hwgWG.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const U={class:"max-w-7xl mx-auto py-8 px-4"},F={class:"flex flex-col md:flex-row md:items-center gap-4 mb-4"},W={class:"flex items-center gap-2"},j=["value"],G={class:"flex items-center gap-2"},E=["value"],J={class:"flex items-center gap-2"},O=["value"],$={class:"bg-white rounded-xl shadow-lg overflow-x-auto"},z={class:"min-w-full divide-y divide-gray-200"},q={class:"bg-white divide-y divide-gray-200"},K={key:0},Q={class:"px-6 py-4 whitespace-nowrap text-sm"},X={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Y={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},te={class:"px-6 py-4 whitespace-nowrap text-sm"},ae={class:"px-6 py-4 whitespace-nowrap text-sm"},se={key:0,class:"flex justify-between items-center mt-4"},re={class:"text-sm text-gray-600"},le={class:"flex gap-1"},oe=["disabled"],ne={class:"px-2"},ie=["disabled"],fe={__name:"CostHistoryReport",props:{histories:Array,warehouses:Array,items:Array},setup(f){const B=f,p=c(""),i=c(25),o=c(1),m=c(""),g=c(""),u=x(()=>{let s=B.histories;if(m.value&&(s=s.filter(e=>String(e.warehouse_name)===String(m.value))),g.value&&(s=s.filter(e=>e.item_name===g.value)),!p.value)return s;const a=p.value.toLowerCase();return s.filter(e=>e.item_name&&e.item_name.toLowerCase().includes(a)||e.warehouse_name&&e.warehouse_name.toLowerCase().includes(a))}),y=x(()=>Math.ceil(u.value.length/i.value)||1),h=x(()=>(o.value-1)*i.value),w=x(()=>Math.min(h.value+i.value,u.value.length)),D=x(()=>u.value.slice(h.value,w.value));function S(){o.value>1&&o.value--}function T(){o.value<y.value&&o.value++}M([i,p],()=>{o.value=1});function k(s){return!s||Number(s)===0?"-":Number(s).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}function V(s){return{manual:"Manual",purchase:"Pembelian",transfer:"Transfer",adjustment:"Penyesuaian"}[s]||s}function H(s,a){return!s||!a?"-":`${{purchase_order:"PO",good_receive:"GR",transfer:"Transfer",adjustment:"Penyesuaian"}[s]||s} #${a}`}return(s,a)=>(l(),R(N,null,{default:A(()=>[t("div",U,[a[12]||(a[12]=t("h1",{class:"text-2xl font-bold mb-6"},"Laporan Riwayat Perubahan Harga Pokok (Cost History Report)",-1)),t("div",F,[v(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),type:"text",placeholder:"Cari barang, warehouse...",class:"px-4 py-2 border border-gray-300 rounded-lg w-full md:w-64 focus:ring-blue-500 focus:border-blue-500"},null,512),[[I,p.value]]),t("div",W,[a[5]||(a[5]=t("label",{class:"text-sm"},"Warehouse",-1)),v(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[a[4]||(a[4]=t("option",{value:""},"Semua Warehouse",-1)),(l(!0),n(d,null,b(f.warehouses,e=>(l(),n("option",{key:e.id,value:e.name},r(e.name),9,j))),128))],512),[[_,m.value]])]),t("div",G,[a[7]||(a[7]=t("label",{class:"text-sm"},"Barang",-1)),v(t("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>g.value=e),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[a[6]||(a[6]=t("option",{value:""},"Semua Barang",-1)),(l(!0),n(d,null,b(f.items,e=>(l(),n("option",{key:e.id,value:e.name},r(e.name),9,E))),128))],512),[[_,g.value]])]),t("div",J,[a[8]||(a[8]=t("label",{class:"text-sm"},"Tampilkan",-1)),v(t("select",{"onUpdate:modelValue":a[3]||(a[3]=e=>i.value=e),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[(l(),n(d,null,b([10,25,50,100],e=>t("option",{key:e,value:e},r(e),9,O)),64))],512),[[_,i.value]]),a[9]||(a[9]=t("span",{class:"text-sm"},"data",-1))])]),t("div",$,[t("table",z,[a[11]||(a[11]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Tanggal"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Barang"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Warehouse"),t("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Cost Lama"),t("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Cost Baru"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Jenis Perubahan"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Referensi")])],-1)),t("tbody",q,[u.value.length?C("",!0):(l(),n("tr",K,a[10]||(a[10]=[t("td",{colspan:"8",class:"text-center py-10 text-gray-400"},"Tidak ada data riwayat perubahan harga.",-1)]))),(l(!0),n(d,null,b(D.value,e=>(l(),n("tr",{key:e.date+e.item_name+e.warehouse_name,class:"hover:bg-gray-50 transition"},[t("td",Q,r(new Date(e.date).toLocaleDateString("id-ID")),1),t("td",X,r(e.item_name),1),t("td",Y,r(e.warehouse_name),1),t("td",Z,r(k(e.old_cost)),1),t("td",ee,r(k(e.new_cost)),1),t("td",te,r(V(e.type)),1),t("td",ae,[e.reference_number?(l(),n(d,{key:0},[L(r(e.reference_type==="good_receive"?"GR":e.reference_type==="purchase_order"?"PO":e.reference_type.toUpperCase())+" #"+r(e.reference_number),1)],64)):(l(),n(d,{key:1},[L(r(H(e.reference_type,e.reference_id)),1)],64))])]))),128))])])]),u.value.length?(l(),n("div",se,[t("div",re," Menampilkan "+r(h.value+1)+" - "+r(w.value)+" dari "+r(u.value.length)+" data ",1),t("div",le,[t("button",{onClick:S,disabled:o.value===1,class:P(["px-3 py-1 rounded border text-sm",o.value===1?"bg-gray-200 text-gray-400":"bg-white text-blue-700 hover:bg-blue-50"])},"<",10,oe),t("span",ne,"Halaman "+r(o.value)+" / "+r(y.value),1),t("button",{onClick:T,disabled:o.value===y.value,class:P(["px-3 py-1 rounded border text-sm",o.value===y.value?"bg-gray-200 text-gray-400":"bg-white text-blue-700 hover:bg-blue-50"])},">",10,ie)])])):C("",!0)])]),_:1}))}};export{fe as default};
