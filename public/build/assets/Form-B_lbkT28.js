const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-C51E4rvH.js","assets/vendor-utils-CpgP2uT4.js","assets/vendor-vue-g7iCcTkf.js","assets/vendor-charts-CuqD4wLC.js","assets/app-wB9rqhlj.css"])))=>i.map(i=>d[i]);
import{_ as U}from"./app-C51E4rvH.js";import{r as c,c as h,w as D,a as Ae,A as Le,B as o,C as Be,D as t,G as x,N as i,O as Te,H as C,L as r,F as G,M as V,I as re,J as ue,l as T,E as p,V as q,x as ee,Q as te,W as ae}from"./vendor-vue-g7iCcTkf.js";import{A as De}from"./AppLayout-BE0dNalr.js";import{s as le}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                                                                 */import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-D219A2Up.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const Ge={class:"w-full px-4 py-8"},Ve={class:"text-2xl font-bold text-blue-700 mb-6 flex items-center gap-2"},Pe={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6"},Ee=["value"],Fe={class:"grid grid-cols-2 gap-2"},Ne={class:"flex items-end"},Oe=["disabled"],je={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ue={key:1,class:"fas fa-download mr-2"},Ie={class:"flex border-b border-gray-200 mb-4"},$e={class:"w-full"},Me={key:0},We={class:"flex items-center justify-between mb-2"},qe=["disabled"],He={class:"border border-blue-200 rounded-lg max-h-96 overflow-y-auto bg-white w-full"},Qe={key:0,class:"p-3 border-b border-gray-200 bg-gray-50"},ze={class:"flex items-center cursor-pointer"},Je={class:"ml-auto text-xs text-gray-500"},Ye={key:1,class:"divide-y divide-gray-200"},Ke={class:"flex items-center"},Xe=["value"],Ze={class:"ml-3 flex-1"},et={class:"flex items-center justify-between"},tt={class:"text-sm font-medium text-gray-900"},at={class:"text-xs text-gray-500"},lt={key:0,class:"text-xs text-blue-600 font-medium mt-1"},st={class:"text-right"},nt={class:"text-sm font-semibold text-blue-600"},ot=["onClick"],it={class:"ml-1"},rt={key:0,class:"mt-3 ml-7"},ut={key:0,class:"flex items-center justify-center py-4"},dt={key:1,class:"bg-gray-50 rounded-lg p-3"},ct={class:"space-y-2"},mt={class:"flex-1"},vt={class:"font-medium text-gray-900"},ft={class:"text-gray-500"},pt={class:"text-right"},_t={class:"text-gray-500"},bt={class:"font-medium text-green-600"},gt={key:2,class:"text-xs text-gray-500 italic"},yt={key:2,class:"p-6 text-center text-gray-500"},ht={key:1},xt={class:"flex items-center justify-between mb-2"},kt=["disabled"],wt={class:"border border-green-200 rounded-lg max-h-96 overflow-y-auto bg-white w-full"},Rt={key:0,class:"p-3 border-b border-gray-200 bg-gray-50"},St={class:"flex items-center cursor-pointer"},Ct={class:"ml-auto text-xs text-gray-500"},At={key:1,class:"divide-y divide-gray-200"},Lt={class:"flex items-center"},Bt=["value"],Tt={class:"ml-3 flex-1"},Dt={class:"flex items-center justify-between"},Gt={class:"text-sm font-medium text-gray-900"},Vt={class:"text-xs text-gray-500"},Pt={key:0,class:"text-xs text-green-600 font-medium mt-1"},Et={class:"text-right"},Ft={class:"text-sm font-semibold text-green-600"},Nt=["onClick"],Ot={class:"ml-1"},jt={key:0,class:"mt-3 ml-7"},Ut={key:0,class:"flex items-center justify-center py-4"},It={key:1,class:"bg-gray-50 rounded-lg p-3"},$t={class:"space-y-2"},Mt={class:"flex-1"},Wt={class:"font-medium text-gray-900"},qt={class:"text-gray-500"},Ht={class:"text-right"},Qt={class:"text-gray-500"},zt={class:"font-medium text-green-600"},Jt={key:2,class:"text-xs text-gray-500 italic"},Yt={key:2,class:"p-6 text-center text-gray-500"},Kt={class:"mt-6"},Xt={class:"w-full border border-blue-200 rounded-lg px-4 py-3 bg-gray-50 font-bold text-blue-700 text-lg select-none"},Zt={key:0,class:"text-xs text-gray-500 mt-1"},ea={key:0,class:"mt-4"},ta={class:"border border-blue-200 rounded-lg bg-white overflow-hidden"},aa={class:"flex items-center"},la={class:"text-sm font-medium text-gray-900"},sa={class:"ml-2 text-xs text-gray-500"},na={key:0},oa={key:1},ia={key:2},ra={class:"text-sm font-semibold text-blue-600"},ua={class:"mt-6 space-y-6"},da={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ca={key:0,class:"text-xs text-gray-500 mt-1"},ma={class:"flex justify-end gap-2 mt-8"},va={type:"submit",class:"px-6 py-3 bg-blue-600 text-white rounded-lg font-bold shadow-lg hover:bg-blue-700 transition-all"},Ca={__name:"Form",props:{mode:{type:String,default:"create"},payment:Object,outlets:Array,grList:Array,banks:{type:Array,default:()=>[]},coas:{type:Array,default:()=>[]}},setup(H){const m=H,I=c(!1),$=c(!1),P=c(m.grList),Q=c([]),E=c(!1),A=c("gr"),v=c([]),F=c(!1),L=c(new Set),k=c({}),M=c({}),f=c([]),N=c(!1),B=c(new Set),w=c({}),W=c({}),R=h(()=>m.mode==="edit"),z=h(()=>n.value.outlet_id&&n.value.date_from&&n.value.date_to),O=c(null),_=c([]),J=c(null),n=c({outlet_id:"",date_from:new Date().toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],gr_ids:[],retail_ids:[],total_amount:0,payment_method:"cash",bank_id:null,receiver_bank_ids:[],coa_id:null}),j=h(()=>m.banks.map(l=>({id:l.id,display_name:`${l.bank_name} - ${l.account_number} (${l.account_name}) - ${l.outlet_name}`})));function de(l){n.value.bank_id=l.id}function ce(){n.value.bank_id=null,O.value=null}function me(l){n.value.receiver_bank_ids=_.value.map(e=>e.id)}function ve(l){n.value.receiver_bank_ids=_.value.map(e=>e.id)}function fe(l){n.value.coa_id=l.id}function pe(){n.value.coa_id=null,J.value=null}D(()=>n.value.payment_method,l=>{l==="cash"&&(O.value=null,n.value.bank_id=null,_.value=[],n.value.receiver_bank_ids=[])}),D(_,l=>{n.value.receiver_bank_ids=l.map(e=>e.id)},{deep:!0});const b=h(()=>P.value),g=h(()=>Q.value),_e=h(()=>!v.value||v.value.length===0?0:v.value.reduce((e,a)=>{const s=b.value.find(d=>d.id==a);if(!s)return e;let u=0;return s.total_amount!==null&&s.total_amount!==void 0&&(u=parseFloat(s.total_amount),isNaN(u)&&(u=0)),e+u},0)),be=h(()=>!f.value||f.value.length===0?0:f.value.reduce((e,a)=>{const s=g.value.find(d=>d.id==a);if(!s)return e;let u=0;return s.total_amount!==null&&s.total_amount!==void 0&&(u=parseFloat(s.total_amount),isNaN(u)&&(u=0)),e+u},0)),Y=h(()=>{const l=parseFloat(_e.value)||0,e=parseFloat(be.value)||0;return l+e}),K=h(()=>{const l={};return v.value&&v.value.length>0&&v.value.forEach(e=>{const a=b.value.find(Z=>Z.id==e);if(!a)return;const s=a.warehouse_name||"Tidak Ada Warehouse",u=a.warehouse_id||null,d=u?`wh_${u}`:s;l[d]||(l[d]={id:u,name:s,total:0,grCount:0,retailCount:0,grIds:[],retailIds:[]});let y=0;a.total_amount!==null&&a.total_amount!==void 0&&(y=parseFloat(a.total_amount),isNaN(y)&&(y=0)),l[d].total+=y,l[d].grCount+=1,l[d].grIds.push(e)}),f.value&&f.value.length>0&&f.value.forEach(e=>{const a=g.value.find(Z=>Z.id==e);if(!a)return;const s=a.warehouse_name||"Tidak Ada Warehouse",u=a.warehouse_id||null,d=u?`wh_${u}`:s;l[d]||(l[d]={id:u,name:s,total:0,grCount:0,retailCount:0,grIds:[],retailIds:[]});let y=0;a.total_amount!==null&&a.total_amount!==void 0&&(y=parseFloat(a.total_amount),isNaN(y)&&(y=0)),l[d].total+=y,l[d].retailCount+=1,l[d].retailIds.push(e)}),Object.values(l).sort((e,a)=>e.name==="Tidak Ada Warehouse"?1:a.name==="Tidak Ada Warehouse"?-1:e.name.localeCompare(a.name))});D(v,l=>{n.value.gr_ids=l,n.value.total_amount=Y.value,F.value=l.length===b.value.length&&b.value.length>0},{deep:!0}),D(f,l=>{n.value.retail_ids=l,n.value.total_amount=Y.value,N.value=l.length===g.value.length&&g.value.length>0},{deep:!0}),D(()=>m.grList,l=>{P.value=l},{deep:!0}),D(A,l=>{l==="retail"&&Q.value.length===0&&z.value&&X()});function se(){ae.get("/outlet-payments")}function ge(){F.value?v.value=b.value.map(l=>l.id):v.value=[]}function ye(){N.value?f.value=g.value.map(l=>l.id):f.value=[]}function he(l){L.value.has(l)?L.value.delete(l):(L.value.add(l),k.value[l]||ke(l))}function xe(l){B.value.has(l)?B.value.delete(l):(B.value.add(l),w.value[l]||we(l))}async function ke(l){M.value[l]=!0;try{const a=await(await fetch(`/outlet-payments/gr-items/${l}`)).json();a.success?k.value[l]=a.items:k.value[l]=[]}catch(e){console.error("Error loading GR items:",e),k.value[l]=[]}finally{M.value[l]=!1}}async function we(l){W.value[l]=!0;try{const a=await(await fetch(`/outlet-payments/retail-sales-items/${l}`)).json();a.success?w.value[l]=a.items:w.value[l]=[]}catch(e){console.error("Error loading Retail Sales items:",e),w.value[l]=[]}finally{W.value[l]=!1}}async function ne(){I.value=!0;try{const l=new URLSearchParams;n.value.outlet_id&&l.append("outlet_id",n.value.outlet_id),n.value.date_from&&l.append("date_from",n.value.date_from),n.value.date_to&&l.append("date_to",n.value.date_to);const a=await(await fetch(`/outlet-payments/gr-list?${l.toString()}`)).json();a.success?(P.value=a.grList,v.value=v.value.filter(u=>a.grList.find(d=>d.id==u)),F.value=v.value.length===a.grList.length&&a.grList.length>0,L.value.clear(),k.value={},M.value={},(await U(async()=>{const{default:u}=await import("./app-C51E4rvH.js").then(d=>d.s);return{default:u}},__vite__mapDeps([0,1,2,3,4]))).default.fire({icon:"success",title:"Berhasil!",text:"Data GR berhasil di-refresh",timer:1500,showConfirmButton:!1})):P.value=[]}catch(l){console.error("Error refreshing GR list:",l),P.value=[],(await U(async()=>{const{default:a}=await import("./app-C51E4rvH.js").then(s=>s.s);return{default:a}},__vite__mapDeps([0,1,2,3,4]))).default.fire({icon:"error",title:"Gagal!",text:"Gagal me-refresh data GR"})}finally{I.value=!1}}async function Re(){if(z.value){E.value=!0;try{await Promise.all([ne(),X()])}catch(l){console.error("Error loading data:",l)}finally{E.value=!1}}}async function X(){$.value=!0;try{const l=new URLSearchParams;n.value.outlet_id&&l.append("outlet_id",n.value.outlet_id),n.value.date_from&&l.append("date_from",n.value.date_from),n.value.date_to&&l.append("date_to",n.value.date_to);const a=await(await fetch(`/outlet-payments/retail-sales-list?${l.toString()}`)).json();if(a.success)Q.value=a.retailList,f.value=f.value.filter(u=>a.retailList.find(d=>d.id==u)),N.value=f.value.length===a.retailList.length&&a.retailList.length>0,B.value.clear(),w.value={},W.value={},(await U(async()=>{const{default:u}=await import("./app-C51E4rvH.js").then(d=>d.s);return{default:u}},__vite__mapDeps([0,1,2,3,4]))).default.fire({icon:"success",title:"Berhasil!",text:"Data Retail Sales berhasil di-refresh",timer:1500,showConfirmButton:!1});else throw new Error("Failed to fetch Retail Sales data")}catch(l){console.error("Error refreshing Retail Sales list:",l),(await U(async()=>{const{default:a}=await import("./app-C51E4rvH.js").then(s=>s.s);return{default:a}},__vite__mapDeps([0,1,2,3,4]))).default.fire({icon:"error",title:"Gagal!",text:"Gagal me-refresh data Retail Sales"})}finally{$.value=!1}}function oe(l){return new Date(l).toLocaleDateString("id-ID")}function S(l){const e=isNaN(l)||l===null||l===void 0?0:parseFloat(l);return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e)}function ie(l){return l==null?"":Number(l).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}async function Se(){const l=(await U(async()=>{const{default:u}=await import("./app-C51E4rvH.js").then(d=>d.s);return{default:u}},__vite__mapDeps([0,1,2,3,4]))).default;if(!(await l.fire({title:R.value?"Update Payment?":"Simpan Payment?",text:R.value?"Yakin ingin update data payment ini?":"Yakin ingin menyimpan data payment ini?",icon:"question",showCancelButton:!0,confirmButtonText:R.value?"Update":"Simpan",cancelButtonText:"Batal"})).isConfirmed)return;l.fire({title:R.value?"Mengupdate...":"Menyimpan...",allowOutsideClick:!1,didOpen:()=>{l.showLoading()}});const a=()=>{l.fire({icon:"success",title:"Berhasil",text:R.value?"Payment berhasil diupdate":"Payment berhasil disimpan",timer:1500,showConfirmButton:!1}),se()},s=u=>{let d="Gagal menyimpan data";u&&u.response&&u.response.data&&u.response.data.message?d=u.response.data.message:u&&u.message&&(d=u.message),l.fire({icon:"error",title:"Gagal",text:d})};try{R.value?await ae.put(`/outlet-payments/${n.value.id}`,n.value,{onSuccess:a,onError:s}):await ae.post("/outlet-payments",n.value,{onSuccess:a,onError:s})}catch(u){s(u)}}function Ce(l){if(!l)return null;const e=l.match(/\[Receiver Banks:\s*(\[[\d,\s]*\])\]/);if(e&&e[1])try{const a=JSON.parse(e[1]);return Array.isArray(a)?a:null}catch(a){return console.error("Error parsing receiver bank IDs from notes:",a),null}return null}return Ae(()=>{if(m.payment){if(m.payment.payment_method&&(n.value.payment_method=m.payment.payment_method),m.payment.bank_id){const e=j.value.find(a=>a.id==m.payment.bank_id);e&&(O.value=e,n.value.bank_id=m.payment.bank_id)}let l=null;if(m.payment.receiver_bank_ids&&Array.isArray(m.payment.receiver_bank_ids)&&m.payment.receiver_bank_ids.length>0?l=m.payment.receiver_bank_ids:m.payment.notes&&(l=Ce(m.payment.notes)),l&&l.length>0){const e=j.value.filter(a=>l.includes(a.id));e.length>0&&(_.value=e,n.value.receiver_bank_ids=l)}else if(m.payment.receiver_bank_id){const e=j.value.find(a=>a.id==m.payment.receiver_bank_id);e&&(_.value=[e],n.value.receiver_bank_ids=[m.payment.receiver_bank_id])}}}),(l,e)=>(o(),Le(De,null,{default:Be(()=>[t("div",Ge,[t("h1",Ve,[e[13]||(e[13]=t("i",{class:"fa-solid fa-money-bill-wave"},null,-1)),x(" "+i(R.value?"Edit Payment":"Buat Payment Baru"),1)]),t("form",{onSubmit:Te(Se,["prevent"])},[t("div",Pe,[t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Outlet",-1)),C(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>n.value.outlet_id=a),class:"w-full border border-blue-200 rounded-lg px-4 py-3 focus:ring-blue-500 focus:border-blue-500 shadow-sm",required:""},[e[14]||(e[14]=t("option",{value:""},"Pilih Outlet",-1)),(o(!0),r(G,null,V(H.outlets,a=>(o(),r("option",{key:a.id,value:a.id},i(a.name),9,Ee))),128))],512),[[re,n.value.outlet_id]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Rentang Tanggal",-1)),t("div",Fe,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Dari Tanggal",-1)),C(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>n.value.date_from=a),class:"w-full border border-blue-200 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm",required:""},null,512),[[ue,n.value.date_from]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-xs text-gray-500 mb-1"},"Sampai Tanggal",-1)),C(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=a=>n.value.date_to=a),class:"w-full border border-blue-200 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm",required:""},null,512),[[ue,n.value.date_to]])])])]),t("div",Ne,[t("button",{type:"button",onClick:Re,disabled:!z.value||E.value,class:"w-full bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center font-medium shadow-sm"},[E.value?(o(),r("svg",je,e[19]||(e[19]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(o(),r("i",Ue)),x(" "+i(E.value?"Loading...":"Load Data"),1)],8,Oe)])]),t("div",Ie,[t("button",{type:"button",onClick:e[3]||(e[3]=a=>A.value="gr"),class:T(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",A.value==="gr"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"])},e[20]||(e[20]=[t("i",{class:"fas fa-truck mr-2"},null,-1),x(" Good Receive (GR) ")]),2),t("button",{type:"button",onClick:e[4]||(e[4]=a=>A.value="retail"),class:T(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",A.value==="retail"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"])},e[21]||(e[21]=[t("i",{class:"fas fa-store mr-2"},null,-1),x(" Retail Sales ")]),2)]),t("div",$e,[A.value==="gr"?(o(),r("div",Me,[t("div",We,[e[22]||(e[22]=t("label",{class:"block text-sm font-semibold text-gray-700"},"Pilih GR",-1)),t("button",{type:"button",onClick:ne,disabled:I.value,class:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed transition-all shadow-sm text-sm",title:"Refresh Data GR"},[t("i",{class:T(["fas fa-sync-alt",{"animate-spin":I.value}])},null,2)],8,qe)]),t("div",He,[b.value.length>0?(o(),r("div",Qe,[t("label",ze,[C(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=a=>F.value=a),onChange:ge,class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,544),[[q,F.value]]),e[23]||(e[23]=t("span",{class:"ml-2 text-sm font-medium text-gray-700"},"Pilih Semua GR",-1)),t("span",Je,i(v.value.length)+" dari "+i(b.value.length)+" dipilih",1)])])):p("",!0),b.value.length>0?(o(),r("div",Ye,[(o(!0),r(G,null,V(b.value,a=>(o(),r("div",{key:a.id,class:"p-3 hover:bg-gray-50 transition-colors"},[t("div",Ke,[C(t("input",{type:"checkbox",value:a.id,"onUpdate:modelValue":e[6]||(e[6]=s=>v.value=s),class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,8,Xe),[[q,v.value]]),t("div",Ze,[t("div",et,[t("div",null,[t("h4",tt,i(a.number||a.gr_number||"-"),1),t("p",at,i(oe(a.receive_date))+" • "+i(a.outlet_name),1),a.warehouse_name?(o(),r("p",lt,[e[24]||(e[24]=t("i",{class:"fas fa-warehouse mr-1"},null,-1)),x(i(a.warehouse_name),1)])):p("",!0)]),t("div",st,[t("p",nt,i(S(a.total_amount)),1),t("button",{type:"button",onClick:s=>he(a.id),class:"text-xs text-blue-500 hover:text-blue-700 flex items-center"},[t("i",{class:T(["fas",L.value.has(a.id)?"fa-chevron-up":"fa-chevron-down"])},null,2),t("span",it,i(L.value.has(a.id)?"Tutup":"Lihat Item"),1)],8,ot)])])])]),L.value.has(a.id)?(o(),r("div",rt,[M.value[a.id]?(o(),r("div",ut,e[25]||(e[25]=[t("i",{class:"fas fa-spinner fa-spin text-blue-500"},null,-1),t("span",{class:"ml-2 text-sm text-gray-500"},"Memuat item...",-1)]))):k.value[a.id]&&k.value[a.id].length>0?(o(),r("div",dt,[e[26]||(e[26]=t("h5",{class:"text-xs font-medium text-gray-700 mb-2"},"Detail Item:",-1)),t("div",ct,[(o(!0),r(G,null,V(k.value[a.id],s=>(o(),r("div",{key:s.id,class:"flex justify-between items-center text-xs"},[t("div",mt,[t("span",vt,i(s.item_name),1),t("div",ft," Qty GR: "+i(ie(s.received_qty))+" "+i(s.unit),1)]),t("div",pt,[t("div",_t,"Harga: "+i(S(s.price)),1),t("div",bt,i(S(s.received_qty*s.price)),1)])]))),128))])])):(o(),r("div",gt,"Tidak ada item"))])):p("",!0)]))),128))])):(o(),r("div",yt,e[27]||(e[27]=[t("i",{class:"fas fa-inbox text-2xl mb-2"},null,-1),t("p",{class:"text-sm"},"Tidak ada GR yang tersedia",-1),t("p",{class:"text-xs"},"Pilih outlet dan tanggal untuk melihat GR",-1)])))])])):p("",!0),A.value==="retail"?(o(),r("div",ht,[t("div",xt,[e[28]||(e[28]=t("label",{class:"block text-sm font-semibold text-gray-700"},"Pilih Retail Sales",-1)),t("button",{type:"button",onClick:X,disabled:$.value,class:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 disabled:cursor-not-allowed transition-all shadow-sm text-sm",title:"Refresh Data Retail Sales"},[t("i",{class:T(["fas fa-sync-alt",{"animate-spin":$.value}])},null,2)],8,kt)]),t("div",wt,[g.value.length>0?(o(),r("div",Rt,[t("label",St,[C(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=a=>N.value=a),onChange:ye,class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,544),[[q,N.value]]),e[29]||(e[29]=t("span",{class:"ml-2 text-sm font-medium text-gray-700"},"Pilih Semua Retail Sales",-1)),t("span",Ct,i(f.value.length)+" dari "+i(g.value.length)+" dipilih",1)])])):p("",!0),g.value.length>0?(o(),r("div",At,[(o(!0),r(G,null,V(g.value,a=>(o(),r("div",{key:a.id,class:"p-3 hover:bg-gray-50 transition-colors"},[t("div",Lt,[C(t("input",{type:"checkbox",value:a.id,"onUpdate:modelValue":e[8]||(e[8]=s=>f.value=s),class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,8,Bt),[[q,f.value]]),t("div",Tt,[t("div",Dt,[t("div",null,[t("h4",Gt,i(a.number),1),t("p",Vt,i(oe(a.sale_date))+" • "+i(a.customer_name)+" ("+i(a.customer_code)+") ",1),a.warehouse_name?(o(),r("p",Pt,[e[30]||(e[30]=t("i",{class:"fas fa-warehouse mr-1"},null,-1)),x(i(a.warehouse_name),1)])):p("",!0)]),t("div",Et,[t("p",Ft,i(S(a.total_amount)),1),t("button",{type:"button",onClick:s=>xe(a.id),class:"text-xs text-green-500 hover:text-green-700 flex items-center"},[t("i",{class:T(["fas",B.value.has(a.id)?"fa-chevron-up":"fa-chevron-down"])},null,2),t("span",Ot,i(B.value.has(a.id)?"Tutup":"Lihat Item"),1)],8,Nt)])])])]),B.value.has(a.id)?(o(),r("div",jt,[W.value[a.id]?(o(),r("div",Ut,e[31]||(e[31]=[t("i",{class:"fas fa-spinner fa-spin text-green-500"},null,-1),t("span",{class:"ml-2 text-sm text-gray-500"},"Memuat item...",-1)]))):w.value[a.id]&&w.value[a.id].length>0?(o(),r("div",It,[e[32]||(e[32]=t("h5",{class:"text-xs font-medium text-gray-700 mb-2"},"Detail Item:",-1)),t("div",$t,[(o(!0),r(G,null,V(w.value[a.id],s=>(o(),r("div",{key:s.id,class:"flex justify-between items-center text-xs"},[t("div",Mt,[t("span",Wt,i(s.item_name),1),t("div",qt," Qty: "+i(ie(s.received_qty))+" "+i(s.unit),1)]),t("div",Ht,[t("div",Qt,"Harga: "+i(S(s.price)),1),t("div",zt,i(S(s.subtotal)),1)])]))),128))])])):(o(),r("div",Jt,"Tidak ada item"))])):p("",!0)]))),128))])):(o(),r("div",Yt,e[33]||(e[33]=[t("i",{class:"fas fa-store text-2xl mb-2"},null,-1),t("p",{class:"text-sm"},"Tidak ada Retail Sales yang tersedia",-1),t("p",{class:"text-xs"},"Pilih outlet dan tanggal untuk melihat Retail Sales",-1)])))])])):p("",!0)]),t("div",Kt,[t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Total Amount",-1)),t("div",Xt,i(S(Y.value)),1),v.value.length>0||f.value.length>0?(o(),r("p",Zt," Total dari "+i(v.value.length)+" GR dan "+i(f.value.length)+" Retail Sales yang dipilih ",1)):p("",!0)]),(v.value.length>0||f.value.length>0)&&K.value.length>0?(o(),r("div",ea,[e[36]||(e[36]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[t("i",{class:"fas fa-warehouse mr-2"}),x("Total per Warehouse ")],-1)),t("div",ta,[(o(!0),r(G,null,V(K.value,(a,s)=>(o(),r("div",{key:a.name,class:T(["px-4 py-3 flex items-center justify-between",s!==K.value.length-1?"border-b border-gray-200":""])},[t("div",aa,[e[35]||(e[35]=t("i",{class:"fas fa-warehouse text-blue-500 mr-2"},null,-1)),t("span",la,i(a.name||"Tidak Ada Warehouse"),1),t("span",sa,[a.grCount>0?(o(),r("span",na,i(a.grCount)+" GR",1)):p("",!0),a.grCount>0&&a.retailCount>0?(o(),r("span",oa," • ")):p("",!0),a.retailCount>0?(o(),r("span",ia,i(a.retailCount)+" Retail Sales",1)):p("",!0)])]),t("span",ra,i(S(a.total)),1)],2))),128))])])):p("",!0)]),t("div",ua,[t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Metode Pembayaran",-1)),C(t("select",{"onUpdate:modelValue":e[9]||(e[9]=a=>n.value.payment_method=a),class:"w-full border border-blue-200 rounded-lg px-4 py-3 focus:ring-blue-500 focus:border-blue-500 shadow-sm"},e[37]||(e[37]=[t("option",{value:"cash"},"Cash",-1),t("option",{value:"transfer"},"Transfer",-1),t("option",{value:"check"},"Check",-1)]),512),[[re,n.value.payment_method]])]),n.value.payment_method==="transfer"||n.value.payment_method==="check"?(o(),r("div",da,[t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Bank Pengirim (Outlet)",-1)),ee(te(le),{modelValue:O.value,"onUpdate:modelValue":e[10]||(e[10]=a=>O.value=a),options:j.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Cari dan pilih bank pengirim...",label:"display_name","track-by":"id",onSelect:de,onRemove:ce,class:"w-full"},null,8,["modelValue","options"])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Bank Penerima (Head Office)",-1)),ee(te(le),{modelValue:_.value,"onUpdate:modelValue":e[11]||(e[11]=a=>_.value=a),options:j.value,searchable:!0,"close-on-select":!1,multiple:!0,"show-labels":!1,placeholder:"Cari dan pilih bank penerima (bisa multiple)...",label:"display_name","track-by":"id",onSelect:me,onRemove:ve,class:"w-full"},null,8,["modelValue","options"]),_.value.length>0?(o(),r("p",ca,i(_.value.length)+" bank penerima dipilih ",1)):p("",!0)])])):p("",!0),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[t("i",{class:"fas fa-book mr-2"}),x("Chart of Account (COA) ")],-1)),ee(te(le),{modelValue:J.value,"onUpdate:modelValue":e[12]||(e[12]=a=>J.value=a),options:H.coas,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Pilih COA untuk pembayaran ini...",label:"display_name","track-by":"id",onSelect:fe,onRemove:pe,class:"w-full"},null,8,["modelValue","options"]),e[42]||(e[42]=t("p",{class:"text-xs text-gray-500 mt-1"},[t("i",{class:"fas fa-info-circle mr-1"}),x(" Pilih Chart of Account yang akan digunakan untuk mencatat pembayaran ini ")],-1))])]),t("div",ma,[t("button",{type:"button",onClick:se,class:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-semibold shadow-sm"},"Batal"),t("button",va,i(R.value?"Update":"Simpan"),1)])],32)])]),_:1}))}};export{Ca as default};
