const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-vFC8Iw15.js","assets/vendor-utils-CpgP2uT4.js","assets/vendor-vue-g7iCcTkf.js","assets/vendor-charts-CuqD4wLC.js","assets/app-Op39MCLy.css"])))=>i.map(i=>d[i]);
import{_ as W}from"./app-vFC8Iw15.js";import{r as f,c as g,w as D,a as Te,A as Be,B as o,C as De,D as a,G as x,N as u,O as Ee,H as C,L as n,F as E,M as G,I as re,J as ue,l as A,E as p,V as z,x as de,Q as ce,W as ee}from"./vendor-vue-g7iCcTkf.js";import{A as Ge}from"./AppLayout-cjLApVXh.js";import{s as me}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                                                                 */import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-pwkt9lfN.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const Pe={class:"w-full px-4 py-8"},Ve={class:"text-2xl font-bold text-blue-700 mb-6 flex items-center gap-2"},Fe={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6"},Ne=["value"],je={class:"grid grid-cols-2 gap-2"},Oe={class:"flex items-end"},$e=["disabled"],Me={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ue={key:1,class:"fas fa-download mr-2"},Ie={class:"flex border-b border-gray-200 mb-4"},We={class:"w-full"},qe={key:0},He={class:"flex items-center justify-between mb-2"},Qe=["disabled"],ze={class:"border border-blue-200 rounded-lg max-h-96 overflow-y-auto bg-white w-full"},Je={key:0,class:"p-3 border-b border-gray-200 bg-gray-50"},Ye={class:"flex items-center cursor-pointer"},Ke={class:"ml-auto text-xs text-gray-500"},Xe={key:1,class:"divide-y divide-gray-200"},Ze={class:"flex items-center"},et=["value"],tt={class:"ml-3 flex-1"},at={class:"flex items-center justify-between"},lt={class:"text-sm font-medium text-gray-900"},st={class:"text-xs text-gray-500"},ot={key:0,class:"text-xs text-blue-600 font-medium mt-1"},nt={class:"text-right"},it={class:"text-sm font-semibold text-blue-600"},rt=["onClick"],ut={class:"ml-1"},dt={key:0,class:"mt-3 ml-7"},ct={key:0,class:"flex items-center justify-center py-4"},mt={key:1,class:"bg-gray-50 rounded-lg p-3"},vt={class:"space-y-2"},ft={class:"flex-1"},pt={class:"font-medium text-gray-900"},bt={class:"text-gray-500"},gt={class:"text-right"},_t={class:"text-gray-500"},yt={class:"font-medium text-green-600"},ht={key:2,class:"text-xs text-gray-500 italic"},xt={key:2,class:"p-6 text-center text-gray-500"},kt={key:1},wt={class:"flex items-center justify-between mb-2"},St=["disabled"],Rt={class:"border border-green-200 rounded-lg max-h-96 overflow-y-auto bg-white w-full"},Ct={key:0,class:"p-3 border-b border-gray-200 bg-gray-50"},At={class:"flex items-center cursor-pointer"},Lt={class:"ml-auto text-xs text-gray-500"},Tt={key:1,class:"divide-y divide-gray-200"},Bt={class:"flex items-center"},Dt=["value"],Et={class:"ml-3 flex-1"},Gt={class:"flex items-center justify-between"},Pt={class:"text-sm font-medium text-gray-900"},Vt={class:"text-xs text-gray-500"},Ft={key:0,class:"text-xs text-green-600 font-medium mt-1"},Nt={class:"text-right"},jt={class:"text-sm font-semibold text-green-600"},Ot=["onClick"],$t={class:"ml-1"},Mt={key:0,class:"mt-3 ml-7"},Ut={key:0,class:"flex items-center justify-center py-4"},It={key:1,class:"bg-gray-50 rounded-lg p-3"},Wt={class:"space-y-2"},qt={class:"flex-1"},Ht={class:"font-medium text-gray-900"},Qt={class:"text-gray-500"},zt={class:"text-right"},Jt={class:"text-gray-500"},Yt={class:"font-medium text-green-600"},Kt={key:2,class:"text-xs text-gray-500 italic"},Xt={key:2,class:"p-6 text-center text-gray-500"},Zt={class:"mt-6"},ea={class:"w-full border border-blue-200 rounded-lg px-4 py-3 bg-gray-50 font-bold text-blue-700 text-lg select-none"},ta={key:0,class:"text-xs text-gray-500 mt-1"},aa={key:0,class:"mt-4"},la={class:"border border-blue-200 rounded-lg bg-white overflow-hidden"},sa={class:"flex items-center"},oa={class:"text-sm font-medium text-gray-900"},na={class:"ml-2 text-xs text-gray-500"},ia={key:0},ra={key:1},ua={key:2},da={class:"text-sm font-semibold text-blue-600"},ca={key:1,class:"mt-4"},ma={key:0,class:"border border-green-200 rounded-lg bg-white p-4 text-sm text-gray-500"},va={key:1,class:"border border-green-200 rounded-lg bg-white overflow-hidden"},fa={class:"flex items-center"},pa={class:"text-sm font-medium text-gray-900"},ba={class:"text-sm font-semibold text-green-600"},ga={key:2,class:"mt-2 border border-amber-300 bg-amber-50 rounded-lg p-3 text-amber-800 text-xs"},_a={key:3,class:"border border-gray-200 rounded-lg bg-white p-4 text-sm text-gray-500"},ya={class:"mt-6 space-y-6"},ha={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},xa={key:0,class:"text-xs text-gray-500 mt-1"},ka={class:"flex justify-end gap-2 mt-8"},wa={type:"submit",class:"px-6 py-3 bg-blue-600 text-white rounded-lg font-bold shadow-lg hover:bg-blue-700 transition-all"},Fa={__name:"Form",props:{mode:{type:String,default:"create"},payment:Object,outlets:Array,grList:Array,banks:{type:Array,default:()=>[]}},setup(te){const v=te,q=f(!1),H=f(!1),F=f(v.grList),J=f([]),N=f(!1),L=f("gr"),c=f([]),j=f(!1),T=f(new Set),_=f({}),P=f({}),m=f([]),O=f(!1),B=f(new Set),y=f({}),V=f({}),R=g(()=>v.mode==="edit"),Y=g(()=>i.value.outlet_id&&i.value.date_from&&i.value.date_to),$=f(null),h=f([]),i=f({outlet_id:"",date_from:new Date().toISOString().split("T")[0],date_to:new Date().toISOString().split("T")[0],gr_ids:[],retail_ids:[],total_amount:0,payment_method:"cash",bank_id:null,receiver_bank_ids:[]}),M=g(()=>v.banks.map(l=>({id:l.id,display_name:`${l.bank_name} - ${l.account_number} (${l.account_name}) - ${l.outlet_name}`})));function ve(l){i.value.bank_id=l.id}function fe(){i.value.bank_id=null,$.value=null}function pe(l){i.value.receiver_bank_ids=h.value.map(e=>e.id)}function be(l){i.value.receiver_bank_ids=h.value.map(e=>e.id)}D(()=>i.value.payment_method,l=>{l==="cash"&&($.value=null,i.value.bank_id=null,h.value=[],i.value.receiver_bank_ids=[])}),D(h,l=>{i.value.receiver_bank_ids=l.map(e=>e.id)},{deep:!0});const k=g(()=>F.value),w=g(()=>J.value),ge=g(()=>!c.value||c.value.length===0?0:c.value.reduce((e,t)=>{const s=k.value.find(d=>d.id==t);if(!s)return e;let r=0;return s.total_amount!==null&&s.total_amount!==void 0&&(r=parseFloat(s.total_amount),isNaN(r)&&(r=0)),e+r},0)),_e=g(()=>!m.value||m.value.length===0?0:m.value.reduce((e,t)=>{const s=w.value.find(d=>d.id==t);if(!s)return e;let r=0;return s.total_amount!==null&&s.total_amount!==void 0&&(r=parseFloat(s.total_amount),isNaN(r)&&(r=0)),e+r},0)),K=g(()=>{const l=parseFloat(ge.value)||0,e=parseFloat(_e.value)||0;return l+e}),X=g(()=>{const l={};return c.value&&c.value.length>0&&c.value.forEach(e=>{const t=k.value.find(I=>I.id==e);if(!t)return;const s=t.warehouse_name||"Tidak Ada Warehouse",r=t.warehouse_id||null,d=r?`wh_${r}`:s;l[d]||(l[d]={id:r,name:s,total:0,grCount:0,retailCount:0,grIds:[],retailIds:[]});let b=0;t.total_amount!==null&&t.total_amount!==void 0&&(b=parseFloat(t.total_amount),isNaN(b)&&(b=0)),l[d].total+=b,l[d].grCount+=1,l[d].grIds.push(e)}),m.value&&m.value.length>0&&m.value.forEach(e=>{const t=w.value.find(I=>I.id==e);if(!t)return;const s=t.warehouse_name||"Tidak Ada Warehouse",r=t.warehouse_id||null,d=r?`wh_${r}`:s;l[d]||(l[d]={id:r,name:s,total:0,grCount:0,retailCount:0,grIds:[],retailIds:[]});let b=0;t.total_amount!==null&&t.total_amount!==void 0&&(b=parseFloat(t.total_amount),isNaN(b)&&(b=0)),l[d].total+=b,l[d].retailCount+=1,l[d].retailIds.push(e)}),Object.values(l).sort((e,t)=>e.name==="Tidak Ada Warehouse"?1:t.name==="Tidak Ada Warehouse"?-1:e.name.localeCompare(t.name))}),U=g(()=>{const l={},e=t=>{Array.isArray(t)&&t.forEach(s=>{const r=s==null?void 0:s.coa_id,d=s==null?void 0:s.coa_code,b=s==null?void 0:s.coa_name,I=d&&b?`${d} - ${b}`:b||"Tanpa CoA",Le=parseFloat(s==null?void 0:s.subtotal)||0,Q=r?`coa_${r}`:"no_coa";l[Q]||(l[Q]={key:Q,label:I,total:0}),l[Q].total+=Le})};return c.value.forEach(t=>{e(_.value[t]||[])}),m.value.forEach(t=>{e(y.value[t]||[])}),Object.values(l).sort((t,s)=>s.total-t.total)}),ye=g(()=>{const l=c.value.some(t=>P.value[t]),e=m.value.some(t=>V.value[t]);return l||e}),he=g(()=>U.value.some(l=>l.key==="no_coa"&&(parseFloat(l.total)||0)>0));D(c,l=>{i.value.gr_ids=l,i.value.total_amount=K.value,j.value=l.length===k.value.length&&k.value.length>0},{deep:!0}),D(m,l=>{i.value.retail_ids=l,i.value.total_amount=K.value,O.value=l.length===w.value.length&&w.value.length>0},{deep:!0}),D([c,m],async()=>{const l=[];c.value.forEach(e=>{!_.value[e]&&!P.value[e]&&l.push(le(e))}),m.value.forEach(e=>{!y.value[e]&&!V.value[e]&&l.push(se(e))}),l.length>0&&await Promise.all(l)},{deep:!0}),D(()=>v.grList,l=>{F.value=l},{deep:!0}),D(L,l=>{l==="retail"&&J.value.length===0&&Y.value&&Z()});function ae(){ee.get("/outlet-payments")}function xe(){j.value?c.value=k.value.map(l=>l.id):c.value=[]}function ke(){O.value?m.value=w.value.map(l=>l.id):m.value=[]}function we(l){T.value.has(l)?T.value.delete(l):(T.value.add(l),_.value[l]||le(l))}function Se(l){B.value.has(l)?B.value.delete(l):(B.value.add(l),y.value[l]||se(l))}async function le(l){P.value[l]=!0;try{const t=await(await fetch(`/outlet-payments/gr-items/${l}`)).json();t.success?_.value[l]=t.items:_.value[l]=[]}catch(e){console.error("Error loading GR items:",e),_.value[l]=[]}finally{P.value[l]=!1}}async function se(l){V.value[l]=!0;try{const t=await(await fetch(`/outlet-payments/retail-sales-items/${l}`)).json();t.success?y.value[l]=t.items:y.value[l]=[]}catch(e){console.error("Error loading Retail Sales items:",e),y.value[l]=[]}finally{V.value[l]=!1}}async function oe(){q.value=!0;try{const l=new URLSearchParams;i.value.outlet_id&&l.append("outlet_id",i.value.outlet_id),i.value.date_from&&l.append("date_from",i.value.date_from),i.value.date_to&&l.append("date_to",i.value.date_to);const t=await(await fetch(`/outlet-payments/gr-list?${l.toString()}`)).json();t.success?(F.value=t.grList,c.value=c.value.filter(r=>t.grList.find(d=>d.id==r)),j.value=c.value.length===t.grList.length&&t.grList.length>0,T.value.clear(),_.value={},P.value={},(await W(async()=>{const{default:r}=await import("./app-vFC8Iw15.js").then(d=>d.s);return{default:r}},__vite__mapDeps([0,1,2,3,4]))).default.fire({icon:"success",title:"Berhasil!",text:"Data GR berhasil di-refresh",timer:1500,showConfirmButton:!1})):F.value=[]}catch(l){console.error("Error refreshing GR list:",l),F.value=[],(await W(async()=>{const{default:t}=await import("./app-vFC8Iw15.js").then(s=>s.s);return{default:t}},__vite__mapDeps([0,1,2,3,4]))).default.fire({icon:"error",title:"Gagal!",text:"Gagal me-refresh data GR"})}finally{q.value=!1}}async function Re(){if(Y.value){N.value=!0;try{await Promise.all([oe(),Z()])}catch(l){console.error("Error loading data:",l)}finally{N.value=!1}}}async function Z(){H.value=!0;try{const l=new URLSearchParams;i.value.outlet_id&&l.append("outlet_id",i.value.outlet_id),i.value.date_from&&l.append("date_from",i.value.date_from),i.value.date_to&&l.append("date_to",i.value.date_to);const t=await(await fetch(`/outlet-payments/retail-sales-list?${l.toString()}`)).json();if(t.success)J.value=t.retailList,m.value=m.value.filter(r=>t.retailList.find(d=>d.id==r)),O.value=m.value.length===t.retailList.length&&t.retailList.length>0,B.value.clear(),y.value={},V.value={},(await W(async()=>{const{default:r}=await import("./app-vFC8Iw15.js").then(d=>d.s);return{default:r}},__vite__mapDeps([0,1,2,3,4]))).default.fire({icon:"success",title:"Berhasil!",text:"Data Retail Sales berhasil di-refresh",timer:1500,showConfirmButton:!1});else throw new Error("Failed to fetch Retail Sales data")}catch(l){console.error("Error refreshing Retail Sales list:",l),(await W(async()=>{const{default:t}=await import("./app-vFC8Iw15.js").then(s=>s.s);return{default:t}},__vite__mapDeps([0,1,2,3,4]))).default.fire({icon:"error",title:"Gagal!",text:"Gagal me-refresh data Retail Sales"})}finally{H.value=!1}}function ne(l){return new Date(l).toLocaleDateString("id-ID")}function S(l){const e=isNaN(l)||l===null||l===void 0?0:parseFloat(l);return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e)}function ie(l){return l==null?"":Number(l).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}async function Ce(){const l=(await W(async()=>{const{default:r}=await import("./app-vFC8Iw15.js").then(d=>d.s);return{default:r}},__vite__mapDeps([0,1,2,3,4]))).default;if(!(await l.fire({title:R.value?"Update Payment?":"Simpan Payment?",text:R.value?"Yakin ingin update data payment ini?":"Yakin ingin menyimpan data payment ini?",icon:"question",showCancelButton:!0,confirmButtonText:R.value?"Update":"Simpan",cancelButtonText:"Batal"})).isConfirmed)return;l.fire({title:R.value?"Mengupdate...":"Menyimpan...",allowOutsideClick:!1,didOpen:()=>{l.showLoading()}});const t=()=>{l.fire({icon:"success",title:"Berhasil",text:R.value?"Payment berhasil diupdate":"Payment berhasil disimpan",timer:1500,showConfirmButton:!1}),ae()},s=r=>{let d="Gagal menyimpan data";r&&r.response&&r.response.data&&r.response.data.message?d=r.response.data.message:r&&r.message&&(d=r.message),l.fire({icon:"error",title:"Gagal",text:d})};try{R.value?await ee.put(`/outlet-payments/${i.value.id}`,i.value,{onSuccess:t,onError:s}):await ee.post("/outlet-payments",i.value,{onSuccess:t,onError:s})}catch(r){s(r)}}function Ae(l){if(!l)return null;const e=l.match(/\[Receiver Banks:\s*(\[[\d,\s]*\])\]/);if(e&&e[1])try{const t=JSON.parse(e[1]);return Array.isArray(t)?t:null}catch(t){return console.error("Error parsing receiver bank IDs from notes:",t),null}return null}return Te(()=>{if(v.payment){if(v.payment.payment_method&&(i.value.payment_method=v.payment.payment_method),v.payment.bank_id){const e=M.value.find(t=>t.id==v.payment.bank_id);e&&($.value=e,i.value.bank_id=v.payment.bank_id)}let l=null;if(v.payment.receiver_bank_ids&&Array.isArray(v.payment.receiver_bank_ids)&&v.payment.receiver_bank_ids.length>0?l=v.payment.receiver_bank_ids:v.payment.notes&&(l=Ae(v.payment.notes)),l&&l.length>0){const e=M.value.filter(t=>l.includes(t.id));e.length>0&&(h.value=e,i.value.receiver_bank_ids=l)}else if(v.payment.receiver_bank_id){const e=M.value.find(t=>t.id==v.payment.receiver_bank_id);e&&(h.value=[e],i.value.receiver_bank_ids=[v.payment.receiver_bank_id])}}}),(l,e)=>(o(),Be(Ge,null,{default:De(()=>[a("div",Pe,[a("h1",Ve,[e[12]||(e[12]=a("i",{class:"fa-solid fa-money-bill-wave"},null,-1)),x(" "+u(R.value?"Edit Payment":"Buat Payment Baru"),1)]),a("form",{onSubmit:Ee(Ce,["prevent"])},[a("div",Fe,[a("div",null,[e[14]||(e[14]=a("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Outlet",-1)),C(a("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>i.value.outlet_id=t),class:"w-full border border-blue-200 rounded-lg px-4 py-3 focus:ring-blue-500 focus:border-blue-500 shadow-sm",required:""},[e[13]||(e[13]=a("option",{value:""},"Pilih Outlet",-1)),(o(!0),n(E,null,G(te.outlets,t=>(o(),n("option",{key:t.id,value:t.id},u(t.name),9,Ne))),128))],512),[[re,i.value.outlet_id]])]),a("div",null,[e[17]||(e[17]=a("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Rentang Tanggal",-1)),a("div",je,[a("div",null,[e[15]||(e[15]=a("label",{class:"block text-xs text-gray-500 mb-1"},"Dari Tanggal",-1)),C(a("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=t=>i.value.date_from=t),class:"w-full border border-blue-200 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm",required:""},null,512),[[ue,i.value.date_from]])]),a("div",null,[e[16]||(e[16]=a("label",{class:"block text-xs text-gray-500 mb-1"},"Sampai Tanggal",-1)),C(a("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=t=>i.value.date_to=t),class:"w-full border border-blue-200 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm text-sm",required:""},null,512),[[ue,i.value.date_to]])])])]),a("div",Oe,[a("button",{type:"button",onClick:Re,disabled:!Y.value||N.value,class:"w-full bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center font-medium shadow-sm"},[N.value?(o(),n("svg",Me,e[18]||(e[18]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(o(),n("i",Ue)),x(" "+u(N.value?"Loading...":"Load Data"),1)],8,$e)])]),a("div",Ie,[a("button",{type:"button",onClick:e[3]||(e[3]=t=>L.value="gr"),class:A(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",L.value==="gr"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"])},e[19]||(e[19]=[a("i",{class:"fas fa-truck mr-2"},null,-1),x(" Good Receive (GR) ")]),2),a("button",{type:"button",onClick:e[4]||(e[4]=t=>L.value="retail"),class:A(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",L.value==="retail"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"])},e[20]||(e[20]=[a("i",{class:"fas fa-store mr-2"},null,-1),x(" Retail Sales ")]),2)]),a("div",We,[L.value==="gr"?(o(),n("div",qe,[a("div",He,[e[21]||(e[21]=a("label",{class:"block text-sm font-semibold text-gray-700"},"Pilih GR",-1)),a("button",{type:"button",onClick:oe,disabled:q.value,class:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed transition-all shadow-sm text-sm",title:"Refresh Data GR"},[a("i",{class:A(["fas fa-sync-alt",{"animate-spin":q.value}])},null,2)],8,Qe)]),a("div",ze,[k.value.length>0?(o(),n("div",Je,[a("label",Ye,[C(a("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=t=>j.value=t),onChange:xe,class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,544),[[z,j.value]]),e[22]||(e[22]=a("span",{class:"ml-2 text-sm font-medium text-gray-700"},"Pilih Semua GR",-1)),a("span",Ke,u(c.value.length)+" dari "+u(k.value.length)+" dipilih",1)])])):p("",!0),k.value.length>0?(o(),n("div",Xe,[(o(!0),n(E,null,G(k.value,t=>(o(),n("div",{key:t.id,class:"p-3 hover:bg-gray-50 transition-colors"},[a("div",Ze,[C(a("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[6]||(e[6]=s=>c.value=s),class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,8,et),[[z,c.value]]),a("div",tt,[a("div",at,[a("div",null,[a("h4",lt,u(t.number||t.gr_number||"-"),1),a("p",st,u(ne(t.receive_date))+" • "+u(t.outlet_name),1),t.warehouse_name?(o(),n("p",ot,[e[23]||(e[23]=a("i",{class:"fas fa-warehouse mr-1"},null,-1)),x(u(t.warehouse_name),1)])):p("",!0)]),a("div",nt,[a("p",it,u(S(t.total_amount)),1),a("button",{type:"button",onClick:s=>we(t.id),class:"text-xs text-blue-500 hover:text-blue-700 flex items-center"},[a("i",{class:A(["fas",T.value.has(t.id)?"fa-chevron-up":"fa-chevron-down"])},null,2),a("span",ut,u(T.value.has(t.id)?"Tutup":"Lihat Item"),1)],8,rt)])])])]),T.value.has(t.id)?(o(),n("div",dt,[P.value[t.id]?(o(),n("div",ct,e[24]||(e[24]=[a("i",{class:"fas fa-spinner fa-spin text-blue-500"},null,-1),a("span",{class:"ml-2 text-sm text-gray-500"},"Memuat item...",-1)]))):_.value[t.id]&&_.value[t.id].length>0?(o(),n("div",mt,[e[25]||(e[25]=a("h5",{class:"text-xs font-medium text-gray-700 mb-2"},"Detail Item:",-1)),a("div",vt,[(o(!0),n(E,null,G(_.value[t.id],s=>(o(),n("div",{key:s.id,class:"flex justify-between items-center text-xs"},[a("div",ft,[a("span",pt,u(s.item_name),1),a("div",bt," Qty GR: "+u(ie(s.received_qty))+" "+u(s.unit),1)]),a("div",gt,[a("div",_t,"Harga: "+u(S(s.price)),1),a("div",yt,u(S(s.received_qty*s.price)),1)])]))),128))])])):(o(),n("div",ht,"Tidak ada item"))])):p("",!0)]))),128))])):(o(),n("div",xt,e[26]||(e[26]=[a("i",{class:"fas fa-inbox text-2xl mb-2"},null,-1),a("p",{class:"text-sm"},"Tidak ada GR yang tersedia",-1),a("p",{class:"text-xs"},"Pilih outlet dan tanggal untuk melihat GR",-1)])))])])):p("",!0),L.value==="retail"?(o(),n("div",kt,[a("div",wt,[e[27]||(e[27]=a("label",{class:"block text-sm font-semibold text-gray-700"},"Pilih Retail Sales",-1)),a("button",{type:"button",onClick:Z,disabled:H.value,class:"px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 disabled:cursor-not-allowed transition-all shadow-sm text-sm",title:"Refresh Data Retail Sales"},[a("i",{class:A(["fas fa-sync-alt",{"animate-spin":H.value}])},null,2)],8,St)]),a("div",Rt,[w.value.length>0?(o(),n("div",Ct,[a("label",At,[C(a("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>O.value=t),onChange:ke,class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,544),[[z,O.value]]),e[28]||(e[28]=a("span",{class:"ml-2 text-sm font-medium text-gray-700"},"Pilih Semua Retail Sales",-1)),a("span",Lt,u(m.value.length)+" dari "+u(w.value.length)+" dipilih",1)])])):p("",!0),w.value.length>0?(o(),n("div",Tt,[(o(!0),n(E,null,G(w.value,t=>(o(),n("div",{key:t.id,class:"p-3 hover:bg-gray-50 transition-colors"},[a("div",Bt,[C(a("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[8]||(e[8]=s=>m.value=s),class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,8,Dt),[[z,m.value]]),a("div",Et,[a("div",Gt,[a("div",null,[a("h4",Pt,u(t.number),1),a("p",Vt,u(ne(t.sale_date))+" • "+u(t.customer_name)+" ("+u(t.customer_code)+") ",1),t.warehouse_name?(o(),n("p",Ft,[e[29]||(e[29]=a("i",{class:"fas fa-warehouse mr-1"},null,-1)),x(u(t.warehouse_name),1)])):p("",!0)]),a("div",Nt,[a("p",jt,u(S(t.total_amount)),1),a("button",{type:"button",onClick:s=>Se(t.id),class:"text-xs text-green-500 hover:text-green-700 flex items-center"},[a("i",{class:A(["fas",B.value.has(t.id)?"fa-chevron-up":"fa-chevron-down"])},null,2),a("span",$t,u(B.value.has(t.id)?"Tutup":"Lihat Item"),1)],8,Ot)])])])]),B.value.has(t.id)?(o(),n("div",Mt,[V.value[t.id]?(o(),n("div",Ut,e[30]||(e[30]=[a("i",{class:"fas fa-spinner fa-spin text-green-500"},null,-1),a("span",{class:"ml-2 text-sm text-gray-500"},"Memuat item...",-1)]))):y.value[t.id]&&y.value[t.id].length>0?(o(),n("div",It,[e[31]||(e[31]=a("h5",{class:"text-xs font-medium text-gray-700 mb-2"},"Detail Item:",-1)),a("div",Wt,[(o(!0),n(E,null,G(y.value[t.id],s=>(o(),n("div",{key:s.id,class:"flex justify-between items-center text-xs"},[a("div",qt,[a("span",Ht,u(s.item_name),1),a("div",Qt," Qty: "+u(ie(s.received_qty))+" "+u(s.unit),1)]),a("div",zt,[a("div",Jt,"Harga: "+u(S(s.price)),1),a("div",Yt,u(S(s.subtotal)),1)])]))),128))])])):(o(),n("div",Kt,"Tidak ada item"))])):p("",!0)]))),128))])):(o(),n("div",Xt,e[32]||(e[32]=[a("i",{class:"fas fa-store text-2xl mb-2"},null,-1),a("p",{class:"text-sm"},"Tidak ada Retail Sales yang tersedia",-1),a("p",{class:"text-xs"},"Pilih outlet dan tanggal untuk melihat Retail Sales",-1)])))])])):p("",!0)]),a("div",Zt,[a("div",null,[e[33]||(e[33]=a("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Total Amount",-1)),a("div",ea,u(S(K.value)),1),c.value.length>0||m.value.length>0?(o(),n("p",ta," Total dari "+u(c.value.length)+" GR dan "+u(m.value.length)+" Retail Sales yang dipilih ",1)):p("",!0)]),(c.value.length>0||m.value.length>0)&&X.value.length>0?(o(),n("div",aa,[e[35]||(e[35]=a("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[a("i",{class:"fas fa-warehouse mr-2"}),x("Total per Warehouse ")],-1)),a("div",la,[(o(!0),n(E,null,G(X.value,(t,s)=>(o(),n("div",{key:t.name,class:A(["px-4 py-3 flex items-center justify-between",s!==X.value.length-1?"border-b border-gray-200":""])},[a("div",sa,[e[34]||(e[34]=a("i",{class:"fas fa-warehouse text-blue-500 mr-2"},null,-1)),a("span",oa,u(t.name||"Tidak Ada Warehouse"),1),a("span",na,[t.grCount>0?(o(),n("span",ia,u(t.grCount)+" GR",1)):p("",!0),t.grCount>0&&t.retailCount>0?(o(),n("span",ra," • ")):p("",!0),t.retailCount>0?(o(),n("span",ua,u(t.retailCount)+" Retail Sales",1)):p("",!0)])]),a("span",da,u(S(t.total)),1)],2))),128))])])):p("",!0),c.value.length>0||m.value.length>0?(o(),n("div",ca,[e[39]||(e[39]=a("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},[a("i",{class:"fas fa-book mr-2"}),x("Total per CoA (dari Sub Category) ")],-1)),ye.value&&U.value.length===0?(o(),n("div",ma,e[36]||(e[36]=[a("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),x("Memuat ringkasan CoA... ")]))):U.value.length>0?(o(),n("div",va,[(o(!0),n(E,null,G(U.value,(t,s)=>(o(),n("div",{key:t.key,class:A(["px-4 py-3 flex items-center justify-between",s!==U.value.length-1?"border-b border-gray-200":""])},[a("div",fa,[e[37]||(e[37]=a("i",{class:"fas fa-tag text-green-500 mr-2"},null,-1)),a("span",pa,u(t.label),1)]),a("span",ba,u(S(t.total)),1)],2))),128))])):p("",!0),he.value?(o(),n("div",ga,e[38]||(e[38]=[a("i",{class:"fas fa-triangle-exclamation mr-1"},null,-1),x(" Ada nominal item yang belum ter-mapping CoA di Sub Category. Silakan lengkapi CoA pada Sub Category terkait agar jurnal lengkap. ")]))):(o(),n("div",_a," Belum ada detail item untuk menghitung sub category. "))])):p("",!0)]),a("div",ya,[a("div",null,[e[41]||(e[41]=a("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Metode Pembayaran",-1)),C(a("select",{"onUpdate:modelValue":e[9]||(e[9]=t=>i.value.payment_method=t),class:"w-full border border-blue-200 rounded-lg px-4 py-3 focus:ring-blue-500 focus:border-blue-500 shadow-sm"},e[40]||(e[40]=[a("option",{value:"cash"},"Cash",-1),a("option",{value:"transfer"},"Transfer",-1),a("option",{value:"check"},"Check",-1)]),512),[[re,i.value.payment_method]])]),i.value.payment_method==="transfer"||i.value.payment_method==="check"?(o(),n("div",ha,[a("div",null,[e[42]||(e[42]=a("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Bank Pengirim (Outlet)",-1)),de(ce(me),{modelValue:$.value,"onUpdate:modelValue":e[10]||(e[10]=t=>$.value=t),options:M.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Cari dan pilih bank pengirim...",label:"display_name","track-by":"id",onSelect:ve,onRemove:fe,class:"w-full"},null,8,["modelValue","options"])]),a("div",null,[e[43]||(e[43]=a("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Bank Penerima (Head Office)",-1)),de(ce(me),{modelValue:h.value,"onUpdate:modelValue":e[11]||(e[11]=t=>h.value=t),options:M.value,searchable:!0,"close-on-select":!1,multiple:!0,"show-labels":!1,placeholder:"Cari dan pilih bank penerima (bisa multiple)...",label:"display_name","track-by":"id",onSelect:pe,onRemove:be,class:"w-full"},null,8,["modelValue","options"]),h.value.length>0?(o(),n("p",xa,u(h.value.length)+" bank penerima dipilih ",1)):p("",!0)])])):p("",!0)]),a("div",ka,[a("button",{type:"button",onClick:ae,class:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-semibold shadow-sm"},"Batal"),a("button",wa,u(R.value?"Update":"Simpan"),1)])],32)])]),_:1}))}};export{Fa as default};
