import{c as x,$ as ue,r as d,a as ut,L as n,B as l,E as u,D as t,x as r,A as de,O as dt,G as h,F as M,M as P,N as v,l as y,Y as ct,C as m,Q as f,W as ft}from"./vendor-vue-g7iCcTkf.js";import vt from"./CommentModal-BCD8B7s7.js";import mt from"./AssignMemberModal-Dve_0Ypd.js";import{g as pt,a as D}from"./vendor-utils-CpgP2uT4.js";import gt from"./ActionPlanButton-B6JsFft5.js";import xt from"./ActionPlanList-XU2D29cy.js";import yt from"./AddRetailItem-Bku7oryk.js";import kt from"./RetailList-nbVbAXBp.js";import ht from"./TimelineModal-wu9gKOdI.js";import bt from"./PurchaseRequisitionListModal-BLX7nfeJ.js";import{S as b}from"./app-CX1ZKpmy.js";import wt from"./PurchaseOrderTypeModal-BMvtnGf3.js";import Ct from"./PurchaseOrderListModal-Dmxli5r2.js";import _t from"./EvidenceModal-CjC99Siv.js";import Tt from"./EvidenceList-eDE95GxJ.js";import{_ as Mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Y as L,h as C,_ as V,G as H,S as W}from"./vendor-ui-CrPgGUUb.js";import"./CameraModal-UOq4SzNh.js";import"./vendor-charts-CuqD4wLC.js";import"./id-C4ThNj35.js";import"./PurchaseRequisitionForm-CAH65xYQ.js";import"./BiddingStartModal-CDLTCGT9.js";import"./BiddingPrintPreviewModal-BsohxcIw.js";import"./BiddingList-CpiYgq6Q.js";import"./BiddingSupplierInputModal-R93TTcrh.js";import"./PurchaseOrderDetailModal-CkpqiIC5.js";import"./GoodReceiveModal-xKecIkee.js";const Pt={key:0,class:"absolute inset-0 bg-white/50 backdrop-blur-sm rounded-xl flex items-center justify-center z-50"},Dt={class:"absolute top-2 right-2 z-10"},Et={key:1,class:"absolute right-0 top-8 w-40 bg-white border rounded shadow-lg z-20"},Rt=["disabled"],At={key:0},St={key:1},$t=["onClick","disabled"],Ot={class:"text-sm text-blue-600 font-medium"},It={class:"flex items-center gap-2 text-xs text-gray-500"},Nt={key:0,class:"ml-2 text-red-500 font-medium"},jt={class:"flex flex-wrap gap-1"},Bt={class:"mt-1"},Gt={class:"font-bold text-gray-800"},zt={class:"mt-2"},Ft={class:"flex items-center gap-1 mb-1"},Lt={class:"text-xs text-gray-500"},Vt={class:"flex items-center gap-1"},Ht=["title"],Wt={class:"border-t border-gray-100 pt-2 mt-1"},Kt={class:"flex items-center gap-2"},Ut={key:0,class:"mt-2 space-y-2"},Yt={key:0,class:"space-y-1"},qt={class:"text-xs text-gray-500"},Qt={class:"flex flex-wrap gap-2"},Jt=["onClick"],Xt=["src","alt"],Zt={key:1,class:"space-y-1"},ea={class:"text-xs text-gray-500"},ta={class:"flex flex-wrap gap-2"},aa=["onClick"],sa=["src","alt"],la={key:2,class:"space-y-1"},na={class:"text-xs text-gray-500"},oa={class:"flex flex-wrap gap-2"},ia=["onClick"],ra={class:"truncate max-w-[100px] group-hover:text-blue-600"},ua={class:"text-gray-400"},da={class:"border-t border-gray-100 pt-2 mt-1"},ca={key:0,class:"mt-2"},fa={class:"border-t border-gray-100 pt-2 mt-1"},va={key:0,class:"mt-2"},ma={class:"border-t border-gray-100 pt-2 mt-1"},pa={key:0,class:"mt-2"},ga={class:"relative"},xa={key:0,class:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center"},ya={class:"fixed inset-0 overflow-y-auto"},ka={class:"flex min-h-full items-center justify-center p-4"},ha=["src","alt"],ba={class:"fixed inset-0 overflow-y-auto"},wa={class:"flex min-h-full items-center justify-center"},Ca={class:"relative aspect-video bg-black rounded-lg overflow-hidden"},_a=["src","alt"],Ta=["src"],Ma={class:"flex justify-center gap-2 mt-4"},Pa=["onClick"],Da=["src","alt"],Ea={key:1,class:"w-full h-full bg-gray-800 flex items-center justify-center"},Ra={class:"fixed inset-0 overflow-y-auto"},Aa={class:"flex min-h-full items-center justify-center p-4"},Sa=["src"],$a={class:"fixed inset-0 overflow-y-auto"},Oa={class:"flex min-h-full items-center justify-center p-4"},Ia={__name:"KanbanCard",props:{task:{type:Object,required:!0}},emits:["taskMoved","open-direct-po"],setup(i,{emit:be}){const c=i,ce=be,E=x(()=>ue().props.auth.user),we=x(()=>E.value.division_id===20&&E.value.status==="A"||E.value.id_role==="5af56935b011a"&&E.value.status==="A"),R=d(!1),S=d(!1),K=d(!1),U=d(!1),Y=d(!1),A=d(null),$=d(null),w=d(0),O=d(null),q=d(!1),Q=d(0),_=d(!1),I=d(!1),N=d(!1),j=d(!1),J=d(!1),B=d(!1),X=d(!1),Z=d(!1),ee=d(!1),te=d(!1),ae=d(!1),G=d(!1),z=d(!1),fe=d(null),ve=d(null),Ce=x(()=>{if(!c.task.due_date)return"text-gray-500";const a=new Date,e=new Date(c.task.due_date),o=pt(e,a);return o<0?"text-red-500 font-medium":o<=2?"text-yellow-500 font-medium":"text-green-500"}),se=x(()=>{if(!c.task.completed_at||!c.task.due_date)return!1;const a=new Date(c.task.completed_at),e=new Date(c.task.due_date);return a>e}),_e=x(()=>{if(!se.value)return 0;const a=new Date(c.task.completed_at),e=new Date(c.task.due_date),o=Math.abs(a-e);return Math.ceil(o/(1e3*60*60*24))}),Te=x(()=>!c.task.completed_at||!c.task.due_date?"text-gray-500":se.value?"text-red-500 font-medium":"text-lime-600 font-medium");function Me(a){console.log("Task data:",c.task);const e=c.task.id;if(!e){console.error("Task ID is missing:",c.task);return}console.log("Starting drag for task:",e),a.dataTransfer.setData("text/plain",e.toString()),a.target.classList.add("dragging"),a.dataTransfer.effectAllowed="move"}function Pe(a){a.target.classList.remove("dragging")}function le(a){const e=new Date(a);return new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"short",year:"numeric"}).format(e)}function De(){S.value=!S.value}const k=x(()=>c.task.media?c.task.media.reduce((a,e)=>(e.file_type.startsWith("image/")?a.images.push({id:e.id,url:`/storage/${e.file_path}`,name:e.file_name,type:e.file_type}):e.file_type.startsWith("video/")&&a.videos.push({id:e.id,url:`/storage/${e.file_path}`,name:e.file_name,type:e.file_type,thumbnail:null}),a),{images:[],videos:[]}):{images:[],videos:[]}),F=x(()=>c.task.documents?c.task.documents.map(a=>({id:a.id,url:`/storage/${a.file_path}`,name:a.file_name,type:a.file_type,size:a.file_size})):[]),Ee=x(()=>k.value.images.length+k.value.videos.length+F.value.length),Re=x(()=>k.value.images.slice(0,3)),ne=x(()=>{const a=k.value.images.map(o=>({...o,mediaType:"image"})),e=k.value.videos.map(o=>({...o,mediaType:"video"}));return[...a,...e]}),me=x(()=>ne.value.length),T=x(()=>ne.value[w.value]||{});function Ae(a){return a.includes("pdf")?"fas fa-file-pdf text-red-500":a.includes("spreadsheet")||a.includes("excel")||a.includes("csv")?"fas fa-file-excel text-green-500":a.includes("document")||a.includes("word")?"fas fa-file-word text-blue-500":"fas fa-file text-gray-500"}function Se(a){if(!a)return"0 B";const e=1024,o=["B","KB","MB","GB"],s=Math.floor(Math.log(a)/Math.log(e));return`${parseFloat((a/Math.pow(e,s)).toFixed(1))} ${o[s]}`}function $e(a){A.value=a,K.value=!0}function pe(){K.value=!1,A.value=null}function Oe(a,e=0){w.value=e,U.value=!0}function ge(){U.value=!1,w.value=0}function Ie(a){$.value=a,Y.value=!0}function xe(){O.value&&O.value.pause(),Y.value=!1,$.value=null}function Ne(){w.value>0&&w.value--}function je(){w.value<me.value-1&&w.value++}function Be(a){w.value=a}function Ge(a){window.open(a.url,"_blank")}function ye(a){return{Mechanical:"#FF4444",Electrical:"#000080",Plumbing:"#33B5E5",Machinary:"#00C851",Civil:"#AA66CC",Others:"#8A8A8A"}[a]||"#8A8A8A"}function ze(a){return{Mechanical:"fa-cogs",Electrical:"fa-bolt",Plumbing:"fa-faucet",Machinary:"fa-industry",Civil:"fa-hard-hat",Others:"fa-tools"}[a]||"fa-tools"}async function ke(){try{const a=await D.get(`/api/maintenance-comments/${c.task.id}/count`);Q.value=a.data.count}catch(a){console.error("Error fetching comment count:",a)}}ut(()=>{ke()});function Fe(){ke()}function Le(){_.value=!1,I.value=!0}function Ve(){I.value=!1}function He(){}function We(a){return a?a.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):""}const he=["bg-blue-500 text-white","bg-green-500 text-white","bg-pink-500 text-white","bg-yellow-500 text-white","bg-purple-500 text-white","bg-red-500 text-white","bg-indigo-500 text-white","bg-teal-500 text-white","bg-orange-500 text-white"];function Ke(a){return he[a%he.length]}function Ue(){var a;(a=fe.value)==null||a.loadActionPlans()}function Ye(){var a;oe(),(a=ve.value)==null||a.loadRetailData()}function qe(){N.value=!N.value}function Qe(){j.value=!j.value}function Je(){J.value=!0,_.value=!1}function oe(){J.value=!1}function Xe(){G.value=!G.value}const ie=x(()=>{const a=ue().props.auth.user;return a.status==="A"&&(a.division_id===20||a.id_role==="5af56935b011a"||a.id_jabatan===217)}),Ze=async a=>{if(!ie.value){alert("Anda tidak memiliki akses untuk memindahkan task");return}if(!["TASK","PR","PO","IN_PROGRESS","IN_REVIEW","DONE"].includes(a)){alert("Status tidak valid");return}if(a==="PO")try{if((await D.get(`/api/maintenance-tasks/${c.task.id}/purchase-requisitions`)).data.some(g=>g.status==="DRAFT")){b.fire({title:"Tidak dapat memindahkan task",text:"Task tidak dapat dipindahkan ke PO karena masih ada PR dengan status DRAFT",icon:"warning"});return}}catch(o){console.error("Error checking PR status:",o),b.fire("Error","Gagal memeriksa status PR","error");return}if(a==="IN_PROGRESS")try{const p=(await D.get(`/api/maintenance-tasks/${c.task.id}/purchase-orders`)).data.filter(g=>g.status==="DRAFT");if(p.length>0){const g=p.map(re=>re.po_number).join(", ");b.fire({title:"Tidak dapat memindahkan task",html:`Task tidak dapat dipindahkan ke In Progress karena masih ada PO dengan status DRAFT:<br><br>${g}`,icon:"warning"});return}}catch(o){console.error("Error checking PO status:",o),b.fire("Error","Gagal memeriksa status PO","error");return}if(a==="DONE")try{const{data:o}=await D.get(`/api/maintenance-evidence/${c.task.id}`);if(!o||o.length===0){b.fire("Tidak bisa selesai","Harus upload dulu bukti pekerjaan telah selesai.","warning");return}}catch{b.fire("Error","Gagal memeriksa evidence","error");return}B.value=!0,ft.post(route("maintenance-tasks.update-status",c.task.id),{status:a,notify_members:!0},{preserveScroll:!0,onSuccess:()=>{ce("taskMoved"),_.value=!1,B.value=!1},onError:()=>{B.value=!1}})},et=a=>({TASK:"fas fa-clipboard-list",PR:"fas fa-file-invoice",PO:"fas fa-file-invoice-dollar",IN_PROGRESS:"fas fa-spinner",IN_REVIEW:"fas fa-eye",DONE:"fas fa-check-circle"})[a]||"fas fa-circle";function tt(a){a==="bidding"&&console.log("Bidding selected")}const at=async()=>{try{const a=await D.get("/api/maintenance-tasks/bidding-history",{params:{task_id:c.task.id}});b.fire({title:"History Bidding",html:st(a.data),width:"80%",showCloseButton:!0,showConfirmButton:!1})}catch(a){console.error("Error fetching bidding history:",a),b.fire("Error","Gagal mengambil data history bidding","error")}},st=a=>{if(!a||a.length===0)return"<p>Tidak ada data history bidding</p>";const e={};a.forEach(s=>{e[s.item_name]||(e[s.item_name]=[]),e[s.item_name].push(s)});let o='<div style="max-height:60vh;overflow-y:auto;">';return o+='<table style="width:100%;border-collapse:collapse;">',o+='<thead><tr><th style="border:1px solid #eee;padding:6px;">Item</th><th style="border:1px solid #eee;padding:6px;">Supplier</th><th style="border:1px solid #eee;padding:6px;">Harga</th><th style="border:1px solid #eee;padding:6px;">Status</th><th style="border:1px solid #eee;padding:6px;">Tanggal</th><th style="border:1px solid #eee;padding:6px;">Oleh</th></tr></thead><tbody>',Object.keys(e).forEach(s=>{const p=e[s];p.forEach((g,re)=>{const it=g.status==="selected"?"color: #38a169; font-weight:bold":g.status==="rejected"?"color: #e53e3e;":"color: #718096;",rt=g.status==="selected"?"Terpilih":g.status==="rejected"?"Tidak Terpilih":"Aktif";o+="<tr>",o+=re===0?`<td style="border:1px solid #eee;padding:6px;vertical-align:top;" rowspan="${p.length}"><b>${s}</b></td>`:"",o+=`<td style="border:1px solid #eee;padding:6px;">${g.supplier_name}</td>`,o+=`<td style="border:1px solid #eee;padding:6px;">Rp ${Number(g.price).toLocaleString("id-ID")}</td>`,o+=`<td style="border:1px solid #eee;padding:6px;${it}">${rt}</td>`,o+=`<td style="border:1px solid #eee;padding:6px;">${new Date(g.created_at).toLocaleString("id-ID")}</td>`,o+=`<td style="border:1px solid #eee;padding:6px;">${g.created_by_name}</td>`,o+="</tr>"})}),o+="</tbody></table></div>",o},lt=x(()=>{const a=ue().props.auth.user;return a.status==="A"&&(a.id_role==="5af56935b011a"||a.division_id===20)});function nt(){console.log("Evidence added")}async function ot(){var e,o;if((await b.fire({title:"Hapus Task?",text:"Semua data terkait task ini akan dihapus permanen!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed){z.value=!0;try{const s=await D.delete(`/api/maintenance-tasks/${c.task.id}`);s.data.success?(b.fire("Berhasil","Task berhasil dihapus","success"),ce("taskMoved")):b.fire("Gagal",s.data.message||"Gagal menghapus task","error")}catch(s){b.fire("Error",((o=(e=s.response)==null?void 0:e.data)==null?void 0:o.message)||"Gagal menghapus task","error")}finally{z.value=!1}}}return(a,e)=>{var o;return l(),n("div",{class:y(["kanban-card bg-white rounded-xl shadow-lg p-4 cursor-move border border-gray-200 hover:shadow-xl transition-all duration-200 select-none flex flex-col gap-2 relative",{"cursor-not-allowed":!ie.value}]),draggable:"true",onDragstart:Me,onDragend:Pe},[B.value?(l(),n("div",Pt,e[14]||(e[14]=[t("div",{class:"flex items-center gap-2"},[t("div",{class:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),t("span",{class:"text-sm text-blue-600"},"Moving...")],-1)]))):u("",!0),t("div",Dt,[t("button",{onClick:e[0]||(e[0]=dt(s=>_.value=!_.value,["stop"])),class:"p-1 rounded-full hover:bg-gray-100 focus:outline-none"},e[15]||(e[15]=[t("i",{class:"fas fa-ellipsis-v text-gray-500"},null,-1)]))]),_.value?(l(),n("div",Et,[t("button",{onClick:e[1]||(e[1]=s=>X.value=!0),class:"w-full text-left px-4 py-2 hover:bg-blue-50 text-gray-700 flex items-center gap-2"},e[16]||(e[16]=[t("i",{class:"fas fa-stream"},null,-1),h(" Timeline ")])),t("button",{onClick:Le,class:"w-full text-left px-4 py-2 hover:bg-blue-50 text-gray-700 flex items-center gap-2"},e[17]||(e[17]=[t("i",{class:"fas fa-user-plus"},null,-1),h(" Assign Member ")])),r(gt,{"task-id":i.task.id,user:E.value,onActionPlanCreated:Ue},null,8,["task-id","user"]),we.value?(l(),n("button",{key:0,onClick:Je,class:"w-full text-left px-4 py-2 hover:bg-gray-100 flex items-center"},e[18]||(e[18]=[t("i",{class:"fas fa-shopping-cart mr-2"},null,-1),h(" Retail ")]))):u("",!0),i.task.status==="PR"?(l(),n("button",{key:1,onClick:e[2]||(e[2]=s=>Z.value=!0),class:"w-full text-left px-4 py-2 hover:bg-blue-50 text-gray-700 flex items-center gap-2"},e[19]||(e[19]=[t("i",{class:"fas fa-file-invoice"},null,-1),h(" Buat PR ")]))):u("",!0),i.task.status==="PO"?(l(),n("button",{key:2,onClick:e[3]||(e[3]=s=>ee.value=!0),class:"w-full text-left px-4 py-2 hover:bg-blue-50 text-gray-700 flex items-center gap-2"},e[20]||(e[20]=[t("i",{class:"fas fa-file-invoice-dollar"},null,-1),h(" Buat PO ")]))):u("",!0),i.task.status==="PO"?(l(),n("button",{key:3,onClick:at,class:"w-full text-left px-4 py-2 hover:bg-blue-50 text-gray-700 flex items-center gap-2"},e[21]||(e[21]=[t("i",{class:"fas fa-history mr-2"},null,-1),h(" History Bidding ")]))):u("",!0),lt.value&&i.task.status==="IN_REVIEW"?(l(),n("button",{key:4,onClick:e[4]||(e[4]=s=>ae.value=!0),class:"w-full text-left px-4 py-2 hover:bg-blue-50 text-gray-700 flex items-center gap-2"},e[22]||(e[22]=[t("i",{class:"fas fa-camera"},null,-1),h(" Evidence ")]))):u("",!0),t("button",{onClick:ot,disabled:z.value,class:"w-full text-left px-4 py-2 hover:bg-red-50 text-red-600 flex items-center gap-2"},[e[24]||(e[24]=t("i",{class:"fas fa-trash"},null,-1)),z.value?(l(),n("span",St,e[23]||(e[23]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),h(" Menghapus... ")]))):(l(),n("span",At,"Delete Task"))],8,Rt),e[25]||(e[25]=t("div",{class:"border-t border-gray-200 my-1"},null,-1)),e[26]||(e[26]=t("div",{class:"px-4 py-2 text-xs text-gray-500 font-semibold"},"Move Task",-1)),(l(),n(M,null,P(["TASK","PR","PO","IN_PROGRESS","IN_REVIEW","DONE"],s=>t("button",{key:s,onClick:p=>Ze(s),class:"flex items-center gap-2 w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-blue-50",disabled:!ie.value},[t("i",{class:y(et(s))},null,2),h(" "+v(s==="TASK"?"TO DO":s),1)],8,$t)),64))])):u("",!0),t("div",Ot,v(i.task.task_number),1),t("div",It,[e[27]||(e[27]=t("i",{class:"fas fa-user"},null,-1)),t("span",null,v(i.task.created_by_name),1),e[28]||(e[28]=t("i",{class:"fas fa-calendar ml-2"},null,-1)),t("span",null,v(le(i.task.created_at)),1)]),t("div",{class:y(["flex items-center gap-2 text-xs",Ce.value])},[e[29]||(e[29]=t("i",{class:"far fa-clock"},null,-1)),t("span",null,"Due: "+v(le(i.task.due_date)),1)],2),i.task.status==="DONE"&&i.task.completed_at?(l(),n("div",{key:2,class:y(["flex items-center gap-2 text-xs mt-1",Te.value])},[e[30]||(e[30]=t("i",{class:"fas fa-flag-checkered"},null,-1)),t("span",null,"Finish: "+v(le(i.task.completed_at)),1),se.value?(l(),n("span",Nt,"("+v(_e.value)+" hari telat)",1)):u("",!0)],2)):u("",!0),t("div",jt,[t("span",{class:y(["text-xs px-2 py-1 rounded",{"bg-red-100 text-red-700":i.task.priority_name==="IMPORTANT VS URGENT","bg-yellow-100 text-yellow-700":i.task.priority_name==="IMPORTANT NOT URGENT","bg-blue-100 text-blue-700":i.task.priority_name==="NOT IMPORTANT VS URGENT","bg-green-100 text-green-700":i.task.priority_name==="NOT IMPORTANT NOT URGENT"}])},[e[31]||(e[31]=t("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),h(" "+v(i.task.priority_name),1)],2),t("span",{class:"text-xs px-2 py-1 rounded flex items-center gap-1",style:ct({backgroundColor:ye(i.task.label_name)+"20",color:ye(i.task.label_name)})},[t("i",{class:y(["fas",ze(i.task.label_name)])},null,2),h(" "+v(i.task.label_name),1)],4)]),t("div",Bt,[t("h3",Gt,v(i.task.title),1),t("p",{class:y(["text-sm text-gray-600 mt-1",{"line-clamp-2":!R.value}])},v(i.task.description),3),t("button",{onClick:e[5]||(e[5]=s=>R.value=!R.value),class:"text-xs text-blue-600 hover:text-blue-800 mt-1"},[h(" Show "+v(R.value?"less":"more")+" ",1),t("i",{class:y(["fas",R.value?"fa-chevron-up":"fa-chevron-down"])},null,2)])]),t("div",zt,[t("div",Ft,[e[32]||(e[32]=t("i",{class:"fas fa-users text-blue-400"},null,-1)),e[33]||(e[33]=t("span",{class:"text-xs text-gray-700 font-semibold"},"Members",-1)),t("span",Lt,"("+v(((o=i.task.members)==null?void 0:o.length)||0)+")",1)]),t("div",Vt,[(l(!0),n(M,null,P(i.task.members,(s,p)=>(l(),n("div",{key:s.id,class:y(["w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold mr-1 cursor-pointer",Ke(p)]),title:s.nama_lengkap},v(We(s.nama_lengkap)),11,Ht))),128))])]),t("div",Wt,[t("button",{onClick:De,class:"w-full flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50 rounded px-2 py-1"},[t("div",Kt,[e[34]||(e[34]=t("i",{class:"fas fa-paperclip"},null,-1)),t("span",null,"Attachments ("+v(Ee.value)+")",1)]),t("i",{class:y(["fas",S.value?"fa-chevron-up":"fa-chevron-down"])},null,2)]),S.value?(l(),n("div",Ut,[k.value.images.length?(l(),n("div",Yt,[t("div",qt,"Photos ("+v(k.value.images.length)+")",1),t("div",Qt,[(l(!0),n(M,null,P(Re.value,s=>(l(),n("div",{key:s.id,class:"w-12 h-12 rounded border cursor-pointer overflow-hidden",onClick:p=>$e(s)},[t("img",{src:s.url,alt:s.name,class:"w-full h-full object-cover"},null,8,Xt)],8,Jt))),128)),k.value.images.length>3?(l(),n("div",{key:0,class:"w-12 h-12 rounded border bg-gray-100 flex items-center justify-center text-xs text-gray-600 cursor-pointer",onClick:e[6]||(e[6]=s=>Oe("image",3))}," +"+v(k.value.images.length-3),1)):u("",!0)])])):u("",!0),k.value.videos.length?(l(),n("div",Zt,[t("div",ea,"Videos ("+v(k.value.videos.length)+")",1),t("div",ta,[(l(!0),n(M,null,P(k.value.videos,s=>(l(),n("div",{key:s.id,class:"w-16 h-12 rounded bg-gray-100 flex items-center justify-center cursor-pointer relative group",onClick:p=>Ie(s)},[s.thumbnail?(l(),n("img",{key:0,src:s.thumbnail,alt:s.name,class:"w-full h-full object-cover rounded"},null,8,sa)):u("",!0),e[35]||(e[35]=t("div",{class:"absolute inset-0 bg-black/40 group-hover:bg-black/60 flex items-center justify-center transition-all"},[t("i",{class:"fas fa-play text-white"})],-1))],8,aa))),128))])])):u("",!0),F.value.length?(l(),n("div",la,[t("div",na,"Documents ("+v(F.value.length)+")",1),t("div",oa,[(l(!0),n(M,null,P(F.value,s=>(l(),n("div",{key:s.id,class:"flex items-center gap-2 p-2 rounded bg-gray-50 text-xs cursor-pointer hover:bg-gray-100 group",onClick:p=>Ge(s)},[t("i",{class:y(Ae(s.type))},null,2),t("div",null,[t("div",ra,v(s.name),1),t("div",ua,v(Se(s.size)),1)])],8,ia))),128))])])):u("",!0)])):u("",!0)]),t("div",da,[t("button",{onClick:qe,class:"w-full flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50 rounded px-2 py-1"},[e[36]||(e[36]=t("div",{class:"flex items-center gap-2"},[t("i",{class:"fas fa-clipboard-list"}),t("span",null,"Action Plan")],-1)),t("i",{class:y(["fas",N.value?"fa-chevron-up":"fa-chevron-down"])},null,2)]),N.value?(l(),n("div",ca,[r(xt,{ref_key:"actionPlanList",ref:fe,"task-id":i.task.id},null,8,["task-id"])])):u("",!0)]),t("div",fa,[t("button",{onClick:Xe,class:"w-full flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50 rounded px-2 py-1"},[e[37]||(e[37]=t("div",{class:"flex items-center gap-2"},[t("i",{class:"fas fa-camera"}),t("span",null,"Evidence")],-1)),t("i",{class:y(["fas",G.value?"fa-chevron-up":"fa-chevron-down"])},null,2)]),G.value?(l(),n("div",va,[r(Tt,{"task-id":i.task.id},null,8,["task-id"])])):u("",!0)]),t("div",ma,[t("button",{onClick:Qe,class:"w-full flex items-center justify-between text-sm text-gray-600 hover:bg-gray-50 rounded px-2 py-1"},[e[38]||(e[38]=t("div",{class:"flex items-center gap-2"},[t("i",{class:"fas fa-shopping-cart"}),t("span",null,"Retail Data")],-1)),t("i",{class:y(["fas",j.value?"fa-chevron-up":"fa-chevron-down"])},null,2)]),j.value?(l(),n("div",pa,[r(kt,{ref_key:"retailList",ref:ve,"task-id":i.task.id},null,8,["task-id"])])):u("",!0)]),t("button",{onClick:e[7]||(e[7]=s=>q.value=!0),class:"flex items-center justify-center gap-2 text-sm text-gray-600 hover:bg-gray-50 rounded px-2 py-1 mt-1"},[t("div",ga,[e[39]||(e[39]=t("i",{class:"far fa-comment"},null,-1)),Q.value>0?(l(),n("span",xa,v(Q.value),1)):u("",!0)]),e[40]||(e[40]=t("span",null,"Comments",-1))]),r(f(W),{appear:"",show:K.value,as:"template"},{default:m(()=>[r(f(L),{as:"div",onClose:pe,class:"relative z-50"},{default:m(()=>[r(f(C),{enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>[r(f(V),{class:"fixed inset-0 bg-black/75"})]),_:1}),t("div",ya,[t("div",ka,[r(f(C),{enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:m(()=>[r(f(H),{class:"relative bg-white rounded-lg max-w-3xl"},{default:m(()=>[t("button",{onClick:pe,class:"absolute -top-10 right-0 text-white hover:text-gray-300"},e[41]||(e[41]=[t("i",{class:"fas fa-times text-xl"},null,-1)])),A.value?(l(),n("img",{key:0,src:A.value.url,alt:A.value.name,class:"rounded-lg"},null,8,ha)):u("",!0)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]),r(f(W),{appear:"",show:U.value,as:"template"},{default:m(()=>[r(f(L),{as:"div",onClose:ge,class:"relative z-50"},{default:m(()=>[r(f(C),{enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>[r(f(V),{class:"fixed inset-0 bg-black/90"})]),_:1}),t("div",ba,[t("div",wa,[r(f(C),{enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:m(()=>[r(f(H),{class:"relative w-full max-w-4xl p-4"},{default:m(()=>[w.value>0?(l(),n("button",{key:0,onClick:Ne,class:"absolute left-4 top-1/2 -translate-y-1/2 text-white hover:text-gray-300 z-10"},e[42]||(e[42]=[t("i",{class:"fas fa-chevron-left text-3xl"},null,-1)]))):u("",!0),w.value<me.value-1?(l(),n("button",{key:1,onClick:je,class:"absolute right-4 top-1/2 -translate-y-1/2 text-white hover:text-gray-300 z-10"},e[43]||(e[43]=[t("i",{class:"fas fa-chevron-right text-3xl"},null,-1)]))):u("",!0),t("button",{onClick:ge,class:"absolute top-4 right-4 text-white hover:text-gray-300 z-10"},e[44]||(e[44]=[t("i",{class:"fas fa-times text-xl"},null,-1)])),t("div",Ca,[T.value.mediaType==="image"?(l(),n("img",{key:0,src:T.value.url,alt:T.value.name,class:"w-full h-full object-contain"},null,8,_a)):T.value.mediaType==="video"?(l(),n("video",{key:1,src:T.value.url,ref:s=>{T.value.mediaType==="video"&&(O.value=s)},controls:"",class:"w-full h-full"},null,8,Ta)):u("",!0)]),t("div",Ma,[(l(!0),n(M,null,P(ne.value,(s,p)=>(l(),n("button",{key:s.id,onClick:g=>Be(p),class:y(["w-16 h-12 rounded overflow-hidden border-2",w.value===p?"border-white":"border-transparent"])},[s.mediaType==="image"?(l(),n("img",{key:0,src:s.url,alt:s.name,class:"w-full h-full object-cover"},null,8,Da)):(l(),n("div",Ea,e[45]||(e[45]=[t("i",{class:"fas fa-play text-white"},null,-1)])))],10,Pa))),128))])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]),r(f(W),{appear:"",show:Y.value,as:"template"},{default:m(()=>[r(f(L),{as:"div",onClose:xe,class:"relative z-50"},{default:m(()=>[r(f(C),{enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>[r(f(V),{class:"fixed inset-0 bg-black/75"})]),_:1}),t("div",Ra,[t("div",Aa,[r(f(C),{enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:m(()=>[r(f(H),{class:"relative bg-black rounded-lg overflow-hidden max-w-3xl"},{default:m(()=>[t("button",{onClick:xe,class:"absolute top-4 right-4 text-white hover:text-gray-300 z-10"},e[46]||(e[46]=[t("i",{class:"fas fa-times text-xl"},null,-1)])),$.value?(l(),n("video",{key:0,src:$.value.url,ref_key:"videoPlayer",ref:O,controls:"",class:"w-full"},null,8,Sa)):u("",!0)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]),q.value?(l(),de(vt,{key:3,"task-id":i.task.id,onClose:e[8]||(e[8]=s=>q.value=!1),onCommentAdded:Fe},null,8,["task-id"])):u("",!0),I.value?(l(),de(mt,{key:4,show:I.value,"task-id":i.task.id,"on-close":Ve,onSaved:He},null,8,["show","task-id"])):u("",!0),r(f(W),{appear:"",show:J.value,as:"template"},{default:m(()=>[r(f(L),{as:"div",onClose:oe,class:"relative z-[8888]"},{default:m(()=>[r(f(C),{enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>[r(f(V),{class:"fixed inset-0 bg-black/40"})]),_:1}),t("div",$a,[t("div",Oa,[r(f(C),{enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:m(()=>[r(f(H),{class:"w-full max-w-3xl transform overflow-hidden rounded-lg bg-white p-6 text-left align-middle shadow-xl transition-all"},{default:m(()=>[t("div",{class:"flex justify-between items-center mb-4"},[e[48]||(e[48]=t("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Buat Retail ",-1)),t("button",{onClick:oe,class:"text-gray-400 hover:text-gray-500"},e[47]||(e[47]=[t("i",{class:"fas fa-times"},null,-1)]))]),r(yt,{"task-id":i.task.id,onSaved:Ye},null,8,["task-id"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]),r(ht,{show:X.value,"task-id":i.task.id,"on-close":()=>X.value=!1},null,8,["show","task-id","on-close"]),r(bt,{show:Z.value,"task-id":i.task.id,onClose:e[9]||(e[9]=s=>Z.value=!1)},null,8,["show","task-id"]),r(wt,{show:ee.value,"task-id":i.task.id,onClose:e[10]||(e[10]=s=>ee.value=!1),onSelectType:tt,onOpenDirectPo:e[11]||(e[11]=s=>te.value=!0)},null,8,["show","task-id"]),r(Ct,{show:te.value,"task-id":i.task.id,onClose:e[12]||(e[12]=s=>te.value=!1)},null,8,["show","task-id"]),ae.value?(l(),de(_t,{key:5,"task-id":i.task.id,onClose:e[13]||(e[13]=s=>ae.value=!1),onEvidenceAdded:nt},null,8,["task-id"])):u("",!0)],34)}}},us=Mt(Ia,[["__scopeId","data-v-204c22ef"]]);export{us as default};
