import{r as p,c as R,a as W,A as z,B as a,C as G,D as t,L as n,G as g,O as J,H as S,J as T,N as l,E as x,F as y,M as w,l as b,W as $}from"./vendor-vue-g7iCcTkf.js";import{A as P}from"./AppLayout-BXpmQkyt.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./app-ErXbte2J.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-C0i_S3gs.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const Y={class:"max-w-7xl mx-auto py-8 px-2"},X={class:"flex justify-between items-center mb-6"},Z={class:"flex gap-2"},tt=["disabled"],et={key:0},st={key:1},ot={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},at={class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white rounded-xl shadow-lg p-6 mb-6"},lt={class:"flex items-center justify-between"},rt={class:"text-3xl font-bold"},nt={class:"text-right"},it={class:"text-3xl font-bold"},dt={key:0,class:"text-center py-12"},ut={key:1,class:"space-y-4"},ct=["onClick"],mt={class:"flex items-center justify-between"},ft={class:"flex items-center gap-3 flex-1"},pt={class:"text-lg font-semibold text-gray-800"},gt={key:0,class:"text-sm text-gray-500"},xt={class:"text-sm text-gray-600"},bt={class:"text-right"},vt={class:"text-lg font-bold text-blue-600"},ht={key:0,class:"bg-gray-50"},_t=["onClick"],yt={class:"flex items-center justify-between"},wt={class:"flex items-center gap-3 flex-1"},kt={class:"font-semibold text-gray-700"},Ct={class:"text-sm text-gray-600"},Dt={class:"text-right"},St={class:"font-bold text-green-600"},Tt={key:0,class:"bg-white"},Ft=["onClick"],Lt={class:"flex items-center justify-between"},Rt={class:"flex items-center gap-3 flex-1"},$t={class:"font-medium text-gray-800"},jt={class:"text-sm text-gray-600"},Bt={key:0,class:"ml-2"},Ot={class:"text-right"},It={class:"font-bold text-purple-600"},Mt={key:0,class:"bg-gray-50"},Nt={class:"overflow-x-auto"},Et={class:"w-full"},Vt={class:"divide-y divide-gray-200"},Ut={class:"px-4 py-2 text-sm text-gray-800"},At={class:"px-4 py-2 text-sm text-gray-600 text-right"},qt={class:"px-4 py-2 text-sm text-gray-600 text-right"},Ht={class:"px-4 py-2 text-sm font-semibold text-gray-800 text-right"},Kt={key:0,class:"text-center py-12 bg-white rounded-xl shadow-lg"},Wt={__name:"ReportSupplier",props:{suppliers:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({search:"",date_from:"",date_to:""})},user:{type:Object,required:!0}},setup(F){const u=F,k=p(!1),_=p(!1),m=p({}),v=p({}),h=p({}),C=()=>{const s=new Date,e=s.getFullYear(),o=s.getMonth(),d=new Date(e,o,1).toISOString().split("T")[0],K=new Date(e,o+1,0).toISOString().split("T")[0];return{dateFrom:d,dateTo:K}},{dateFrom:j,dateTo:B}=C(),r=p({search:u.filters.search||"",date_from:u.filters.date_from||j,date_to:u.filters.date_to||B}),O=R(()=>u.suppliers.reduce((s,e)=>s+(parseFloat(e.total_amount)||0),0)),L=R(()=>{if(!r.value.search)return u.suppliers;const s=r.value.search.toLowerCase();return u.suppliers.filter(e=>e.name.toLowerCase().includes(s)||e.code&&e.code.toLowerCase().includes(s)?!0:e.outlets.some(o=>o.name.toLowerCase().includes(s)?!0:o.transactions.some(i=>i.retail_number.toLowerCase().includes(s)||i.notes&&i.notes.toLowerCase().includes(s)?!0:i.items.some(d=>d.item_name.toLowerCase().includes(s)))))}),I=s=>{m.value[s]=!m.value[s]},M=(s,e)=>{const o=`${s}-${e}`;v.value[o]=!v.value[o]},N=s=>{h.value[s]=!h.value[s]},E=s=>s.outlets.reduce((e,o)=>e+o.transactions.length,0),D=()=>{k.value=!0,$.get(route("retail-food.report-supplier"),r.value,{preserveState:!0,preserveScroll:!0,onFinish:()=>{k.value=!1}})},V=()=>{const{dateFrom:s,dateTo:e}=C();r.value={search:"",date_from:s,date_to:e},D()},U=()=>{$.visit(route("retail-food.index"))},A=()=>{_.value=!0;const s=new URLSearchParams;r.value.search&&s.append("search",r.value.search),r.value.date_from&&s.append("date_from",r.value.date_from),r.value.date_to&&s.append("date_to",r.value.date_to);const e=route("retail-food.report-supplier.export")+"?"+s.toString();window.open(e,"_blank"),setTimeout(()=>{_.value=!1},2e3)},f=s=>new Intl.NumberFormat("id-ID").format(s||0),q=s=>new Intl.NumberFormat("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),H=s=>s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}):"";return W(()=>{if(u.suppliers.length>0&&(m.value[u.suppliers[0].id]=!0),!u.filters.date_from||!u.filters.date_to){const{dateFrom:s,dateTo:e}=C();r.value.date_from=s,r.value.date_to=e,D()}}),(s,e)=>(a(),z(P,null,{default:G(()=>[t("div",Y,[t("div",X,[e[5]||(e[5]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-chart-line text-blue-500"}),g(" Report Retail Food per Supplier ")],-1)),t("div",Z,[t("button",{onClick:A,class:"bg-green-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold",disabled:_.value},[e[3]||(e[3]=t("i",{class:"fa-solid fa-file-excel mr-2"},null,-1)),_.value?(a(),n("span",st,"Exporting...")):(a(),n("span",et,"Export Excel"))],8,tt),t("button",{onClick:U,class:"bg-gray-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},e[4]||(e[4]=[t("i",{class:"fa-solid fa-arrow-left mr-2"},null,-1),g("Kembali ")]))])]),t("div",ot,[e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},[t("i",{class:"fa-solid fa-filter text-blue-500"}),g(" Filter Data ")],-1)),t("form",{onSubmit:J(D,["prevent"]),class:"grid grid-cols-1 md:grid-cols-4 gap-4"},[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Cari (Semua Kolom)",-1)),S(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>r.value.search=o),placeholder:"Supplier, outlet, item, no. transaksi...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[T,r.value.search]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Dari",-1)),S(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=o=>r.value.date_from=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[T,r.value.date_from]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Sampai",-1)),S(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=o=>r.value.date_to=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[T,r.value.date_to]])]),t("div",{class:"flex items-end gap-2"},[e[10]||(e[10]=t("button",{type:"submit",class:"flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors font-semibold"},[t("i",{class:"fa-solid fa-search mr-2"}),g("Filter ")],-1)),t("button",{type:"button",onClick:V,class:"bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors"},e[9]||(e[9]=[t("i",{class:"fa-solid fa-refresh"},null,-1)]))])],32)]),t("div",at,[t("div",lt,[t("div",null,[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold mb-2"},"Total Supplier",-1)),t("p",rt,l(F.suppliers.length),1)]),t("div",nt,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold mb-2"},"Total Belanja",-1)),t("p",it,"Rp "+l(f(O.value)),1)])])]),k.value?(a(),n("div",dt,e[14]||(e[14]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Memuat data...",-1)]))):(a(),n("div",ut,[(a(!0),n(y,null,w(L.value,o=>(a(),n("div",{key:o.id,class:"bg-white rounded-xl shadow-lg overflow-hidden"},[t("div",{onClick:i=>I(o.id),class:b(["p-4 cursor-pointer hover:bg-gray-50 transition-colors border-b border-gray-200",{"bg-blue-50":m.value[o.id]}])},[t("div",mt,[t("div",ft,[t("i",{class:b(["fa-solid transition-transform duration-200",m.value[o.id]?"fa-chevron-down":"fa-chevron-right"])},null,2),t("div",null,[t("h3",pt,[g(l(o.name)+" ",1),o.code?(a(),n("span",gt,"("+l(o.code)+")",1)):x("",!0)]),t("p",xt,l(o.outlets.length)+" Outlet • "+l(E(o))+" Transaksi ",1)])]),t("div",bt,[t("p",vt,"Rp "+l(f(o.total_amount)),1)])])],10,ct),m.value[o.id]?(a(),n("div",ht,[(a(!0),n(y,null,w(o.outlets,i=>(a(),n("div",{key:i.id,class:"border-b border-gray-200 last:border-b-0"},[t("div",{onClick:d=>M(o.id,i.id),class:b(["p-4 pl-12 cursor-pointer hover:bg-gray-100 transition-colors",{"bg-gray-100":v.value[`${o.id}-${i.id}`]}])},[t("div",yt,[t("div",wt,[t("i",{class:b(["fa-solid transition-transform duration-200 text-sm",v.value[`${o.id}-${i.id}`]?"fa-chevron-down":"fa-chevron-right"])},null,2),t("div",null,[t("h4",kt,l(i.name),1),t("p",Ct,l(i.transactions.length)+" Transaksi",1)])]),t("div",Dt,[t("p",St,"Rp "+l(f(i.total_amount)),1)])])],10,_t),v.value[`${o.id}-${i.id}`]?(a(),n("div",Tt,[(a(!0),n(y,null,w(i.transactions,d=>(a(),n("div",{key:d.id,class:"border-b border-gray-200 last:border-b-0"},[t("div",{onClick:c=>N(d.id),class:b(["p-4 pl-20 cursor-pointer hover:bg-blue-50 transition-colors",{"bg-blue-50":h.value[d.id]}])},[t("div",Lt,[t("div",Rt,[t("i",{class:b(["fa-solid transition-transform duration-200 text-sm",h.value[d.id]?"fa-chevron-down":"fa-chevron-right"])},null,2),t("div",null,[t("h5",$t,l(d.retail_number),1),t("p",jt,[g(l(H(d.transaction_date))+" ",1),d.notes?(a(),n("span",Bt,"• "+l(d.notes),1)):x("",!0)])])]),t("div",Ot,[t("p",It,"Rp "+l(f(d.total_amount)),1)])])],10,Ft),h.value[d.id]?(a(),n("div",Mt,[t("div",Nt,[t("table",Et,[e[15]||(e[15]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-semibold text-gray-700 uppercase"},"Item"),t("th",{class:"px-4 py-2 text-right text-xs font-semibold text-gray-700 uppercase"},"Qty"),t("th",{class:"px-4 py-2 text-right text-xs font-semibold text-gray-700 uppercase"},"Harga"),t("th",{class:"px-4 py-2 text-right text-xs font-semibold text-gray-700 uppercase"},"Subtotal")])],-1)),t("tbody",Vt,[(a(!0),n(y,null,w(d.items,c=>(a(),n("tr",{key:c.id,class:"hover:bg-gray-50"},[t("td",Ut,l(c.item_name),1),t("td",At,l(q(c.qty))+" "+l(c.unit),1),t("td",qt," Rp "+l(f(c.price)),1),t("td",Ht," Rp "+l(f(c.subtotal)),1)]))),128))])])])])):x("",!0)]))),128))])):x("",!0)]))),128))])):x("",!0)]))),128)),L.value.length===0?(a(),n("div",Kt,e[16]||(e[16]=[t("i",{class:"fa-solid fa-inbox text-4xl text-gray-400 mb-4"},null,-1),t("p",{class:"text-gray-600"},"Tidak ada data ditemukan",-1)]))):x("",!0)]))])]),_:1}))}},se=Q(Wt,[["__scopeId","data-v-403aa179"]]);export{se as default};
