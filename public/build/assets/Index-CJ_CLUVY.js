import{r as u,w,c as B,A as L,B as o,C as I,D as t,L as n,E as v,G as k,H as E,J as $,N as s,l as f,F as D,M as F}from"./vendor-vue-g7iCcTkf.js";import{A as M}from"./AppLayout-D_GBiqpN.js";import{a as T}from"./vendor-utils-CpgP2uT4.js";import"./app-D3yJLFoH.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DW6hwgWG.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const P={class:"w-full py-8 px-2"},V={class:"bg-white rounded-xl shadow-xl p-6 mb-6"},U={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},j={class:"flex items-end gap-2"},W=["disabled"],z={key:0,class:"fa-solid fa-spinner fa-spin mr-1"},H={key:1,class:"fa-solid fa-search mr-1"},J=["disabled"],K={key:0,class:"fa-solid fa-spinner fa-spin mr-1"},q={key:1,class:"fa-solid fa-rotate mr-1"},Q=["href"],X={class:"border-b border-gray-200 mb-6"},Y={class:"flex gap-1","aria-label":"Tabs"},Z={key:0,class:"bg-white rounded-xl shadow-xl p-12 text-center"},tt={key:1,class:"bg-white rounded-xl shadow-xl overflow-x-auto"},et={class:"min-w-full divide-y divide-gray-200"},st={class:"bg-white divide-y divide-gray-200"},at={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"},rt={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},it={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},ot={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},nt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},pt={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 text-right"},ct={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},lt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},xt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},dt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},ut={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},gt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},yt={key:0},mt={key:2,class:"bg-white rounded-xl shadow-xl overflow-x-auto"},ht={class:"min-w-full divide-y divide-gray-200"},_t={class:"bg-white divide-y divide-gray-200"},ft={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"},bt={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},wt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},vt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},kt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Ct={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 text-right"},Nt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Dt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Ft={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Rt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},St={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Tt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},At={key:0},Ot={key:3,class:"bg-white rounded-xl shadow-xl overflow-x-auto"},Gt={class:"min-w-full divide-y divide-gray-200"},Bt={class:"bg-white divide-y divide-gray-200"},Lt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"},It={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},Et={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},$t={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Mt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Pt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Vt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Ut={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},jt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Wt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},zt={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 text-right"},Ht={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Jt={key:0},re={__name:"Index",props:{outlets:{type:Array,default:()=>[]},reportRows:{type:Array,default:()=>[]},cogsRows:{type:Array,default:()=>[]},categoryCostRows:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({bulan:""})}},setup(A){const c=A,g=u(!1),_=u(!1),l=u({...c.filters}),p=u("cost_inventory"),y=u(c.reportRows||[]),m=u(c.cogsRows||[]),h=u(c.categoryCostRows||[]),b=u({});w(()=>c.filters,r=>{l.value={...r}},{immediate:!0}),w(()=>c.reportRows,r=>{y.value=r||[]},{immediate:!0}),w(()=>c.cogsRows,r=>{m.value=r||[]},{immediate:!0}),w(()=>c.categoryCostRows,r=>{h.value=r||[]},{immediate:!0});const O=B(()=>{const r=l.value.bulan||"";return`/cost-report/export?bulan=${encodeURIComponent(r)}`});function i(r){if(r==null||r==="")return"0";const a=Number(r);return isNaN(a)?"0":new Intl.NumberFormat("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}function R(){const r=l.value.bulan||"";b.value={},y.value=[],m.value=[],h.value=[],N(p.value,r,!0)}function C(r){p.value=r;const a=l.value.bulan||"";a&&N(r,a,!1)}async function N(r,a,e=!1){var S;if(!a)return;const x=`${a}:${r}`;if(!(!e&&b.value[x])){g.value=!0;try{const d=await T.get("/cost-report/tab-data",{params:{bulan:a,tab:r}});(S=d==null?void 0:d.data)!=null&&S.success&&(r==="cost_inventory"?y.value=d.data.reportRows||[]:r==="cogs"?m.value=d.data.cogsRows||[]:r==="category_cost"&&(h.value=d.data.categoryCostRows||[]),b.value[x]=!0)}catch(d){console.error("Failed to load cost report tab data:",d)}finally{g.value=!1}}}async function G(){const r=l.value.bulan||"";if(r){_.value=!0;try{await T.post("/cost-report/clear-cache",{bulan:r}),b.value={},y.value=[],m.value=[],h.value=[],await N(p.value,r,!0)}catch(a){console.error("Failed to clear cost report cache:",a)}finally{_.value=!1}}}return(r,a)=>(o(),L(M,null,{default:I(()=>[t("div",P,[a[13]||(a[13]=t("div",{class:"flex items-center justify-between mb-6"},[t("h1",{class:"text-2xl font-bold flex items-center gap-2"},[t("i",{class:"fa-solid fa-coins text-amber-500"}),k(" Cost Report ")])],-1)),t("div",V,[t("div",U,[t("div",null,[a[4]||(a[4]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bulan",-1)),E(t("input",{type:"month","onUpdate:modelValue":a[0]||(a[0]=e=>l.value.bulan=e),onChange:R,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[$,l.value.bulan]])]),t("div",j,[t("button",{onClick:R,disabled:g.value||_.value,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed"},[g.value?(o(),n("i",z)):(o(),n("i",H)),k(" "+s(g.value?"Loading...":"Load Data"),1)],8,W),t("button",{onClick:G,disabled:g.value||_.value||!l.value.bulan,class:"inline-flex items-center px-4 py-2 rounded bg-amber-600 text-white hover:bg-amber-700 transition disabled:opacity-50 disabled:cursor-not-allowed"},[_.value?(o(),n("i",K)):(o(),n("i",q)),k(" "+s(_.value?"Clearing...":"Clear Cache"),1)],8,J),t("a",{href:O.value,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center px-4 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700 transition"},a[5]||(a[5]=[t("i",{class:"fa-solid fa-file-excel mr-1"},null,-1),k(" Export to Excel ")]),8,Q)])])]),t("div",X,[t("nav",Y,[t("button",{type:"button",onClick:a[1]||(a[1]=e=>C("cost_inventory")),class:f([p.value==="cost_inventory"?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","px-4 py-3 border-b-2 font-medium text-sm transition"])}," Cost Inventory ",2),t("button",{type:"button",onClick:a[2]||(a[2]=e=>C("cogs")),class:f([p.value==="cogs"?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","px-4 py-3 border-b-2 font-medium text-sm transition"])}," COGS ",2),t("button",{type:"button",onClick:a[3]||(a[3]=e=>C("category_cost")),class:f([p.value==="category_cost"?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","px-4 py-3 border-b-2 font-medium text-sm transition"])}," Category Cost ",2)])]),g.value?(o(),n("div",Z,a[6]||(a[6]=[t("div",{class:"text-blue-500"},[t("i",{class:"fa-solid fa-spinner fa-spin text-4xl mb-4"}),t("p",{class:"text-lg font-medium"},"Memuat data...")],-1)]))):p.value==="cost_inventory"?(o(),n("div",tt,[t("table",et,[a[8]||(a[8]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Begin Inventory (Total MAC)"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Official Cost"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cost RND"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet Transfer"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Barang Tersedia"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ending Inventory"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"COGS Aktual"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sales Before Discount"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Discount"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sales After Discount"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Discount vs Sales")])],-1)),t("tbody",st,[(o(!0),n(D,null,F(y.value||[],(e,x)=>(o(),n("tr",{key:e.outlet_id},[t("td",at,s(x+1),1),t("td",rt,s(e.outlet_name),1),t("td",it,s(i(e.total_begin_mac)),1),t("td",ot,s(i(e.official_cost)),1),t("td",nt,s(i(e.cost_rnd)),1),t("td",{class:f(["px-4 py-3 whitespace-nowrap text-sm text-right",(e.outlet_transfer||0)<0?"text-red-600":"text-gray-900"])},s(i(e.outlet_transfer)),3),t("td",pt,s(i(e.total_barang_tersedia)),1),t("td",ct,s(i(e.ending_inventory)),1),t("td",lt,s(i(e.cogs_aktual)),1),t("td",xt,s(i(e.sales_before_discount)),1),t("td",dt,s(i(e.discount)),1),t("td",ut,s(i(e.sales_after_discount)),1),t("td",gt,s(e.pct_discount!=null?Number(e.pct_discount).toFixed(2)+"%":"-"),1)]))),128)),!y.value||y.value.length===0?(o(),n("tr",yt,a[7]||(a[7]=[t("td",{colspan:"13",class:"px-4 py-8 text-center text-gray-500"},"Tidak ada data. Pilih bulan lalu klik Load Data.",-1)]))):v("",!0)])])])):p.value==="cogs"?(o(),n("div",mt,[t("table",ht,[a[10]||(a[10]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"COGS"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Category Cost"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Meal Employees"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"COGS Pembanding"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Deviasi"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Toleransi 2%"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% COGS Pembanding"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% COGS Actual Before Disc"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% COGS Actual After Disc"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% COGS Foods"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Deviasi"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Category Cost")])],-1)),t("tbody",_t,[(o(!0),n(D,null,F(m.value||[],(e,x)=>(o(),n("tr",{key:e.outlet_id},[t("td",ft,s(x+1),1),t("td",bt,s(e.outlet_name),1),t("td",wt,s(i(e.cogs)),1),t("td",vt,s(i(e.category_cost)),1),t("td",kt,s(i(e.meal_employees)),1),t("td",Ct,s(i(e.cogs_pembanding)),1),t("td",{class:f(["px-4 py-3 whitespace-nowrap text-sm text-right",(e.deviasi||0)<0?"text-red-600":(e.deviasi||0)>0?"text-green-600":"text-gray-900"])},s(i(e.deviasi)),3),t("td",Nt,s(i(e.toleransi_2_pct)),1),t("td",Dt,s(e.pct_cogs_pembanding!=null?Number(e.pct_cogs_pembanding).toFixed(2)+"%":"-"),1),t("td",Ft,s(e.pct_cogs_actual_before_disc!=null?Number(e.pct_cogs_actual_before_disc).toFixed(2)+"%":"-"),1),t("td",Rt,s(e.pct_cogs_actual_after_disc!=null?Number(e.pct_cogs_actual_after_disc).toFixed(2)+"%":"-"),1),t("td",St,s(e.pct_cogs_foods!=null?Number(e.pct_cogs_foods).toFixed(2)+"%":"-"),1),t("td",{class:f(["px-4 py-3 whitespace-nowrap text-sm text-right",(e.pct_deviasi||0)<0?"text-red-600":(e.pct_deviasi||0)>0?"text-green-600":"text-gray-900"])},s(e.pct_deviasi!=null?Number(e.pct_deviasi).toFixed(2)+"%":"-"),3),t("td",Tt,s(e.pct_category_cost!=null?Number(e.pct_category_cost).toFixed(2)+"%":"-"),1)]))),128)),!m.value||m.value.length===0?(o(),n("tr",At,a[9]||(a[9]=[t("td",{colspan:"14",class:"px-4 py-8 text-center text-gray-500"},"Tidak ada data. Pilih bulan lalu klik Load Data.",-1)]))):v("",!0)])])])):p.value==="category_cost"?(o(),n("div",Ot,[t("table",Gt,[a[12]||(a[12]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Guest Supplies"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Guest Supplies"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Spoilage"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Spoilage"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Waste"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Waste"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Non Commodity"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Non Commodity"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Category Cost"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Category Cost")])],-1)),t("tbody",Bt,[(o(!0),n(D,null,F(h.value||[],(e,x)=>(o(),n("tr",{key:e.outlet_id},[t("td",Lt,s(x+1),1),t("td",It,s(e.outlet_name),1),t("td",Et,s(i(e.guest_supplies)),1),t("td",$t,s(e.pct_guest_supplies!=null?Number(e.pct_guest_supplies).toFixed(2)+"%":"-"),1),t("td",Mt,s(i(e.spoilage)),1),t("td",Pt,s(e.pct_spoilage!=null?Number(e.pct_spoilage).toFixed(2)+"%":"-"),1),t("td",Vt,s(i(e.waste)),1),t("td",Ut,s(e.pct_waste!=null?Number(e.pct_waste).toFixed(2)+"%":"-"),1),t("td",jt,s(i(e.non_commodity)),1),t("td",Wt,s(e.pct_non_commodity!=null?Number(e.pct_non_commodity).toFixed(2)+"%":"-"),1),t("td",zt,s(i(e.category_cost)),1),t("td",Ht,s(e.pct_category_cost!=null?Number(e.pct_category_cost).toFixed(2)+"%":"-"),1)]))),128)),!h.value||h.value.length===0?(o(),n("tr",Jt,a[11]||(a[11]=[t("td",{colspan:"12",class:"px-4 py-8 text-center text-gray-500"},"Tidak ada data. Pilih bulan lalu klik Load Data.",-1)]))):v("",!0)])])])):v("",!0)])]),_:1}))}};export{re as default};
