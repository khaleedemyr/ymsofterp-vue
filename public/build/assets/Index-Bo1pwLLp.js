import{$ as U,r as h,c as q,W as x,A as J,B as a,C as Y,L as r,E as A,D as e,Q as H,N as n,G as b,l as g,H as v,J as C,I as G,F as D,M as B}from"./vendor-vue-g7iCcTkf.js";import{l as Q}from"./lodash-DB3HVzpp.js";import{S as M}from"./app-BjOxw_aQ.js";import{A as X}from"./AppLayout-DuOTY_8o.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-B2Hc20Ep.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const Z={key:0,class:"mb-4 mx-4 mt-4"},ee={class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"},te={class:"block sm:inline"},se={class:"w-full py-8 px-0"},oe={class:"flex justify-between items-center mb-6"},ae={class:"mt-2 flex items-center gap-2"},ne={class:"flex items-center gap-1 text-sm"},le={class:"text-gray-600"},re={class:"flex items-center gap-1 text-sm"},ie=["disabled","title"],de={class:"flex flex-wrap gap-3 mb-4 items-center"},ue={class:"bg-white rounded-2xl shadow-2xl overflow-x-auto transition-all"},ce={class:"w-full min-w-full divide-y divide-gray-200"},pe={key:0},xe={class:"px-6 py-3 font-mono font-semibold text-blue-700"},be={class:"px-6 py-3"},ge={class:"px-6 py-3"},fe={class:"px-6 py-3"},me={class:"px-6 py-3"},he={class:"px-6 py-3"},ve={class:"px-6 py-3"},ye={key:0,class:"text-xs space-y-1"},_e={class:"font-semibold text-gray-800"},we={class:"text-gray-600"},Se={class:"text-gray-500"},ke={key:1,class:"text-xs text-gray-400"},Ce={key:0},De={key:1},Be={class:"px-6 py-3"},Me={class:"flex gap-2"},Te=["onClick"],Re=["onClick"],Fe=["onClick"],Pe={class:"flex justify-end mt-4 gap-2"},We=["disabled","onClick","innerHTML"],ze={__name:"Index",props:{prFoods:Object,filters:Object},setup(f){var P,W,I,j;const m=f,T=U(),y=h(((P=m.filters)==null?void 0:P.search)||""),_=h(((W=m.filters)==null?void 0:W.status)||""),w=h(((I=m.filters)==null?void 0:I.from)||""),S=h(((j=m.filters)==null?void 0:j.to)||""),i=q(()=>{const o=new Date,s=new Date(o.getFullYear(),o.getMonth(),o.getDate()),l=new Date(s);l.setHours(10,0,0,0);const t=new Date(s);t.setHours(15,0,0,0);const c=!(o>=l&&o<t),u=p=>p.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"});return{isWithinSchedule:c,startTime:u(l),endTime:u(t),now:u(o),debug:{now:o.toISOString(),closeStart:l.toISOString(),closeEnd:t.toISOString(),isInCloseTime:o>=l&&o<t}}}),k=Q.debounce(()=>{x.get("/pr-foods",{search:y.value,status:_.value,from:w.value,to:S.value},{preserveState:!0,replace:!0})},400);function L(){k()}function $(){k()}function R(){k()}function E(o){o&&x.visit(o,{preserveState:!0,replace:!0})}function F(o){var t,c,u,p;const s=((t=o.warehouse)==null?void 0:t.name)==="MK1 Hot Kitchen"||((c=o.warehouse)==null?void 0:c.name)==="MK2 Cold Kitchen",l=[];if(!s&&o.assistant_ssd_manager_approved_at&&l.push({name:((u=o.assistant_ssd_manager)==null?void 0:u.nama_lengkap)||"Asisten SSD Manager",date:o.assistant_ssd_manager_approved_at,role:o.status==="rejected"&&!o.ssd_manager_approved_at?"Asisten SSD Manager (Rejected)":"Asisten SSD Manager (Approved)"}),o.ssd_manager_approved_at){const d=s?"Sous Chef MK":"SSD Manager",z=o.status==="rejected"?" (Rejected)":" (Approved)";l.push({name:((p=o.ssd_manager)==null?void 0:p.nama_lengkap)||d,date:o.ssd_manager_approved_at,role:d+z})}return l}function K(){if(console.log("Schedule Debug:",i.value.debug),console.log("Is Within Schedule:",i.value.isWithinSchedule),!i.value.isWithinSchedule){M.fire({title:"Jadwal PR Foods",text:"PR Foods hanya bisa dibuat di luar jam 10:00 - 15:00",icon:"warning",confirmButtonText:"OK"});return}x.visit("/pr-foods/create")}function O(o){x.visit(`/pr-foods/${o}/edit`)}function V(o){x.visit(`/pr-foods/${o}`)}async function N(o){(await M.fire({title:"Hapus PR Foods?",text:`Yakin ingin menghapus PR ${o.pr_number}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed&&x.delete(route("pr-foods.destroy",o.id),{onSuccess:()=>M.fire("Berhasil","PR berhasil dihapus!","success")})}return(o,s)=>(a(),J(X,null,{default:Y(()=>{var l;return[(l=H(T).props.flash)!=null&&l.error?(a(),r("div",Z,[e("div",ee,[s[4]||(s[4]=e("strong",{class:"font-bold"},"Error!",-1)),e("span",te,n(H(T).props.flash.error),1)])])):A("",!0),e("div",se,[e("div",oe,[e("div",null,[s[7]||(s[7]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-file-invoice text-blue-500"}),b(" Purchase Requisition Foods ")],-1)),e("div",ae,[e("div",ne,[s[5]||(s[5]=e("i",{class:"fa fa-clock text-blue-500"},null,-1)),s[6]||(s[6]=e("span",{class:"font-medium"},"Jadwal:",-1)),e("span",le,n(i.value.startTime)+" - "+n(i.value.endTime),1)]),e("div",re,[e("i",{class:g(["fa fa-circle",i.value.isWithinSchedule?"text-green-500":"text-red-500"])},null,2),e("span",{class:g([i.value.isWithinSchedule?"text-green-600":"text-red-600","font-medium"])},n(i.value.isWithinSchedule?"Buka":"Tutup"),3)])])]),e("button",{onClick:K,disabled:!i.value.isWithinSchedule,class:g(["px-4 py-2 rounded-xl shadow-lg transition-all font-semibold",i.value.isWithinSchedule?"bg-gradient-to-r from-blue-500 to-blue-700 text-white hover:shadow-2xl cursor-pointer":"bg-gray-300 text-gray-500 cursor-not-allowed"]),title:i.value.isWithinSchedule?"Buat PR Foods Baru":"PR Foods hanya bisa dibuat di luar jam 10:00 - 15:00"},s[8]||(s[8]=[e("i",{class:"fa fa-clock mr-2"},null,-1),b(" + Buat PR Foods Baru ")]),10,ie)]),e("div",de,[v(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>y.value=t),onInput:L,type:"text",placeholder:"Cari nomor PR...",class:"w-64 px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,544),[[C,y.value]]),v(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>_.value=t),onChange:$,class:"px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},s[9]||(s[9]=[e("option",{value:""},"Semua Status",-1),e("option",{value:"draft"},"Draft",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1),e("option",{value:"po"},"PO",-1),e("option",{value:"receive"},"Receive",-1),e("option",{value:"payment"},"Payment",-1)]),544),[[G,_.value]]),v(e("input",{type:"date","onUpdate:modelValue":s[2]||(s[2]=t=>w.value=t),onChange:R,class:"px-2 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Dari tanggal"},null,544),[[C,w.value]]),s[10]||(s[10]=e("span",null,"-",-1)),v(e("input",{type:"date","onUpdate:modelValue":s[3]||(s[3]=t=>S.value=t),onChange:R,class:"px-2 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Sampai tanggal"},null,544),[[C,S.value]])]),e("div",ue,[e("table",ce,[s[15]||(s[15]=e("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tl-2xl"},"No. PR"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Tanggal"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Warehouse"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Warehouse Division"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Requester"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Approver"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tr-2xl"},"Aksi")])],-1)),e("tbody",null,[f.prFoods.data.length===0?(a(),r("tr",pe,s[11]||(s[11]=[e("td",{colspan:"8",class:"text-center py-10 text-gray-400"},"Tidak ada data PR Foods.",-1)]))):A("",!0),(a(!0),r(D,null,B(f.prFoods.data,t=>{var c,u,p;return a(),r("tr",{key:t.id,class:"hover:bg-blue-50 transition shadow-sm"},[e("td",xe,n(t.pr_number),1),e("td",be,n(new Date(t.tanggal).toLocaleDateString("id-ID")),1),e("td",ge,n((c=t.warehouse)==null?void 0:c.name),1),e("td",fe,n(((u=t.warehouse_division)==null?void 0:u.name)||"-"),1),e("td",me,n((p=t.requester)==null?void 0:p.nama_lengkap),1),e("td",he,[e("span",{class:g([{"bg-gray-100 text-gray-700":t.status==="draft","bg-green-100 text-green-700":t.status==="approved","bg-red-100 text-red-700":t.status==="rejected","bg-blue-100 text-blue-700":t.status==="po","bg-yellow-100 text-yellow-700":t.status==="receive","bg-purple-100 text-purple-700":t.status==="payment"},"px-2 py-1 rounded-full text-xs font-semibold shadow"])},n(t.status),3)]),e("td",ve,[F(t).length>0?(a(),r("div",ye,[(a(!0),r(D,null,B(F(t),d=>(a(),r("div",{key:d.date,class:"border-b border-gray-100 pb-1 last:border-b-0"},[e("div",_e,n(d.name),1),e("div",we,n(d.role),1),e("div",Se,n(new Date(d.date).toLocaleString("id-ID")),1)]))),128))])):(a(),r("div",ke,[t.status==="draft"?(a(),r("div",Ce,"Menunggu approval")):(a(),r("div",De,"-"))]))]),e("td",Be,[e("div",Me,[e("button",{onClick:d=>V(t.id),class:"inline-flex items-center btn btn-xs bg-blue-100 text-blue-800 hover:bg-blue-200 rounded px-2 py-1 font-semibold transition"},s[12]||(s[12]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),b(" Detail ")]),8,Te),e("button",{onClick:d=>O(t.id),class:"inline-flex items-center btn btn-xs bg-yellow-100 text-yellow-800 hover:bg-yellow-200 rounded px-2 py-1 font-semibold transition"},s[13]||(s[13]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M15.232 5.232l3.536 3.536M9 13l6-6m2 2l-6 6m-2 2h6a2 2 0 002-2v-6a2 2 0 00-2-2H7a2 2 0 00-2 2v6a2 2 0 002 2z"})],-1),b(" Edit ")]),8,Re),e("button",{onClick:d=>N(t),class:"inline-flex items-center btn btn-xs bg-red-100 text-red-700 hover:bg-red-200 rounded px-2 py-1 font-semibold transition"},s[14]||(s[14]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M6 18L18 6M6 6l12 12"})],-1),b(" Hapus ")]),8,Fe)])])])}),128))])])]),e("div",Pe,[(a(!0),r(D,null,B(f.prFoods.links,t=>(a(),r("button",{key:t.label,disabled:!t.url,onClick:c=>E(t.url),innerHTML:t.label,class:g(["px-3 py-1 rounded-lg border text-sm font-semibold",[t.active?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-700 hover:bg-blue-50",t.url?"cursor-pointer":"opacity-50 cursor-not-allowed"]])},null,10,We))),128))])])]}),_:1}))}};export{ze as default};
