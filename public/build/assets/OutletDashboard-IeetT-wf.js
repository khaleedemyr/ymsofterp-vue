import{$ as X,r,a as Z,a8 as tt,A as R,B as l,C as et,D as t,L as a,E as U,G as st,Q as E,H as T,F as m,M as v,N as d,I as lt,J as Y,l as G,x as H,Y as at}from"./vendor-vue-g7iCcTkf.js";import{A as ot}from"./AppLayout-DwCHohmp.js";import{a as Q}from"./vendor-utils-CpgP2uT4.js";import{m as it}from"./vendor-charts-CuqD4wLC.js";import{_ as rt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./app-BFfP2QJl.js";import"./ProfileUpdateModal-BgI6B89c.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const dt={class:"max-w-7xl mx-auto py-8 px-4 relative"},nt={key:0,class:"absolute inset-0 z-50 flex items-center justify-center bg-white/70"},ut={class:"flex gap-4 mb-6 items-end"},ct={key:0},pt=["value"],mt={key:1},vt={class:"rounded border border-gray-300 px-2 py-1 bg-gray-100 text-gray-700 min-w-[180px]"},bt=["disabled"],ht={key:0,class:"animate-spin"},gt={key:1},xt={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"},yt={class:"text-2xl font-extrabold text-white drop-shadow-lg"},ft={class:"text-white text-sm mt-1 font-semibold tracking-wide uppercase drop-shadow"},_t={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},wt={class:"bg-white rounded-xl shadow p-4 md:col-span-2"},kt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},Ot={class:"bg-white rounded-xl shadow p-4"},Ct={class:"bg-white rounded-xl shadow p-4"},Dt={key:1,class:"text-gray-400 text-center py-8"},Pt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},St={class:"bg-white rounded-xl shadow p-4"},Tt={class:"min-w-full divide-y divide-gray-200"},Mt={class:"px-2 py-1"},jt={class:"px-2 py-1 text-right"},Nt={class:"bg-white rounded-xl shadow p-4"},$t={class:"min-w-full divide-y divide-gray-200"},zt={class:"px-2 py-1"},At={class:"px-2 py-1 text-right"},Lt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},Bt={class:"bg-white rounded-xl shadow p-4"},It={class:"min-w-full divide-y divide-gray-200"},Vt={class:"px-2 py-1"},Ft={class:"px-2 py-1 text-right"},Rt={class:"bg-white rounded-xl shadow p-4"},Ut={class:"min-w-full divide-y divide-gray-200"},Et={class:"px-2 py-1"},Yt={class:"px-2 py-1 text-right"},Gt={class:"px-2 py-1 text-right"},Ht={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},Qt={class:"bg-white rounded-xl shadow p-4"},Wt={class:"list-disc ml-6"},qt={class:"bg-white rounded-xl shadow p-4"},Jt={class:"min-w-full divide-y divide-gray-200"},Kt={class:"px-2 py-1"},Xt={class:"px-2 py-1 text-right"},Zt={class:"mb-10"},te={class:"bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-2xl shadow-2xl p-6 pb-2 relative overflow-hidden animate-fade-in"},ee={class:"flex justify-center gap-6 mb-8"},se={class:"w-20 h-20 rounded-full bg-white border-4 border-white shadow-lg flex items-center justify-center mb-2"},le=["src"],ae={key:1,class:"text-3xl font-bold text-blue-500"},oe={class:"text-white font-bold text-lg drop-shadow"},ie={class:"text-white text-sm font-semibold drop-shadow"},re={key:0,class:"mt-2"},de={class:"bg-white rounded-xl shadow-lg p-4"},ne={class:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center font-bold text-blue-500"},ue={class:"flex-1"},ce={class:"font-semibold text-gray-800"},pe={class:"w-full bg-gray-100 rounded h-2 mt-1"},me={class:"font-bold text-gray-700 ml-2"},ve={components:{apexchart:it}},be=Object.assign(ve,{__name:"OutletDashboard",setup(he){var F;function W(){const o=new Date;return new Date(o.getFullYear(),o.getMonth(),1).toISOString().slice(0,10)}function q(){const o=new Date;return new Date(o.getFullYear(),o.getMonth()+1,0).toISOString().slice(0,10)}const x=((F=X().props.auth)==null?void 0:F.user)||{id_outlet:1,nama_outlet:"Outlet Demo"},_=r([]),b=r(x.id_outlet),w=r(W()),k=r(q()),u=r({}),M=r([]),J=r([]),j=r([]),N=r([]),$=r([]),z=r([]),A=r([]),L=r([]),D=r([]),O=r([]),B=r({}),C=r({chart:{id:"sales"},xaxis:{categories:[]}}),I=r([]),h=r({labels:[]}),P=r([]),y=r({labels:[]}),S=r([]),f=r(!1);Z(async()=>{if(x.id_outlet==1){const o=await Q.get("/api/outlets");_.value=o.data.map(e=>({id:e.id_outlet||e.id,name:e.nama_outlet||e.name})),!b.value&&_.value.length&&(b.value=_.value[0].id)}else b.value=x.id_outlet;await V(),h.value={labels:Object.keys(u.value.payment_methods||{})},P.value=Object.values(u.value.payment_methods||{}),C.value={...C.value,chart:{id:"sales",dropShadow:{enabled:!0,top:4,left:2,blur:8,opacity:.18},toolbar:{show:!0}},stroke:{width:4,curve:"smooth"},markers:{size:5,colors:["#fff"],strokeColors:["#2563eb"],strokeWidth:3,hover:{size:8}},grid:{borderColor:"#eee"},xaxis:{categories:[]},tooltip:{y:{formatter:o=>n(o)}}},h.value={...h.value,chart:{type:"donut",dropShadow:{enabled:!0,top:4,left:2,blur:8,opacity:.18}},plotOptions:{pie:{donut:{size:"65%",labels:{show:!0}}}},legend:{position:"right"},tooltip:{y:{formatter:o=>n(o)},custom:function({series:o,seriesIndex:e,w:c}){return`<div class='px-3 py-2 rounded bg-yellow-400 text-white font-bold'>${c.globals.labels[e]}: ${n(o[e])}</div>`}}},y.value={...y.value,chart:{type:"donut",dropShadow:{enabled:!0,top:4,left:2,blur:8,opacity:.18}},plotOptions:{pie:{donut:{size:"65%",labels:{show:!0}}}},legend:{position:"right"},tooltip:{y:{formatter:o=>n(o)},custom:function({series:o,seriesIndex:e,w:c}){return`<div class='px-3 py-2 rounded bg-yellow-400 text-white font-bold'>${c.globals.labels[e]}: ${n(o[e])}</div>`}}}});function K(o,e){const c=[];let s=new Date(o);const i=new Date(e);for(;s<=i;)c.push(s.toISOString().slice(0,10)),s.setDate(s.getDate()+1);return c}async function V(){f.value=!0;try{const o={id_outlet:b.value,from:w.value,to:k.value},e=await Q.get("/api/outlet-dashboard",{params:o});u.value=e.data.summary,M.value=e.data.sales_chart,J.value=e.data.payment_pie,j.value=e.data.top_items,N.value=e.data.last_orders,$.value=e.data.promo_usage,z.value=e.data.officer_checks,A.value=e.data.active_promos_list,L.value=e.data.investors,D.value=e.data.sales_per_mode||[],O.value=e.data.waiter_leaderboard||[],B.value={total_orders:{label:"Transaksi",value:u.value.total_orders,color:"from-blue-400 to-blue-600"},total_sales:{label:"Penjualan",value:n(u.value.total_sales),color:"from-green-400 to-green-600"},total_pax:{label:"Pax",value:u.value.total_pax,color:"from-yellow-400 to-yellow-600"},avg_order:{label:"Average Check",value:u.value.total_pax>0?n(Math.round(u.value.total_sales/u.value.total_pax)):"Rp 0",color:"from-purple-400 to-purple-600"},total_discount:{label:"Diskon",value:n(u.value.total_discount),color:"from-pink-400 to-pink-600"},total_cashback:{label:"Cashback",value:n(u.value.total_cashback),color:"from-cyan-400 to-cyan-600"},total_commfee:{label:"Commfee",value:n(u.value.total_commfee),color:"from-indigo-400 to-indigo-600"},active_promos:{label:"Promo Aktif",value:u.value.active_promos,color:"from-teal-400 to-teal-600"},investor_count:{label:"Investor",value:u.value.investor_count,color:"from-gray-400 to-gray-600"}};const c=K(w.value,k.value),s=Object.fromEntries((M.value||[]).map(i=>[i.tgl,Number(i.total)||0]));C.value.xaxis.categories=c,I.value=[{name:"Penjualan",data:c.map(i=>s[i]||0)}],h.value={...h.value,labels:Object.keys(e.data.payment_pie||{}),tooltip:{y:{formatter:i=>n(i)},custom:function({series:i,seriesIndex:p,w:g}){return`<div class='px-3 py-2 rounded bg-yellow-400 text-white font-bold'>${g.globals.labels[p]}: ${n(i[p])}</div>`}}},P.value=Object.values(e.data.payment_pie||{}),y.value={...y.value,labels:D.value.map(i=>i.mode||"Tanpa Mode"),tooltip:{y:{formatter:i=>n(i)},custom:function({series:i,seriesIndex:p,w:g}){return`<div class='px-3 py-2 rounded bg-yellow-400 text-white font-bold'>${g.globals.labels[p]}: ${n(i[p])}</div>`}}},S.value=D.value.map(i=>Number(i.total)||0)}finally{f.value=!1}}function n(o){return typeof o!="number"&&(o=Number(o)||0),"Rp "+o.toLocaleString("id-ID")}return(o,e)=>{const c=tt("apexchart");return l(),R(ot,null,{default:et(()=>[t("div",dt,[f.value?(l(),a("div",nt,e[3]||(e[3]=[t("svg",{class:"animate-spin h-12 w-12 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})],-1)]))):U("",!0),e[27]||(e[27]=t("h1",{class:"text-3xl font-bold mb-6 flex items-center gap-2"},[t("i",{class:"fa-solid fa-store text-blue-500"}),st(" Dashboard Sales Outlet ")],-1)),t("div",ut,[E(x).id_outlet==1?(l(),a("div",ct,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Outlet",-1)),T(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),class:"rounded border-gray-300 px-2 py-1"},[e[4]||(e[4]=t("option",{value:""},"Pilih Outlet",-1)),(l(!0),a(m,null,v(_.value,s=>(l(),a("option",{key:s.id,value:s.id},d(s.name),9,pt))),128))],512),[[lt,b.value]])])):(l(),a("div",mt,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Outlet",-1)),t("div",vt,d(E(x).nama_outlet),1)])),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Dari",-1)),T(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>w.value=s),class:"rounded border-gray-300 px-2 py-1"},null,512),[[Y,w.value]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Sampai",-1)),T(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>k.value=s),class:"rounded border-gray-300 px-2 py-1"},null,512),[[Y,k.value]])]),t("button",{onClick:V,disabled:f.value,class:"ml-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition flex items-center gap-2"},[f.value?(l(),a("span",ht,e[9]||(e[9]=[t("svg",{class:"h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})],-1)]))):(l(),a("span",gt,"Tampilkan"))],8,bt)]),t("div",xt,[(l(!0),a(m,null,v(B.value,(s,i,p)=>(l(),a("div",{key:i,class:G(`bg-gradient-to-br ${s.color} rounded-xl shadow-xl p-4 flex flex-col items-center transform transition duration-300 hover:scale-105 hover:shadow-2xl animate-fade-in`),style:{"min-height":"110px","box-shadow":"0 6px 24px 0 rgba(0,0,0,0.08), 0 1.5px 4px 0 rgba(0,0,0,0.08)"}},[t("div",yt,d(s.value),1),t("div",ft,d(s.label),1)],2))),128))]),t("div",_t,[t("div",wt,[e[10]||(e[10]=t("h2",{class:"font-bold mb-2"},"Grafik Penjualan Harian",-1)),H(c,{type:"line",height:"250",options:C.value,series:I.value},null,8,["options","series"])])]),t("div",kt,[t("div",Ot,[e[11]||(e[11]=t("h2",{class:"font-bold mb-2"},"Pie Chart Pembayaran",-1)),H(c,{type:"pie",height:"250",options:h.value,series:P.value},null,8,["options","series"])]),t("div",Ct,[e[12]||(e[12]=t("h2",{class:"font-bold mb-2"},"Pie Chart Penjualan per Mode Transaksi",-1)),S.value.length?(l(),R(c,{key:0,type:"pie",height:"250",options:y.value,series:S.value},null,8,["options","series"])):(l(),a("div",Dt,"Tidak ada data"))])]),t("div",Pt,[t("div",St,[e[14]||(e[14]=t("h2",{class:"font-bold mb-2"},"Top 10 Item Terlaris",-1)),t("table",Tt,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",{class:"text-left px-2 py-1"},"Item"),t("th",{class:"text-right px-2 py-1"},"Qty")])],-1)),t("tbody",null,[(l(!0),a(m,null,v(j.value,s=>(l(),a("tr",{key:s.item_name},[t("td",Mt,d(s.item_name),1),t("td",jt,d(s.total_qty),1)]))),128))])])]),t("div",Nt,[e[16]||(e[16]=t("h2",{class:"font-bold mb-2"},"Promo Terpakai",-1)),t("table",$t,[e[15]||(e[15]=t("thead",null,[t("tr",null,[t("th",{class:"text-left px-2 py-1"},"Promo"),t("th",{class:"text-right px-2 py-1"},"Dipakai")])],-1)),t("tbody",null,[(l(!0),a(m,null,v($.value,s=>(l(),a("tr",{key:s.name},[t("td",zt,d(s.name),1),t("td",At,d(s.used_count),1)]))),128))])])])]),t("div",Lt,[t("div",Bt,[e[18]||(e[18]=t("h2",{class:"font-bold mb-2"},"Transaksi Terakhir",-1)),t("table",It,[e[17]||(e[17]=t("thead",null,[t("tr",null,[t("th",{class:"text-left px-2 py-1"},"Nomor"),t("th",{class:"text-right px-2 py-1"},"Total")])],-1)),t("tbody",null,[(l(!0),a(m,null,v(N.value,s=>(l(),a("tr",{key:s.id},[t("td",Vt,d(s.nomor),1),t("td",Ft,d(n(s.grand_total)),1)]))),128))])])]),t("div",Rt,[e[20]||(e[20]=t("h2",{class:"font-bold mb-2"},"Officer Check Terakhir",-1)),t("table",Ut,[e[19]||(e[19]=t("thead",null,[t("tr",null,[t("th",{class:"text-left px-2 py-1"},"Nama"),t("th",{class:"text-right px-2 py-1"},"Nilai"),t("th",{class:"text-right px-2 py-1"},"Sales")])],-1)),t("tbody",null,[(l(!0),a(m,null,v(z.value.filter(s=>Number(s.transaksi)>0),s=>(l(),a("tr",{key:s.id},[t("td",Et,d(s.user_name),1),t("td",Yt,d(n(s.nilai)),1),t("td",Gt,d(n(s.transaksi)),1)]))),128))])])])]),t("div",Ht,[t("div",Qt,[e[21]||(e[21]=t("h2",{class:"font-bold mb-2"},"Promo Aktif",-1)),t("ul",Wt,[(l(!0),a(m,null,v(A.value,s=>(l(),a("li",{key:s.id},d(s.name),1))),128))])]),t("div",qt,[e[23]||(e[23]=t("h2",{class:"font-bold mb-2"},"Investor",-1)),t("table",Jt,[e[22]||(e[22]=t("thead",null,[t("tr",null,[t("th",{class:"text-left px-2 py-1"},"Nama"),t("th",{class:"text-right px-2 py-1"},"Sales")])],-1)),t("tbody",null,[(l(!0),a(m,null,v(L.value.filter(s=>Number(s.transaksi)>0),s=>(l(),a("tr",{key:s.id},[t("td",Kt,d(s.name),1),t("td",Xt,d(n(s.transaksi)),1)]))),128))])])])]),t("div",Zt,[t("div",te,[e[26]||(e[26]=t("h2",{class:"text-white text-2xl font-bold mb-6 text-center tracking-wide drop-shadow"},"Leaderboard Sales by Waiters",-1)),t("div",ee,[(l(!0),a(m,null,v(O.value.slice(0,3),(s,i)=>{var p;return l(),a("div",{key:s.waiters,class:G(["flex flex-col items-center",i===1?"scale-110 z-10":"opacity-80"])},[t("div",se,[s.avatar?(l(),a("img",{key:0,src:s.avatar,class:"w-full h-full rounded-full object-cover"},null,8,le)):(l(),a("span",ae,d(((p=s.waiters)==null?void 0:p.charAt(0))||"?"),1))]),t("div",oe,d(s.waiters||"-"),1),t("div",ie,d(n(s.total_sales)),1),i===1?(l(),a("div",re,e[24]||(e[24]=[t("span",{class:"inline-block bg-yellow-300 text-yellow-900 px-3 py-1 rounded-full font-bold shadow"},"TOP 1",-1)]))):U("",!0)],2)}),128))]),t("div",de,[e[25]||(e[25]=t("h3",{class:"font-bold mb-2 text-gray-700"},"Leaderboard",-1)),(l(!0),a(m,null,v(O.value,(s,i)=>{var p,g;return l(),a("div",{key:s.waiters,class:"flex items-center gap-3 mb-3"},[t("div",ne,d(((p=s.waiters)==null?void 0:p.charAt(0))||"?"),1),t("div",ue,[t("div",ce,d(s.waiters||"-"),1),t("div",pe,[t("div",{class:"h-2 rounded bg-gradient-to-r from-blue-400 to-purple-500",style:at(`width: ${s.total_sales/(((g=O.value[0])==null?void 0:g.total_sales)||1)*100}%`)},null,4)])]),t("div",me,d(n(s.total_sales)),1)])}),128))])])])])]),_:1})}}}),Se=rt(be,[["__scopeId","data-v-c750e205"]]);export{Se as default};
