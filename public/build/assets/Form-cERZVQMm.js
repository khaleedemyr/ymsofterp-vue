import{r as y,c as se,w as ae,A as U,B as n,C as re,D as t,N,O as ke,L as m,E as d,H as i,J as p,I as xe,x as v,Q as u,V as w,a6 as _,F as ie,M as ne,S as ce,G as ue,W as we}from"./vendor-vue-g7iCcTkf.js";import{A as _e}from"./AppLayout-DP-q1yH_.js";import{s as f}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{s as me}from"./VueTimepicker-BGHuji_y.js";import{S as k}from"./app-BoyRvw0M.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./ProfileUpdateModal-Cs9EnNrk.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const Be={class:"max-w-2xl mx-auto py-8 px-2"},Pe={class:"text-2xl font-bold text-pink-700 mb-6"},Ue={key:0},Ne={key:1},he={key:2},Se={key:3},Me={class:"inline-flex items-center cursor-pointer"},Ae={class:"flex gap-6 items-center mb-2"},Te={class:"inline-flex items-center"},Ee={class:"inline-flex items-center"},De={class:"flex gap-6 items-center mt-4"},je={class:"inline-flex items-center"},Ge={class:"inline-flex items-center"},Ie={key:4},Re={key:5};const Ce={class:"flex gap-4"},Fe={class:"flex-1"},Oe={class:"flex-1"},He={class:"flex flex-wrap gap-4"},Je=["value"],Ke={class:"ml-2 text-gray-700"},Le={class:"flex gap-4"},qe={class:"flex-1"},Ye={class:"flex-1"},$e=["src"],We={class:"inline-flex items-center cursor-pointer"},ze={key:7},Qe={class:"mb-2"},Xe={class:"inline-flex items-center cursor-pointer"},Ze=["checked"],et={class:"flex flex-wrap gap-4"},tt=["value","disabled"],lt={class:"ml-2 text-gray-700"},ot={class:"flex justify-end gap-2 mt-8"},st=["disabled"],at={key:0},rt={key:1},it={__name:"Form",props:{promo:Object,categories:Array,items:Array,outlets:Array,regions:Array,isEdit:Boolean},setup(h){var A,T,E,D,j,G,I,R,C,F,O,H,J,K,L,q,Y,$,W,z,Q,X,Z,ee,te,le,oe;const s=h,g=y((A=s.promo)!=null&&A.categories&&s.promo.categories.length>0?"kategori":"item"),b=y((T=s.promo)!=null&&T.regions&&s.promo.regions.length>0?"region":"outlet"),x=y(!1),c=["Silver","Loyal","Elite"];function de(a){if(!a)return[];if(Array.isArray(a))return a;if(typeof a=="string")try{const e=JSON.parse(a);return Array.isArray(e)?e:[]}catch{return[]}return[]}function pe(a){return a===!0||a===1||a==="1"}const l=y({name:((E=s.promo)==null?void 0:E.name)||"",type:((D=s.promo)==null?void 0:D.type)||"percent",value:((j=s.promo)==null?void 0:j.value)||"",min_transaction:((G=s.promo)==null?void 0:G.min_transaction)||"",max_transaction:((I=s.promo)==null?void 0:I.max_transaction)||"",start_date:((R=s.promo)==null?void 0:R.start_date)||"",end_date:((C=s.promo)==null?void 0:C.end_date)||"",start_time:((F=s.promo)==null?void 0:F.start_time)||"",end_time:((O=s.promo)==null?void 0:O.end_time)||"",days:((H=s.promo)==null?void 0:H.days)||[],description:((J=s.promo)==null?void 0:J.description)||"",terms:((K=s.promo)==null?void 0:K.terms)||"",outlets:((L=s.promo)==null?void 0:L.outlets)||[],categories:((q=s.promo)==null?void 0:q.categories)||[],items:((Y=s.promo)==null?void 0:Y.items)||[],buy_items:(($=s.promo)==null?void 0:$.buy_items)||[],get_items:((W=s.promo)==null?void 0:W.get_items)||[],banner:((z=s.promo)==null?void 0:z.banner)||null,banner_preview:"",status:((Q=s.promo)==null?void 0:Q.status)||"active",regions:((X=s.promo)==null?void 0:X.regions)||[],need_member:((Z=s.promo)==null?void 0:Z.need_member)||"No",max_discount:((ee=s.promo)==null?void 0:ee.max_discount)||"",is_multiple:((te=s.promo)==null?void 0:te.is_multiple)||"No",tiers:de((le=s.promo)==null?void 0:le.tiers),all_tiers:pe((oe=s.promo)==null?void 0:oe.all_tiers)}),be=s.categories||[],V=s.items||[],ge=s.regions||[],S=s.outlets||[];console.log("outlets",S);const B=y([]);se(()=>B.value.some(a=>!a.new_price||a.new_price>=a.old_price));const M=se(()=>l.value.all_tiers||l.value.tiers.length===c.length),ve=a=>{a.target.checked?(l.value.all_tiers=!0,l.value.tiers=[]):l.value.all_tiers=!1};ae(()=>l.value.tiers,a=>{a.length===c.length?(l.value.all_tiers=!0,l.value.tiers=[]):l.value.all_tiers&&a.length<c.length&&(l.value.all_tiers=!1)}),ae([()=>l.value.type,()=>l.value.items,()=>l.value.outlets,()=>l.value.regions,()=>b.value],([a,e,o,r,P])=>{B.value=[]},{immediate:!0});const fe=async()=>{if(!(await k.fire({title:"Simpan Promo?",text:"Apakah Anda yakin ingin menyimpan data promo ini?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Simpan",cancelButtonText:"Batal"})).isConfirmed)return;x.value=!0;const e={...l.value,by_type:g.value,outlet_type:b.value,categories:l.value.categories.map(r=>r.id),items:l.value.items.map(r=>r.id),outlets:l.value.outlets.map(r=>r.id),regions:l.value.regions.map(r=>r.id),buy_items:l.value.buy_items.map(r=>r.id),get_items:l.value.get_items.map(r=>r.id),item_prices:B.value,tiers:l.value.all_tiers?[]:l.value.tiers,all_tiers:l.value.all_tiers},o=s.isEdit?route("promos.update",{promo:s.promo.id}):route("promos.store");s.isEdit&&(e._method="PUT"),we.post(o,e,{forceFormData:!0,onSuccess:()=>{k.fire("Sukses!","Data promo berhasil disimpan.","success")},onError:r=>{let P=Object.values(r).join("<br>");k.fire("Gagal",P,"error")},onFinish:()=>{x.value=!1}})};function ye(a){const e=a.target.files[0];if(e){if(e.size>2*1024*1024){k.fire("Error","Ukuran file maksimal 2MB","error"),a.target.value=null;return}if(!["image/jpeg","image/png","image/jpg","image/gif"].includes(e.type)){k.fire("Error","Format file harus JPG, JPEG, PNG, atau GIF","error"),a.target.value=null;return}l.value.banner=e,l.value.banner_preview=URL.createObjectURL(e)}}return(a,e)=>(n(),U(_e,null,{default:re(()=>[t("div",Be,[t("h1",Pe,N(h.isEdit?"Edit Promo":"Tambah Promo"),1),t("form",{onSubmit:ke(fe,["prevent"]),class:"space-y-5 bg-white rounded-2xl shadow-xl p-8"},[t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700"},"Nama Promo",-1)),i(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.name=o),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500",required:"",maxlength:"100"},null,512),[[p,l.value.name]])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700"},"Tipe Promo",-1)),i(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.type=o),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500"},e[28]||(e[28]=[t("option",{value:"percent"},"Diskon Persen",-1),t("option",{value:"nominal"},"Diskon Nominal",-1),t("option",{value:"bundle"},"Bundling",-1),t("option",{value:"bogo"},"Buy 1 Get 1",-1)]),512),[[xe,l.value.type]])]),l.value.type==="percent"||l.value.type==="nominal"?(n(),m("div",Ue,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700"},"Value",-1)),i(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.value=o),type:"number",min:"0",step:"0.01",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500",required:""},null,512),[[p,l.value.value,void 0,{number:!0}]])])):d("",!0),l.value.type==="percent"?(n(),m("div",Ne,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700"},"Maximum Diskon",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.max_discount=o),type:"number",min:"0",step:"0.01",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500"},null,512),[[p,l.value.max_discount,void 0,{number:!0}]]),e[32]||(e[32]=t("p",{class:"mt-1 text-sm text-gray-500"},"Kosongkan jika tidak ada batasan maksimum diskon",-1))])):d("",!0),l.value.type==="bundle"?(n(),m("div",he,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700"},"Harga Paket",-1)),i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.value=o),type:"number",min:"0",step:"0.01",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500",required:""},null,512),[[p,l.value.value,void 0,{number:!0}]])])):d("",!0),l.value.type==="bogo"?(n(),m("div",Se,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700"},"Item Promo (Buy)",-1)),v(u(f),{modelValue:l.value.buy_items,"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.buy_items=o),options:u(V),multiple:!0,label:"name","track-by":"id",placeholder:"Pilih Item yang Dibeli"},null,8,["modelValue","options"]),e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 mt-2"},"Item Promo (Get)",-1)),v(u(f),{modelValue:l.value.get_items,"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.get_items=o),options:u(V),multiple:!0,label:"name","track-by":"id",placeholder:"Pilih Item yang Didapat"},null,8,["modelValue","options"])])):d("",!0),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700"},"Minimum Transaksi",-1)),i(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>l.value.min_transaction=o),type:"number",min:"0",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500"},null,512),[[p,l.value.min_transaction]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700"},"Maximum Transaksi",-1)),i(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>l.value.max_transaction=o),type:"number",min:"0",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500"},null,512),[[p,l.value.max_transaction]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Berlaku Kelipatan?",-1)),t("label",Me,[i(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=o=>l.value.is_multiple=o),"true-value":"Yes","false-value":"No",class:"form-checkbox h-5 w-5 text-pink-600"},null,512),[[w,l.value.is_multiple]]),e[38]||(e[38]=t("span",{class:"ml-2"},"Ya, promo dapat digunakan berulang kali",-1))])]),t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium text-gray-700"},"Outlet Promo",-1)),t("div",Ae,[t("label",Te,[i(t("input",{type:"radio",value:"region","onUpdate:modelValue":e[10]||(e[10]=o=>b.value=o),class:"form-radio text-pink-600"},null,512),[[_,b.value]]),e[40]||(e[40]=t("span",{class:"ml-2"},"By Region",-1))]),t("label",Ee,[i(t("input",{type:"radio",value:"outlet","onUpdate:modelValue":e[11]||(e[11]=o=>b.value=o),class:"form-radio text-pink-600"},null,512),[[_,b.value]]),e[41]||(e[41]=t("span",{class:"ml-2"},"By Outlet",-1))])]),b.value==="region"?(n(),U(u(f),{key:0,modelValue:l.value.regions,"onUpdate:modelValue":e[12]||(e[12]=o=>l.value.regions=o),options:u(ge),multiple:!0,label:"name","track-by":"id",placeholder:"Pilih Region"},null,8,["modelValue","options"])):d("",!0),b.value==="outlet"?(n(),U(u(f),{key:1,modelValue:l.value.outlets,"onUpdate:modelValue":e[13]||(e[13]=o=>l.value.outlets=o),options:u(S),multiple:!0,label:"name","track-by":"id",placeholder:"Pilih Outlet"},null,8,["modelValue","options"])):d("",!0)]),t("div",De,[t("label",je,[i(t("input",{type:"radio",value:"kategori","onUpdate:modelValue":e[14]||(e[14]=o=>g.value=o),class:"form-radio text-pink-600"},null,512),[[_,g.value]]),e[43]||(e[43]=t("span",{class:"ml-2"},"By Kategori",-1))]),t("label",Ge,[i(t("input",{type:"radio",value:"item","onUpdate:modelValue":e[15]||(e[15]=o=>g.value=o),class:"form-radio text-pink-600"},null,512),[[_,g.value]]),e[44]||(e[44]=t("span",{class:"ml-2"},"By Item",-1))])]),g.value==="kategori"?(n(),m("div",Ie,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-gray-700"},"Kategori Promo",-1)),v(u(f),{modelValue:l.value.categories,"onUpdate:modelValue":e[16]||(e[16]=o=>l.value.categories=o),options:u(be),multiple:!0,label:"name","track-by":"id",placeholder:"Pilih Kategori"},null,8,["modelValue","options"])])):d("",!0),g.value==="item"?(n(),m("div",Re,[e[46]||(e[46]=t("label",{class:"block text-sm font-medium text-gray-700"},"Item Promo",-1)),v(u(f),{modelValue:l.value.items,"onUpdate:modelValue":e[17]||(e[17]=o=>l.value.items=o),options:u(V),multiple:!0,label:"name","track-by":"id",placeholder:"Pilih Item"},null,8,["modelValue","options"])])):d("",!0),d("",!0),t("div",Ce,[t("div",Fe,[e[49]||(e[49]=t("label",{class:"block text-sm font-medium text-gray-700"},"Tanggal Mulai",-1)),i(t("input",{"onUpdate:modelValue":e[18]||(e[18]=o=>l.value.start_date=o),type:"date",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500",required:""},null,512),[[p,l.value.start_date]])]),t("div",Oe,[e[50]||(e[50]=t("label",{class:"block text-sm font-medium text-gray-700"},"Tanggal Akhir",-1)),i(t("input",{"onUpdate:modelValue":e[19]||(e[19]=o=>l.value.end_date=o),type:"date",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500",required:""},null,512),[[p,l.value.end_date]])])]),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Hari Promo Berlaku",-1)),t("div",He,[(n(),m(ie,null,ne(["Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],o=>t("label",{key:o,class:"inline-flex items-center cursor-pointer"},[i(t("input",{type:"checkbox",value:o,"onUpdate:modelValue":e[20]||(e[20]=r=>l.value.days=r),class:"form-checkbox h-5 w-5 text-pink-600 rounded"},null,8,Je),[[w,l.value.days]]),t("span",Ke,N(o),1)])),64))]),e[52]||(e[52]=t("p",{class:"mt-1 text-sm text-gray-500"},"Pilih hari-hari dimana promo ini berlaku. Kosongkan jika berlaku setiap hari.",-1))]),t("div",Le,[t("div",qe,[e[53]||(e[53]=t("label",{class:"block text-sm font-medium text-gray-700"},"Jam Mulai",-1)),v(u(me),{modelValue:l.value.start_time,"onUpdate:modelValue":e[21]||(e[21]=o=>l.value.start_time=o),format:"HH:mm",is24:!0,"minute-interval":"5",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm"},null,8,["modelValue"])]),t("div",Ye,[e[54]||(e[54]=t("label",{class:"block text-sm font-medium text-gray-700"},"Jam Akhir",-1)),v(u(me),{modelValue:l.value.end_time,"onUpdate:modelValue":e[22]||(e[22]=o=>l.value.end_time=o),format:"HH:mm",is24:!0,"minute-interval":"5",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm"},null,8,["modelValue"])])]),t("div",null,[e[55]||(e[55]=t("label",{class:"block text-sm font-medium text-gray-700"},"Deskripsi",-1)),i(t("textarea",{"onUpdate:modelValue":e[23]||(e[23]=o=>l.value.description=o),rows:"2",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-pink-500 focus:border-pink-500"},null,512),[[p,l.value.description]])]),t("div",null,[e[56]||(e[56]=t("label",{class:"block text-sm font-medium text-gray-700"},"Term & Condition",-1)),i(t("textarea",{"onUpdate:modelValue":e[24]||(e[24]=o=>l.value.terms=o),rows:"3",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm"},null,512),[[p,l.value.terms]])]),t("div",null,[e[57]||(e[57]=t("label",{class:"block text-sm font-medium text-gray-700"},"Banner Promo",-1)),t("input",{type:"file",onChange:ye,accept:"image/jpeg,image/png,image/jpg,image/gif",class:"mt-1 block w-full"},null,32),l.value.banner_preview||l.value.banner?(n(),m("img",{key:0,src:l.value.banner_preview||`/storage/${l.value.banner}`,class:"mt-2 max-h-32 rounded shadow"},null,8,$e)):d("",!0),e[58]||(e[58]=t("p",{class:"mt-1 text-sm text-gray-500"}," Format: JPG, JPEG, PNG, GIF. Maksimal 2MB ",-1))]),t("div",null,[e[60]||(e[60]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Perlu Member?",-1)),t("label",We,[i(t("input",{type:"checkbox","onUpdate:modelValue":e[25]||(e[25]=o=>l.value.need_member=o),"true-value":"Yes","false-value":"No",class:"form-checkbox h-5 w-5 text-pink-600"},null,512),[[w,l.value.need_member]]),e[59]||(e[59]=t("span",{class:"ml-2"},"Ya, hanya untuk member",-1))])]),l.value.need_member==="Yes"?(n(),m("div",ze,[e[62]||(e[62]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tier Member",-1)),t("div",Qe,[t("label",Xe,[t("input",{type:"checkbox",checked:M.value,onChange:ve,class:"form-checkbox h-5 w-5 text-pink-600"},null,40,Ze),e[61]||(e[61]=t("span",{class:"ml-2 font-semibold"},"Semua Tier",-1))])]),t("div",et,[(n(),m(ie,null,ne(c,o=>t("label",{key:o,class:"inline-flex items-center cursor-pointer"},[i(t("input",{type:"checkbox",value:o,"onUpdate:modelValue":e[26]||(e[26]=r=>l.value.tiers=r),disabled:M.value,class:"form-checkbox h-5 w-5 text-pink-600 rounded"},null,8,tt),[[w,l.value.tiers]]),t("span",lt,N(o),1)])),64))]),e[63]||(e[63]=t("p",{class:"mt-1 text-sm text-gray-500"},'Pilih tier member yang dapat menggunakan promo ini. Pilih "Semua Tier" untuk semua tier member.',-1))])):d("",!0),t("div",ot,[v(u(ce),{href:a.route("promos.index"),class:"px-4 py-2 rounded bg-gray-100 text-gray-700 font-semibold hover:bg-gray-200"},{default:re(()=>e[64]||(e[64]=[ue("Batal")])),_:1},8,["href"]),t("button",{disabled:x.value,class:"px-6 py-2 rounded bg-pink-600 text-white font-bold hover:bg-pink-700"},[x.value?(n(),m("span",at,e[65]||(e[65]=[t("i",{class:"fa fa-spinner fa-spin"},null,-1),ue(" Menyimpan...")]))):(n(),m("span",rt,"Simpan"))],8,st)])],32)])]),_:1}))}},wt=Ve(it,[["__scopeId","data-v-fef0a9af"]]);export{wt as default};
