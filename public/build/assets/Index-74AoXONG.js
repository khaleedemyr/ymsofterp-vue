import{u as F}from"./useToast-D6Z3J7rW.js";import{A as H}from"./AppLayout-BqaX40sL.js";import V from"./SessionModal-D7MADSfd.js";import G from"./MaterialModal-DFKSv5-d.js";import X from"./QuizSelectionModal-CyP51eJW.js";import J from"./QuestionnaireSelectionModal-BiJxK3Ij.js";import Z from"./MaterialIcon-B4L5Rfhq.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as m,a as Y,A as q,B as r,C as ee,D as e,E as f,N as i,Q as T,G as C,L as u,F as A,M as N,x as te}from"./vendor-vue-g7iCcTkf.js";import"./app-BoSIlzLW.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-CY3nv2ep.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const se={class:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 relative overflow-hidden"},oe={class:"relative z-10 py-8 px-6"},le={class:"backdrop-blur-xl bg-white/10 border border-white/20 rounded-3xl shadow-2xl mb-8"},re={class:"p-8 bg-gradient-to-r from-blue-600/80 via-purple-600/80 to-pink-600/80 rounded-3xl"},ie={class:"flex items-center justify-between"},ne={class:"space-y-4"},ae={class:"flex items-center space-x-4"},ue={class:"text-xl text-white/90 drop-shadow-md"},de={class:"flex items-center space-x-4"},ce={class:"text-center"},me={class:"text-6xl font-bold text-white drop-shadow-lg animate-pulse"},pe={class:"max-w-7xl mx-auto"},he={key:0,class:"flex justify-center items-center py-16"},ve={key:1,class:"text-center py-16"},xe={class:"flex justify-center"},be={key:2,class:"space-y-6"},ge={class:"px-8 py-6 bg-gradient-to-r from-blue-600/20 via-purple-600/20 to-pink-600/20 border-b border-white/20"},fe={class:"flex items-center justify-between"},we={class:"flex items-center space-x-4"},_e={class:"flex-shrink-0"},ye={class:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center shadow-lg"},ke={class:"text-lg font-bold text-white"},qe={class:"text-2xl font-bold text-white drop-shadow-lg"},Se={key:0,class:"text-lg text-white/80 mt-2 drop-shadow-md"},ze={class:"flex items-center space-x-4"},Ee={class:"inline-flex items-center px-4 py-2 rounded-full text-sm font-medium bg-green-500/20 text-green-200 border border-green-500/30"},Te=["onClick"],Ce=["onClick"],Re={class:"px-8 py-6"},$e={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Ae={class:"backdrop-blur-xl bg-white/5 border border-white/20 rounded-xl p-6 hover:bg-white/10 transition-all duration-300"},Ne={class:"flex items-center justify-between mb-4"},je=["onClick"],Pe={key:0,class:"space-y-3"},Qe={class:"text-base font-medium text-white"},Ie={class:"text-sm text-white/70"},Me={class:"flex items-center space-x-2"},Oe={class:"text-xs text-white/60"},Ue={key:1,class:"text-sm text-white/60 italic"},Be={class:"backdrop-blur-xl bg-white/5 border border-white/20 rounded-xl p-6 hover:bg-white/10 transition-all duration-300"},Ke={class:"flex items-center justify-between mb-4"},Le={class:"text-lg font-semibold text-white"},De=["onClick"],Fe={key:0,class:"space-y-3"},He={class:"w-5 h-5"},Ve={class:"text-white truncate"},Ge={key:0,class:"text-xs text-white/60"},Xe={key:1,class:"text-sm text-white/60 italic"},Je={class:"backdrop-blur-xl bg-white/5 border border-white/20 rounded-xl p-6 hover:bg-white/10 transition-all duration-300"},Ze={class:"flex items-center justify-between mb-4"},We=["onClick"],Ye={key:0,class:"space-y-3"},et={class:"text-base font-medium text-white"},tt={class:"text-sm text-white/70"},st={class:"flex items-center space-x-2"},ot={class:"text-xs text-white/60"},lt={key:1,class:"text-sm text-white/60 italic"},rt={__name:"Index",props:{course:{type:[String,Number],required:!0}},setup(j){const{showToast:d}=F(),w=j,p=typeof w.course=="object"?w.course.id:w.course,z=m(!0),_=m([]),v=m([]),x=m([]),P=m(typeof w.course=="object"?w.course:null),b=m(!1),S=m(!1),y=m(!1),k=m(!1),E=m(null),a=m(null),g=async()=>{try{z.value=!0,console.log("Loading curriculum for course:",p),console.log("Course ID type:",typeof p),console.log("Course ID value:",p);const o=`/lms/courses/${p}/curriculum`;console.log("Fetching from URL:",o);const t=await fetch(o);if(console.log("Response status:",t.status),console.log("Response headers:",t.headers),!t.ok){const l=await t.text();throw console.error("Response not OK. Status:",t.status),console.error("Error response:",l),new Error(`HTTP error! status: ${t.status}`)}const n=await t.json();console.log("Curriculum data received:",n),n.success?(_.value=n.curriculum||[],v.value=n.availableQuizzes||[],x.value=n.availableQuestionnaires||[],console.log("Curriculum items loaded:",_.value.length),console.log("Available quizzes loaded:",v.value.length),console.log("Available questionnaires loaded:",x.value.length),v.value.length>0&&console.log("First quiz:",v.value[0]),x.value.length>0&&console.log("First questionnaire:",x.value[0])):(console.error("API returned success: false"),console.error("API message:",n.message),d("Error loading curriculum","error"))}catch(o){console.error("Error loading curriculum:",o),d("Error loading curriculum","error")}finally{z.value=!1}},Q=o=>{E.value={...o},b.value=!0},I=async o=>{if(confirm("Apakah Anda yakin ingin menghapus sesi ini?"))try{(await(await fetch(`/lms/courses/${p}/curriculum/sessions/${o}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json()).success?(d("Sesi berhasil dihapus","success"),await g()):d("Error deleting session","error")}catch(t){console.error("Error deleting session:",t),d("Error deleting session","error")}},M=o=>{a.value=o,S.value=!0},O=o=>{a.value=o,y.value=!0},U=o=>{a.value=o,k.value=!0},R=()=>{b.value=!1,E.value=null},$=()=>{S.value=!1,a.value=null},B=async()=>{await g(),R()},K=async()=>{await g(),$()},L=async o=>{if(console.log("=== QUIZ SELECTION STARTED ==="),console.log("Selected quiz:",o),console.log("Selected session:",a.value),!a.value){console.error("No session selected"),d("No session selected","error");return}try{console.log("Preparing request data...");const t={...a.value,quiz_id:o.id};console.log("Request data:",t);const n=`/lms/courses/${p}/curriculum/sessions/${a.value.id}`;console.log("Request URL:",n),console.log("Request method: PUT");const l=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(t)});if(console.log("Response status:",l.status),console.log("Response headers:",l.headers),!l.ok){const s=await l.text();throw console.error("Response not OK. Status:",l.status),console.error("Error response:",s),new Error(`HTTP error! status: ${l.status}`)}const c=await l.json();console.log("Response data:",c),c.success?(console.log("Quiz selection successful"),d("Quiz berhasil dipilih","success"),await g(),y.value=!1):(console.error("API returned success: false"),console.error("API message:",c.message),d("Error selecting quiz: "+(c.message||"Unknown error"),"error"))}catch(t){console.error("Error selecting quiz:",t),d("Error selecting quiz: "+t.message,"error")}},D=async o=>{if(console.log("=== QUESTIONNAIRE SELECTION STARTED ==="),console.log("Selected questionnaire:",o),console.log("Selected session:",a.value),!a.value){console.error("No session selected"),d("No session selected","error");return}try{console.log("Preparing request data...");const t={...a.value,questionnaire_id:o.id};console.log("Request data:",t);const n=`/lms/courses/${p}/curriculum/sessions/${a.value.id}`;console.log("Request URL:",n),console.log("Request method: PUT");const l=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify(t)});if(console.log("Response status:",l.status),console.log("Response headers:",l.headers),!l.ok){const s=await l.text();throw console.error("Response not OK. Status:",l.status),console.error("Error response:",s),new Error(`HTTP error! status: ${l.status}`)}const c=await l.json();console.log("Response data:",c),c.success?(console.log("Questionnaire selection successful"),d("Kuesioner berhasil dipilih","success"),await g(),k.value=!1):(console.error("API returned success: false"),console.error("API message:",c.message),d("Error selecting questionnaire: "+(c.message||"Unknown error"),"error"))}catch(t){console.error("Error selecting questionnaire:",t),d("Error selecting questionnaire: "+t.message,"error")}};return Y(async()=>{await g()}),(o,t)=>(r(),q(H,null,{default:ee(()=>{var n,l,c;return[e("div",se,[t[21]||(t[21]=e("div",{class:"absolute inset-0 overflow-hidden"},[e("div",{class:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob"}),e("div",{class:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob animation-delay-2000"}),e("div",{class:"absolute top-40 left-40 w-80 h-80 bg-pink-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob animation-delay-4000"})],-1)),e("div",oe,[e("div",le,[e("div",re,[e("div",ie,[e("div",ne,[e("div",ae,[e("button",{onClick:t[0]||(t[0]=s=>o.$router.go(-1)),class:"text-white/80 hover:text-white transition-colors"},t[5]||(t[5]=[e("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),e("div",null,[t[6]||(t[6]=e("h1",{class:"text-4xl font-bold text-white drop-shadow-lg"}," Kurikulum Training ",-1)),e("p",ue,i(((n=P.value)==null?void 0:n.title)||T(p)),1)])])]),e("div",de,[e("div",ce,[e("div",me,i(_.value.length),1),t[7]||(t[7]=e("div",{class:"text-lg text-white/90 drop-shadow-md"},"Sesi Training",-1))]),e("button",{onClick:t[1]||(t[1]=s=>b.value=!0),class:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg"},t[8]||(t[8]=[e("i",{class:"fas fa-plus mr-2"},null,-1),C(" Tambah Sesi ")]))])])])]),e("div",pe,[z.value?(r(),u("div",he,t[9]||(t[9]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-4 border-white"},null,-1)]))):_.value.length===0?(r(),u("div",ve,[t[11]||(t[11]=e("div",{class:"w-32 h-32 mx-auto mb-8 bg-white/10 rounded-full flex items-center justify-center backdrop-blur-xl border border-white/20"},[e("i",{class:"fas fa-book-open text-6xl text-white/50"})],-1)),t[12]||(t[12]=e("h3",{class:"text-2xl font-bold text-white mb-4"},"Belum ada sesi training tersedia",-1)),t[13]||(t[13]=e("p",{class:"text-white/70 text-lg mb-8"},"Mulai dengan menambahkan sesi pertama untuk course ini",-1)),e("div",xe,[e("button",{onClick:t[2]||(t[2]=s=>b.value=!0),class:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-8 py-4 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg"},t[10]||(t[10]=[e("i",{class:"fas fa-plus mr-2"},null,-1),C(" Tambah Sesi Pertama ")]))])])):(r(),u("div",be,[(r(!0),u(A,null,N(_.value,(s,it)=>(r(),u("div",{key:s.id,class:"backdrop-blur-xl bg-white/10 border border-white/20 rounded-2xl shadow-2xl overflow-hidden"},[e("div",ge,[e("div",fe,[e("div",we,[e("div",_e,[e("div",ye,[e("span",ke,i(s.session_number),1)])]),e("div",null,[e("h3",qe,i(s.session_title),1),s.session_description?(r(),u("p",Se,i(s.session_description),1)):f("",!0)])]),e("div",ze,[e("span",Ee,[t[14]||(t[14]=e("i",{class:"fas fa-clock mr-2"},null,-1)),C(" "+i(s.total_duration_minutes)+" menit ",1)]),e("button",{onClick:h=>Q(s),class:"text-white/80 hover:text-white transition-colors p-2 rounded-lg hover:bg-white/10",title:"Edit Sesi"},t[15]||(t[15]=[e("i",{class:"fas fa-edit text-xl"},null,-1)]),8,Te),e("button",{onClick:h=>I(s.id),class:"text-white/80 hover:text-red-300 transition-colors p-2 rounded-lg hover:bg-red-500/10",title:"Hapus Sesi"},t[16]||(t[16]=[e("i",{class:"fas fa-trash text-xl"},null,-1)]),8,Ce)])])]),e("div",Re,[e("div",$e,[e("div",Ae,[e("div",Ne,[t[17]||(t[17]=e("h4",{class:"text-lg font-semibold text-white"},"Quiz",-1)),e("button",{onClick:h=>O(s),class:"text-blue-300 hover:text-blue-200 text-sm font-medium px-3 py-1 rounded-lg hover:bg-blue-500/20 transition-all duration-300"},i(s.quiz?"Ganti":"Pilih"),9,je)]),s.quiz?(r(),u("div",Pe,[e("div",Qe,i(s.quiz.title),1),e("div",Ie,i(s.quiz.description),1),e("div",Me,[t[18]||(t[18]=e("span",{class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-500/20 text-blue-200 border border-blue-500/30"}," Quiz ",-1)),e("span",Oe,i(s.quiz.questions_count||0)+" pertanyaan",1)])])):(r(),u("div",Ue,"Belum ada quiz dipilih"))]),e("div",Be,[e("div",Ke,[e("h4",Le,"Materi ("+i(s.materials.length)+")",1),e("button",{onClick:h=>M(s),class:"text-green-300 hover:text-green-200 text-sm font-medium px-3 py-1 rounded-lg hover:bg-green-500/20 transition-all duration-300"}," Tambah ",8,De)]),s.materials.length>0?(r(),u("div",Fe,[(r(!0),u(A,null,N(s.materials.slice(0,2),h=>(r(),u("div",{key:h.id,class:"flex items-center space-x-3 text-sm"},[e("div",He,[te(Z,{type:h.material_type},null,8,["type"])]),e("span",Ve,i(h.title),1)]))),128)),s.materials.length>2?(r(),u("div",Ge," +"+i(s.materials.length-2)+" materi lainnya ",1)):f("",!0)])):(r(),u("div",Xe,"Belum ada materi"))]),e("div",Je,[e("div",Ze,[t[19]||(t[19]=e("h4",{class:"text-lg font-semibold text-white"},"Kuesioner",-1)),e("button",{onClick:h=>U(s),class:"text-purple-300 hover:text-purple-200 text-sm font-medium px-3 py-1 rounded-lg hover:bg-purple-500/20 transition-all duration-300"},i(s.questionnaire?"Ganti":"Pilih"),9,We)]),s.questionnaire?(r(),u("div",Ye,[e("div",et,i(s.questionnaire.title),1),e("div",tt,i(s.questionnaire.description),1),e("div",st,[t[20]||(t[20]=e("span",{class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-500/20 text-purple-200 border border-purple-500/30"}," Kuesioner ",-1)),e("span",ot,i(s.questionnaire.questions_count||0)+" pertanyaan",1)])])):(r(),u("div",lt,"Belum ada kuesioner dipilih"))])])])]))),128))]))])])]),b.value?(r(),q(V,{key:0,show:b.value,session:E.value,"available-quizzes":v.value,"available-questionnaires":x.value,"course-id":T(p),onClose:R,onSaved:B},null,8,["show","session","available-quizzes","available-questionnaires","course-id"])):f("",!0),S.value?(r(),q(G,{key:1,show:S.value,"curriculum-item":a.value,"course-id":T(p),onClose:$,onSaved:K},null,8,["show","curriculum-item","course-id"])):f("",!0),y.value?(r(),q(X,{key:2,show:y.value,"available-quizzes":v.value,"selected-quiz":(l=a.value)==null?void 0:l.quiz,onClose:t[3]||(t[3]=s=>y.value=!1),onSelected:L},null,8,["show","available-quizzes","selected-quiz"])):f("",!0),k.value?(r(),q(J,{key:3,show:k.value,"available-questionnaires":x.value,"selected-questionnaire":(c=a.value)==null?void 0:c.questionnaire,onClose:t[4]||(t[4]=s=>k.value=!1),onSelected:D},null,8,["show","available-questionnaires","selected-questionnaire"])):f("",!0)]}),_:1}))}},kt=W(rt,[["__scopeId","data-v-b415a8c7"]]);export{kt as default};
