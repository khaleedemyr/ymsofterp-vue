import{L as v,B as c,D as a,P as U,r as I,c as D,w as z,A,C as m,x as d,Q as o,G as x,N as u,O as q,H as G,E as k,l as w,J as H}from"./vendor-vue-g7iCcTkf.js";import{a as M}from"./vendor-utils-CpgP2uT4.js";import{S}from"./app-DlrnVByK.js";import{Y as K,h as F,G as L,V as X,S as Y}from"./vendor-ui-CrPgGUUb.js";import"./vendor-charts-CuqD4wLC.js";function $(C,j){return c(),v("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}const J={class:"fixed inset-0 z-10 overflow-y-auto"},Q={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},W={class:"absolute right-0 top-0 hidden pr-4 pt-4 sm:block"},Z={class:"sm:flex sm:items-start"},ee={class:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left w-full"},se={class:"mt-4"},ae={key:0,class:"mt-1 text-sm text-red-600"},oe={class:"relative"},ne=["value"],te={key:0,class:"mt-1 text-sm text-red-600"},ie={class:"relative"},le=["value"],re={key:0,class:"mt-1 text-sm text-red-600"},me={class:"relative"},de=["value"],ue={key:0,class:"mt-1 text-sm text-red-600"},ce={class:"mt-6 flex justify-end gap-3"},pe=["disabled"],he={__name:"DivisiFormModal",props:{show:Boolean,mode:String,divisi:Object},emits:["close","success"],setup(C,{emit:j}){const n=C,P=j,e=U({nama_divisi:"",nominal_lembur:"",nominal_uang_makan:"",nominal_ph:""});console.log("Form initialized with:",e.data());const p=I(!1),V=D(()=>n.mode==="create"?"Buat Divisi Baru":"Edit Divisi"),O=D(()=>p.value?"Menyimpan...":n.mode==="create"?"Buat Divisi":"Update Divisi");z(()=>n.show,t=>{console.log("Modal show changed:",t),console.log("Props divisi:",n.divisi),t&&n.divisi?(console.log("Populating form with divisi data:",{nama_divisi:n.divisi.nama_divisi,nominal_lembur:n.divisi.nominal_lembur,nominal_uang_makan:n.divisi.nominal_uang_makan,nominal_ph:n.divisi.nominal_ph}),e.nama_divisi=n.divisi.nama_divisi,e.nominal_lembur=h(String(n.divisi.nominal_lembur||"")),e.nominal_uang_makan=h(String(n.divisi.nominal_uang_makan||"")),e.nominal_ph=n.divisi.nominal_ph?h(String(n.divisi.nominal_ph)):"",console.log("Form after population:",{nama_divisi:e.nama_divisi,nominal_lembur:e.nominal_lembur,nominal_uang_makan:e.nominal_uang_makan,nominal_ph:e.nominal_ph})):t&&!n.divisi&&(console.log("Resetting form for create mode"),e.reset())});function T(){P("close"),e.reset()}function E(){window.location.reload()}function R(){var i,y;p.value=!0,console.log("Submitting form:",{mode:n.mode,divisiId:(i=n.divisi)==null?void 0:i.id,formData:e.data()}),console.log("Form values before cleaning:",{nama_divisi:e.nama_divisi,nominal_lembur:e.nominal_lembur,nominal_uang_makan:e.nominal_uang_makan,nominal_ph:e.nominal_ph});const t={nama_divisi:e.nama_divisi,nominal_lembur:String(e.nominal_lembur||"").replace(/\./g,""),nominal_uang_makan:String(e.nominal_uang_makan||"").replace(/\./g,""),nominal_ph:e.nominal_ph?String(e.nominal_ph).replace(/\./g,""):null};console.log("Clean form data:",t);const s=(y=document.querySelector('meta[name="csrf-token"]'))==null?void 0:y.getAttribute("content");if(console.log("CSRF Token:",s),n.mode==="create")console.log("Sending POST request to: /divisis"),M.post("/divisis",t,{headers:{"X-CSRF-TOKEN":s,"Content-Type":"application/json",Accept:"application/json"}}).then(r=>{console.log("Create success:",r),S.fire("Berhasil",r.data.message,"success").then(()=>{setTimeout(()=>{E()},100)})}).catch(r=>{var l,f,_,g;console.error("Create error:",r),console.error("Error response:",r.response),(f=(l=r.response)==null?void 0:l.data)!=null&&f.errors?Object.keys(r.response.data.errors).forEach(b=>{e.setError(b,r.response.data.errors[b][0])}):S.fire("Error",((g=(_=r.response)==null?void 0:_.data)==null?void 0:g.message)||"Terjadi kesalahan","error")}).finally(()=>{p.value=!1});else{console.log("Sending PUT request to:",`/divisis/${n.divisi.id}`);const r={...t,_method:"PUT"};M.post(`/divisis/${n.divisi.id}`,r,{headers:{"X-CSRF-TOKEN":s,"Content-Type":"application/json",Accept:"application/json"}}).then(l=>{console.log("Update success:",l),S.fire("Berhasil",l.data.message,"success").then(()=>{setTimeout(()=>{E()},100)})}).catch(l=>{var f,_,g,b;console.error("Update error:",l),console.error("Error response:",l.response),(_=(f=l.response)==null?void 0:f.data)!=null&&_.errors?Object.keys(l.response.data.errors).forEach(N=>{e.setError(N,l.response.data.errors[N][0])}):S.fire("Error",((b=(g=l.response)==null?void 0:g.data)==null?void 0:b.message)||"Terjadi kesalahan","error")}).finally(()=>{p.value=!1})}}function h(t){if(!t&&t!==0)return"";const s=String(t).replace(/[^\d]/g,"");return s?s.replace(/\B(?=(\d{3})+(?!\d))/g,"."):""}function B(t,s){const i=s.target.value||"",y=h(i);e[t]=y}return(t,s)=>(c(),A(o(Y),{as:"template",show:C.show},{default:m(()=>[d(o(K),{as:"div",class:"relative z-50",onClose:T},{default:m(()=>[d(o(F),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:m(()=>s[4]||(s[4]=[a("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])),_:1}),a("div",J,[a("div",Q,[d(o(F),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:m(()=>[d(o(L),{class:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"},{default:m(()=>[a("div",W,[a("button",{type:"button",class:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",onClick:T},[s[5]||(s[5]=a("span",{class:"sr-only"},"Close",-1)),d(o($),{class:"h-6 w-6","aria-hidden":"true"})])]),a("div",Z,[s[13]||(s[13]=a("div",{class:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10"},[a("i",{class:"fa-solid fa-building text-blue-600"})],-1)),a("div",ee,[d(o(X),{as:"h3",class:"text-base font-semibold leading-6 text-gray-900"},{default:m(()=>[x(u(V.value),1)]),_:1}),a("div",se,[a("form",{onSubmit:q(R,["prevent"]),class:"space-y-4"},[a("div",null,[s[6]||(s[6]=a("label",{for:"nama_divisi",class:"block text-sm font-medium text-gray-700 mb-1"},[x(" Nama Divisi "),a("span",{class:"text-red-500"},"*")],-1)),G(a("input",{id:"nama_divisi","onUpdate:modelValue":s[0]||(s[0]=i=>o(e).nama_divisi=i),type:"text",class:w(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-500":o(e).errors.nama_divisi}]),placeholder:"Masukkan nama divisi"},null,2),[[H,o(e).nama_divisi]]),o(e).errors.nama_divisi?(c(),v("p",ae,u(o(e).errors.nama_divisi),1)):k("",!0)]),a("div",null,[s[8]||(s[8]=a("label",{for:"nominal_lembur",class:"block text-sm font-medium text-gray-700 mb-1"},[x(" Nominal Lembur "),a("span",{class:"text-red-500"},"*")],-1)),a("div",oe,[s[7]||(s[7]=a("span",{class:"absolute left-3 top-2 text-gray-500"},"Rp",-1)),a("input",{id:"nominal_lembur",value:o(e).nominal_lembur,onInput:s[1]||(s[1]=i=>B("nominal_lembur",i)),type:"text",class:w(["w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-500":o(e).errors.nominal_lembur}]),placeholder:"0"},null,42,ne)]),o(e).errors.nominal_lembur?(c(),v("p",te,u(o(e).errors.nominal_lembur),1)):k("",!0)]),a("div",null,[s[10]||(s[10]=a("label",{for:"nominal_uang_makan",class:"block text-sm font-medium text-gray-700 mb-1"},[x(" Nominal Uang Makan "),a("span",{class:"text-red-500"},"*")],-1)),a("div",ie,[s[9]||(s[9]=a("span",{class:"absolute left-3 top-2 text-gray-500"},"Rp",-1)),a("input",{id:"nominal_uang_makan",value:o(e).nominal_uang_makan,onInput:s[2]||(s[2]=i=>B("nominal_uang_makan",i)),type:"text",class:w(["w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-500":o(e).errors.nominal_uang_makan}]),placeholder:"0"},null,42,le)]),o(e).errors.nominal_uang_makan?(c(),v("p",re,u(o(e).errors.nominal_uang_makan),1)):k("",!0)]),a("div",null,[s[12]||(s[12]=a("label",{for:"nominal_ph",class:"block text-sm font-medium text-gray-700 mb-1"}," Nominal PH ",-1)),a("div",me,[s[11]||(s[11]=a("span",{class:"absolute left-3 top-2 text-gray-500"},"Rp",-1)),a("input",{id:"nominal_ph",value:o(e).nominal_ph,onInput:s[3]||(s[3]=i=>B("nominal_ph",i)),type:"text",class:w(["w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",{"border-red-500":o(e).errors.nominal_ph}]),placeholder:"0"},null,42,de)]),o(e).errors.nominal_ph?(c(),v("p",ue,u(o(e).errors.nominal_ph),1)):k("",!0)]),a("div",ce,[a("button",{type:"button",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:T}," Batal "),a("button",{type:"submit",disabled:p.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},u(O.value),9,pe)])],32)])])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}};export{he as default};
