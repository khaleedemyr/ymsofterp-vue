const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-V2AeMLhf.js","assets/vendor-utils-CpgP2uT4.js","assets/vendor-vue-g7iCcTkf.js","assets/vendor-charts-CuqD4wLC.js","assets/app-CsZ1PhXD.css"])))=>i.map(i=>d[i]);
import{_ as w}from"./app-V2AeMLhf.js";import{c as L,r as h,k as Je,w as Qe,A as Ye,B as n,C as X,D as e,L as i,E as u,G as d,F as S,M as C,l as U,N as o,x as ne,Q as ie,H as T,J as N,O as q,Y as Xe,I as Be,W as $e,$ as Ze}from"./vendor-vue-g7iCcTkf.js";import{u as Ke,A as et}from"./AppLayout-IVexHyAO.js";import{a as Z}from"./vendor-utils-CpgP2uT4.js";import{s as K}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{_ as tt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-BZZ_tA4T.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const st={class:"w-full py-8 px-0"},lt={key:0,class:"space-y-6"},at={key:0,class:"bg-white rounded-2xl shadow-2xl p-6"},nt={class:"space-y-4"},it=["onClick"],ot={class:"flex items-center justify-between"},rt={class:"flex-1"},ut={class:"flex items-center gap-2 mb-1"},dt={class:"font-semibold text-gray-900"},mt={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},ct={class:"text-sm text-gray-600"},pt={class:"text-sm text-gray-500"},ft={key:0,class:"text-xs text-gray-600 mt-1"},bt={key:1,class:"text-xs text-blue-600 mt-1"},gt={key:2,class:"text-sm text-red-600 mt-1"},_t={class:"text-right"},yt=["disabled"],xt={key:1,class:"bg-white rounded-2xl shadow-2xl p-6"},vt={class:"flex justify-between items-center mb-4"},ht={class:"flex items-center gap-2"},kt={class:"relative"},wt={class:"space-y-4"},Pt=["onClick"],Ot={class:"flex items-center justify-between"},St={class:"flex-1"},Ct={class:"flex items-center gap-2 mb-1"},Tt={class:"font-semibold text-gray-900"},At={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},Rt={class:"text-sm text-gray-600"},jt={class:"text-sm text-gray-500"},Bt={key:0,class:"text-sm text-red-600 mt-1"},$t={class:"text-right"},Et=["disabled"],Vt={key:2,class:"bg-white rounded-2xl shadow-2xl p-6 text-center"},Lt={key:3,class:"bg-white rounded-2xl shadow-2xl p-6 text-center"},Nt={class:"text-gray-500"},qt={key:1,class:"space-y-6"},It={class:"bg-white rounded-2xl shadow-2xl p-6"},Dt={class:"flex justify-between items-center mb-4"},Ft={class:"text-xl font-bold text-gray-800"},Mt={class:"flex items-center gap-2"},Ut={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},zt={class:"block text-sm font-medium text-gray-700"},Gt={class:"mt-1 text-lg font-semibold text-gray-900"},Ht={key:0},Wt={class:"mt-1 text-gray-900"},Jt={class:"block text-sm font-medium text-gray-700"},Qt={class:"mt-1 text-gray-900"},Yt={key:1},Xt={class:"mt-1 text-gray-900"},Zt={key:2},Kt={class:"mt-1 text-red-600 font-semibold"},es={key:0},ts={key:1},ss={key:2},ls={key:3},as={class:"mt-1 text-blue-600 font-semibold"},ns={class:"block text-sm font-medium text-gray-700"},is={class:"mt-1 text-lg font-bold text-green-600"},os={key:0,class:"mt-1 text-xs text-gray-500"},rs={key:0},us={key:4},ds={class:"mt-1 text-gray-900"},ms={key:5},cs={class:"mt-1 text-gray-900"},ps={key:6,class:"md:col-span-2"},fs={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},bs={class:"flex items-center justify-between mb-2"},gs={key:0,class:"mt-2"},_s={key:0,class:"mt-2 text-sm text-gray-700"},ys={key:1,class:"mt-2 text-sm text-gray-600"},xs={key:1,class:"mt-2 text-sm text-gray-500 italic"},vs={key:0,class:"bg-white rounded-2xl shadow-2xl p-6 mb-6"},hs={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ks={key:0,class:"md:col-span-2"},ws={class:"text-gray-900 font-medium"},Ps={key:1,class:"md:col-span-2"},Os={class:"text-gray-900 whitespace-pre-wrap"},Ss={key:1,class:"bg-white rounded-2xl shadow-2xl p-6"},Cs={key:0,class:"mb-6"},Ts={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},As=["onClick"],Rs={class:"aspect-square bg-gray-100 border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-all duration-200"},js=["src","alt","onClick"],Bs={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent text-white p-2"},$s={class:"text-xs truncate font-medium"},Es={key:1,class:"flex items-center gap-3"},Vs={class:"flex-1 min-w-0"},Ls={class:"text-sm font-medium text-gray-900 truncate"},Ns={class:"text-xs text-gray-500"},qs={class:"flex-shrink-0"},Is=["href"],Ds={key:1,class:"mb-6"},Fs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Ms=["onClick"],Us={class:"aspect-square bg-gray-100 border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-all duration-200"},zs=["src","alt","onClick"],Gs={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent text-white p-2"},Hs={class:"text-xs truncate font-medium"},Ws={key:1,class:"flex items-center gap-3"},Js={class:"flex-1 min-w-0"},Qs={class:"text-sm font-medium text-gray-900 truncate"},Ys={class:"text-xs text-gray-500"},Xs={class:"flex-shrink-0"},Zs=["href"],Ks={key:2},el={class:"text-lg font-semibold text-gray-800 mb-4"},tl={class:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 mb-3"},sl={class:"flex justify-between items-start"},ll={class:"text-lg font-semibold text-blue-800"},al={class:"text-sm text-blue-600 mt-1"},nl={key:0,class:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs mr-2"},il={key:1,class:"inline-block bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-xs mr-2"},ol={key:2,class:"inline-block bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs mr-2"},rl={key:3,class:"inline-block bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs"},ul={class:"text-xs text-gray-600 mt-1"},dl={key:0},ml={class:"text-right"},cl={class:"text-lg font-bold text-green-600"},pl={key:0,class:"mt-4 bg-green-50 rounded-lg p-4 mb-4"},fl={class:"space-y-2"},bl={key:0},gl={class:"text-sm text-gray-900 font-medium"},_l={key:1},yl={class:"text-sm text-gray-900 whitespace-pre-wrap"},xl={class:"overflow-x-auto"},vl={class:"min-w-full divide-y divide-gray-200"},hl={class:"bg-gray-50"},kl={key:0,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},wl={class:"bg-white divide-y divide-gray-200"},Pl={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ol={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Sl={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Cl={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Tl={key:0,class:"px-6 py-4 whitespace-nowrap text-sm text-xs"},Al={key:0,class:"text-red-600"},Rl={key:0},jl={key:1},Bl={key:1,class:"text-gray-400"},$l={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900"},El={key:1,class:"mt-4 bg-green-50 rounded-lg p-4"},Vl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},Ll=["onClick"],Nl={class:"aspect-square bg-gray-100 border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-all duration-200"},ql=["src","alt","onClick"],Il={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent text-white p-2"},Dl={class:"text-xs truncate font-medium"},Fl={key:1,class:"flex items-center gap-3"},Ml={class:"flex-1 min-w-0"},Ul={class:"text-sm font-medium text-gray-900 truncate"},zl={class:"text-xs text-gray-500"},Gl={class:"flex-shrink-0"},Hl=["href"],Wl={class:"bg-white rounded-2xl shadow-2xl p-6"},Jl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ql={key:0},Yl={class:"block text-sm font-medium text-gray-700 mb-2"},Xl={key:0},Zl={key:0,class:"mt-1 text-xs text-gray-500"},Kl={key:1,class:"mt-1 text-xs text-gray-500"},ea={key:2,class:"mt-1 text-xs text-gray-500"},ta={class:"md:col-span-2"},sa={key:1,class:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4"},la={class:"flex items-center justify-between mb-3"},aa={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},na={class:"block text-xs font-medium text-gray-600 mb-1"},ia={class:"text-lg font-bold text-gray-900"},oa={key:0,class:"text-xs text-gray-500 mt-1"},ra={key:0},ua={key:1,class:"block mt-1"},da={class:"text-lg font-bold text-green-600"},ma={class:"text-xs text-gray-500 mt-1"},ca={key:0,class:"mt-3"},pa={class:"w-full bg-gray-200 rounded-full h-2.5"},fa={class:"text-xs text-gray-600 mt-1 text-center"},ba={key:1,class:"mt-3 p-2 bg-green-100 border border-green-300 rounded-lg"},ga={class:"text-sm text-green-800 text-center font-medium"},_a={key:0,class:"md:col-span-2"},ya={class:"mt-2"},xa=["value"],va={key:0,class:"text-sm text-red-600 mt-1"},ha={class:"block text-sm font-medium text-gray-700 mb-2"},ka={key:0,class:"text-xs font-normal text-blue-600 ml-2"},wa={class:"relative"},Pa=["max"],Oa={class:"mt-1 text-xs text-gray-500"},Sa={key:0,class:"mt-1 text-xs text-gray-600"},Ca={key:1,class:"mt-1 text-xs text-blue-600"},Ta={key:2,class:"mt-1 text-xs text-blue-600"},Aa={class:"mt-6"},Ra={class:"mt-6"},ja={key:0,class:"bg-white rounded-2xl shadow-2xl p-6"},Ba={class:"text-sm text-gray-600 mb-4"},$a={key:0,class:"block mt-2 text-blue-600"},Ea={class:"space-y-4"},Va={class:"flex items-start justify-between mb-3"},La={class:"flex-1"},Na={class:"text-lg font-semibold text-gray-900"},qa={class:"text-sm text-gray-600 mt-1"},Ia={key:0,class:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs mr-2"},Da={class:"text-gray-500"},Fa={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ma=["onUpdate:modelValue"],Ua={class:"mt-1 text-xs text-gray-500"},za={class:"flex items-end"},Ga=["onClick"],Ha={key:0,class:"mt-4"},Wa={class:"mt-1 text-xs text-gray-500"},Ja={key:0,class:"mt-1 text-xs text-green-600"},Qa={class:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"},Ya={class:"flex justify-between items-center"},Xa={class:"text-lg font-bold text-blue-600"},Za={class:"flex justify-end gap-4"},Ka=["disabled"],en=["src","alt"],tn={class:"text-center text-white mt-2"},sn={class:"text-sm"},ln={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},an={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0 relative",style:{"z-index":"2"}},nn={class:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4 flex items-center justify-between"},on={class:"px-6 py-6 max-h-[70vh] overflow-y-auto"},rn={class:"space-y-6"},un={class:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded"},dn={class:"font-semibold text-blue-800 mb-3"},mn={class:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},cn={class:"font-medium text-gray-700"},pn={class:"ml-2 text-gray-900"},fn={key:0},bn={class:"ml-2 text-gray-900"},gn={class:"font-medium text-gray-700"},_n={class:"ml-2 text-gray-900"},yn={class:"ml-2 text-lg font-bold text-green-600"},xn={class:"bg-green-50 border-l-4 border-green-500 p-4 rounded"},vn={class:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},hn={class:"ml-2 text-gray-900"},kn={class:"ml-2 text-lg font-bold text-green-600"},wn={class:"ml-2 text-gray-900 capitalize"},Pn={key:0,class:"md:col-span-2"},On={class:"ml-2 text-gray-900"},Sn={class:"ml-2 text-gray-900"},Cn={key:1},Tn={class:"ml-2 text-gray-900"},An={key:2},Rn={class:"ml-2 text-gray-900"},jn={key:3,class:"md:col-span-2"},Bn={class:"mt-1 text-gray-900 whitespace-pre-wrap"},$n={key:4,class:"md:col-span-2"},En={class:"mt-1 text-gray-900 whitespace-pre-wrap"},Vn={key:0,class:"bg-purple-50 border-l-4 border-purple-500 p-4 rounded"},Ln={class:"space-y-3"},Nn={class:"flex justify-between items-start mb-2"},qn={class:"font-semibold text-gray-900"},In={class:"text-xs text-gray-600 mt-1"},Dn={key:0,class:"inline-block bg-purple-100 text-purple-800 px-2 py-1 rounded-full mr-2"},Fn={class:"text-right"},Mn={class:"text-lg font-bold text-purple-600"},Un={key:0,class:"mt-2 pt-2 border-t border-purple-200"},zn={class:"ml-2 text-xs text-gray-900"},Gn={class:"bg-white border border-purple-300 rounded-lg p-3 mt-3"},Hn={class:"flex justify-between items-center"},Wn={class:"text-xl font-bold text-purple-600"},Jn={class:"bg-gray-50 px-6 py-4 flex justify-between"},Qn=["disabled"],Yn={key:0,class:"fa fa-spinner fa-spin mr-2"},Xn={key:1,class:"fa fa-check mr-2"},Zn={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Kn={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full"},ei={class:"bg-blue-600 px-6 py-4 flex items-center justify-between"},ti={class:"bg-gray-50 px-6 py-4 flex justify-end"},si={components:{Multiselect:K}},li=Object.assign(si,{__name:"Create",props:{suppliers:Array,availablePOs:Array,availablePRs:Array,filters:Object,banks:{type:Array,default:()=>[]}},setup(be){const j=be,oe=L(()=>(j.availablePOs||[]).map(s=>({...s,is_held:s.is_held===!0||s.is_held===1||s.is_held==="1"||s.is_held==="true",hold_reason:s.hold_reason||null}))),z=h(""),ee=L(()=>{const s=(j.availablePRs||[]).map(m=>({...m,is_held:m.is_held===!0||m.is_held===1||m.is_held==="1"||m.is_held==="true",hold_reason:m.hold_reason||null}));if(!z.value)return s;const t=z.value.toLowerCase();return s.filter(m=>{const c=(m.pr_number||"").toLowerCase(),p=(m.title||"").toLowerCase(),y=(m.mode||"").toLowerCase();return c.includes(t)||p.includes(t)||y.includes(t)})}),I=h(!1),{showLoading:Ee,hideLoading:ge}=Ke(),l=h(null),f=h(null),O=h(null),Ve=h(null),_e=h([]),k=h({}),te=h(!1),B=h([]),$=h([]),W=h(null),re=h(!1),A=h(null),E=h(!1),D=h(!1),v=h({total_paid:0,remaining:0,payment_count:0}),_=h({}),r=Je({purchase_order_ops_id:null,purchase_requisition_id:null,supplier_id:"",coa_id:"",amount:"",payment_method:"",bank_id:null,payment_date:new Date().toISOString().split("T")[0],due_date:"",description:"",reference_number:"",notes:"",is_partial_payment:!1}),J=h([]),R=h(null),ue=h([]),Q=h(null);async function Le(){try{const s=await Z.get("/api/chart-of-accounts/dropdown");if(J.value=(s.data||[]).map(t=>({...t,display_name:`${t.code} - ${t.name}`})),r.coa_id){const t=J.value.find(m=>String(m.id)===String(r.coa_id));t&&(R.value=t)}}catch(s){console.error("Failed to load COA list",s),J.value=[]}}Le();async function Ne(){try{const s=await Z.get("/api/outlets");ue.value=(s.data||[]).map(t=>({id:t.id_outlet||t.id||t.id_outlet,name:t.nama_outlet||t.name||t.nama}))}catch(s){console.error("Failed to load outlets list",s),ue.value=[]}}Ne();function ye(s){s&&s.id&&(r.coa_id=s.id,R.value=s)}function xe(){r.coa_id="",R.value=null}const se=L(()=>Object.values(_.value).reduce((s,t)=>s+(parseFloat(t.amount)||0),0));function ve(){r.amount=se.value}const de=L(()=>{const s=Object.values(_.value).some(t=>t.amount&&parseFloat(t.amount)>0);return String(r.payment_method)==="cash"&&!s});function qe(s,t){_.value[s]&&(_.value[s].amount=t,ve())}function he(){_.value={},k.value&&Object.keys(k.value).length>0&&(Object.keys(k.value).forEach(s=>{const t=k.value[s];_.value[s]={outlet_id:t.outlet_id||null,category_id:t.category_id||null,amount:t.default_amount||t.subtotal||0,bank_id:null,selectedBank:null}}),r.amount=se.value)}function ke(s,t){t&&t.id&&(_.value[s].bank_id=t.id,_.value[s].selectedBank=t)}function we(s){_.value[s].bank_id=null,_.value[s].selectedBank=null}const me=L(()=>!j.banks||!Array.isArray(j.banks)?[]:j.banks.map(s=>{var m;const t=((m=s.outlet)==null?void 0:m.nama_outlet)||s.outlet_name||"Head Office";return{...s,display_name:`${s.bank_name} - ${s.account_number} (${s.account_name}) - ${t}`}}));function le(s){if(s==null||s===""||s===0||s==="0"||typeof s=="string"&&Number.isNaN(Number(s)))return null;const t=Number(s);return Number.isFinite(t)?t:null}function Pe(s){const t=le(s);return t==null?"HO":String(t)}function Oe(s){var t;return le(((t=s==null?void 0:s.outlet)==null?void 0:t.id_outlet)??(s==null?void 0:s.outlet_id)??null)}const Ie=L(()=>{const s=new Map;return(me.value||[]).forEach(t=>{const m=Pe(Oe(t));s.has(m)||s.set(m,[]),s.get(m).push(t)}),s});function Se(s){if(le(s)==null)return me.value||[];const t=Pe(s);return Ie.value.get(t)||[]}Qe(()=>r.payment_method,s=>{if(!(s==="transfer"||s==="check")){Object.keys(_.value).forEach(m=>we(m)),r.bank_id=null,Ve.value=null;return}Object.keys(_.value).forEach(m=>{const c=_.value[m];if(!c)return;const p=c.outlet_id??null,y=Se(p);!c.selectedBank&&y.length===1&&ke(m,y[0])})});const ce=L(()=>{if(l.value)return!0;if(f.value){const s=f.value.mode;return!(s==="travel_application"||s==="kasbon")}return!0}),Y=L(()=>{if(l.value)return!0;if(f.value){const s=f.value.mode;return s==="pr_ops"}return!0});function De(s){s&&s.id&&(r.supplier_id=s.id)}function Fe(){O.value=null,r.supplier_id=""}function G(s){return s?new Date(s).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"}function g(s){return s==null?"-":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s)}function pe(s){if(!s)return"0 B";const t=1024,m=["B","KB","MB","GB"],c=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,c)).toFixed(2))+" "+m[c]}function fe(s){if(!s)return!1;const t=[".jpg",".jpeg",".png",".gif",".bmp",".webp",".svg"],m=s.toLowerCase().substring(s.lastIndexOf("."));return t.includes(m)}function H(s,t){W.value={path:s,name:t},re.value=!0}function Ce(){re.value=!1,W.value=null}function Te(){l.value=null,f.value=null,O.value=null,_e.value=[],k.value={},B.value=[],$.value=[],_.value={},r.purchase_order_ops_id=null,r.purchase_requisition_id=null,r.supplier_id="",r.amount="",r.is_partial_payment=!1,A.value=null,v.value={total_paid:0,remaining:0,payment_count:0}}function Me(){l.value&&l.value.payment_type==="termin"?r.amount=v.value.remaining>0?v.value.remaining:0:A.value!==null?r.amount=A.value:l.value?r.amount=l.value.grand_total:f.value&&(r.amount=f.value.amount)}async function Ue(s){var m;if(s.is_held===!0||s.is_held===1||s.is_held==="1"||s.is_held==="true"){w(async()=>{const{default:c}=await import("./app-V2AeMLhf.js").then(p=>p.s);return{default:c}},__vite__mapDeps([0,1,2,3,4])).then(({default:c})=>{c.fire("Warning","Purchase Order tidak dapat dipilih karena PR source-nya sedang di-hold. Silakan release PR terlebih dahulu.","warning")});return}if(l.value=s,f.value=null,r.purchase_order_ops_id=s.id,r.purchase_requisition_id=null,r.supplier_id=s.supplier_id,s.supplier_id&&j.suppliers){const c=j.suppliers.find(p=>p.id==s.supplier_id);c&&(O.value=c)}te.value=!0;try{const c=await Z.get(`/non-food-payments/po-items/${s.id}`);_e.value=c.data.items||[],k.value=c.data.items_by_outlet||{},B.value=c.data.po_attachments||[],$.value=[],he(),c.data.po_discount_info&&(l.value.po_discount_info=c.data.po_discount_info,l.value.subtotal=c.data.po_discount_info.subtotal,l.value.grand_total=c.data.po_discount_info.grand_total);const p=((m=c.data.po_discount_info)==null?void 0:m.grand_total)||s.grand_total;if(s.payment_type==="termin")try{const y=await Z.get(`/api/non-food-payments/payment-info/${s.id}`);v.value={total_paid:y.data.total_paid||0,remaining:y.data.remaining||p,payment_count:y.data.payment_count||0},r.amount=v.value.remaining>0?v.value.remaining:0,A.value=v.value.remaining,r.is_partial_payment=v.value.total_paid>0}catch(y){console.error("Error loading payment info:",y),v.value={total_paid:0,remaining:p,payment_count:0},r.amount=p,A.value=p,r.is_partial_payment=!1}else r.amount=p,A.value=p,r.is_partial_payment=!1,v.value={total_paid:0,remaining:p,payment_count:0}}catch(c){console.error("Error loading PO items:",c),w(async()=>{const{default:p}=await import("./app-V2AeMLhf.js").then(y=>y.s);return{default:p}},__vite__mapDeps([0,1,2,3,4])).then(({default:p})=>{p.fire("Error","Gagal memuat detail Purchase Order","error")})}finally{te.value=!1}}async function ze(s){if(s.is_held===!0||s.is_held===1||s.is_held==="1"||s.is_held==="true"){w(async()=>{const{default:c}=await import("./app-V2AeMLhf.js").then(p=>p.s);return{default:c}},__vite__mapDeps([0,1,2,3,4])).then(({default:c})=>{c.fire("Warning","Purchase Requisition tidak dapat dipilih karena sedang di-hold. Silakan release PR terlebih dahulu.","warning")});return}f.value=s,l.value=null,r.purchase_requisition_id=s.id,r.purchase_order_ops_id=null;const m=s.mode;r.supplier_id="",O.value=null,r.amount=s.amount,A.value=s.amount,te.value=!0;try{const c=await Z.get(`/non-food-payments/pr-items/${s.id}`);k.value=c.data.items_by_outlet||{},$.value=c.data.pr_attachments||[],B.value=[],he(),c.data.total_amount&&(r.amount=c.data.total_amount,A.value=c.data.total_amount),c.data.pr&&(f.value={...f.value,...c.data.pr})}catch(c){console.error("Error loading PR items:",c),w(async()=>{const{default:p}=await import("./app-V2AeMLhf.js").then(y=>y.s);return{default:p}},__vite__mapDeps([0,1,2,3,4])).then(({default:p})=>{p.fire("Error","Gagal memuat detail Purchase Requisition","error")})}finally{te.value=!1}}function Ge(){if(!r.purchase_order_ops_id&&!r.purchase_requisition_id){w(async()=>{const{default:s}=await import("./app-V2AeMLhf.js").then(t=>t.s);return{default:s}},__vite__mapDeps([0,1,2,3,4])).then(({default:s})=>{s.fire("Error","Pilih minimal satu transaksi (Purchase Order atau Purchase Requisition).","error")});return}if(ce.value&&Y.value&&!r.supplier_id){w(async()=>{const{default:s}=await import("./app-V2AeMLhf.js").then(t=>t.s);return{default:s}},__vite__mapDeps([0,1,2,3,4])).then(({default:s})=>{s.fire("Error","Supplier harus dipilih.","error")});return}if(ce.value||(r.supplier_id=""),l.value&&l.value.payment_type==="termin"){if(parseFloat(r.amount)>v.value.remaining){w(async()=>{const{default:s}=await import("./app-V2AeMLhf.js").then(t=>t.s);return{default:s}},__vite__mapDeps([0,1,2,3,4])).then(({default:s})=>{s.fire("Error",`Jumlah pembayaran melebihi sisa yang harus dibayar. Sisa: ${g(v.value.remaining)}`,"error")});return}if(parseFloat(r.amount)<=0){w(async()=>{const{default:s}=await import("./app-V2AeMLhf.js").then(t=>t.s);return{default:s}},__vite__mapDeps([0,1,2,3,4])).then(({default:s})=>{s.fire("Error","Jumlah pembayaran harus lebih dari 0.","error")});return}}if(r.payment_method==="transfer"||r.payment_method==="check"){if(Object.keys(_.value).filter(m=>{const c=_.value[m];return c.amount&&parseFloat(c.amount)>0&&!c.bank_id}).length>0){w(async()=>{const{default:m}=await import("./app-V2AeMLhf.js").then(c=>c.s);return{default:m}},__vite__mapDeps([0,1,2,3,4])).then(({default:m})=>{m.fire("Error","Semua outlet yang memiliki jumlah pembayaran harus memiliki bank yang dipilih untuk metode pembayaran "+r.payment_method+".","error")});return}if(Object.keys(_.value).filter(m=>{const c=_.value[m];if(!c||!(c.amount&&parseFloat(c.amount)>0))return!1;const p=le(c.outlet_id??null);if(p==null)return!1;const y=c.selectedBank||(me.value||[]).find(M=>String(M.id)===String(c.bank_id)),F=Oe(y);return String(F)!==String(p)}).length>0){w(async()=>{const{default:m}=await import("./app-V2AeMLhf.js").then(c=>c.s);return{default:m}},__vite__mapDeps([0,1,2,3,4])).then(({default:m})=>{m.fire("Error","Rekening bank harus sesuai outlet masing-masing. Silakan pilih bank outlet yang tepat untuk setiap outlet.","error")});return}}D.value=!0}function He(){I.value=!0,D.value=!1,Ee("Menyimpan Non Food Payment...","Mohon tunggu sebentar");const s=Object.values(_.value).filter(m=>m.amount&&parseFloat(m.amount)>0).map(m=>({outlet_id:m.outlet_id,category_id:m.category_id,amount:m.amount,bank_id:m.bank_id||null})),t={...r,outlet_payments:s.length>0?s:null};if(s.length>0&&delete t.bank_id,de.value){if(!Q.value){I.value=!1,D.value=!0,ge(),w(async()=>{const{default:m}=await import("./app-V2AeMLhf.js").then(c=>c.s);return{default:m}},__vite__mapDeps([0,1,2,3,4])).then(({default:m})=>{m.fire("Error","Silakan pilih outlet sebelum menyimpan pembayaran tunai.","error")});return}t.outlet_payments=[{outlet_id:Q.value,category_id:null,amount:r.amount,bank_id:null}],delete t.bank_id}$e.post("/non-food-payments",t,{onSuccess:()=>{w(async()=>{const{default:m}=await import("./app-V2AeMLhf.js").then(c=>c.s);return{default:m}},__vite__mapDeps([0,1,2,3,4])).then(({default:m})=>{m.fire("Berhasil","Non Food Payment berhasil dibuat!","success")})},onError:m=>{console.error("Validation errors:",m),console.error("Form data:",t),w(async()=>{const{default:c}=await import("./app-V2AeMLhf.js").then(p=>p.s);return{default:c}},__vite__mapDeps([0,1,2,3,4])).then(({default:c})=>{var M;let p="Gagal membuat Non Food Payment. Periksa data yang diinput.",y=[];if(m&&typeof m=="object")if(Object.keys(m).forEach(P=>{const V=m[P];Array.isArray(V)&&V.length>0?y.push(`${P}: ${V[0]}`):typeof V=="string"&&y.push(`${P}: ${V}`)}),y.length>0)p=y.join(`
`);else{const P=Object.values(m)[0];Array.isArray(P)&&P.length>0?p=P[0]:typeof P=="string"&&(p=P)}else typeof m=="string"&&(p=m);const F=Ze();(M=F.props)!=null&&M.error&&(p=F.props.error),c.fire({icon:"error",title:"Error",html:p.replace(/\n/g,"<br>"),confirmButtonText:"OK",width:"600px"})})},onFinish:()=>{I.value=!1,ge()}})}function We(){$e.get("/non-food-payments")}return(s,t)=>(n(),Ye(et,null,{default:X(()=>{var m,c,p,y,F,M,P,V,Ae,Re,je;return[e("div",st,[e("div",{class:"flex justify-between items-center mb-6"},[t[26]||(t[26]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-plus-circle"}),d(" Buat Non Food Payment ")],-1)),e("button",{onClick:We,class:"bg-gray-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},t[25]||(t[25]=[e("i",{class:"fa fa-arrow-left mr-1"},null,-1),d(" Kembali ")]))]),l.value?u("",!0):(n(),i("div",lt,[oe.value.length>0?(n(),i("div",at,[t[34]||(t[34]=e("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Pilih Purchase Order untuk Dibayar",-1)),e("div",nt,[(n(!0),i(S,null,C(oe.value,a=>(n(),i("div",{key:a.id,class:U(["border rounded-lg p-4 transition",a.is_held?"border-red-300 bg-red-50 opacity-60 cursor-not-allowed":"border-gray-200 hover:bg-gray-50 cursor-pointer"]),onClick:x=>a.is_held?null:Ue(a)},[e("div",ot,[e("div",rt,[e("div",ut,[e("div",dt,o(a.number),1),a.is_held?(n(),i("span",mt,t[27]||(t[27]=[e("i",{class:"fas fa-lock mr-1"},null,-1),d(" ON HOLD ")]))):u("",!0)]),e("div",ct,o(a.supplier_name),1),e("div",pt,o(G(a.date))+" - "+o(g(a.grand_total)),1),a.pr_outlet_name?(n(),i("div",ft,[t[28]||(t[28]=e("i",{class:"fa fa-store mr-1"},null,-1)),d("Outlet: "+o(a.pr_outlet_name),1)])):u("",!0),a.source_pr_number?(n(),i("div",bt,[t[29]||(t[29]=e("i",{class:"fa fa-link mr-1"},null,-1)),d("Source: "+o(a.source_pr_number),1)])):u("",!0),a.is_held&&a.hold_reason?(n(),i("p",gt,[t[30]||(t[30]=e("i",{class:"fas fa-info-circle mr-1"},null,-1)),d(" "+o(a.hold_reason),1)])):u("",!0)]),e("div",_t,[e("button",{type:"button",class:U(a.is_held?"bg-gray-400 text-white px-4 py-2 rounded-lg cursor-not-allowed":"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition"),disabled:a.is_held},t[31]||(t[31]=[e("i",{class:"fa fa-arrow-right mr-1"},null,-1),d(" Pilih ")]),10,yt)])])],10,it))),128)),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Akun Pembayaran (COA)",-1)),ne(ie(K),{modelValue:R.value,"onUpdate:modelValue":t[0]||(t[0]=a=>R.value=a),options:J.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Pilih Akun (ketik untuk mencari)",label:"display_name","track-by":"id",onSelect:ye,onRemove:xe,class:"w-full"},null,8,["modelValue","options"]),t[33]||(t[33]=e("p",{class:"mt-1 text-xs text-gray-500"},"Opsional: pilih akun untuk jurnal pembayaran",-1))])])])):u("",!0),ee.value.length>0?(n(),i("div",xt,[e("div",vt,[t[36]||(t[36]=e("h2",{class:"text-xl font-bold text-gray-800"},"Available Purchase Requisitions",-1)),e("div",ht,[e("div",kt,[T(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>z.value=a),placeholder:"Cari PR number, title, atau mode...",class:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400 w-64"},null,512),[[N,z.value]]),t[35]||(t[35]=e("i",{class:"fa fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"},null,-1))])])]),e("div",wt,[(n(!0),i(S,null,C(ee.value,a=>(n(),i("div",{key:a.id,class:U(["border rounded-lg p-4 transition",a.is_held?"border-red-300 bg-red-50 opacity-60 cursor-not-allowed":"border-gray-200 hover:bg-gray-50 cursor-pointer"]),onClick:x=>a.is_held?null:ze(a)},[e("div",Ot,[e("div",St,[e("div",Ct,[e("div",Tt,o(a.pr_number),1),a.is_held?(n(),i("span",At,t[37]||(t[37]=[e("i",{class:"fas fa-lock mr-1"},null,-1),d(" ON HOLD ")]))):u("",!0)]),e("div",Rt,o(a.title),1),e("div",jt,o(G(a.date))+" - "+o(g(a.amount)),1),a.is_held&&a.hold_reason?(n(),i("p",Bt,[t[38]||(t[38]=e("i",{class:"fas fa-info-circle mr-1"},null,-1)),d(" "+o(a.hold_reason),1)])):u("",!0)]),e("div",$t,[e("button",{type:"button",class:U(a.is_held?"bg-gray-400 text-white px-4 py-2 rounded-lg cursor-not-allowed":"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition"),disabled:a.is_held},t[39]||(t[39]=[e("i",{class:"fa fa-arrow-right mr-1"},null,-1),d(" Pilih ")]),10,Et)])])],10,Pt))),128))])])):u("",!0),oe.value.length===0&&ee.value.length===0?(n(),i("div",Vt,t[40]||(t[40]=[e("div",{class:"text-gray-500"},[e("i",{class:"fa fa-inbox text-4xl mb-4"}),e("p",null,"Tidak ada Purchase Order atau Purchase Requisition yang tersedia untuk dibayar.")],-1)]))):u("",!0),(j.availablePRs||[]).length>0&&ee.value.length===0?(n(),i("div",Lt,[e("div",Nt,[t[41]||(t[41]=e("i",{class:"fa fa-search text-4xl mb-4"},null,-1)),e("p",null,'Tidak ada Purchase Requisition yang ditemukan untuk pencarian "'+o(z.value)+'".',1),e("button",{onClick:t[2]||(t[2]=a=>z.value=""),class:"mt-4 text-blue-600 hover:text-blue-800 underline"}," Hapus filter pencarian ")])])):u("",!0)])),l.value||f.value?(n(),i("div",qt,[e("div",It,[e("div",Dt,[e("h2",Ft,o(l.value?"Detail Purchase Order":"Detail Purchase Requisition"),1),e("div",Mt,[l.value?(n(),i("button",{key:0,type:"button",onClick:t[3]||(t[3]=a=>E.value=!0),class:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1 px-3 py-1 bg-blue-50 rounded-lg border border-blue-200"},t[42]||(t[42]=[e("i",{class:"fa fa-question-circle"},null,-1),e("span",{class:"text-red-600 font-semibold"},"Tutorial Payment Type",-1)]))):u("",!0),e("button",{type:"button",onClick:Te,class:"text-gray-500 hover:text-gray-700"},t[43]||(t[43]=[e("i",{class:"fa fa-times"},null,-1)]))])]),e("div",Ut,[e("div",null,[e("label",zt,o(l.value?"PO Number":"PR Number"),1),e("p",Gt,o(l.value?l.value.number:f.value.pr_number),1)]),l.value?(n(),i("div",Ht,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-gray-700"},"Supplier",-1)),e("p",Wt,o(l.value.supplier_name),1)])):u("",!0),e("div",null,[e("label",Jt,o(l.value?"PO Date":"PR Date"),1),e("p",Qt,o(G(l.value?l.value.date:f.value.date)),1)]),l.value&&((m=l.value.po_discount_info)!=null&&m.subtotal)?(n(),i("div",Yt,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-gray-700"},"Subtotal",-1)),e("p",Xt,o(g(l.value.po_discount_info.subtotal)),1)])):u("",!0),l.value&&l.value.po_discount_info&&(l.value.po_discount_info.discount_total_percent>0||l.value.po_discount_info.discount_total_amount>0)?(n(),i("div",Zt,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-gray-700"},"Diskon Total PO",-1)),e("p",Kt,[l.value.po_discount_info.discount_total_percent>0?(n(),i("span",es,o(l.value.po_discount_info.discount_total_percent)+"%",1)):u("",!0),l.value.po_discount_info.discount_total_percent>0&&l.value.po_discount_info.discount_total_amount>0?(n(),i("span",ts," / ")):u("",!0),l.value.po_discount_info.discount_total_amount>0?(n(),i("span",ss,o(g(l.value.po_discount_info.discount_total_amount)),1)):u("",!0)])])):u("",!0),l.value&&l.value.po_discount_info&&l.value.po_discount_info.ppn_enabled?(n(),i("div",ls,[t[47]||(t[47]=e("label",{class:"block text-sm font-medium text-gray-700"},"PPN (11%)",-1)),e("p",as,o(g(l.value.po_discount_info.ppn_amount||0)),1)])):u("",!0),e("div",null,[e("label",ns,"Grand Total (Setelah Discount"+o(l.value&&l.value.po_discount_info&&l.value.po_discount_info.ppn_enabled?" + PPN":"")+")",1),e("p",is,o(g(l.value?((c=l.value.po_discount_info)==null?void 0:c.grand_total)||l.value.grand_total:f.value.amount)),1),l.value&&l.value.po_discount_info?(n(),i("p",os,[l.value.po_discount_info.discount_total_percent>0||l.value.po_discount_info.discount_total_amount>0?(n(),i("span",rs," (Subtotal: "+o(g(l.value.po_discount_info.subtotal))+" - Discount: "+o(g(l.value.po_discount_info.discount_total_amount))+o(l.value.po_discount_info.ppn_enabled?" + PPN: "+g(l.value.po_discount_info.ppn_amount||0):"")+") ",1)):u("",!0)])):u("",!0)]),l.value&&l.value.source_pr_number?(n(),i("div",us,[t[48]||(t[48]=e("label",{class:"block text-sm font-medium text-gray-700"},"Source PR",-1)),e("p",ds,o(l.value.source_pr_number),1)])):u("",!0),f.value&&f.value.division_name?(n(),i("div",ms,[t[49]||(t[49]=e("label",{class:"block text-sm font-medium text-gray-700"},"Division",-1)),e("p",cs,o(f.value.division_name),1)])):u("",!0),l.value?(n(),i("div",ps,[e("div",fs,[e("div",bs,[t[51]||(t[51]=e("label",{class:"block text-sm font-medium text-blue-800"},"Metode Pembayaran",-1)),e("button",{type:"button",onClick:t[4]||(t[4]=a=>E.value=!0),class:"text-blue-600 hover:text-blue-800 text-xs font-medium flex items-center gap-1"},t[50]||(t[50]=[e("i",{class:"fa fa-question-circle"},null,-1),e("span",{class:"text-red-600 font-semibold"},"Tutorial",-1)]))]),l.value.payment_type?(n(),i("div",gs,[e("span",{class:U(["inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",l.value.payment_type==="lunas"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"])},[e("i",{class:U(l.value.payment_type==="lunas"?"fa fa-check-circle mr-1":"fa fa-calendar-alt mr-1")},null,2),d(" "+o(l.value.payment_type==="lunas"?"Bayar Lunas":"Termin Bayar"),1)],2),l.value.payment_type==="termin"&&l.value.payment_terms?(n(),i("p",_s,[t[52]||(t[52]=e("strong",null,"Detail Termin:",-1)),d(" "+o(l.value.payment_terms),1)])):l.value.payment_type==="lunas"?(n(),i("p",ys,t[53]||(t[53]=[e("i",{class:"fa fa-info-circle mr-1"},null,-1),d(" Pembayaran harus dilakukan sekaligus (lunas) dengan amount = Grand Total PO ")]))):u("",!0)])):(n(),i("div",xs,t[54]||(t[54]=[e("i",{class:"fa fa-info-circle mr-1"},null,-1),d(" Metode pembayaran belum ditentukan di PO ")])))])])):u("",!0)]),l.value&&(l.value.pr_title||l.value.pr_description)||f.value&&(f.value.title||f.value.description)?(n(),i("div",vs,[t[57]||(t[57]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},[e("i",{class:"fa fa-shopping-cart mr-2 text-green-500"}),d(" Informasi Purchase Requisition ")],-1)),e("div",hs,[l.value&&l.value.pr_title||f.value&&f.value.title?(n(),i("div",ks,[t[55]||(t[55]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Title",-1)),e("p",ws,o(l.value?l.value.pr_title:f.value.title),1)])):u("",!0),l.value&&l.value.pr_description||f.value&&f.value.description?(n(),i("div",Ps,[t[56]||(t[56]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),e("p",Os,o(l.value?l.value.pr_description:f.value.description),1)])):u("",!0)])])):u("",!0),B.value&&B.value.length>0||$.value&&$.value.length>0?(n(),i("div",Ss,[t[66]||(t[66]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Attachments",-1)),l.value&&B.value&&B.value.length>0?(n(),i("div",Cs,[t[61]||(t[61]=e("h4",{class:"text-md font-medium text-gray-700 mb-3"},"Purchase Order Attachments",-1)),e("div",Ts,[(n(!0),i(S,null,C(B.value,a=>(n(),i("div",{key:`po-${a.id}`,class:"border border-gray-200 rounded-lg p-3"},[fe(a.file_name)?(n(),i("div",{key:0,class:"relative group cursor-pointer",onClick:x=>H(`/po-ops/attachments/${a.id}/view`,a.file_name)},[e("div",Rs,[e("img",{src:`/po-ops/attachments/${a.id}/view`,alt:a.file_name,class:"w-full h-full object-cover hover:scale-105 transition-transform duration-200",onClick:q(x=>H(`/po-ops/attachments/${a.id}/view`,a.file_name),["stop"])},null,8,js)]),t[58]||(t[58]=e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center"},[e("div",{class:"opacity-0 group-hover:opacity-100 bg-white bg-opacity-90 text-gray-800 px-3 py-1 rounded-full text-sm transition-all duration-200 flex items-center gap-2"},[e("i",{class:"fas fa-search-plus"}),e("span",null,"View")])],-1)),e("div",Bs,[e("p",$s,o(a.file_name),1)])],8,As)):(n(),i("div",Es,[t[60]||(t[60]=e("div",{class:"flex-shrink-0"},[e("i",{class:"fa fa-file text-gray-500 text-xl"})],-1)),e("div",Vs,[e("p",Ls,o(a.file_name),1),e("p",Ns,o(pe(a.file_size)),1)]),e("div",qs,[e("a",{href:`/po-ops/attachments/${a.id}/download`,target:"_blank",class:"text-blue-600 hover:text-blue-800 text-sm"},t[59]||(t[59]=[e("i",{class:"fa fa-download"},null,-1)]),8,Is)])]))]))),128))])])):u("",!0),f.value&&$.value&&$.value.length>0?(n(),i("div",Ds,[t[65]||(t[65]=e("h4",{class:"text-md font-medium text-gray-700 mb-3"},"Purchase Requisition Attachments",-1)),e("div",Fs,[(n(!0),i(S,null,C($.value,a=>(n(),i("div",{key:`pr-${a.id}`,class:"border border-gray-200 rounded-lg p-3"},[fe(a.file_name)?(n(),i("div",{key:0,class:"relative group cursor-pointer",onClick:x=>H(`/purchase-requisitions/attachments/${a.id}/view`,a.file_name)},[e("div",Us,[e("img",{src:`/purchase-requisitions/attachments/${a.id}/view`,alt:a.file_name,class:"w-full h-full object-cover hover:scale-105 transition-transform duration-200",onClick:q(x=>H(`/purchase-requisitions/attachments/${a.id}/view`,a.file_name),["stop"])},null,8,zs)]),t[62]||(t[62]=e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center"},[e("div",{class:"opacity-0 group-hover:opacity-100 bg-white bg-opacity-90 text-gray-800 px-3 py-1 rounded-full text-sm transition-all duration-200 flex items-center gap-2"},[e("i",{class:"fas fa-search-plus"}),e("span",null,"View")])],-1)),e("div",Gs,[e("p",Hs,o(a.file_name),1)])],8,Ms)):(n(),i("div",Ws,[t[64]||(t[64]=e("div",{class:"flex-shrink-0"},[e("i",{class:"fa fa-file text-gray-500 text-xl"})],-1)),e("div",Js,[e("p",Qs,o(a.file_name),1),e("p",Ys,o(pe(a.file_size)),1)]),e("div",Xs,[e("a",{href:`/purchase-requisitions/attachments/${a.id}/download`,target:"_blank",class:"text-blue-600 hover:text-blue-800 text-sm"},t[63]||(t[63]=[e("i",{class:"fa fa-download"},null,-1)]),8,Zs)])]))]))),128))])])):u("",!0)])):u("",!0),k.value&&Object.keys(k.value).length>0?(n(),i("div",Ks,[e("h3",el,"Items "+o(l.value?"per Outlet":"per Outlet & Category"),1),(n(!0),i(S,null,C(k.value,(a,x)=>(n(),i("div",{key:x,class:"mb-6"},[e("div",tl,[e("div",sl,[e("div",null,[e("h4",ll,o(a.outlet_name||"Global / All Outlets"),1),e("div",al,[a.category_name?(n(),i("span",nl," Category: "+o(a.category_name),1)):u("",!0),a.category_division?(n(),i("span",il,o(a.category_division),1)):u("",!0),a.category_subcategory?(n(),i("span",ol,o(a.category_subcategory),1)):u("",!0),a.category_budget_type?(n(),i("span",rl,o(a.category_budget_type==="GLOBAL"?"Global Budget":"Per Outlet Budget"),1)):u("",!0)]),e("div",ul,[a.pr_number?(n(),i("span",dl,"PR: "+o(a.pr_number),1)):u("",!0)])]),e("div",ml,[e("div",cl,o(g(a.subtotal)),1),t[67]||(t[67]=e("div",{class:"text-xs text-gray-500"},"Subtotal",-1))])])]),a.pr_title||a.pr_description?(n(),i("div",pl,[t[70]||(t[70]=e("h5",{class:"text-sm font-semibold text-green-800 mb-3"},[e("i",{class:"fa fa-shopping-cart mr-2"}),d(" Informasi Purchase Requisition ")],-1)),e("div",fl,[a.pr_title?(n(),i("div",bl,[t[68]||(t[68]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Title",-1)),e("p",gl,o(a.pr_title),1)])):u("",!0),a.pr_description?(n(),i("div",_l,[t[69]||(t[69]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Description",-1)),e("p",yl,o(a.pr_description),1)])):u("",!0)])])):u("",!0),e("div",xl,[e("table",vl,[e("thead",hl,[e("tr",null,[t[71]||(t[71]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item",-1)),t[72]||(t[72]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Quantity",-1)),t[73]||(t[73]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Unit",-1)),t[74]||(t[74]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Price",-1)),l.value?(n(),i("th",kl,"Diskon")):u("",!0),t[75]||(t[75]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total",-1))])]),e("tbody",wl,[(n(!0),i(S,null,C(a.items,b=>(n(),i("tr",{key:b.id},[e("td",Pl,o(b.item_name),1),e("td",Ol,o(b.quantity),1),e("td",Sl,o(b.unit),1),e("td",Cl,o(g(b.price)),1),l.value?(n(),i("td",Tl,[b.discount_percent>0||b.discount_amount>0?(n(),i("div",Al,[b.discount_percent>0?(n(),i("div",Rl,o(b.discount_percent)+"%",1)):u("",!0),b.discount_amount>0?(n(),i("div",jl,o(g(b.discount_amount)),1)):u("",!0)])):(n(),i("span",Bl,"-"))])):u("",!0),e("td",$l,o(g(b.total)),1)]))),128))])])]),a.pr_attachments&&a.pr_attachments.length>0?(n(),i("div",El,[t[79]||(t[79]=e("h5",{class:"text-sm font-semibold text-green-800 mb-3"},"PR Attachments",-1)),e("div",Vl,[(n(!0),i(S,null,C(a.pr_attachments,b=>(n(),i("div",{key:`pr-${b.id}`,class:"border border-green-200 rounded-lg p-3 bg-white"},[fe(b.file_name)?(n(),i("div",{key:0,class:"relative group cursor-pointer",onClick:ae=>H(`/purchase-requisitions/attachments/${b.id}/view`,b.file_name)},[e("div",Nl,[e("img",{src:`/purchase-requisitions/attachments/${b.id}/view`,alt:b.file_name,class:"w-full h-full object-cover hover:scale-105 transition-transform duration-200",onClick:q(ae=>H(`/purchase-requisitions/attachments/${b.id}/view`,b.file_name),["stop"])},null,8,ql)]),t[76]||(t[76]=e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center"},[e("div",{class:"opacity-0 group-hover:opacity-100 bg-white bg-opacity-90 text-gray-800 px-3 py-1 rounded-full text-sm transition-all duration-200 flex items-center gap-2"},[e("i",{class:"fas fa-search-plus"}),e("span",null,"View")])],-1)),e("div",Il,[e("p",Dl,o(b.file_name),1)])],8,Ll)):(n(),i("div",Fl,[t[78]||(t[78]=e("div",{class:"flex-shrink-0"},[e("i",{class:"fa fa-file text-gray-500 text-xl"})],-1)),e("div",Ml,[e("p",Ul,o(b.file_name),1),e("p",zl,o(pe(b.file_size)),1)]),e("div",Gl,[e("a",{href:`/purchase-requisitions/attachments/${b.id}/download`,target:"_blank",class:"text-green-600 hover:text-green-800 text-sm"},t[77]||(t[77]=[e("i",{class:"fa fa-download"},null,-1)]),8,Hl)])]))]))),128))])])):u("",!0)]))),128))])):u("",!0)]),e("div",Wl,[t[107]||(t[107]=e("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Informasi Payment",-1)),e("div",Jl,[ce.value?(n(),i("div",Ql,[e("label",Yl,[t[80]||(t[80]=d(" Supplier ")),Y.value?(n(),i("span",Xl,"*")):u("",!0)]),ne(ie(K),{modelValue:O.value,"onUpdate:modelValue":t[5]||(t[5]=a=>O.value=a),options:be.suppliers,searchable:!0,"close-on-select":!0,"show-labels":!1,disabled:l.value,placeholder:"Pilih Supplier",label:"name","track-by":"id",onSelect:De,onRemove:Fe,class:"mt-1",required:Y.value},{noOptions:X(()=>t[81]||(t[81]=[e("span",null,"Tidak ada supplier ditemukan",-1)])),noResult:X(()=>t[82]||(t[82]=[e("span",null,"Tidak ada supplier ditemukan",-1)])),_:1},8,["modelValue","options","disabled","required"]),l.value?(n(),i("p",Zl," Supplier diambil dari Purchase Order ")):u("",!0),f.value&&Y.value?(n(),i("p",Kl," Pilih supplier untuk payment ini (wajib) ")):u("",!0),f.value&&!Y.value?(n(),i("p",ea," Pilih supplier untuk payment ini (opsional) ")):u("",!0)])):u("",!0),e("div",ta,[t[83]||(t[83]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Akun Pembayaran (COA)",-1)),ne(ie(K),{modelValue:R.value,"onUpdate:modelValue":t[6]||(t[6]=a=>R.value=a),options:J.value,searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Pilih Akun (ketik untuk mencari)",label:"display_name","track-by":"id",onSelect:ye,onRemove:xe,class:"w-full"},null,8,["modelValue","options"]),t[84]||(t[84]=e("p",{class:"mt-1 text-xs text-gray-500"},"Opsional: pilih akun untuk jurnal pembayaran",-1))]),l.value&&l.value.payment_type==="termin"?(n(),i("div",sa,[e("div",la,[t[86]||(t[86]=e("h4",{class:"text-sm font-semibold text-blue-800 flex items-center"},[e("i",{class:"fa fa-calendar-alt mr-2"}),d(" Informasi Pembayaran Termin ")],-1)),e("button",{type:"button",onClick:t[7]||(t[7]=a=>E.value=!0),class:"text-blue-600 hover:text-blue-800 text-xs font-medium flex items-center gap-1"},t[85]||(t[85]=[e("i",{class:"fa fa-question-circle"},null,-1),e("span",{class:"text-red-600 font-semibold"},"Tutorial",-1)]))]),e("div",aa,[e("div",null,[e("label",na,"Total PO (Setelah Discount"+o(l.value.po_discount_info&&l.value.po_discount_info.ppn_enabled?" + PPN":"")+")",1),e("p",ia,o(g(((p=l.value.po_discount_info)==null?void 0:p.grand_total)||l.value.grand_total)),1),l.value.po_discount_info?(n(),i("p",oa,[l.value.po_discount_info.discount_total_percent>0||l.value.po_discount_info.discount_total_amount>0?(n(),i("span",ra," Subtotal: "+o(g(l.value.po_discount_info.subtotal))+" - Discount: "+o(g(l.value.po_discount_info.discount_total_amount)),1)):u("",!0),l.value.po_discount_info.ppn_enabled?(n(),i("span",ua," PPN (11%): "+o(g(l.value.po_discount_info.ppn_amount||0)),1)):u("",!0)])):u("",!0)]),e("div",null,[t[87]||(t[87]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Sudah Dibayar",-1)),e("p",da,o(g(v.value.total_paid)),1),e("p",ma,o(v.value.payment_count)+" pembayaran",1)]),e("div",null,[t[88]||(t[88]=e("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Sisa Pembayaran",-1)),e("p",{class:U(["text-lg font-bold",v.value.remaining>0?"text-red-600":"text-green-600"])},o(g(v.value.remaining)),3)])]),v.value.remaining>0?(n(),i("div",ca,[e("div",pa,[e("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:Xe({width:`${v.value.total_paid/(((y=l.value.po_discount_info)==null?void 0:y.grand_total)||l.value.grand_total)*100}%`})},null,4)]),e("p",fa," Progress: "+o((v.value.total_paid/(((F=l.value.po_discount_info)==null?void 0:F.grand_total)||l.value.grand_total)*100).toFixed(1))+"% ",1)])):(n(),i("div",ba,[e("p",ga,[de.value?(n(),i("div",_a,[t[90]||(t[90]=e("label",{class:"font-medium text-gray-700"},"Pilih Outlet untuk Pembayaran Tunai:",-1)),e("div",ya,[T(e("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>Q.value=a),class:"px-3 py-2 rounded border border-gray-300 w-full"},[t[89]||(t[89]=e("option",{value:""},"-- Pilih Outlet --",-1)),(n(!0),i(S,null,C(ue.value,a=>(n(),i("option",{key:a.id,value:a.id},o(a.name),9,xa))),128))],512),[[Be,Q.value]])]),de.value&&!Q.value?(n(),i("div",va,"Outlet wajib dipilih untuk pembayaran tunai.")):u("",!0)])):u("",!0),t[91]||(t[91]=e("i",{class:"fa fa-check-circle mr-1"},null,-1)),t[92]||(t[92]=d(" PO sudah lunas! "))])]))])):u("",!0),e("div",null,[e("label",ha,[t[93]||(t[93]=d(" Amount * ")),t[94]||(t[94]=e("span",{class:"text-xs font-normal text-gray-500"},"(Dapat diubah)",-1)),l.value&&l.value.payment_type==="termin"?(n(),i("span",ka," (Maks: "+o(g(v.value.remaining))+") ",1)):u("",!0)]),e("div",wa,[T(e("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=a=>r.amount=a),step:"0.01",min:0,max:l.value&&l.value.payment_type==="termin"?v.value.remaining:void 0,required:"",class:"w-full px-4 py-2 pr-24 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"0.00"},null,8,Pa),[[N,r.amount]]),l.value||f.value?(n(),i("button",{key:0,type:"button",onClick:Me,class:"absolute right-2 top-1/2 -translate-y-1/2 px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition",title:"Reset ke nilai PO/PR"},t[95]||(t[95]=[e("i",{class:"fa fa-undo mr-1"},null,-1),d(" Reset ")]))):u("",!0)]),e("p",Oa,[t[96]||(t[96]=e("i",{class:"fa fa-info-circle mr-1"},null,-1)),d(" Nilai otomatis diisi dari "+o(l.value?"PO":"PR")+", namun dapat diubah sesuai kebutuhan ",1)]),l.value||f.value?(n(),i("p",Sa,[d(" Nilai "+o(l.value?"PO":"PR")+": ",1),e("strong",null,o(g(A.value||(l.value?((M=l.value.po_discount_info)==null?void 0:M.grand_total)||l.value.grand_total:f.value.amount))),1)])):u("",!0),l.value&&l.value.po_discount_info&&(l.value.po_discount_info.discount_total_percent>0||l.value.po_discount_info.discount_total_amount>0)?(n(),i("p",Ca,[t[97]||(t[97]=e("i",{class:"fa fa-info-circle mr-1"},null,-1)),d(" Nilai ini sudah termasuk discount total PO ("+o(l.value.po_discount_info.discount_total_percent>0?l.value.po_discount_info.discount_total_percent+"%":"")+o(l.value.po_discount_info.discount_total_percent>0&&l.value.po_discount_info.discount_total_amount>0?" / ":"")+o(l.value.po_discount_info.discount_total_amount>0?g(l.value.po_discount_info.discount_total_amount):"")+") ",1)])):u("",!0),l.value&&l.value.payment_type==="termin"&&v.value.remaining<(((P=l.value.po_discount_info)==null?void 0:P.grand_total)||l.value.grand_total)?(n(),i("p",Ta,[t[98]||(t[98]=e("i",{class:"fa fa-info-circle mr-1"},null,-1)),t[99]||(t[99]=d(" Ini adalah pembayaran termin. Sisa yang harus dibayar: ")),e("strong",null,o(g(v.value.remaining)),1)])):u("",!0)]),e("div",null,[t[101]||(t[101]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Payment Method *",-1)),T(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>r.payment_method=a),required:"",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[100]||(t[100]=[e("option",{value:""},"Pilih Payment Method",-1),e("option",{value:"cash"},"Cash",-1),e("option",{value:"transfer"},"Transfer",-1),e("option",{value:"check"},"Check",-1)]),512),[[Be,r.payment_method]])]),e("div",null,[t[102]||(t[102]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Payment Date *",-1)),T(e("input",{type:"date","onUpdate:modelValue":t[11]||(t[11]=a=>r.payment_date=a),required:"",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[N,r.payment_date]])]),e("div",null,[t[103]||(t[103]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Due Date",-1)),T(e("input",{type:"date","onUpdate:modelValue":t[12]||(t[12]=a=>r.due_date=a),class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[N,r.due_date]])]),e("div",null,[t[104]||(t[104]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Reference Number",-1)),T(e("input",{type:"text","onUpdate:modelValue":t[13]||(t[13]=a=>r.reference_number=a),class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Nomor referensi"},null,512),[[N,r.reference_number]])])]),e("div",Aa,[t[105]||(t[105]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),T(e("textarea",{"onUpdate:modelValue":t[14]||(t[14]=a=>r.description=a),rows:"3",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Deskripsi payment"},null,512),[[N,r.description]])]),e("div",Ra,[t[106]||(t[106]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notes",-1)),T(e("textarea",{"onUpdate:modelValue":t[15]||(t[15]=a=>r.notes=a),rows:"3",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Catatan tambahan"},null,512),[[N,r.notes]])])]),k.value&&Object.keys(k.value).length>0?(n(),i("div",ja,[t[125]||(t[125]=e("h2",{class:"text-xl font-bold text-gray-800 mb-4"},"Pembayaran Per Outlet",-1)),e("p",Ba,[t[112]||(t[112]=e("i",{class:"fa fa-info-circle mr-1"},null,-1)),t[113]||(t[113]=d(" Input jumlah pembayaran untuk setiap outlet. Default diisi dari subtotal items per outlet, namun dapat diubah sesuai kebutuhan. ")),r.payment_method==="transfer"||r.payment_method==="check"?(n(),i("span",$a,[t[108]||(t[108]=e("i",{class:"fa fa-university mr-1"},null,-1)),t[109]||(t[109]=e("strong",null,"Penting:",-1)),t[110]||(t[110]=d(" Pilih bank untuk setiap outlet dengan metode pembayaran ")),e("strong",null,o(r.payment_method==="transfer"?"Transfer":"Check"),1),t[111]||(t[111]=d(". "))])):u("",!0)]),e("div",Ea,[(n(!0),i(S,null,C(k.value,(a,x)=>(n(),i("div",{key:x,class:"border border-gray-200 rounded-lg p-4"},[e("div",Va,[e("div",La,[e("h3",Na,o(a.outlet_name||"Global / All Outlets"),1),e("div",qa,[a.category_name?(n(),i("span",Ia," Category: "+o(a.category_name),1)):u("",!0),e("span",Da,"Subtotal: "+o(g(a.subtotal)),1)])])]),e("div",Fa,[e("div",null,[t[114]||(t[114]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Jumlah Pembayaran untuk Outlet Ini "),e("span",{class:"text-red-500"},"*")],-1)),T(e("input",{type:"number","onUpdate:modelValue":b=>_.value[x].amount=b,step:"0.01",min:0,required:"",class:"w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"0.00",onInput:ve},null,40,Ma),[[N,_.value[x].amount]]),e("p",Ua," Default: "+o(g(a.default_amount||a.subtotal)),1)]),e("div",za,[e("button",{type:"button",onClick:b=>qe(x,a.default_amount||a.subtotal),class:"px-4 py-2 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition"},t[115]||(t[115]=[e("i",{class:"fa fa-undo mr-1"},null,-1),d(" Reset ke Default ")]),8,Ga)])]),r.payment_method==="transfer"||r.payment_method==="check"?(n(),i("div",Ha,[t[122]||(t[122]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa fa-university mr-1"}),d(" Pilih Bank untuk Outlet Ini "),e("span",{class:"text-red-500"},"*")],-1)),ne(ie(K),{modelValue:_.value[x].selectedBank,"onUpdate:modelValue":b=>_.value[x].selectedBank=b,options:Se(_.value[x].outlet_id),searchable:!0,"close-on-select":!0,"show-labels":!1,placeholder:"Cari dan pilih bank untuk outlet ini...",label:"display_name","track-by":"id",onSelect:b=>ke(x,b),onRemove:()=>we(x),class:"w-full",required:""},{noOptions:X(()=>t[116]||(t[116]=[e("span",null,"Tidak ada bank ditemukan",-1)])),noResult:X(()=>t[117]||(t[117]=[e("span",null,"Tidak ada bank ditemukan",-1)])),_:2},1032,["modelValue","onUpdate:modelValue","options","onSelect","onRemove"]),e("p",Wa,[t[118]||(t[118]=d(" Pilih bank untuk metode pembayaran ")),e("strong",null,o(r.payment_method==="transfer"?"Transfer":"Check"),1),t[119]||(t[119]=d(" di outlet ini "))]),_.value[x].selectedBank?(n(),i("p",Ja,[t[120]||(t[120]=e("i",{class:"fa fa-check-circle mr-1"},null,-1)),t[121]||(t[121]=d(" Bank terpilih: ")),e("strong",null,o(_.value[x].selectedBank.display_name),1)])):u("",!0)])):u("",!0)]))),128))]),e("div",Qa,[e("div",Ya,[t[123]||(t[123]=e("span",{class:"text-sm font-medium text-gray-700"},"Total Pembayaran Semua Outlet:",-1)),e("span",Xa,o(g(se.value)),1)]),t[124]||(t[124]=e("p",{class:"text-xs text-gray-600 mt-2"},[e("i",{class:"fa fa-info-circle mr-1"}),d(" Total ini akan otomatis terisi ke field Amount di atas. Anda juga bisa mengubah Amount secara manual. ")],-1))])])):u("",!0),e("div",Za,[e("button",{type:"button",onClick:Te,class:"bg-gray-500 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," Kembali ke Pilih PO "),e("button",{type:"button",onClick:Ge,disabled:I.value,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold disabled:opacity-50"},t[126]||(t[126]=[e("i",{class:"fa fa-eye mr-2"},null,-1),d(" Preview & Simpan ")]),8,Ka)])])):u("",!0)]),re.value?(n(),i("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",onClick:Ce},[e("div",{class:"relative max-w-4xl max-h-full p-4",onClick:t[16]||(t[16]=q(()=>{},["stop"]))},[e("button",{onClick:Ce,class:"absolute top-2 right-2 text-white text-2xl hover:text-gray-300 z-10"},t[127]||(t[127]=[e("i",{class:"fa fa-times"},null,-1)])),e("img",{src:(V=W.value)==null?void 0:V.path,alt:(Ae=W.value)==null?void 0:Ae.name,class:"max-w-full max-h-full object-contain rounded-lg"},null,8,en),e("div",tn,[e("p",sn,o((Re=W.value)==null?void 0:Re.name),1)])])])):u("",!0),D.value?(n(),i("div",ln,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:t[17]||(t[17]=a=>D.value=!1),style:{"z-index":"1"}}),e("div",an,[e("div",{class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full relative",onClick:t[20]||(t[20]=q(()=>{},["stop"]))},[e("div",nn,[t[129]||(t[129]=e("h3",{class:"text-lg font-semibold text-white"},[e("i",{class:"fa fa-eye mr-2"}),d(" Preview Data Non Food Payment ")],-1)),e("button",{onClick:t[18]||(t[18]=a=>D.value=!1),class:"text-white hover:text-gray-200 focus:outline-none"},t[128]||(t[128]=[e("i",{class:"fa fa-times text-xl"},null,-1)]))]),e("div",on,[e("div",rn,[e("div",un,[e("h4",dn,[t[130]||(t[130]=e("i",{class:"fa fa-file-invoice mr-2"},null,-1)),d(" "+o(l.value?"Purchase Order":"Purchase Requisition"),1)]),e("div",mn,[e("div",null,[e("span",cn,o(l.value?"PO Number":"PR Number")+":",1),e("span",pn,o(l.value?l.value.number:f.value.pr_number),1)]),l.value?(n(),i("div",fn,[t[131]||(t[131]=e("span",{class:"font-medium text-gray-700"},"Supplier:",-1)),e("span",bn,o(l.value.supplier_name),1)])):u("",!0),e("div",null,[e("span",gn,o(l.value?"PO Date":"PR Date")+":",1),e("span",_n,o(G(l.value?l.value.date:f.value.date)),1)]),e("div",null,[t[132]||(t[132]=e("span",{class:"font-medium text-gray-700"},"Grand Total:",-1)),e("span",yn,o(g(l.value?((je=l.value.po_discount_info)==null?void 0:je.grand_total)||l.value.grand_total:f.value.amount)),1)])])]),e("div",xn,[t[142]||(t[142]=e("h4",{class:"font-semibold text-green-800 mb-3"},[e("i",{class:"fa fa-credit-card mr-2"}),d(" Informasi Pembayaran ")],-1)),e("div",vn,[e("div",null,[t[133]||(t[133]=e("span",{class:"font-medium text-gray-700"},"Supplier:",-1)),e("span",hn,o(O.value?O.value.name:l.value?l.value.supplier_name:"-"),1)]),e("div",null,[t[134]||(t[134]=e("span",{class:"font-medium text-gray-700"},"Amount:",-1)),e("span",kn,o(g(r.amount)),1)]),e("div",null,[t[135]||(t[135]=e("span",{class:"font-medium text-gray-700"},"Payment Method:",-1)),e("span",wn,o(r.payment_method||"-"),1)]),R.value?(n(),i("div",Pn,[t[136]||(t[136]=e("span",{class:"font-medium text-gray-700"},"COA:",-1)),e("span",On,o(R.value.display_name),1)])):u("",!0),e("div",null,[t[137]||(t[137]=e("span",{class:"font-medium text-gray-700"},"Payment Date:",-1)),e("span",Sn,o(G(r.payment_date)),1)]),r.due_date?(n(),i("div",Cn,[t[138]||(t[138]=e("span",{class:"font-medium text-gray-700"},"Due Date:",-1)),e("span",Tn,o(G(r.due_date)),1)])):u("",!0),r.reference_number?(n(),i("div",An,[t[139]||(t[139]=e("span",{class:"font-medium text-gray-700"},"Reference Number:",-1)),e("span",Rn,o(r.reference_number),1)])):u("",!0),r.description?(n(),i("div",jn,[t[140]||(t[140]=e("span",{class:"font-medium text-gray-700"},"Description:",-1)),e("p",Bn,o(r.description),1)])):u("",!0),r.notes?(n(),i("div",$n,[t[141]||(t[141]=e("span",{class:"font-medium text-gray-700"},"Notes:",-1)),e("p",En,o(r.notes),1)])):u("",!0)])]),Object.keys(_.value).length>0?(n(),i("div",Vn,[t[146]||(t[146]=e("h4",{class:"font-semibold text-purple-800 mb-3"},[e("i",{class:"fa fa-store mr-2"}),d(" Pembayaran Per Outlet ")],-1)),e("div",Ln,[(n(!0),i(S,null,C(k.value,(a,x)=>{var b,ae;return n(),i("div",{key:x,class:"bg-white border border-purple-200 rounded-lg p-3"},[e("div",Nn,[e("div",null,[e("h5",qn,o(a.outlet_name||"Global / All Outlets"),1),e("div",In,[a.category_name?(n(),i("span",Dn,o(a.category_name),1)):u("",!0),e("span",null,"Subtotal: "+o(g(a.subtotal)),1)])]),e("div",Fn,[e("div",Mn,o(g(((b=_.value[x])==null?void 0:b.amount)||0)),1),t[143]||(t[143]=e("div",{class:"text-xs text-gray-500"},"Amount",-1))])]),(r.payment_method==="transfer"||r.payment_method==="check")&&((ae=_.value[x])!=null&&ae.selectedBank)?(n(),i("div",Un,[t[144]||(t[144]=e("span",{class:"text-xs font-medium text-gray-700"},"Bank:",-1)),e("span",zn,o(_.value[x].selectedBank.display_name),1)])):u("",!0)])}),128)),e("div",Gn,[e("div",Hn,[t[145]||(t[145]=e("span",{class:"font-semibold text-gray-700"},"Total Pembayaran Semua Outlet:",-1)),e("span",Wn,o(g(se.value)),1)])])])])):u("",!0),t[147]||(t[147]=e("div",{class:"bg-amber-50 border-l-4 border-amber-500 p-4 rounded"},[e("h4",{class:"font-semibold text-amber-800 mb-2"},[e("i",{class:"fa fa-exclamation-triangle mr-2"}),d(" Konfirmasi ")]),e("p",{class:"text-sm text-amber-700"}," Pastikan semua data di atas sudah benar sebelum menyimpan. Setelah disimpan, data tidak dapat diubah. ")],-1))])]),e("div",Jn,[e("button",{onClick:t[19]||(t[19]=q(a=>D.value=!1,["stop"])),class:"px-6 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"},t[148]||(t[148]=[e("i",{class:"fa fa-times mr-2"},null,-1),d(" Batal ")])),e("button",{onClick:q(He,["stop"]),disabled:I.value,class:"px-6 py-2 bg-gradient-to-r from-green-500 to-green-700 text-white rounded-md hover:from-green-600 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed"},[I.value?(n(),i("i",Yn)):(n(),i("i",Xn)),d(" "+o(I.value?"Menyimpan...":"Konfirmasi & Simpan"),1)],8,Qn)])])])])):u("",!0),E.value?(n(),i("div",{key:2,class:"fixed inset-0 z-50 overflow-y-auto",onClick:t[24]||(t[24]=q(a=>E.value=!1,["self"]))},[e("div",Zn,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t[21]||(t[21]=a=>E.value=!1)}),e("div",Kn,[e("div",ei,[t[150]||(t[150]=e("h3",{class:"text-lg font-semibold text-white"},[e("i",{class:"fa fa-graduation-cap mr-2"}),d(" Tutorial: Payment Type & Pembayaran Termin ")],-1)),e("button",{onClick:t[22]||(t[22]=a=>E.value=!1),class:"text-white hover:text-gray-200 focus:outline-none"},t[149]||(t[149]=[e("i",{class:"fa fa-times text-xl"},null,-1)]))]),t[151]||(t[151]=e("div",{class:"px-6 py-6 max-h-[70vh] overflow-y-auto"},[e("div",{class:"space-y-6"},[e("div",{class:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded"},[e("h4",{class:"font-semibold text-blue-800 mb-2"},[e("i",{class:"fa fa-info-circle mr-2"}),d(" Payment Type di Purchase Order ")]),e("p",{class:"text-sm text-blue-700"},[d(" Setiap PO memiliki "),e("strong",null,"Payment Type"),d(" yang ditentukan saat membuat PO di menu Purchase Order Ops. Ada dua jenis: "),e("strong",null,"Bayar Lunas"),d(" (pembayaran penuh sekaligus) dan "),e("strong",null,"Termin Bayar"),d(" (pembayaran bertahap). Payment type ini akan mempengaruhi cara pembayaran di menu Non Food Payment. ")])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold"},[e("i",{class:"fa fa-info-circle text-sm"})]),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Perbedaan Payment Type"),e("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-2"},[e("div",{class:"bg-green-50 p-3 rounded border border-green-200"},[e("p",{class:"text-xs font-semibold text-green-800 mb-1"},[e("i",{class:"fa fa-check-circle mr-1"}),d(" Bayar Lunas: ")]),e("ul",{class:"text-xs text-gray-700 space-y-1 list-disc list-inside"},[e("li",null,"Pembayaran penuh sekaligus"),e("li",null,"Hanya bisa 1x payment"),e("li",null,"Amount harus = Grand Total PO"),e("li",null,"Tidak bisa buat payment baru jika sudah ada payment")])]),e("div",{class:"bg-blue-50 p-3 rounded border border-blue-200"},[e("p",{class:"text-xs font-semibold text-blue-800 mb-1"},[e("i",{class:"fa fa-calendar-alt mr-1"}),d(" Termin Bayar: ")]),e("ul",{class:"text-xs text-gray-700 space-y-1 list-disc list-inside"},[e("li",null,"Pembayaran bertahap"),e("li",null,"Bisa multiple payments"),e("li",null,"Amount bisa  Sisa Pembayaran"),e("li",null,"Bisa buat payment baru sampai lunas")])])])])])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold"}," 1 "),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Pilih PO dan Lihat Payment Type"),e("ul",{class:"text-sm text-gray-700 space-y-1 list-disc list-inside"},[e("li",null,"Di form Create Payment, pilih PO yang sudah di-approve"),e("li",null,[d('Di section "Detail Purchase Order", akan muncul informasi '),e("strong",null,"Metode Pembayaran")]),e("li",null,[d("PO dengan payment_type = 'lunas' akan menampilkan badge "),e("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},"Bayar Lunas")]),e("li",null,[d("PO dengan payment_type = 'termin' akan menampilkan badge "),e("span",{class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},"Termin Bayar")]),e("li",null,"Jika termin, akan muncul detail termin yang diinput saat create PO")])])])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold"}," 2 "),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Lihat Informasi Pembayaran Termin"),e("p",{class:"text-sm text-gray-700 mb-2"}," Setelah memilih PO dengan termin, akan muncul box informasi: "),e("div",{class:"bg-gray-50 p-3 rounded border border-gray-200"},[e("ul",{class:"text-xs text-gray-700 space-y-1"},[e("li",null,[e("strong",null,"Total PO:"),d(" Grand total dari PO")]),e("li",null,[e("strong",null,"Sudah Dibayar:"),d(" Total semua payment yang sudah dibuat (approved/paid)")]),e("li",null,[e("strong",null,"Sisa Pembayaran:"),d(" Total PO - Sudah Dibayar")]),e("li",null,[e("strong",null,"Progress Bar:"),d(" Visual progress pembayaran (persentase)")]),e("li",null,[e("strong",null,"Detail Termin:"),d(' Catatan termin dari PO (contoh: "50% di muka, 50% setelah barang diterima")')])])])])])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold"}," 3 "),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Input Amount Pembayaran"),e("p",{class:"text-sm text-gray-700 mb-2"},[d(" Field Amount akan otomatis terisi dengan "),e("strong",null,"Sisa Pembayaran"),d(". Anda punya 2 opsi: ")]),e("div",{class:"space-y-2"},[e("div",{class:"bg-green-50 border-l-4 border-green-500 p-3 rounded"},[e("p",{class:"text-xs font-medium text-green-800 mb-1"},[e("i",{class:"fa fa-check-circle mr-1"}),d(" Opsi A: Bayar Sisa Penuh (Lunas) ")]),e("ul",{class:"text-xs text-green-700 space-y-1 list-disc list-inside ml-4"},[e("li",null,"Biarkan amount = Sisa Pembayaran"),e("li",null,[d("Atau klik tombol "),e("strong",null,"Reset"),d(" untuk set ke sisa")]),e("li",null,[d("Setelah payment ini, PO akan "),e("strong",null,"LUNAS"),d(" ")])])]),e("div",{class:"bg-blue-50 border-l-4 border-blue-500 p-3 rounded"},[e("p",{class:"text-xs font-medium text-blue-800 mb-1"},[e("i",{class:"fa fa-calendar-alt mr-1"}),d(" Opsi B: Bayar Sebagian (Partial) ")]),e("ul",{class:"text-xs text-blue-700 space-y-1 list-disc list-inside ml-4"},[e("li",null,"Ubah amount menjadi lebih kecil dari sisa"),e("li",null,"Contoh: Sisa Rp 5.000.000  Input Rp 3.000.000"),e("li",null,"Masih ada sisa, bisa buat payment lagi nanti")])])]),e("div",{class:"bg-amber-50 border-l-4 border-amber-500 p-3 rounded mt-2"},[e("p",{class:"text-xs text-amber-800"},[e("i",{class:"fa fa-exclamation-triangle mr-1"}),e("strong",null,"Validasi:"),d(" Amount tidak boleh melebihi Sisa Pembayaran. Sistem akan menolak jika amount > sisa. ")])])])])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold"}," 4 "),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Cara Membayar Sisa Termin (Payment Berikutnya)"),e("p",{class:"text-sm text-gray-700 mb-2"}," Jika sudah ada payment sebelumnya dan masih ada sisa: "),e("ol",{class:"text-sm text-gray-700 space-y-2 list-decimal list-inside"},[e("li",null,[d("Buka menu "),e("strong",null,"Non Food Payment  Create")]),e("li",null,[d("Pilih "),e("strong",null,"PO yang sama"),d(" (yang sudah punya payment sebelumnya)")]),e("li",null,[d("Lihat info: "),e("strong",null,"Sisa Pembayaran"),d(" akan otomatis ter-update")]),e("li",null,"Input amount untuk pembayaran berikutnya ( Sisa Pembayaran)"),e("li",null,"Submit dan approve payment"),e("li",null,"Ulangi sampai PO lunas (Sisa = 0)")]),e("div",{class:"bg-purple-50 border-l-4 border-purple-500 p-3 rounded mt-2"},[e("p",{class:"text-xs text-purple-800"},[e("i",{class:"fa fa-info-circle mr-1"}),e("strong",null,"Catatan:"),d(" Setiap payment akan punya sequence number (#1, #2, #3, dst) dan bisa dilihat di Show page. ")])])])])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center font-bold"}," 5 "),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Perbedaan: PO Lunas vs PO Termin"),e("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-2"},[e("div",{class:"bg-green-50 p-3 rounded border border-green-200"},[e("p",{class:"text-xs font-semibold text-green-800 mb-1"},"PO dengan Bayar Lunas:"),e("ul",{class:"text-xs text-green-700 space-y-1 list-disc list-inside"},[e("li",null,"Hanya 1x payment"),e("li",null,"Amount = Grand Total PO"),e("li",null,"Tidak ada info box termin"),e("li",null,"Tidak bisa buat payment baru jika sudah ada payment")])]),e("div",{class:"bg-blue-50 p-3 rounded border border-blue-200"},[e("p",{class:"text-xs font-semibold text-blue-800 mb-1"},"PO dengan Termin Bayar:"),e("ul",{class:"text-xs text-blue-700 space-y-1 list-disc list-inside"},[e("li",null,"Multiple payments"),e("li",null,"Amount  Sisa Pembayaran"),e("li",null,"Ada info box dengan progress"),e("li",null,"Bisa buat payment baru sampai lunas")])])])])])]),e("div",{class:"bg-amber-50 border-l-4 border-amber-500 p-4 rounded"},[e("h4",{class:"font-semibold text-amber-800 mb-2"},[e("i",{class:"fa fa-lightbulb mr-2"}),d(" Tips Penting ")]),e("ul",{class:"text-sm text-amber-700 space-y-1 list-disc list-inside"},[e("li",null,[d("Selalu cek "),e("strong",null,"Sisa Pembayaran"),d(" sebelum input amount")]),e("li",null,[d("Gunakan field "),e("strong",null,"Description"),d(' untuk tracking (contoh: "Pembayaran termin pertama (50% di muka)")')]),e("li",null,"Cek progress di Show page setelah approve payment"),e("li",null,"Sistem otomatis mencegah overpayment (amount > sisa)"),e("li",null,"PO yang sudah lunas tidak akan muncul di list Available PO")])])])],-1)),e("div",ti,[e("button",{onClick:t[23]||(t[23]=a=>E.value=!1),class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Tutup ")])])])])):u("",!0)]}),_:1}))}}),gi=tt(li,[["__scopeId","data-v-50cf8889"]]);export{gi as default};
