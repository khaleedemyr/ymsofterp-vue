import{r as k,c as z,A as K,B as n,C as F,D as t,L as o,E as i,G as f,x as Y,Q as q,S as H,N as l,l as y,F as w,M as j,H as Q,I as U,W as A}from"./vendor-vue-g7iCcTkf.js";import{A as $}from"./AppLayout-C22rYVZx.js";import{S as d}from"./app-CQcWanFv.js";import{a as X}from"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DO0UW4jb.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const Z={class:"w-full py-8 px-0"},tt={class:"flex justify-between items-center mb-6"},et={class:"flex gap-2"},st={class:"bg-white rounded-2xl shadow-2xl p-6 mb-6"},at={class:"grid grid-cols-2 gap-6"},rt={class:"space-y-3"},lt={class:"mt-1 font-mono font-semibold text-blue-700"},nt={class:"mt-1"},ot={class:"mt-1"},it={class:"mt-1"},dt={key:0},ut={class:"mt-1"},ft={key:1},mt={class:"mt-1"},pt={key:2},xt={class:"mt-1"},ct={class:"space-y-3"},bt={class:"mt-1"},gt={class:"mt-1"},vt={class:"mt-1"},yt={class:"mt-1"},ht={class:"mt-1"},kt={key:0,class:"bg-white rounded-2xl shadow-2xl p-6 mb-6"},wt={class:"space-y-3"},jt={class:"flex-1"},At={class:"font-semibold"},Ct={class:"text-sm text-gray-600"},Tt={class:"flex-shrink-0"},Dt={key:0,class:"flex-shrink-0 text-sm text-gray-600"},Et={key:1,class:"flex-shrink-0 text-xs text-gray-500"},Bt={key:2,class:"flex-shrink-0 text-xs text-gray-500"},St={key:0,class:"mt-4 text-sm text-gray-600"},_t={class:"font-semibold"},Ot={class:"bg-white rounded-2xl shadow-2xl overflow-hidden"},Nt={class:"overflow-x-auto"},Pt={class:"w-full min-w-full divide-y divide-gray-200"},Ft={class:"bg-white divide-y divide-gray-200"},Mt={class:"px-6 py-4"},Rt={class:"font-medium text-gray-900"},Vt={class:"text-sm text-gray-500"},It={class:"px-6 py-4"},Jt={class:"px-6 py-4"},Gt={class:"px-6 py-4"},Lt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"},Wt={class:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6"},zt={class:"mb-4"},Kt=["value"],Yt={class:"flex justify-end gap-3"},qt=["disabled"],Ht={key:0,class:"fa fa-spinner fa-spin mr-2"},le={__name:"Show",props:{transfer:Object,outlets:Object,user:Object,canApprove:Boolean,pendingFlow:Object,users:Array},setup(a){const x=a,h=k(!1),m=k([]),g=k(!1);function v(r){return r?new Date(r).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"}function C(r){var e;return!r||!x.outlets?"-":((e=x.outlets[r])==null?void 0:e.nama_outlet)||"-"}function M(r){return{draft:"Draft",submitted:"Menunggu Approval",approved:"Disetujui",rejected:"Ditolak"}[r]||r}function R(r){return{draft:"bg-gray-100 text-gray-800",submitted:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[r]||"bg-gray-100 text-gray-800"}const T=z(()=>!!x.canApprove);function V(){m.value=[],h.value=!0}function D(){h.value=!1,m.value=[]}async function I(){if(!m.value||m.value.length===0){d.fire("Error!","Pilih minimal 1 approver.","error");return}g.value=!0;try{await X.post(route("outlet-transfer.submit",x.transfer.id),{approvers:m.value}),D(),d.fire("Berhasil!","Transfer berhasil di-submit untuk approval.","success"),A.reload({preserveScroll:!0})}catch{d.fire("Error!","Terjadi kesalahan saat submit transfer.","error")}finally{g.value=!1}}function E(r){const e=r==="reject";d.fire({title:e?"Reject Transfer?":"Approve Transfer?",text:e?"Transfer akan ditolak dan proses approval berhenti.":"Transfer akan di-approve. Jika ini approval terakhir, stock akan dipindahkan.",icon:e?"warning":"question",showCancelButton:!0,confirmButtonColor:e?"#d33":"#28a745",cancelButtonColor:"#6b7280",confirmButtonText:e?"Ya, Reject!":"Ya, Approve!",cancelButtonText:"Batal",input:"textarea",inputPlaceholder:e?"Alasan reject (wajib)":"Catatan approval (opsional)",inputAttributes:{"aria-label":"Catatan"},preConfirm:u=>(e&&(!u||!u.trim())&&d.showValidationMessage("Alasan reject wajib diisi."),u||"")}).then(u=>{u.isConfirmed&&A.post(route("outlet-transfer.approve",x.transfer.id),{action:r,comments:u.value||""},{preserveScroll:!0,onSuccess:()=>{d.fire("Berhasil!",e?"Transfer telah di-reject.":"Approval berhasil diproses.","success")},onError:()=>{d.fire("Error!","Terjadi kesalahan saat proses approval.","error")}})})}function J(r){return r.status==="APPROVED"?"bg-green-50 border-green-200":r.status==="REJECTED"?"bg-red-50 border-red-200":r.status==="PENDING"?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"}function G(r){return r.status==="APPROVED"?"bg-green-500 text-white":r.status==="REJECTED"?"bg-red-500 text-white":r.status==="PENDING"?"bg-yellow-500 text-white":"bg-gray-500 text-white"}function L(r){return r==="APPROVED"?"bg-green-200 text-green-800":r==="REJECTED"?"bg-red-200 text-red-800":"bg-yellow-200 text-yellow-800"}function W(){d.fire({title:"Apakah Anda yakin?",text:"Data yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(r=>{r.isConfirmed&&A.delete(route("outlet-transfer.destroy",x.transfer.id),{onSuccess:()=>{d.fire("Terhapus!","Data berhasil dihapus.","success")},onError:()=>{d.fire("Error!","Terjadi kesalahan saat menghapus data.","error")}})})}return(r,e)=>(n(),K($,null,{default:F(()=>{var u,B,S,_,O,N,P;return[t("div",Z,[t("div",tt,[e[8]||(e[8]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-right-left"}),f(" Detail Pindah Outlet ")],-1)),t("div",et,[Y(q(H),{href:r.route("outlet-transfer.index"),class:"bg-gray-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},{default:F(()=>e[3]||(e[3]=[t("i",{class:"fa fa-arrow-left mr-2"},null,-1),f(" Kembali ")])),_:1},8,["href"]),a.transfer.status==="draft"?(n(),o("button",{key:0,onClick:V,class:"bg-green-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},e[4]||(e[4]=[t("i",{class:"fa fa-paper-plane mr-2"},null,-1),f(" Submit ")]))):i("",!0),a.transfer.status==="submitted"&&T.value?(n(),o("button",{key:1,onClick:e[0]||(e[0]=s=>E("approve")),class:"bg-yellow-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},e[5]||(e[5]=[t("i",{class:"fa fa-check mr-2"},null,-1),f(" Approve ")]))):i("",!0),a.transfer.status==="submitted"&&T.value?(n(),o("button",{key:2,onClick:e[1]||(e[1]=s=>E("reject")),class:"bg-red-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},e[6]||(e[6]=[t("i",{class:"fa fa-times mr-2"},null,-1),f(" Reject ")]))):i("",!0),a.transfer.status==="draft"?(n(),o("button",{key:3,onClick:W,class:"bg-red-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},e[7]||(e[7]=[t("i",{class:"fa fa-trash mr-2"},null,-1),f(" Hapus ")]))):i("",!0)])]),t("div",st,[t("div",at,[t("div",null,[e[16]||(e[16]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Informasi Transfer",-1)),t("div",rt,[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-600"},"Nomor Transfer",-1)),t("div",lt,l(a.transfer.transfer_number),1)]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-600"},"Tanggal Transfer",-1)),t("div",nt,l(v(a.transfer.transfer_date)),1)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-600"},"Status",-1)),t("div",ot,[t("span",{class:y(["px-2 py-1 text-xs font-semibold rounded-full",R(a.transfer.status)])},l(M(a.transfer.status)),3)])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-600"},"Dibuat Oleh",-1)),t("div",it,l((u=a.transfer.creator)==null?void 0:u.nama_lengkap),1)]),a.transfer.approver?(n(),o("div",dt,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-600"},"Disetujui Oleh",-1)),t("div",ut,l((B=a.transfer.approver)==null?void 0:B.nama_lengkap),1)])):i("",!0),a.transfer.approval_at?(n(),o("div",ft,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-600"},"Tanggal Approval",-1)),t("div",mt,l(v(a.transfer.approval_at)),1)])):i("",!0),a.transfer.approval_notes?(n(),o("div",pt,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-600"},"Catatan Approval",-1)),t("div",xt,l(a.transfer.approval_notes),1)])):i("",!0)])]),t("div",null,[e[22]||(e[22]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Informasi Gudang",-1)),t("div",ct,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-600"},"Outlet Asal",-1)),t("div",bt,l(C((S=a.transfer.warehouse_outlet_from)==null?void 0:S.outlet_id)),1)]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-600"},"Warehouse Outlet Asal",-1)),t("div",gt,l((_=a.transfer.warehouse_outlet_from)==null?void 0:_.name),1)]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-600"},"Outlet Tujuan",-1)),t("div",vt,l(C((O=a.transfer.warehouse_outlet_to)==null?void 0:O.outlet_id)),1)]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-600"},"Warehouse Outlet Tujuan",-1)),t("div",yt,l((N=a.transfer.warehouse_outlet_to)==null?void 0:N.name),1)]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-600"},"Keterangan",-1)),t("div",ht,l(a.transfer.notes||"-"),1)])])])])]),a.transfer.approval_flows&&a.transfer.approval_flows.length>0?(n(),o("div",kt,[e[25]||(e[25]=t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Approval Flow",-1)),t("div",wt,[(n(!0),o(w,null,j(a.transfer.approval_flows,s=>{var p,c,b;return n(),o("div",{key:s.id,class:y(["flex items-center gap-4 p-3 rounded-lg border",J(s)])},[t("div",{class:y(["flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center font-bold",G(s)])},l(s.approval_level),3),t("div",jt,[t("div",At,l(((p=s.approver)==null?void 0:p.nama_lengkap)||"-"),1),t("div",Ct,l(((b=(c=s.approver)==null?void 0:c.jabatan)==null?void 0:b.nama_jabatan)||"-"),1)]),t("div",Tt,[t("span",{class:y([L(s.status),"px-3 py-1 rounded-full text-xs font-semibold"])},l(s.status),3)]),s.comments?(n(),o("div",Dt,[e[23]||(e[23]=t("i",{class:"fa fa-comment mr-1"},null,-1)),f(" "+l(s.comments),1)])):i("",!0),s.approved_at?(n(),o("div",Et,l(v(s.approved_at)),1)):i("",!0),s.rejected_at?(n(),o("div",Bt,l(v(s.rejected_at)),1)):i("",!0)],2)}),128))]),a.pendingFlow?(n(),o("div",St,[e[24]||(e[24]=f(" Next approver: ")),t("span",_t,l(((P=a.pendingFlow.approver)==null?void 0:P.nama_lengkap)||a.pendingFlow.approver_id),1)])):i("",!0)])):i("",!0),t("div",Ot,[e[27]||(e[27]=t("div",{class:"p-6 border-b"},[t("h2",{class:"text-lg font-semibold text-gray-800"},"Detail Item")],-1)),t("div",Nt,[t("table",Pt,[e[26]||(e[26]=t("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Item"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Qty"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Unit"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Keterangan")])],-1)),t("tbody",Ft,[(n(!0),o(w,null,j(a.transfer.items,s=>{var p,c,b;return n(),o("tr",{key:s.id,class:"hover:bg-blue-50"},[t("td",Mt,[t("div",Rt,l((p=s.item)==null?void 0:p.name),1),t("div",Vt,l((c=s.item)==null?void 0:c.sku),1)]),t("td",It,l(s.quantity),1),t("td",Jt,l(((b=s.unit)==null?void 0:b.name)||"-"),1),t("td",Gt,l(s.note||"-"),1)])}),128))])])])])]),h.value?(n(),o("div",Lt,[t("div",Wt,[e[31]||(e[31]=t("h3",{class:"text-lg font-bold text-gray-800 mb-4"},"Submit untuk Approval",-1)),t("div",zt,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Pilih Approvers (berurutan dari terendah ke tertinggi)",-1)),Q(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>m.value=s),multiple:"",size:"8",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[(n(!0),o(w,null,j(a.users||[],s=>{var p;return n(),o("option",{key:s.id,value:s.id},l(s.nama_lengkap)+" - "+l(((p=s.jabatan)==null?void 0:p.nama_jabatan)||"-"),9,Kt)}),128))],512),[[U,m.value]]),e[29]||(e[29]=t("p",{class:"mt-2 text-xs text-gray-500"},"Approver level tertinggi akan eksekusi pindah stok saat approve terakhir. Jika ada reject, proses berhenti.",-1))]),t("div",Yt,[t("button",{onClick:D,class:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600"}," Batal "),t("button",{onClick:I,disabled:g.value||m.value.length===0,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50"},[g.value?(n(),o("i",Ht)):i("",!0),e[30]||(e[30]=f(" Submit "))],8,qt)])])])):i("",!0)]}),_:1}))}};export{le as default};
