import{k as M,r as y,$ as J,c as L,a as N,L as d,B as u,D as e,E as g,G as r,Q as U,H as f,I as w,F as c,M as x,R as Y,N as s,J as j,l as A}from"./vendor-vue-g7iCcTkf.js";import{A as K}from"./AppLayout-BdiuRSin.js";import{a as _}from"./vendor-utils-CpgP2uT4.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./app-xIQ7JztA.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-LiNpoaCg.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const $={class:"min-h-screen w-full bg-gray-50 p-0"},z={class:"w-full bg-white shadow-2xl rounded-2xl p-8"},G={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8 items-end"},H={key:0},X=["value"],Z=["value"],ee={key:0,class:"text-center py-10"},te={key:1},oe={class:"bg-blue-50 p-6 rounded-lg mb-6"},se={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},le={class:"text-lg"},ae={key:0,class:"flex items-center gap-2"},re={key:1,class:"text-lg font-semibold"},ne={class:"text-lg"},de={class:"mt-4 grid grid-cols-2 md:grid-cols-6 gap-4 text-sm"},ue={class:"text-xl font-bold mb-4 text-blue-800"},ie={class:"overflow-x-auto mb-4"},pe={class:"min-w-full rounded-2xl overflow-hidden shadow-lg"},me=["rowspan"],be={class:"px-3 py-3 text-center font-semibold text-gray-800 border-r border-gray-200"},ve={class:"px-3 py-3 text-center font-semibold text-gray-800 border-r border-gray-200"},ye={key:0,class:"text-xs text-red-600 font-normal mt-1"},ge={class:"px-3 py-3 text-right border-r border-gray-200"},fe={class:"px-3 py-3 text-center border-r border-gray-200"},ce={class:"px-3 py-3 text-right"},xe={class:"bg-gray-50 p-4 rounded-lg"},_e={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},ke={class:"bg-[#1e3a8a] text-white p-6 rounded-lg"},we={class:"grid grid-cols-2 md:grid-cols-3 gap-4"},he=Object.assign({layout:K},{__name:"ReportWeeklyOutletFbRevenue",setup(De){var W;const a=M({outlet:"",month:"",year:""}),h=y([]),l=M({weekly_data:{},weekly_summaries:{},monthly_summary:{},monthly_budget:null,mtd_performance:0,day_counts:{},outlet_name:""}),k=y(!1),D=y(!1),v=((W=J().props.auth)==null?void 0:W.user)||{},b=y(""),R=new Date().getFullYear(),E=L(()=>{const o=[];for(let t=R;t>=R-5;t--)o.push(t);return o}),O=async()=>{const o=await _.get("/api/outlets/report");h.value=o.data.outlets||[]},T=async()=>{const o=await _.get("/api/my-outlet-qr");o.data.qr_code&&(a.outlet=o.data.qr_code)},B=async()=>{if(!a.month||!a.year){alert("Pilih bulan dan tahun terlebih dahulu");return}if(v.id_outlet==1&&!a.outlet){alert("Pilih outlet terlebih dahulu");return}k.value=!0;try{const o={month:a.month,year:a.year,...v.id_outlet==1&&{outlet:a.outlet}},t=await _.get("/api/report/weekly-outlet-fb-revenue",{params:o});Object.assign(l,t.data),D.value=!0}catch(o){console.error("Error fetching report:",o),alert("Terjadi kesalahan saat mengambil data report")}finally{k.value=!1}},S=async()=>{if(!b.value||b.value<=0){alert("Masukkan budget yang valid");return}try{await _.post("/api/report/weekly-outlet-fb-revenue/budget",{outlet:a.outlet,month:a.month,year:a.year,budget_amount:b.value}),await B(),b.value=""}catch(o){console.error("Error saving budget:",o),alert("Terjadi kesalahan saat menyimpan budget")}},V=o=>new Date(o).getDate(),F=o=>typeof o!="number"?"0":o.toLocaleString("id-ID"),i=o=>typeof o!="number"?"Rp 0":`Rp ${o.toLocaleString("id-ID")}`,C=o=>["","Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"][parseInt(o)]||"",P=o=>o.is_holiday?"bg-red-100 hover:bg-red-200":o.is_weekend?"bg-orange-100 hover:bg-orange-200":"bg-white hover:bg-blue-50",q=o=>o>=100?"text-green-600":o>=80?"text-yellow-600":"text-red-600";return N(async()=>{const o=new Date;a.month=(o.getMonth()+1).toString(),a.year=o.getFullYear().toString(),v.id_outlet==1?await O():await T()}),(o,t)=>(u(),d("div",$,[e("div",z,[t[35]||(t[35]=e("h1",{class:"text-2xl font-bold mb-6 text-blue-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-chart-line"}),r(" Weekly Outlet FB Revenue Report ")],-1)),e("div",G,[U(v).id_outlet==1?(u(),d("div",H,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium mb-1"},"Outlet",-1)),f(e("select",{"onUpdate:modelValue":t[0]||(t[0]=n=>a.outlet=n),class:"block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 px-3 py-2",required:""},[t[4]||(t[4]=e("option",{value:""},"Pilih Outlet",-1)),(u(!0),d(c,null,x(h.value,n=>(u(),d("option",{key:n.id,value:n.qr_code},s(n.name),9,X))),128))],512),[[w,a.outlet]])])):g("",!0),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium mb-1"},"Bulan",-1)),f(e("select",{"onUpdate:modelValue":t[1]||(t[1]=n=>a.month=n),class:"block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 px-3 py-2",required:""},t[6]||(t[6]=[Y('<option value="" data-v-6a55a1d4>Pilih Bulan</option><option value="1" data-v-6a55a1d4>Januari</option><option value="2" data-v-6a55a1d4>Februari</option><option value="3" data-v-6a55a1d4>Maret</option><option value="4" data-v-6a55a1d4>April</option><option value="5" data-v-6a55a1d4>Mei</option><option value="6" data-v-6a55a1d4>Juni</option><option value="7" data-v-6a55a1d4>Juli</option><option value="8" data-v-6a55a1d4>Agustus</option><option value="9" data-v-6a55a1d4>September</option><option value="10" data-v-6a55a1d4>Oktober</option><option value="11" data-v-6a55a1d4>November</option><option value="12" data-v-6a55a1d4>Desember</option>',13)]),512),[[w,a.month]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium mb-1"},"Tahun",-1)),f(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>a.year=n),class:"block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500 px-3 py-2",required:""},[t[8]||(t[8]=e("option",{value:""},"Pilih Tahun",-1)),(u(!0),d(c,null,x(E.value,n=>(u(),d("option",{key:n,value:n},s(n),9,Z))),128))],512),[[w,a.year]])]),e("div",{class:"flex items-end h-full"},[e("button",{onClick:B,class:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition"},"Tampilkan")])]),k.value?(u(),d("div",ee,t[10]||(t[10]=[e("span",{class:"text-gray-500"},"Loading...",-1)]))):D.value?(u(),d("div",te,[e("div",oe,[e("div",se,[e("div",null,[t[11]||(t[11]=e("h3",{class:"font-bold text-blue-800 mb-2"},"Outlet",-1)),e("p",le,s(l.outlet_name),1)]),e("div",null,[t[12]||(t[12]=e("h3",{class:"font-bold text-blue-800 mb-2"},"Monthly Budget",-1)),l.monthly_budget===null||l.monthly_budget===void 0?(u(),d("div",ae,[f(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>b.value=n),type:"number",placeholder:"Input budget bulanan",class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[j,b.value]]),e("button",{onClick:S,class:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition"}," Simpan ")])):(u(),d("p",re,s(i(l.monthly_budget)),1))]),e("div",null,[t[13]||(t[13]=e("h3",{class:"font-bold text-blue-800 mb-2"},"MTD Performance",-1)),e("p",{class:A(["text-lg font-semibold",q(l.mtd_performance)])},s(l.mtd_performance)+"% ",3)]),e("div",null,[t[14]||(t[14]=e("h3",{class:"font-bold text-blue-800 mb-2"},"Periode",-1)),e("p",ne,s(C(a.month))+" "+s(a.year),1)])]),e("div",de,[e("div",null,[t[15]||(t[15]=e("span",{class:"font-semibold"},"No. of Days:",-1)),r(" "+s(l.day_counts.total_days),1)]),e("div",null,[t[16]||(t[16]=e("span",{class:"font-semibold"},"No. of Weekdays:",-1)),r(" "+s(l.day_counts.weekdays),1)]),e("div",null,[t[17]||(t[17]=e("span",{class:"font-semibold"},"No. of Weekends:",-1)),r(" "+s(l.day_counts.weekends),1)]),e("div",null,[t[18]||(t[18]=e("span",{class:"font-semibold"},"Day to Date:",-1)),r(" "+s(l.day_counts.days_to_date),1)]),e("div",null,[t[19]||(t[19]=e("span",{class:"font-semibold"},"Weekdays to Date:",-1)),r(" "+s(l.day_counts.weekdays_to_date),1)]),e("div",null,[t[20]||(t[20]=e("span",{class:"font-semibold"},"Weekends to Date:",-1)),r(" "+s(l.day_counts.weekends_to_date),1)])])]),(u(!0),d(c,null,x(l.weekly_data,(n,m)=>(u(),d("div",{key:m,class:"mb-8"},[e("h3",ue,"WEEK "+s(m),1),e("div",ie,[e("table",pe,[t[21]||(t[21]=e("thead",null,[e("tr",{class:"bg-[#2563eb] text-white font-bold text-sm"},[e("th",{class:"px-3 py-3 text-center border-r border-blue-400",rowspan:"2"},"WEEK"),e("th",{class:"px-3 py-3 text-center border-r border-blue-400"},"DATE"),e("th",{class:"px-3 py-3 text-center border-r border-blue-400"},"DAY"),e("th",{class:"px-3 py-3 text-center border-r border-blue-400"},"FB REVENUE"),e("th",{class:"px-3 py-3 text-center border-r border-blue-400"},"COVER"),e("th",{class:"px-3 py-3 text-center"},"A/C")])],-1)),e("tbody",null,[(u(!0),d(c,null,x(n,(p,I)=>(u(),d("tr",{key:p.date,class:A([P(p),"border-b last:border-b-0"])},[I===0?(u(),d("td",{key:0,rowspan:n.length,class:"px-3 py-3 text-center font-semibold text-gray-800 border-r border-gray-200 align-middle"},s(p.week),9,me)):g("",!0),e("td",be,s(V(p.date)),1),e("td",ve,[r(s(p.day)+" ",1),p.holiday_description?(u(),d("div",ye,s(p.holiday_description),1)):g("",!0)]),e("td",ge,s(F(p.revenue)),1),e("td",fe,s(p.cover),1),e("td",ce,s(F(p.avg_check)),1)],2))),128))])])]),e("div",xe,[e("div",_e,[e("div",null,[t[22]||(t[22]=e("span",{class:"font-semibold"},"Total FB Revenue:",-1)),r(" "+s(i(l.weekly_summaries[m].total_revenue)),1)]),e("div",null,[t[23]||(t[23]=e("span",{class:"font-semibold"},"Average FB Revenue per Day:",-1)),r(" "+s(i(l.weekly_summaries[m].avg_revenue_per_day)),1)]),e("div",null,[t[24]||(t[24]=e("span",{class:"font-semibold"},"Weekdays FB Revenue:",-1)),r(" "+s(i(l.weekly_summaries[m].weekdays_revenue)),1)]),e("div",null,[t[25]||(t[25]=e("span",{class:"font-semibold"},"Average FB Revenue per Day (Weekdays):",-1)),r(" "+s(i(l.weekly_summaries[m].avg_weekdays_revenue)),1)]),e("div",null,[t[26]||(t[26]=e("span",{class:"font-semibold"},"Weekends FB Revenue:",-1)),r(" "+s(i(l.weekly_summaries[m].weekends_revenue)),1)]),e("div",null,[t[27]||(t[27]=e("span",{class:"font-semibold"},"Average FB Revenue per Day (Weekends):",-1)),r(" "+s(i(l.weekly_summaries[m].avg_weekends_revenue)),1)])])])]))),128)),e("div",ke,[t[34]||(t[34]=e("h3",{class:"text-xl font-bold mb-4"},"MTD Summary",-1)),e("div",we,[e("div",null,[t[28]||(t[28]=e("span",{class:"font-semibold"},"Total MTD FB Revenue:",-1)),r(" "+s(i(l.monthly_summary.total_revenue)),1)]),e("div",null,[t[29]||(t[29]=e("span",{class:"font-semibold"},"Average FB Revenue / Day:",-1)),r(" "+s(i(l.monthly_summary.total_revenue/l.day_counts.days_to_date||0)),1)]),e("div",null,[t[30]||(t[30]=e("span",{class:"font-semibold"},"Weekdays FB Revenue:",-1)),r(" "+s(i(l.monthly_summary.weekdays_revenue)),1)]),e("div",null,[t[31]||(t[31]=e("span",{class:"font-semibold"},"Average FB Revenue / Day (Weekdays):",-1)),r(" "+s(i(l.monthly_summary.weekdays_revenue/l.day_counts.weekdays_to_date||0)),1)]),e("div",null,[t[32]||(t[32]=e("span",{class:"font-semibold"},"Weekends FB Revenue:",-1)),r(" "+s(i(l.monthly_summary.weekends_revenue)),1)]),e("div",null,[t[33]||(t[33]=e("span",{class:"font-semibold"},"Average FB Revenue / Day (Weekends):",-1)),r(" "+s(i(l.monthly_summary.weekends_revenue/l.day_counts.weekends_to_date||0)),1)])])])])):g("",!0)])]))}}),Ve=Q(he,[["__scopeId","data-v-6a55a1d4"]]);export{Ve as default};
