import{r as n,W as k,P as Me,w as z,a as Fe,A as Le,B as o,C as Be,D as e,L as r,E as S,G as i,H as h,J as O,I as K,N as l,F as M,M as F,l as J,Z as Ie}from"./vendor-vue-g7iCcTkf.js";import{A as je}from"./AppLayout-BXpmQkyt.js";import{a as P}from"./vendor-utils-CpgP2uT4.js";import{S as v}from"./app-ErXbte2J.js";import{l as Te}from"./lodash-DB3HVzpp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-C0i_S3gs.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const Ne={class:"w-full py-8 px-0"},Ae={class:"py-4"},Ge={class:"flex flex-wrap gap-3 mb-4 items-center"},Ee=["disabled"],$e={key:0,class:"fa fa-spinner fa-spin"},Re={key:1,class:"fas fa-database mr-1"},Ve={class:"py-12"},qe={class:"w-full px-0"},He={class:"bg-white overflow-hidden shadow-xl rounded-none p-0"},Je={key:0,class:"flex justify-center items-center py-8"},Ue={key:1,class:"flex justify-center items-center py-12"},ze={key:2},Ke={class:"bg-white rounded-2xl shadow-2xl overflow-x-auto transition-all"},We={class:"w-full min-w-full divide-y divide-gray-200"},Ye={key:0},Qe={class:"px-6 py-3 font-mono font-semibold text-blue-700"},Ze={class:"px-6 py-3"},Xe={class:"px-6 py-3"},et={class:"flex flex-col gap-1"},tt={class:"flex items-center gap-1"},st={key:0,class:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full font-semibold"},at={key:1,class:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full font-semibold"},ot={key:2,class:"bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full font-semibold"},rt={class:"flex flex-wrap gap-1"},lt={key:0,class:"flex flex-wrap gap-1 mt-1"},nt={class:"px-6 py-3"},it={class:"px-6 py-3"},dt={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},ut={key:1,class:"text-gray-400 text-sm"},ct={class:"px-6 py-3"},pt={class:"px-6 py-3"},ft={class:"px-6 py-3"},gt={class:"px-6 py-3"},xt={key:0,class:"text-xs"},mt={class:"font-semibold text-green-700"},vt={class:"text-gray-600"},bt={class:"text-gray-500"},yt={key:1,class:"text-xs text-gray-400"},ht={class:"px-6 py-3"},_t={key:0,class:"text-xs"},wt={class:"font-semibold text-green-700"},kt={class:"text-gray-600"},St={class:"text-gray-500"},Pt={key:1,class:"text-xs text-gray-400"},Ct={class:"px-6 py-3"},Dt={class:"px-6 py-3"},Ot={class:"flex gap-2"},Mt=["onClick"],Ft=["onClick"],Lt=["onClick"],Bt={class:"flex justify-end mt-4 gap-2"},It=["disabled","onClick","innerHTML"],jt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Tt={class:"bg-white rounded-lg shadow-xl w-11/12 max-w-7xl max-h-[90vh] overflow-hidden"},Nt={class:"p-4 bg-gray-50 border-b border-gray-200"},At={class:"flex flex-wrap gap-3 items-center"},Gt={class:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]"},Et={key:0,class:"flex justify-center items-center py-8"},$t={key:1,class:"text-center py-8 text-gray-500"},Rt={key:2},Vt={class:"mb-4 p-3 bg-purple-50 rounded-lg border border-purple-200"},qt={class:"flex justify-between items-center"},Ht={class:"text-purple-800"},Jt={class:"font-semibold"},Ut={class:"space-y-4"},zt={class:"bg-gradient-to-r from-purple-50 to-purple-100 p-4"},Kt={class:"flex justify-between items-center"},Wt={class:"flex items-center gap-4"},Yt=["onClick","title"],Qt={class:"font-semibold text-purple-800"},Zt={class:"text-sm text-purple-600"},Xt={key:0,class:"text-xs text-green-600 mt-1"},es={class:"flex gap-2"},ts=["onClick"],ss=["onClick"],as={key:0,class:"p-4 bg-gray-50"},os={class:"flex justify-between items-center mb-4"},rs=["onClick"],ls={class:"overflow-x-auto"},ns={class:"w-full text-sm"},is={class:"bg-white"},ds={class:"px-4 py-3"},us={class:"px-4 py-3"},cs={class:"px-4 py-3"},ps={class:"px-4 py-3"},fs={class:"px-4 py-3"},gs={class:"px-4 py-3 text-xs text-gray-600"},xs={class:"bg-gray-50"},ms={class:"px-4 py-2 font-medium"},vs={key:0},bs={class:"px-4 py-2 font-medium text-blue-600"},ys={class:"bg-gray-100"},hs={class:"px-4 py-2 font-bold text-green-600"},Bs={__name:"PurchaseOrderFoods",props:{purchaseOrders:Object,filters:Object,user:Object},setup(L){var se,ae,oe,re,le;const ne=n([]);n([]),n([]);const ie=n([]),W=n(!1),de=n([]),u=L,c=n(((se=u.filters)==null?void 0:se.search)||""),p=n(((ae=u.filters)==null?void 0:ae.status)||""),f=n(((oe=u.filters)==null?void 0:oe.from)||""),g=n(((re=u.filters)==null?void 0:re.to)||""),x=n(((le=u.filters)==null?void 0:le.perPage)||10),E=n(!1),B=n([]),U=n(!1),C=n(new Set),$=n(""),R=n(""),V=n(""),q=n(""),_=n(!1),w=n(!1),Y=async()=>{if(!w.value){w.value=!0,_.value=!0;try{const s={search:c.value,status:p.value,from:f.value,to:g.value,perPage:x.value,load:"true"};sessionStorage.setItem("po-foods-filters",JSON.stringify(s)),k.get("/po-foods",s,{preserveState:!0,replace:!0})}catch(s){console.error("Error loading data:",s),v.fire("Error","Gagal memuat data","error")}finally{w.value=!1}}},I=Te.debounce(()=>{if(!_.value)return;const s={search:c.value,status:p.value,from:f.value,to:g.value,perPage:x.value,load:"true"};sessionStorage.setItem("po-foods-filters",JSON.stringify(s)),k.get("/po-foods",s,{preserveState:!0,replace:!0})},400);function ue(){I()}function ce(){I()}function Q(){I()}function pe(){I()}function fe(){c.value="",p.value="",f.value="",g.value="",x.value=10,_.value=!1}async function j(){try{U.value=!0;const s={search:$.value,status:R.value,from:V.value,to:q.value},t=await P.get("/api/po-foods/pending-gm-finance",{params:s});B.value=t.data}catch(s){console.error("Error fetching pending GM Finance POs:",s),v.fire("Error","Gagal mengambil data PO pending GM Finance","error")}finally{U.value=!1}}function T(){j()}function ge(){$.value="",R.value="",V.value="",q.value="",j()}async function Z(){E.value=!E.value,E.value&&await j()}function xe(s){if(C.value.has(s))C.value.delete(s);else{C.value.add(s);const t=B.value.find(d=>d.id===s);t&&ee(t)}}function X(){try{const s=sessionStorage.getItem("po-foods-filters");if(s){const t=JSON.parse(s);c.value=t.search||"",p.value=t.status||"",f.value=t.from||"",g.value=t.to||"",x.value=t.perPage||10,I()}}catch(s){console.error("Error restoring filter state:",s)}}function me(s){if(s){const t={search:c.value,status:p.value,from:f.value,to:g.value,perPage:x.value};sessionStorage.setItem("po-foods-filters",JSON.stringify(t)),k.visit(s,{preserveState:!0,replace:!0})}}function ve(){const s={search:c.value,status:p.value,from:f.value,to:g.value,perPage:x.value};sessionStorage.setItem("po-foods-filters",JSON.stringify(s)),k.visit("/po-foods/create")}function be(s){const t={search:c.value,status:p.value,from:f.value,to:g.value,perPage:x.value};sessionStorage.setItem("po-foods-filters",JSON.stringify(t)),k.visit(`/po-foods/${s}/edit`)}function ye(s){const t={search:c.value,status:p.value,from:f.value,to:g.value,perPage:x.value};sessionStorage.setItem("po-foods-filters",JSON.stringify(t)),k.visit(`/po-foods/${s}`)}async function he(s){(await v.fire({title:"Hapus PO Foods?",text:`Yakin ingin menghapus PO ${s.number}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed&&k.delete(route("po-foods.destroy",s.id),{onSuccess:()=>v.fire("Berhasil","PO berhasil dihapus!","success")})}async function _e(s){const{value:t}=await v.fire({title:"Approve PO?",input:"textarea",inputLabel:"Catatan (opsional)",inputValue:"",showCancelButton:!0,confirmButtonText:"Approve",cancelButtonText:"Batal"});if(t!==void 0)try{(await P.post(route("po-foods.approve-gm-finance",s.id),{approved:!0,note:t})).data.success&&(await v.fire({icon:"success",title:"Berhasil",text:"PO berhasil diapprove!"}),await j())}catch{v.fire("Gagal","Terjadi kesalahan saat approve","error")}}async function we(s){const{value:t}=await v.fire({title:"Reject PO?",input:"textarea",inputLabel:"Catatan (opsional)",inputValue:"",showCancelButton:!0,confirmButtonText:"Reject",cancelButtonText:"Batal"});if(t!==void 0)try{(await P.post(route("po-foods.approve-gm-finance",s.id),{approved:!1,note:t})).data.success&&(await v.fire({icon:"success",title:"Berhasil",text:"PO berhasil direject!"}),await j())}catch{v.fire("Gagal","Terjadi kesalahan saat reject","error")}}async function ee(s){if(!(!s.items||s.items.length===0))try{const t=s.items.map(async y=>{if(!y.item_id||!s.warehouse_outlet_id)return y;const H=await P.get("/api/inventory/stock",{params:{item_id:y.item_id,warehouse_id:s.warehouse_outlet_id}});return{...y,stock:H.data}}),d=await Promise.all(t);s.items_with_stock=d}catch(t){console.error("Error fetching stock for PO:",t)}}function ke(s){if(!s)return"Stok: 0";const t=[];return s.qty_small!==void 0&&s.qty_small>0&&t.push(`${Number(s.qty_small).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})} ${s.unit_small||""}`),s.qty_medium!==void 0&&s.qty_medium>0&&t.push(`${Number(s.qty_medium).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})} ${s.unit_medium||""}`),s.qty_large!==void 0&&s.qty_large>0&&t.push(`${Number(s.qty_large).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})} ${s.unit_large||""}`),t.length>0?`Stok: ${t.join(" | ")}`:"Stok: 0"}function Se(){var s,t,d,y;return((s=u.user)==null?void 0:s.id_jabatan)===152&&((t=u.user)==null?void 0:t.status)==="A"||((d=u.user)==null?void 0:d.id_role)==="5af56935b011a"&&((y=u.user)==null?void 0:y.status)==="A"}function N(s){return typeof s!="number"&&(s=Number(s)||0),"Rp "+s.toLocaleString("id-ID")}function te(s){return s.items?s.items.reduce((t,d)=>t+(Number(d.total)||0),0):0}function Pe(s){const t=te(s);if(s.ppn_enabled){const d=s.ppn_amount||t*.11;return t+d}return t}Me({items:[]});const Ce=async()=>{try{const s=await P.get("/pr-foods/available");ne.value=s.data}catch(s){console.error("Error fetching PR list:",s),v.fire("Error","Failed to fetch PR list","error")}},De=async()=>{try{const s=await P.get("/api/suppliers");ie.value=s.data}catch(s){console.error("Error fetching suppliers:",s),v.fire("Error","Failed to fetch suppliers","error")}},Oe=async()=>{try{W.value=!0;const s=await P.get("/api/po-foods");de.value=s.data}catch(s){console.error("Error fetching PO list:",s),v.fire("Error","Failed to fetch PO list","error")}finally{W.value=!1}};return z(()=>u.filters,s=>{s?(c.value=s.search||"",p.value=s.status||"",f.value=s.from||"",g.value=s.to||"",x.value=s.perPage||10,u.purchaseOrders&&(_.value=!0)):X()},{immediate:!0}),z(()=>u.purchaseOrders,s=>{s&&(_.value=!0)},{immediate:!0}),z([c,p,f,g,x],()=>{const s={search:c.value,status:p.value,from:f.value,to:g.value,perPage:x.value};sessionStorage.setItem("po-foods-filters",JSON.stringify(s))},{deep:!0}),Fe(()=>{Ce(),De(),Oe(),(!u.filters||Object.keys(u.filters).length===0)&&X(),u.purchaseOrders&&(_.value=!0);const s={search:c.value,status:p.value,from:f.value,to:g.value,perPage:x.value};sessionStorage.setItem("po-foods-filters",JSON.stringify(s))}),(s,t)=>(o(),Le(je,null,{default:Be(()=>{var d,y,H;return[e("div",Ne,[e("div",{class:"flex justify-between items-center mb-6"},[t[9]||(t[9]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-file-invoice text-blue-500"}),i(" Purchase Order Foods ")],-1)),e("button",{onClick:ve,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Buat PO Foods Baru ")]),e("div",Ae,[e("div",Ge,[h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>c.value=a),onInput:ue,type:"text",placeholder:"Cari nomor PO atau nama supplier...",class:"w-64 px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,544),[[O,c.value]]),h(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>p.value=a),onChange:ce,class:"px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[10]||(t[10]=[e("option",{value:""},"Semua Status",-1),e("option",{value:"draft"},"Draft",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1),e("option",{value:"receive"},"Receive",-1),e("option",{value:"payment"},"Payment",-1)]),544),[[K,p.value]]),h(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=a=>f.value=a),onChange:Q,class:"px-2 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Dari tanggal"},null,544),[[O,f.value]]),t[14]||(t[14]=e("span",null,"-",-1)),h(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=a=>g.value=a),onChange:Q,class:"px-2 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",placeholder:"Sampai tanggal"},null,544),[[O,g.value]]),h(e("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>x.value=a),onChange:pe,class:"px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[11]||(t[11]=[e("option",{value:"10"},"10 data",-1),e("option",{value:"25"},"25 data",-1),e("option",{value:"50"},"50 data",-1),e("option",{value:"100"},"100 data",-1)]),544),[[K,x.value]]),e("button",{onClick:fe,class:"px-4 py-2 rounded-xl bg-gray-500 text-white hover:bg-gray-600 transition font-semibold"},t[12]||(t[12]=[e("i",{class:"fas fa-undo mr-2"},null,-1),i(" Clear Filter ")])),e("button",{onClick:Y,disabled:w.value,class:"px-4 py-2 rounded-xl bg-gradient-to-r from-green-500 to-green-700 text-white hover:from-green-600 hover:to-green-800 transition font-semibold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[w.value?(o(),r("i",$e)):(o(),r("i",Re)),i(" "+l(w.value?"Loading...":"Load Data"),1)],8,Ee),Se()?(o(),r("button",{key:0,onClick:Z,class:"px-4 py-2 rounded-xl bg-purple-100 text-purple-700 hover:bg-purple-200 font-semibold transition"},t[13]||(t[13]=[e("i",{class:"fas fa-clock mr-2"},null,-1),i(" Pending Approval GM ")]))):S("",!0)])]),e("div",Ve,[e("div",qe,[e("div",He,[w.value?(o(),r("div",Je,t[15]||(t[15]=[e("div",{class:"text-center"},[e("svg",{class:"animate-spin h-8 w-8 text-blue-600 mx-auto mb-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("p",{class:"text-gray-600"},"Memuat data...")],-1)]))):_.value?(o(),r("div",ze,[e("div",Ke,[e("table",We,[t[25]||(t[25]=e("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tl-2xl"},"No. PO"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Tanggal"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Source"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Supplier"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"GR Number"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Tgl Kedatangan"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Tanggal Print"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Created By"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Purchasing Manager"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"GM Finance"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tr-2xl"},"Aksi")])],-1)),e("tbody",null,[!((d=L.purchaseOrders)!=null&&d.data)||L.purchaseOrders.data.length===0?(o(),r("tr",Ye,t[20]||(t[20]=[e("td",{colspan:"12",class:"text-center py-10 text-gray-400"},"Tidak ada data PO Foods.",-1)]))):S("",!0),(o(!0),r(M,null,F(((y=L.purchaseOrders)==null?void 0:y.data)||[],a=>{var D,A,m,G;return o(),r("tr",{key:a.id,class:"hover:bg-blue-50 transition shadow-sm"},[e("td",Qe,l(a.number),1),e("td",Ze,l(new Date(a.date).toLocaleDateString("id-ID")),1),e("td",Xe,[e("div",et,[e("div",tt,[a.source_type==="pr_foods"||!a.source_type?(o(),r("span",st," Purchase Requisition ")):a.source_type==="ro_supplier"?(o(),r("span",at," RO Supplier ")):(o(),r("span",ot," N/A "))]),e("div",rt,[(o(!0),r(M,null,F(a.source_numbers,b=>(o(),r("span",{key:b,class:J([{"bg-blue-100 text-blue-800":a.source_type==="pr_foods"||!a.source_type,"bg-green-100 text-green-800":a.source_type==="ro_supplier"},"text-xs px-2 py-1 rounded-full"])},l(b),3))),128))]),a.source_type==="ro_supplier"&&a.source_outlets&&a.source_outlets.length>0?(o(),r("div",lt,[(o(!0),r(M,null,F(a.source_outlets,b=>(o(),r("span",{key:b,class:"bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full"},l(b),1))),128))])):S("",!0)])]),e("td",nt,l((D=a.supplier)==null?void 0:D.name),1),e("td",it,[a.gr_number?(o(),r("span",dt,[t[21]||(t[21]=e("i",{class:"fas fa-check-circle mr-1"},null,-1)),i(" "+l(a.gr_number),1)])):(o(),r("span",ut,"-"))]),e("td",ct,l(a.arrival_date?new Date(a.arrival_date).toLocaleDateString("id-ID"):"-"),1),e("td",pt,l(a.printed_at?new Date(a.printed_at).toLocaleDateString("id-ID")+" "+new Date(a.printed_at).toLocaleTimeString("id-ID"):"-"),1),e("td",ft,l((A=a.creator)==null?void 0:A.nama_lengkap),1),e("td",gt,[a.purchasing_manager_approved_at?(o(),r("div",xt,[e("div",mt,l((m=a.purchasing_manager)==null?void 0:m.nama_lengkap),1),e("div",vt,l(new Date(a.purchasing_manager_approved_at).toLocaleDateString("id-ID")),1),e("div",bt,l(new Date(a.purchasing_manager_approved_at).toLocaleTimeString("id-ID")),1)])):(o(),r("div",yt,"-"))]),e("td",ht,[a.gm_finance_approved_at?(o(),r("div",_t,[e("div",wt,l((G=a.gm_finance)==null?void 0:G.nama_lengkap),1),e("div",kt,l(new Date(a.gm_finance_approved_at).toLocaleDateString("id-ID")),1),e("div",St,l(new Date(a.gm_finance_approved_at).toLocaleTimeString("id-ID")),1)])):(o(),r("div",Pt,"-"))]),e("td",Ct,[e("span",{class:J([{"bg-gray-100 text-gray-700":a.status==="draft","bg-green-100 text-green-700":a.status==="approved","bg-red-100 text-red-700":a.status==="rejected","bg-yellow-100 text-yellow-700":a.status==="receive","bg-purple-100 text-purple-700":a.status==="payment"},"px-2 py-1 rounded-full text-xs font-semibold shadow"])},l(a.status),3)]),e("td",Dt,[e("div",Ot,[e("button",{onClick:b=>ye(a.id),class:"inline-flex items-center btn btn-xs bg-blue-100 text-blue-800 hover:bg-blue-200 rounded px-2 py-1 font-semibold transition"},t[22]||(t[22]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),i(" Detail ")]),8,Mt),e("button",{onClick:b=>be(a.id),class:"inline-flex items-center btn btn-xs bg-yellow-100 text-yellow-800 hover:bg-yellow-200 rounded px-2 py-1 font-semibold transition"},t[23]||(t[23]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M15.232 5.232l3.536 3.536M9 13l6-6m2 2l-6 6m-2 2h6a2 2 0 002-2v-6a2 2 0 00-2-2H7a2 2 0 00-2 2v6a2 2 0 002 2z"})],-1),i(" Edit ")]),8,Ft),e("button",{onClick:b=>he(a),class:"inline-flex items-center btn btn-xs bg-red-100 text-red-700 hover:bg-red-200 rounded px-2 py-1 font-semibold transition"},t[24]||(t[24]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M6 18L18 6M6 6l12 12"})],-1),i(" Hapus ")]),8,Lt)])])])}),128))])])]),e("div",Bt,[(o(!0),r(M,null,F(((H=L.purchaseOrders)==null?void 0:H.links)||[],a=>(o(),r("button",{key:a.label,disabled:!a.url,onClick:D=>me(a.url),innerHTML:a.label,class:J(["px-3 py-1 rounded-lg border text-sm font-semibold",[a.active?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-700 hover:bg-blue-50",a.url?"cursor-pointer":"opacity-50 cursor-not-allowed"]])},null,10,It))),128))])])):(o(),r("div",Ue,[e("div",{class:"text-center"},[t[17]||(t[17]=e("i",{class:"fas fa-database text-6xl text-gray-300 mb-4"},null,-1)),t[18]||(t[18]=e("p",{class:"text-gray-600 text-lg mb-2"},"Data belum dimuat",-1)),t[19]||(t[19]=e("p",{class:"text-gray-500 text-sm mb-4"},'Silakan isi filter dan klik tombol "Load Data" untuk menampilkan data',-1)),e("button",{onClick:Y,class:"px-6 py-2 rounded-xl bg-gradient-to-r from-green-500 to-green-700 text-white hover:from-green-600 hover:to-green-800 transition font-semibold shadow-lg"},t[16]||(t[16]=[e("i",{class:"fas fa-database mr-2"},null,-1),i(" Load Data ")]))])]))])])])]),E.value?(o(),r("div",jt,[e("div",Tt,[e("div",{class:"flex justify-between items-center p-6 border-b border-gray-200"},[t[26]||(t[26]=e("h2",{class:"text-xl font-semibold text-gray-800"},[e("i",{class:"fas fa-clock text-purple-500 mr-2"}),i(" PO Pending GM Finance Approval ")],-1)),e("button",{onClick:Z,class:"text-gray-400 hover:text-gray-600 text-2xl font-bold"}," Ã— ")]),e("div",Nt,[e("div",At,[h(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>$.value=a),onKeyup:Ie(T,["enter"]),type:"text",placeholder:"Cari nomor PO atau nama supplier...",class:"w-48 px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition text-sm"},null,544),[[O,$.value]]),h(e("select",{"onUpdate:modelValue":t[6]||(t[6]=a=>R.value=a),onChange:T,class:"px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition text-sm"},t[27]||(t[27]=[e("option",{value:""},"Semua Status",-1),e("option",{value:"draft"},"Draft",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"rejected"},"Rejected",-1)]),544),[[K,R.value]]),h(e("input",{type:"date","onUpdate:modelValue":t[7]||(t[7]=a=>V.value=a),onChange:T,class:"px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition text-sm",placeholder:"Dari tanggal"},null,544),[[O,V.value]]),t[30]||(t[30]=e("span",{class:"text-gray-500"},"-",-1)),h(e("input",{type:"date","onUpdate:modelValue":t[8]||(t[8]=a=>q.value=a),onChange:T,class:"px-3 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition text-sm",placeholder:"Sampai tanggal"},null,544),[[O,q.value]]),e("button",{onClick:T,class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition text-sm font-semibold"},t[28]||(t[28]=[e("i",{class:"fas fa-search mr-1"},null,-1),i(" Filter ")])),e("button",{onClick:ge,class:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition text-sm font-semibold"},t[29]||(t[29]=[e("i",{class:"fas fa-undo mr-1"},null,-1),i(" Reset ")]))])]),e("div",Gt,[U.value?(o(),r("div",Et,t[31]||(t[31]=[e("svg",{class:"animate-spin h-8 w-8 text-purple-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):B.value.length===0?(o(),r("div",$t,t[32]||(t[32]=[e("i",{class:"fas fa-check-circle text-4xl text-green-500 mb-4"},null,-1),e("p",{class:"text-lg"},"Tidak ada PO yang pending GM Finance approval",-1)]))):(o(),r("div",Rt,[e("div",Vt,[e("div",qt,[e("div",Ht,[e("span",Jt,l(B.value.length),1),t[33]||(t[33]=i(" PO ditemukan yang pending GM Finance approval "))]),t[34]||(t[34]=e("div",{class:"text-sm text-purple-600"},[e("i",{class:"fas fa-info-circle mr-1"}),i(" PO yang sudah di-approve Purchasing Manager ")],-1))])]),e("div",Ut,[(o(!0),r(M,null,F(B.value,a=>{var D,A;return o(),r("div",{key:a.id,class:"border border-gray-200 rounded-lg overflow-hidden"},[e("div",zt,[e("div",Kt,[e("div",Wt,[e("button",{onClick:m=>xe(a.id),class:"text-purple-600 hover:text-purple-800 transition",title:C.value.has(a.id)?"Sembunyikan detail":"Tampilkan detail"},[e("i",{class:J(C.value.has(a.id)?"fas fa-chevron-down":"fas fa-chevron-right")},null,2)],8,Yt),e("div",null,[e("h3",Qt,l(a.number),1),e("p",Zt,l((D=a.supplier)==null?void 0:D.name),1),a.purchasing_manager_approved_at?(o(),r("div",Xt,[t[35]||(t[35]=e("i",{class:"fas fa-check-circle mr-1"},null,-1)),i(" Approved by "+l((A=a.purchasing_manager)==null?void 0:A.nama_lengkap)+" on "+l(new Date(a.purchasing_manager_approved_at).toLocaleDateString("id-ID"))+" "+l(new Date(a.purchasing_manager_approved_at).toLocaleTimeString("id-ID")),1)])):S("",!0)])]),e("div",es,[e("button",{onClick:m=>_e(a),class:"px-3 py-1 bg-green-100 text-green-700 rounded text-sm hover:bg-green-200 transition"},t[36]||(t[36]=[e("i",{class:"fas fa-check mr-1"},null,-1),i(" Approve ")]),8,ts),e("button",{onClick:m=>we(a),class:"px-3 py-1 bg-red-100 text-red-700 rounded text-sm hover:bg-red-200 transition"},t[37]||(t[37]=[e("i",{class:"fas fa-times mr-1"},null,-1),i(" Reject ")]),8,ss)])])]),C.value.has(a.id)?(o(),r("div",as,[e("div",os,[t[39]||(t[39]=e("h4",{class:"text-lg font-semibold text-gray-800"},"Detail Item PO",-1)),e("button",{onClick:m=>ee(a),class:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm hover:bg-blue-200 transition"},t[38]||(t[38]=[e("i",{class:"fas fa-sync-alt mr-1"},null,-1),i(" Refresh Stock ")]),8,rs)]),e("div",ls,[e("table",ns,[t[46]||(t[46]=e("thead",{class:"bg-white"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left font-medium text-gray-700"},"Item"),e("th",{class:"px-4 py-2 text-left font-medium text-gray-700"},"Qty"),e("th",{class:"px-4 py-2 text-left font-medium text-gray-700"},"Unit"),e("th",{class:"px-4 py-2 text-left font-medium text-gray-700"},"Harga"),e("th",{class:"px-4 py-2 text-left font-medium text-gray-700"},"Total"),e("th",{class:"px-4 py-2 text-left font-medium text-gray-700"},"Last Stock")])],-1)),e("tbody",is,[(o(!0),r(M,null,F(a.items_with_stock||a.items,m=>{var G,b;return o(),r("tr",{key:m.id,class:"border-b border-gray-100"},[e("td",ds,l((G=m.item)==null?void 0:G.name),1),e("td",us,l(m.quantity),1),e("td",cs,l((b=m.unit)==null?void 0:b.name),1),e("td",ps,l(N(m.price)),1),e("td",fs,l(N(m.total)),1),e("td",gs,l(ke(m.stock)),1)])}),128))]),e("tfoot",xs,[e("tr",null,[t[40]||(t[40]=e("td",{colspan:"4",class:"px-4 py-2 text-right font-medium"},"Subtotal:",-1)),e("td",ms,l(N(a.subtotal||te(a))),1),t[41]||(t[41]=e("td",null,null,-1))]),a.ppn_enabled?(o(),r("tr",vs,[t[42]||(t[42]=e("td",{colspan:"4",class:"px-4 py-2 text-right font-medium text-blue-600"},"PPN (11%):",-1)),e("td",bs,l(N(a.ppn_amount||0)),1),t[43]||(t[43]=e("td",null,null,-1))])):S("",!0),e("tr",ys,[t[44]||(t[44]=e("td",{colspan:"4",class:"px-4 py-2 text-right font-bold"},"Grand Total:",-1)),e("td",hs,l(N(a.grand_total||Pe(a))),1),t[45]||(t[45]=e("td",null,null,-1))])])])])])):S("",!0)])}),128))])]))])])])):S("",!0)]}),_:1}))}};export{Bs as default};
