import{P as j,r as g,c as h,a as A,w,A as N,B as i,C as k,D as e,x as b,G as d,Q as l,S as E,O as L,L as a,E as c,N as u,F as M,M as D,W as B}from"./vendor-vue-g7iCcTkf.js";import{A as F}from"./AppLayout-Dr73aeKz.js";import{s as C}from"./vue-multiselect.esm-V-bx43V9.js";import{S as m}from"./app-CZyV0iGJ.js";/* empty css                            */import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./ProfileUpdateModal-DbuU0LgT.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const T={class:"w-full py-8 px-4"},$={class:"flex justify-between items-center mb-6"},G={class:"bg-white rounded-xl shadow-lg overflow-hidden"},R={class:"p-6"},W={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},q={class:"space-y-2"},Q={key:0,class:"text-red-500 text-xs mt-1"},Y={class:"space-y-2"},z={key:0,class:"text-red-500 text-xs mt-1"},H={key:0,class:"mt-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 shadow-sm"},J={class:"space-y-4"},X={key:0,class:"bg-white p-4 rounded-lg border border-blue-100"},Z={class:"flex items-center"},I={class:"font-semibold text-gray-800"},ee={key:1,class:"bg-white p-4 rounded-lg border border-blue-100"},te={class:"flex items-center mb-3"},se={class:"font-semibold text-gray-800"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-2"},le={class:"text-sm font-medium text-blue-800"},re={class:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-200"},ie=["disabled"],ae={key:0,class:"fa fa-spinner fa-spin mr-2"},ne={key:1,class:"fa fa-save mr-2"},de={__name:"Create",props:{outlets:Array},setup(S){const _=S,s=j({user_id:null,outlet_ids:[]}),f=g([]),x=g(!1),n=g(!1),p=h(()=>_.outlets.map(o=>({id_outlet:o.id_outlet,nama_outlet:o.nama_outlet}))),O=h(()=>s.user_id&&s.outlet_ids.length>0),v=o=>{if(!o)return"";if(typeof o=="object"&&o.name)return o.name;const t=f.value.find(r=>r.id===o);return t?t.name:""},y=o=>{if(!o)return"";if(typeof o=="object"&&o.nama_outlet)return o.nama_outlet;const t=p.value.find(r=>r.id_outlet===o);return t?t.nama_outlet:""};A(()=>{console.log("Props outlets:",_.outlets),console.log("Outlet options:",p.value),P()}),w(()=>s.user_id,o=>{console.log("User selected:",o,typeof o)}),w(()=>s.outlet_ids,o=>{console.log("Outlets selected:",o,typeof o)},{deep:!0});const P=async()=>{x.value=!0;try{const t=await(await fetch("/api/regional/search-users?search=")).json();console.log("Users response:",t),f.value=t}catch(o){console.error("Error loading users:",o)}finally{x.value=!1}};function U(){if(!s.user_id){m.fire({icon:"warning",title:"Peringatan",text:"Pilih user terlebih dahulu!",confirmButtonColor:"#3b82f6"});return}if(s.outlet_ids.length===0){m.fire({icon:"warning",title:"Peringatan",text:"Pilih minimal satu outlet!",confirmButtonColor:"#3b82f6"});return}m.fire({title:"Konfirmasi Assignment",html:`
      <div class="text-left">
        <p class="mb-2"><strong>User:</strong> ${v(s.user_id)}</p>
        <p class="mb-2"><strong>Outlets:</strong> ${s.outlet_ids.length} outlet dipilih</p>
        <div class="text-sm text-gray-600">
          ${s.outlet_ids.map(o=>y(o)).join(", ")}
        </div>
      </div>
    `,icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Simpan!",cancelButtonText:"Batal",showLoaderOnConfirm:!0,preConfirm:()=>new Promise(o=>{const t={user_id:typeof s.user_id=="object"?s.user_id.id:s.user_id,outlet_ids:s.outlet_ids.map(r=>typeof r=="object"?r.id_outlet:r)};console.log("Submitting form data:",t),n.value=!0,B.post("/regional",t,{onSuccess:()=>{n.value=!1,m.fire({icon:"success",title:"Berhasil!",text:"Regional assignment berhasil disimpan!",confirmButtonColor:"#10b981"}),o()},onError:r=>{n.value=!1,console.error("Validation errors:",r),m.fire({icon:"error",title:"Error!",text:"Gagal menyimpan assignment. Silakan coba lagi.",confirmButtonColor:"#ef4444"}),o()}})}),allowOutsideClick:()=>!n.value})}function V(){B.get("/regional")}return(o,t)=>(i(),N(F,null,{default:k(()=>[e("div",T,[e("div",$,[t[3]||(t[3]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-globe"}),d(" Assign Regional Outlets ")],-1)),b(l(E),{href:o.route("regional.index"),class:"bg-gradient-to-r from-gray-500 to-gray-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},{default:k(()=>t[2]||(t[2]=[e("i",{class:"fa fa-arrow-left mr-1"},null,-1),d(" Kembali ")])),_:1},8,["href"])]),e("div",G,[e("div",R,[e("form",{onSubmit:L(U,["prevent"])},[e("div",W,[e("div",q,[t[4]||(t[4]=e("label",{class:"block text-sm font-semibold text-gray-700"},[e("i",{class:"fa-solid fa-user mr-2"}),d("Pilih User ")],-1)),b(l(C),{modelValue:l(s).user_id,"onUpdate:modelValue":t[0]||(t[0]=r=>l(s).user_id=r),options:f.value,searchable:!0,"close-on-select":!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Ketik nama atau email user...","track-by":"name",label:"name","preselect-first":!1,class:"w-full"},null,8,["modelValue","options"]),l(s).errors&&l(s).errors.user_id?(i(),a("p",Q,u(l(s).errors.user_id),1)):c("",!0)]),e("div",Y,[t[5]||(t[5]=e("label",{class:"block text-sm font-semibold text-gray-700"},[e("i",{class:"fa-solid fa-store mr-2"}),d("Pilih Outlets ")],-1)),b(l(C),{modelValue:l(s).outlet_ids,"onUpdate:modelValue":t[1]||(t[1]=r=>l(s).outlet_ids=r),options:p.value,multiple:!0,searchable:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih outlet yang akan di-assign...","track-by":"nama_outlet",label:"nama_outlet","preselect-first":!1,class:"w-full"},null,8,["modelValue","options"]),l(s).errors&&l(s).errors.outlet_ids?(i(),a("p",z,u(l(s).errors.outlet_ids),1)):c("",!0)])]),l(s).user_id||l(s).outlet_ids&&l(s).outlet_ids.length>0?(i(),a("div",H,[t[11]||(t[11]=e("div",{class:"flex items-center mb-4"},[e("div",{class:"bg-blue-100 p-2 rounded-lg mr-3"},[e("i",{class:"fa-solid fa-check-circle text-blue-600"})]),e("h3",{class:"text-lg font-semibold text-blue-800"}," Preview Assignment ")],-1)),e("div",J,[l(s).user_id?(i(),a("div",X,[e("div",Z,[t[7]||(t[7]=e("div",{class:"bg-green-100 p-2 rounded-full mr-3"},[e("i",{class:"fa-solid fa-user text-green-600"})],-1)),e("div",null,[t[6]||(t[6]=e("p",{class:"text-sm text-gray-600"},"Selected User",-1)),e("p",I,u(v(l(s).user_id)),1)])])])):c("",!0),l(s).outlet_ids&&l(s).outlet_ids.length>0?(i(),a("div",ee,[e("div",te,[t[9]||(t[9]=e("div",{class:"bg-orange-100 p-2 rounded-full mr-3"},[e("i",{class:"fa-solid fa-store text-orange-600"})],-1)),e("div",null,[t[8]||(t[8]=e("p",{class:"text-sm text-gray-600"},"Selected Outlets",-1)),e("p",se,u(l(s).outlet_ids.length)+" outlet(s) selected",1)])]),e("div",oe,[(i(!0),a(M,null,D(l(s).outlet_ids,(r,ue)=>(i(),a("div",{key:r,class:"flex items-center bg-blue-50 p-3 rounded-lg border border-blue-100"},[t[10]||(t[10]=e("div",{class:"bg-blue-100 p-1 rounded-full mr-2"},[e("i",{class:"fa-solid fa-building text-blue-600 text-xs"})],-1)),e("span",le,u(y(r)),1)]))),128))])])):c("",!0)])])):c("",!0),e("div",re,[e("button",{type:"button",onClick:V,class:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-semibold shadow-sm transition-all"},t[12]||(t[12]=[e("i",{class:"fa fa-times mr-2"},null,-1),d("Batal ")])),e("button",{type:"submit",disabled:!O.value||n.value,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg font-bold shadow-lg hover:shadow-xl transition-all disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed"},[n.value?(i(),a("i",ae)):(i(),a("i",ne)),d(" "+u(n.value?"Menyimpan...":"Simpan Assignment"),1)],8,ie)])],32)])])])]),_:1}))}},ke=K(de,[["__scopeId","data-v-bebe2829"]]);export{ke as default};
