import{r as p,w as T,c as B,a as R,A as j,B as o,C as q,D as e,L as r,E as f,G as y,H as c,F as x,M as g,N as d,I as D,J as S,l as H,W as A}from"./vendor-vue-g7iCcTkf.js";import{A as K}from"./AppLayout-DQ4wNTsP.js";import"./vendor-utils-CpgP2uT4.js";import"./app-DAB8i6cE.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CinBCb2E.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const Q={class:"w-full py-8 px-2"},$={class:"bg-white rounded-xl shadow-xl p-6 mb-6"},z={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},G=["value"],J=["disabled"],X=["value"],Y={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Z={class:"mt-4 flex gap-2"},ee=["disabled"],te={key:0,class:"fa-solid fa-spinner fa-spin mr-1"},ae={key:1,class:"fa-solid fa-search mr-1"},se=["disabled"],le=["disabled"],oe={key:0,class:"fa-solid fa-spinner fa-spin mr-1"},re={key:1,class:"fa-solid fa-file-excel mr-1"},de={key:0,class:"bg-white rounded-xl shadow-xl p-12 text-center"},ue={key:1,class:"bg-white rounded-xl shadow-xl overflow-x-auto"},ie={class:"min-w-full divide-y divide-gray-200"},ne={class:"bg-white divide-y divide-gray-200"},pe={class:"px-4 py-4 text-sm text-gray-900"},ce={class:"px-4 py-4 text-sm text-gray-900"},ve={class:"px-4 py-4 text-sm text-gray-900"},xe={class:"flex flex-col gap-1"},ge=["href"],_e={class:"px-4 py-4 text-sm text-gray-900"},me={class:"px-4 py-4 text-sm text-gray-900"},fe={class:"font-medium"},ye={class:"text-xs text-gray-500"},be={class:"px-4 py-4 text-sm text-gray-900"},he={key:0,class:"flex flex-col"},we={key:1},ke={class:"px-4 py-4 text-sm text-gray-900 font-medium"},Ce={class:"px-4 py-4 text-sm text-gray-900 font-bold"},Te={class:"px-4 py-4 text-sm text-gray-900"},De={key:0,class:"flex flex-col"},Se={key:1},Ae={key:0,class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},Me={class:"flex items-center justify-between"},Oe={class:"text-sm text-gray-700"},Ne={class:"flex items-center gap-2"},Fe=["disabled"],Ie={class:"text-sm text-gray-700"},Ue=["disabled"],Ve={key:2,class:"bg-white rounded-xl shadow-xl p-12 text-center"},Ee={key:3,class:"bg-white rounded-xl shadow-xl p-12 text-center"},$e={__name:"Index",props:{reportData:{type:Array,default:()=>[]},outlets:{type:Array,default:()=>[]},warehouseOutlets:{type:Array,default:()=>[]},pagination:{type:Object,default:()=>null},filters:{type:Object,default:()=>({outlet_id:"",warehouse_outlet_id:"",start_date:"",end_date:"",search:"",per_page:50,page:1})}},setup(F){const i=F,t=p({outlet_id:i.filters.outlet_id||"",warehouse_outlet_id:i.filters.warehouse_outlet_id||"",start_date:i.filters.start_date||"",end_date:i.filters.end_date||"",search:i.filters.search||"",per_page:i.filters.per_page||50,page:i.filters.page||1}),I=p(i.outlets||[]),b=p(i.warehouseOutlets||[]),_=p(i.reportData||[]),u=p(i.pagination),n=p(!1),v=p(!1),h=p(null);T(()=>i.warehouseOutlets,l=>{b.value=l||[]},{immediate:!0}),T(()=>i.reportData,l=>{_.value=l||[]},{immediate:!0}),T(()=>i.pagination,l=>{u.value=l},{immediate:!0});const U=()=>{if(!t.value.outlet_id){b.value=[],t.value.warehouse_outlet_id="";return}n.value=!0,A.get(route("internal-use-waste-report.index"),{outlet_id:t.value.outlet_id,warehouse_outlet_id:"",start_date:t.value.start_date,end_date:t.value.end_date,search:t.value.search,per_page:t.value.per_page,page:1},{preserveState:!1,only:["warehouseOutlets","filters"],onFinish:()=>{n.value=!1}})},w=()=>{!t.value.outlet_id||!t.value.start_date||!t.value.end_date||(n.value=!0,t.value.page=1,A.get(route("internal-use-waste-report.index"),{outlet_id:t.value.outlet_id,warehouse_outlet_id:t.value.warehouse_outlet_id||"",start_date:t.value.start_date,end_date:t.value.end_date,search:t.value.search,per_page:t.value.per_page,page:t.value.page},{preserveState:!1,onFinish:()=>{n.value=!1,window.scrollTo({top:0,behavior:"smooth"})}}))},V=()=>{h.value&&clearTimeout(h.value),h.value=setTimeout(()=>{w()},500)},M=l=>{l<1||l>u.value.total_pages||(t.value.page=l,n.value=!0,A.get(route("internal-use-waste-report.index"),{outlet_id:t.value.outlet_id,warehouse_outlet_id:t.value.warehouse_outlet_id||"",start_date:t.value.start_date,end_date:t.value.end_date,search:t.value.search,per_page:t.value.per_page,page:t.value.page},{preserveState:!1,preserveScroll:!0,onFinish:()=>{n.value=!1,window.scrollTo({top:0,behavior:"smooth"})}}))},E=l=>u.value?(u.value.current_page-1)*u.value.per_page+l+1:l+1,O=l=>!l&&l!==0?"0":new Intl.NumberFormat("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l),L=l=>l?new Date(l).toLocaleDateString("id-ID",{year:"numeric",month:"2-digit",day:"2-digit"}):"-",m=B(()=>t.value.outlet_id&&t.value.start_date&&t.value.end_date),P=()=>{if(!m.value)return;const l=new URLSearchParams({start_date:t.value.start_date,end_date:t.value.end_date});window.open("/internal-use-waste-report/summary?"+l.toString(),"_blank")},W=()=>{if(!m.value)return;v.value=!0;const l=new URLSearchParams({outlet_id:t.value.outlet_id,warehouse_outlet_id:t.value.warehouse_outlet_id||"",start_date:t.value.start_date,end_date:t.value.end_date,search:t.value.search||""}),a=route("internal-use-waste-report.export")+"?"+l.toString(),s=document.createElement("a");s.href=a,s.download="",document.body.appendChild(s),s.click(),document.body.removeChild(s),setTimeout(()=>{v.value=!1},2e3)};return R(()=>{i.filters&&(t.value={...i.filters})}),(l,a)=>(o(),j(K,null,{default:q(()=>[e("div",Q,[a[25]||(a[25]=e("div",{class:"flex items-center justify-between mb-6"},[e("h1",{class:"text-2xl font-bold flex items-center gap-2"},[e("i",{class:"fa-solid fa-chart-line text-blue-500"}),y(" Report RnD, BM, WM ")])],-1)),e("div",$,[e("div",z,[e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Outlet",-1)),c(e("select",{"onUpdate:modelValue":a[0]||(a[0]=s=>t.value.outlet_id=s),onChange:U,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[a[8]||(a[8]=e("option",{value:""},"Pilih Outlet",-1)),(o(!0),r(x,null,g(I.value,s=>(o(),r("option",{key:s.id_outlet,value:s.id_outlet},d(s.name),9,G))),128))],544),[[D,t.value.outlet_id]])]),e("div",null,[a[12]||(a[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Warehouse Outlet",-1)),c(e("select",{"onUpdate:modelValue":a[1]||(a[1]=s=>t.value.warehouse_outlet_id=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!t.value.outlet_id},[a[10]||(a[10]=e("option",{value:""},"Pilih Warehouse",-1)),a[11]||(a[11]=e("option",{value:"all"},"Semua Warehouse",-1)),(o(!0),r(x,null,g(b.value,s=>(o(),r("option",{key:s.id,value:s.id},d(s.name),9,X))),128))],8,J),[[D,t.value.warehouse_outlet_id]])]),e("div",null,[a[13]||(a[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Mulai",-1)),c(e("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=s=>t.value.start_date=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[S,t.value.start_date]])]),e("div",null,[a[14]||(a[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Akhir",-1)),c(e("input",{type:"date","onUpdate:modelValue":a[3]||(a[3]=s=>t.value.end_date=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[S,t.value.end_date]])])]),t.value.outlet_id&&t.value.start_date&&t.value.end_date?(o(),r("div",Y,[e("div",null,[a[15]||(a[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cari (Nama Item / Type)",-1)),c(e("input",{type:"text","onUpdate:modelValue":a[4]||(a[4]=s=>t.value.search=s),onInput:V,placeholder:"Cari berdasarkan nama item atau type...",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[S,t.value.search]])]),e("div",null,[a[17]||(a[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Per Halaman",-1)),c(e("select",{"onUpdate:modelValue":a[5]||(a[5]=s=>t.value.per_page=s),onChange:w,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},a[16]||(a[16]=[e("option",{value:25},"25",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1),e("option",{value:200},"200",-1),e("option",{value:500},"500",-1)]),544),[[D,t.value.per_page]])])])):f("",!0),e("div",Z,[e("button",{onClick:w,disabled:n.value,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed"},[n.value?(o(),r("i",te)):(o(),r("i",ae)),y(" "+d(n.value?"Loading...":"Load Data"),1)],8,ee),e("button",{onClick:P,disabled:n.value||!m.value,class:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition disabled:opacity-50 disabled:cursor-not-allowed"},a[18]||(a[18]=[e("i",{class:"fa-solid fa-chart-pie mr-1"},null,-1),y(" Summary ")]),8,se),e("button",{onClick:W,disabled:n.value||v.value||!m.value,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed"},[v.value?(o(),r("i",oe)):(o(),r("i",re)),y(" "+d(v.value?"Exporting...":"Export Excel"),1)],8,le)])]),n.value?(o(),r("div",de,a[19]||(a[19]=[e("div",{class:"text-blue-500"},[e("i",{class:"fa-solid fa-spinner fa-spin text-4xl mb-4"}),e("p",{class:"text-lg font-medium"},"Memuat data...")],-1)]))):f("",!0),!n.value&&_.value&&_.value.length>0?(o(),r("div",ue,[e("table",ie,[a[20]||(a[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tanggal"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Warehouse Outlet"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nama Item"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Qty (Konversi)"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"MAC Per Unit"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Qty x MAC"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Approver")])],-1)),e("tbody",ne,[(o(!0),r(x,null,g(_.value,(s,N)=>(o(),r("tr",{key:N,class:"hover:bg-gray-50"},[e("td",pe,d(E(N)),1),e("td",ce,d(L(s.date)),1),e("td",ve,[e("div",xe,[e("span",{class:H(["px-2 py-1 rounded text-xs font-medium",{"bg-purple-100 text-purple-800":s.type_code==="r_and_d","bg-blue-100 text-blue-800":s.type_code==="marketing","bg-red-100 text-red-800":s.type_code==="wrong_maker"}])},d(s.type),3),e("a",{href:l.route("outlet-internal-use-waste.show",s.header_id),target:"_blank",class:"text-xs text-blue-600 hover:text-blue-800 hover:underline cursor-pointer",title:"Klik untuk melihat detail transaksi"},d(s.header_number),9,ge)])]),e("td",_e,d(s.warehouse_outlet_name||"-"),1),e("td",me,[e("div",fe,d(s.item_name),1),e("div",ye,d(s.item_code),1)]),e("td",be,[Array.isArray(s.qty)?(o(),r("div",he,[(o(!0),r(x,null,g(s.qty,(k,C)=>(o(),r("div",{key:C},d(k),1))),128))])):(o(),r("div",we,d(s.qty||"0"),1))]),e("td",ke,d(O(s.mac_per_unit)),1),e("td",Ce,d(O(s.subtotal_mac)),1),e("td",Te,[Array.isArray(s.approvers)?(o(),r("div",De,[(o(!0),r(x,null,g(s.approvers,(k,C)=>(o(),r("div",{key:C,class:"text-xs"},d(k),1))),128))])):(o(),r("div",Se,d(s.approvers||"-"),1))])]))),128))])]),u.value&&u.value.total_pages>1?(o(),r("div",Ae,[e("div",Me,[e("div",Oe," Menampilkan "+d((u.value.current_page-1)*u.value.per_page+1)+" - "+d(Math.min(u.value.current_page*u.value.per_page,u.value.total_items))+" dari "+d(u.value.total_items)+" item ",1),e("div",Ne,[e("button",{onClick:a[6]||(a[6]=s=>M(u.value.current_page-1)),disabled:u.value.current_page<=1,class:"px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},a[21]||(a[21]=[e("i",{class:"fa-solid fa-chevron-left"},null,-1)]),8,Fe),e("span",Ie," Halaman "+d(u.value.current_page)+" dari "+d(u.value.total_pages),1),e("button",{onClick:a[7]||(a[7]=s=>M(u.value.current_page+1)),disabled:u.value.current_page>=u.value.total_pages,class:"px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},a[22]||(a[22]=[e("i",{class:"fa-solid fa-chevron-right"},null,-1)]),8,Ue)])])])):f("",!0)])):!n.value&&t.value.outlet_id&&t.value.start_date&&t.value.end_date?(o(),r("div",Ve,a[23]||(a[23]=[e("div",{class:"text-gray-500"},[e("i",{class:"fa-solid fa-inbox text-4xl mb-4"}),e("p",{class:"text-lg font-medium"},"Tidak ada data"),e("p",{class:"text-sm"},"Tidak ada data untuk filter yang dipilih")],-1)]))):n.value?f("",!0):(o(),r("div",Ee,a[24]||(a[24]=[e("div",{class:"text-gray-500"},[e("i",{class:"fa-solid fa-filter text-4xl mb-4"}),e("p",{class:"text-lg font-medium"},"Pilih Filter"),e("p",{class:"text-sm"},"Silakan pilih outlet, periode tanggal, dan warehouse untuk melihat report")],-1)])))])]),_:1}))}};export{$e as default};
