import{P as F,r as x,w as D,L as i,E as b,B as r,D as s,N as n,O as N,H as f,J as S,Q as l,I as V,F as w,M as k,x as C,C as j,l as B,a6 as M,G as O}from"./vendor-vue-g7iCcTkf.js";import{S as _}from"./app-CMkuePvF.js";import{s as U}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as T}from"./vendor-ui-CrPgGUUb.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";const A={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 transition-all"},K={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-auto p-0 animate-fade-in"},q={class:"px-8 pt-8 pb-2"},z={class:"flex items-center gap-2 mb-6"},G={class:"text-2xl font-bold text-gray-900"},H={class:"space-y-4"},L={key:0,class:"text-xs text-red-500 mt-1"},$={key:0,class:"text-xs text-red-500 mt-1"},J=["value"],Q={key:0,class:"text-xs text-red-500 mt-1"},Y={class:"flex gap-4"},W={class:"flex-1"},X={key:0,class:"text-xs text-red-500 mt-1"},Z={class:"flex-1"},ee={class:"ml-2 text-gray-700"},te={key:0,class:"text-xs text-red-500 mt-1"},se={class:"mt-4"},oe={class:"flex gap-4 mb-2"},le={class:"inline-flex items-center"},ae={class:"inline-flex items-center"},ie={key:0},re={class:"flex flex-wrap gap-2 mt-2"},ne=["onClick"],ue={key:1},de={class:"flex flex-wrap gap-2 mt-2"},ce=["onClick"],me={class:"mt-8 flex justify-end gap-3"},be=["disabled"],pe={__name:"SubCategoryFormModal",props:{show:Boolean,mode:String,subCategory:Object,categories:Array,regions:Array,outlets:Array},emits:["close","success"],setup(y,{emit:R}){const a=y,v=R,t=F({code:"",name:"",description:"",status:"active",show_pos:"1",category_id:"",availability_type:"",selected_regions:[],selected_outlets:[]}),u=x("byRegion"),d=x([]),c=x([]);D(()=>a.show,g=>{if(g&&a.mode==="edit"&&a.subCategory){t.code=a.subCategory.code,t.name=a.subCategory.name,t.description=a.subCategory.description,t.status=a.subCategory.status,t.show_pos=String(a.subCategory.show_pos),t.category_id=a.subCategory.category_id;const e=a.subCategory.outlet_ids?a.outlets.filter(p=>a.subCategory.outlet_ids.includes(p.id)):[];c.value=e;const o=[...new Set(e.map(p=>p.region_id))];d.value=a.regions.filter(p=>o.includes(p.id)),u.value=e.length>0?"byOutlet":"byRegion"}else t.code="",t.name="",t.description="",t.status="active",t.show_pos="1",t.category_id="",d.value=[],c.value=[],u.value="byRegion"});const m=x(!1);async function P(){let g=[];if(u.value==="byRegion"){if(d.value.length===0){_.fire("Pilih minimal satu region!"),m.value=!1;return}g=a.outlets.filter(e=>d.value.map(o=>o.id).includes(e.region_id)).map(e=>e.id)}else{if(c.value.length===0){_.fire("Pilih minimal satu outlet!"),m.value=!1;return}g=c.value.map(e=>e.id)}t.availability_type=u.value,t.outlet_ids=g,t.selected_regions=d.value.map(e=>({id:e.id})),t.selected_outlets=c.value.map(e=>({id:e.id})),console.log("DEBUG SUBMIT",{availability_type:t.availability_type,show_pos:t.show_pos,selected_regions:t.selected_regions}),m.value=!0,a.mode==="create"?t.post(route("sub-categories.store"),{forceFormData:!0,onSuccess:()=>{_.fire("Berhasil","Sub Kategori berhasil ditambahkan!","success"),v("success"),v("close")},onError:e=>{console.error("Error creating sub category:",e),m.value=!1},onFinish:()=>m.value=!1}):a.mode==="edit"&&a.subCategory&&(t._method="PUT",t.post(route("sub-categories.update",a.subCategory.id),{forceFormData:!0,onSuccess:()=>{_.fire("Berhasil","Sub Kategori berhasil diupdate!","success"),v("success"),v("close")},onError:e=>{console.error("Error updating sub category:",e),m.value=!1},onFinish:()=>m.value=!1}))}function E(){v("close")}return(g,e)=>y.show?(r(),i("div",A,[s("div",K,[s("div",q,[s("div",z,[e[10]||(e[10]=s("svg",{class:"w-7 h-7 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{d:"M16 7a4 4 0 01-8 0","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M12 3v4m0 0a4 4 0 01-4 4H4m8-4a4 4 0 014 4h4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),s("h3",G,n(y.mode==="edit"?"Edit":"Tambah")+" Sub Kategori",1)]),s("form",{onSubmit:N(P,["prevent"])},[s("div",H,[s("div",null,[e[11]||(e[11]=s("label",{class:"block text-sm font-medium text-gray-700"},"Nama",-1)),f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l(t).name=o),type:"text",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[S,l(t).name]]),l(t).errors.name?(r(),i("div",L,n(l(t).errors.name),1)):b("",!0)]),s("div",null,[e[12]||(e[12]=s("label",{class:"block text-sm font-medium text-gray-700"},"Deskripsi",-1)),f(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=o=>l(t).description=o),rows:"3",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[S,l(t).description]]),l(t).errors.description?(r(),i("div",$,n(l(t).errors.description),1)):b("",!0)]),s("div",null,[e[14]||(e[14]=s("label",{class:"block text-sm font-medium text-gray-700"},"Kategori",-1)),f(s("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>l(t).category_id=o),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:""},[e[13]||(e[13]=s("option",{value:""},"Pilih Kategori",-1)),(r(!0),i(w,null,k(y.categories,o=>(r(),i("option",{key:o.id,value:o.id},n(o.name),9,J))),128))],512),[[V,l(t).category_id]]),l(t).errors.category_id?(r(),i("div",Q,n(l(t).errors.category_id),1)):b("",!0)]),s("div",Y,[s("div",W,[e[16]||(e[16]=s("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),f(s("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>l(t).status=o),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},e[15]||(e[15]=[s("option",{value:"active"},"Active",-1),s("option",{value:"inactive"},"Inactive",-1)]),512),[[V,l(t).status]]),l(t).errors.status?(r(),i("div",X,n(l(t).errors.status),1)):b("",!0)]),s("div",Z,[e[17]||(e[17]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Show POS",-1)),C(l(T),{modelValue:l(t).show_pos,"onUpdate:modelValue":[e[4]||(e[4]=o=>l(t).show_pos=o),e[5]||(e[5]=o=>l(t).show_pos=o?"1":"0")],class:B([l(t).show_pos==="1"?"bg-blue-600":"bg-gray-200","relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none"]),checked:l(t).show_pos==="1"},{default:j(()=>[s("span",{class:B([l(t).show_pos==="1"?"translate-x-6":"translate-x-1","inline-block h-4 w-4 transform rounded-full bg-white transition"])},null,2)]),_:1},8,["modelValue","class","checked"]),s("span",ee,n(l(t).show_pos==="1"?"Yes":"No"),1),l(t).errors.show_pos?(r(),i("div",te,n(l(t).errors.show_pos),1)):b("",!0)])]),s("div",se,[e[22]||(e[22]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sub Category Availability",-1)),s("div",oe,[s("label",le,[f(s("input",{type:"radio",value:"byRegion","onUpdate:modelValue":e[6]||(e[6]=o=>u.value=o),class:"form-radio text-blue-600"},null,512),[[M,u.value]]),e[18]||(e[18]=s("span",{class:"ml-2"},"By Region",-1))]),s("label",ae,[f(s("input",{type:"radio",value:"byOutlet","onUpdate:modelValue":e[7]||(e[7]=o=>u.value=o),class:"form-radio text-blue-600"},null,512),[[M,u.value]]),e[19]||(e[19]=s("span",{class:"ml-2"},"By Outlet",-1))])]),u.value==="byRegion"?(r(),i("div",ie,[e[20]||(e[20]=s("label",{class:"block text-xs text-gray-500 mb-1"},"Pilih Region",-1)),C(l(U),{modelValue:d.value,"onUpdate:modelValue":e[8]||(e[8]=o=>d.value=o),options:a.regions,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"name","track-by":"id",placeholder:"Pilih Region",class:"mb-2"},null,8,["modelValue","options"]),s("div",re,[(r(!0),i(w,null,k(d.value,o=>(r(),i("span",{key:o.id,class:"inline-flex items-center bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs font-semibold"},[O(n(o.name)+" ",1),s("button",{type:"button",class:"ml-1 text-blue-500 hover:text-red-500",onClick:p=>d.value=d.value.filter(h=>h.id!==o.id)},"×",8,ne)]))),128))])])):b("",!0),u.value==="byOutlet"?(r(),i("div",ue,[e[21]||(e[21]=s("label",{class:"block text-xs text-gray-500 mb-1"},"Pilih Outlet",-1)),C(l(U),{modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=o=>c.value=o),options:a.outlets,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"nama_outlet","track-by":"id",placeholder:"Pilih Outlet",class:"mb-2"},null,8,["modelValue","options"]),s("div",de,[(r(!0),i(w,null,k(c.value,o=>(r(),i("span",{key:o.id,class:"inline-flex items-center bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs font-semibold"},[O(n(o.nama_outlet)+" ",1),s("button",{type:"button",class:"ml-1 text-blue-500 hover:text-red-500",onClick:p=>c.value=c.value.filter(h=>h.id!==o.id)},"×",8,ce)]))),128))])])):b("",!0)])]),s("div",me,[s("button",{type:"button",onClick:E,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Batal "),s("button",{type:"submit",disabled:m.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},n(m.value?"Menyimpan...":"Simpan"),9,be)])],32)])])])):b("",!0)}},ke=I(pe,[["__scopeId","data-v-75dc9c27"]]);export{ke as default};
