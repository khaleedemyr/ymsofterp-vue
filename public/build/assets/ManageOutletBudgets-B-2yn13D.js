import{r as v,k,c as B,A as J,B as o,C,D as t,L as a,E as _,N as d,G as i,O as A,H as h,F as M,M as D,I as P,J as O,Y as Q,l as N,x as Y,Q as K,S as X,W as w}from"./vendor-vue-g7iCcTkf.js";import{A as Z}from"./AppLayout-Cke2dYBX.js";import"./vendor-utils-CpgP2uT4.js";import"./app-AaUk6aDd.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DtjcyHN1.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const tt={class:"flex items-center justify-between"},et={class:"text-sm text-gray-600 mt-1"},st={class:"py-12"},lt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ot={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},dt={class:"p-6"},at={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},rt={class:"bg-blue-50 p-4 rounded-lg"},nt={class:"text-2xl font-bold text-blue-800"},it={class:"bg-green-50 p-4 rounded-lg"},ut={class:"text-2xl font-bold text-green-800"},gt={class:"bg-orange-50 p-4 rounded-lg"},ct={class:"text-2xl font-bold text-orange-800"},mt={class:"bg-purple-50 p-4 rounded-lg"},pt={class:"text-2xl font-bold text-purple-800"},bt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},xt={class:"p-6"},ft={class:"flex flex-wrap gap-4"},yt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},vt={class:"p-6"},_t=["value"],ht={key:0,class:"mt-1 text-sm text-red-600"},wt={class:"relative"},kt={key:0,class:"mt-1 text-sm text-red-600"},Bt={class:"flex items-end"},Ct=["disabled"],At={key:0},Ot={key:1},Ft={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},St={class:"p-6"},Ut={key:0,class:"text-center py-8"},Et={key:1,class:"overflow-x-auto"},$t={class:"min-w-full divide-y divide-gray-200"},Mt={class:"bg-white divide-y divide-gray-200"},Dt={class:"px-6 py-4 whitespace-nowrap"},Nt={class:"text-sm font-medium text-gray-900"},Rt={class:"text-sm text-gray-500"},Vt={class:"px-6 py-4 whitespace-nowrap"},jt={class:"text-sm text-gray-900"},qt={class:"px-6 py-4 whitespace-nowrap"},zt={class:"text-sm text-gray-900"},It={class:"px-6 py-4 whitespace-nowrap"},Lt={class:"text-sm text-gray-900"},Tt={class:"px-6 py-4 whitespace-nowrap"},Wt={class:"flex items-center"},Gt={class:"w-16 bg-gray-200 rounded-full h-2 mr-2"},Ht={class:"text-sm text-gray-900"},Jt={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Qt={class:"flex space-x-2"},Yt=["onClick"],Kt=["onClick"],Xt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Zt={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},te={class:"mt-3"},ee={class:"mb-4"},se={class:"relative"},le={class:"flex justify-end space-x-3"},oe=["disabled"],de={key:0},ae={key:1},re={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ne={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},ie={class:"mt-3"},ue={class:"mb-4"},ge={class:"text-sm text-gray-900"},ce={class:"mb-4"},me={class:"relative"},pe={class:"flex justify-end space-x-3"},be=["disabled"],xe={key:0},fe={key:1},Fe={__name:"ManageOutletBudgets",props:{category:Object,outletBudgets:Array,outlets:Array,unallocatedOutlets:Array,errors:Object},setup(n){const c=n,r=v(!1),p=v(!1),b=v(!1),x=v(null),u=k({outlet_id:"",allocated_budget:""}),f=k({default_budget:""}),y=k({allocated_budget:""}),F=B(()=>c.outletBudgets.reduce((l,e)=>l+parseFloat(e.allocated_budget),0)),S=B(()=>c.outletBudgets.reduce((l,e)=>l+parseFloat(e.used_budget),0)),R=B(()=>F.value-S.value),g=l=>l?"Rp "+new Intl.NumberFormat("id-ID").format(l):"Rp 0",m=l=>l.allocated_budget<=0?0:l.used_budget/l.allocated_budget*100,V=l=>{const e=m(l);return e>=100?"bg-red-500":e>=90?"bg-red-400":e>=75?"bg-yellow-500":"bg-green-500"},j=l=>{const e=m(l);return e>=100?"Exceeded":e>=90?"Critical":e>=75?"Warning":"Safe"},q=l=>{const e=m(l);return e>=100||e>=90?"bg-red-100 text-red-800":e>=75?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"},z=()=>{r.value=!0,w.post(`/budget-management/category/${c.category.id}/outlet-budgets`,u,{onFinish:()=>{r.value=!1,u.outlet_id="",u.allocated_budget=""},onError:l=>{console.error("Form errors:",l)}})},I=()=>{r.value=!0,w.post(`/budget-management/category/${c.category.id}/bulk-create`,f,{onFinish:()=>{r.value=!1,p.value=!1,f.default_budget=""},onError:l=>{console.error("Form errors:",l)}})},L=l=>{x.value=l,y.allocated_budget=l.allocated_budget,b.value=!0},T=()=>{r.value=!0,w.put(`/budget-management/category/${c.category.id}/outlet-budgets/${x.value.id}`,y,{onFinish:()=>{r.value=!1,b.value=!1,x.value=null},onError:l=>{console.error("Form errors:",l)}})},W=l=>{confirm("Are you sure you want to delete this outlet budget allocation?")&&w.delete(`/budget-management/category/${c.category.id}/outlet-budgets/${l.id}`)},G=()=>{alert("Export functionality will be implemented")};return(l,e)=>(o(),J(Z,{title:"Manage Outlet Budgets"},{header:C(()=>[t("div",tt,[t("div",null,[e[7]||(e[7]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Manage Outlet Budgets ",-1)),t("p",et,d(n.category.name)+" - "+d(n.category.division),1)]),Y(K(X),{href:"/budget-management",class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:C(()=>e[8]||(e[8]=[t("i",{class:"fa fa-arrow-left mr-2"},null,-1),i(" Back to Budget Management ")])),_:1})])]),default:C(()=>{var U,E;return[t("div",st,[t("div",lt,[t("div",ot,[t("div",dt,[e[13]||(e[13]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Category Summary",-1)),t("div",at,[t("div",rt,[e[9]||(e[9]=t("div",{class:"text-sm font-medium text-blue-600"},"Total Budget",-1)),t("div",nt,d(g(n.category.budget_limit)),1)]),t("div",it,[e[10]||(e[10]=t("div",{class:"text-sm font-medium text-green-600"},"Allocated",-1)),t("div",ut,d(g(F.value)),1)]),t("div",gt,[e[11]||(e[11]=t("div",{class:"text-sm font-medium text-orange-600"},"Used",-1)),t("div",ct,d(g(S.value)),1)]),t("div",mt,[e[12]||(e[12]=t("div",{class:"text-sm font-medium text-purple-600"},"Remaining",-1)),t("div",pt,d(g(R.value)),1)])])])]),t("div",bt,[t("div",xt,[e[16]||(e[16]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Bulk Actions",-1)),t("div",ft,[t("button",{onClick:e[0]||(e[0]=s=>p.value=!0),class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"},e[14]||(e[14]=[t("i",{class:"fa fa-plus mr-2"},null,-1),i(" Create All Outlet Budgets ")])),t("button",{onClick:G,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"},e[15]||(e[15]=[t("i",{class:"fa fa-download mr-2"},null,-1),i(" Export Data ")]))])])]),t("div",yt,[t("div",vt,[e[21]||(e[21]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Add New Outlet Budget",-1)),t("form",{onSubmit:A(z,["prevent"]),class:"grid grid-cols-1 md:grid-cols-3 gap-4"},[t("div",null,[e[18]||(e[18]=t("label",{for:"outlet_id",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Select Outlet "),t("span",{class:"text-red-500"},"*")],-1)),h(t("select",{id:"outlet_id","onUpdate:modelValue":e[1]||(e[1]=s=>u.outlet_id=s),class:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:""},[e[17]||(e[17]=t("option",{value:""},"Select an outlet",-1)),(o(!0),a(M,null,D(n.unallocatedOutlets,s=>(o(),a("option",{key:s.id_outlet,value:s.id_outlet},d(s.nama_outlet),9,_t))),128))],512),[[P,u.outlet_id]]),n.errors.outlet_id?(o(),a("div",ht,d(n.errors.outlet_id),1)):_("",!0)]),t("div",null,[e[20]||(e[20]=t("label",{for:"allocated_budget",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Allocated Budget "),t("span",{class:"text-red-500"},"*")],-1)),t("div",wt,[e[19]||(e[19]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"text-gray-500 sm:text-sm"},"Rp")],-1)),h(t("input",{id:"allocated_budget","onUpdate:modelValue":e[2]||(e[2]=s=>u.allocated_budget=s),type:"number",step:"0.01",min:"0",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"0.00",required:""},null,512),[[O,u.allocated_budget]])]),n.errors.allocated_budget?(o(),a("div",kt,d(n.errors.allocated_budget),1)):_("",!0)]),t("div",Bt,[t("button",{type:"submit",disabled:r.value,class:"w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50"},[r.value?(o(),a("span",At,"Adding...")):(o(),a("span",Ot,"Add Budget"))],8,Ct)])],32)])]),t("div",Ft,[t("div",St,[e[26]||(e[26]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Outlet Budget Allocations",-1)),n.outletBudgets.length===0?(o(),a("div",Ut,e[22]||(e[22]=[t("i",{class:"fa fa-inbox text-gray-400 text-4xl mb-4"},null,-1),t("p",{class:"text-gray-500"},"No outlet budgets configured yet.",-1),t("p",{class:"text-sm text-gray-400"},"Use the form above to add outlet budgets.",-1)]))):(o(),a("div",Et,[t("table",$t,[e[25]||(e[25]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Outlet "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Allocated Budget "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Used Budget "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Remaining "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Usage % "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",Mt,[(o(!0),a(M,null,D(n.outletBudgets,s=>{var $;return o(),a("tr",{key:s.id},[t("td",Dt,[t("div",Nt,d((($=s.outlet)==null?void 0:$.nama_outlet)||"Unknown Outlet"),1),t("div",Rt,"ID: "+d(s.outlet_id),1)]),t("td",Vt,[t("div",jt,d(g(s.allocated_budget)),1)]),t("td",qt,[t("div",zt,d(g(s.used_budget)),1)]),t("td",It,[t("div",Lt,d(g(s.allocated_budget-s.used_budget)),1)]),t("td",Tt,[t("div",Wt,[t("div",Gt,[t("div",{class:N(["h-2 rounded-full",V(s)]),style:Q({width:m(s)+"%"})},null,6)]),t("span",Ht,d(m(s).toFixed(1))+"%",1)])]),t("td",Jt,[t("span",{class:N([q(s),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},d(j(s)),3)]),t("td",Pt,[t("div",Qt,[t("button",{onClick:H=>L(s),class:"text-blue-600 hover:text-blue-900"},e[23]||(e[23]=[t("i",{class:"fa fa-edit"},null,-1),i(" Edit ")]),8,Yt),t("button",{onClick:H=>W(s),class:"text-red-600 hover:text-red-900"},e[24]||(e[24]=[t("i",{class:"fa fa-trash"},null,-1),i(" Delete ")]),8,Kt)])])])}),128))])])]))])])])]),p.value?(o(),a("div",Xt,[t("div",Zt,[t("div",te,[e[29]||(e[29]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Create All Outlet Budgets",-1)),e[30]||(e[30]=t("p",{class:"text-sm text-gray-600 mb-4"}," This will create budget allocations for all outlets that don't have one yet. ",-1)),t("form",{onSubmit:A(I,["prevent"])},[t("div",ee,[e[28]||(e[28]=t("label",{for:"default_budget",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Default Budget Amount "),t("span",{class:"text-red-500"},"*")],-1)),t("div",se,[e[27]||(e[27]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"text-gray-500 sm:text-sm"},"Rp")],-1)),h(t("input",{id:"default_budget","onUpdate:modelValue":e[3]||(e[3]=s=>f.default_budget=s),type:"number",step:"0.01",min:"0",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"0.00",required:""},null,512),[[O,f.default_budget]])])]),t("div",le,[t("button",{type:"button",onClick:e[4]||(e[4]=s=>p.value=!1),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"}," Cancel "),t("button",{type:"submit",disabled:r.value,class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50"},[r.value?(o(),a("span",de,"Creating...")):(o(),a("span",ae,"Create All"))],8,oe)])],32)])])])):_("",!0),b.value?(o(),a("div",re,[t("div",ne,[t("div",ie,[e[34]||(e[34]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Outlet Budget",-1)),t("form",{onSubmit:A(T,["prevent"])},[t("div",ue,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Outlet",-1)),t("p",ge,d((E=(U=x.value)==null?void 0:U.outlet)==null?void 0:E.nama_outlet),1)]),t("div",ce,[e[33]||(e[33]=t("label",{for:"edit_allocated_budget",class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Allocated Budget "),t("span",{class:"text-red-500"},"*")],-1)),t("div",me,[e[32]||(e[32]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"text-gray-500 sm:text-sm"},"Rp")],-1)),h(t("input",{id:"edit_allocated_budget","onUpdate:modelValue":e[5]||(e[5]=s=>y.allocated_budget=s),type:"number",step:"0.01",min:"0",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"0.00",required:""},null,512),[[O,y.allocated_budget]])])]),t("div",pe,[t("button",{type:"button",onClick:e[6]||(e[6]=s=>b.value=!1),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"}," Cancel "),t("button",{type:"submit",disabled:r.value,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50"},[r.value?(o(),a("span",xe,"Updating...")):(o(),a("span",fe,"Update"))],8,be)])],32)])])])):_("",!0)]}),_:1}))}};export{Fe as default};
