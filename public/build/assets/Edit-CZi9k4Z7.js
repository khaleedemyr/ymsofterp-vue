import{r as w,a as W,j as te,L as u,B as r,D as t,N as j,E as x,l as oe,G as b,w as se,n as ie,A as G,C as ne,O as le,H as T,F as B,M as U,I as ae,J as P,V as q,W as re}from"./vendor-vue-g7iCcTkf.js";import{A as ue}from"./AppLayout-DP-q1yH_.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as k}from"./app-BoyRvw0M.js";import"./vendor-utils-CpgP2uT4.js";import"./ProfileUpdateModal-Cs9EnNrk.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const ce={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60"},pe={class:"bg-white w-full h-full sm:h-auto sm:max-h-[90vh] sm:max-w-xl sm:rounded-2xl shadow-2xl relative flex flex-col"},ge={class:"flex-shrink-0 p-4 border-b border-gray-200 bg-gray-50 sm:bg-white sm:rounded-t-2xl"},me={class:"flex items-center justify-between"},fe={class:"text-lg font-bold text-gray-900"},ve={class:"flex-1 flex flex-col min-h-0 p-4"},be={class:"relative bg-black rounded-lg overflow-hidden mb-4 flex-1 min-h-0"},he={key:0,class:"absolute top-3 left-3"},xe={key:0,class:"flex items-center gap-2 px-3 py-2 bg-red-600 text-white rounded-full text-sm font-medium"},ye={class:"flex-shrink-0 space-y-3"},_e={key:0,class:"flex gap-3"},ke={key:1,class:"flex gap-3"},we={class:"text-center text-xs text-gray-500 px-2"},$e={key:0},Ce={key:1},Se={key:2},je={__name:"CameraModal",props:{mode:{type:String,default:"photo"}},emits:["close","capture"],setup(C,{emit:d}){const i=d,m=C,h=w(null);let f=null,v=null,E=[];const y=w(!1),A=w(""),S=w("environment");async function M(p=null){try{f&&f.getTracks().forEach(O=>O.stop());const g={video:{facingMode:p||S.value,width:{ideal:1280},height:{ideal:720}},audio:m.mode==="video"};try{f=await navigator.mediaDevices.getUserMedia(g)}catch{console.log("Trying fallback camera..."),S.value=S.value==="user"?"environment":"user",f=await navigator.mediaDevices.getUserMedia({video:{facingMode:S.value,width:{ideal:1280},height:{ideal:720}},audio:m.mode==="video"})}h.value&&(h.value.srcObject=f,h.value.onloadedmetadata=()=>{console.log("Video ready:",h.value.videoWidth,"x",h.value.videoHeight)}),m.mode==="video"&&y.value&&L()}catch(g){console.error("Error accessing camera:",g),alert("Tidak dapat mengakses kamera. Pastikan Anda memberikan izin akses kamera.")}}async function R(){S.value=S.value==="user"?"environment":"user",await M()}W(async()=>{await M()}),te(()=>{f&&f.getTracks().forEach(p=>p.stop()),A.value&&URL.revokeObjectURL(A.value)});function $(){if(!h.value||!f){alert("Kamera belum siap. Silakan tunggu sebentar.");return}try{const p=document.createElement("canvas");p.width=h.value.videoWidth,p.height=h.value.videoHeight,p.getContext("2d").drawImage(h.value,0,0);const O=p.toDataURL("image/jpeg",.9);i("capture",O)}catch(p){console.error("Error capturing photo:",p),alert("Gagal mengambil foto. Silakan coba lagi.")}}function L(){if(!f){alert("Kamera belum siap. Silakan tunggu sebentar.");return}try{E=[],v=new MediaRecorder(f,{mimeType:"video/webm;codecs=vp8,opus"}),v.ondataavailable=p=>{p.data.size>0&&E.push(p.data)},v.onstop=()=>{const p=new Blob(E,{type:"video/webm"});A.value=URL.createObjectURL(p)},v.start(),y.value=!0,console.log("Recording started")}catch(p){console.error("Error starting recording:",p),alert("Gagal memulai perekaman. Silakan coba lagi.")}}function V(){if(v&&y.value)try{v.stop(),y.value=!1,console.log("Recording stopped"),v.onstop=()=>{const p=new Blob(E,{type:"video/webm"});i("capture",p)}}catch(p){console.error("Error stopping recording:",p),alert("Gagal menghentikan perekaman. Silakan coba lagi.")}}return(p,g)=>(r(),u("div",ce,[t("div",pe,[t("div",ge,[t("div",me,[t("h2",fe,j(C.mode==="photo"?"Ambil Foto":"Rekam Video"),1),t("button",{onClick:g[0]||(g[0]=O=>p.$emit("close")),class:"p-2 text-gray-400 hover:text-red-500 rounded-full hover:bg-gray-100 transition-colors"},g[3]||(g[3]=[t("i",{class:"fas fa-times text-xl"},null,-1)]))])]),t("div",ve,[t("div",be,[t("video",{ref_key:"video",ref:h,autoplay:"",playsinline:"",class:oe(["w-full h-full object-cover",C.mode==="photo"?"aspect-[4/3]":"aspect-video"])},null,2),t("button",{onClick:R,class:"absolute top-3 right-3 p-3 bg-black/60 hover:bg-black/80 text-white rounded-full transition-all shadow-lg",title:"Switch Kamera"},g[4]||(g[4]=[t("i",{class:"fas fa-camera-rotate text-lg"},null,-1)])),C.mode==="video"?(r(),u("div",he,[y.value?(r(),u("div",xe,g[5]||(g[5]=[t("div",{class:"w-2 h-2 bg-white rounded-full animate-pulse"},null,-1),b(" Recording... ")]))):x("",!0)])):x("",!0)]),t("div",ye,[C.mode==="photo"?(r(),u("div",_e,[t("button",{onClick:g[1]||(g[1]=O=>p.$emit("close")),class:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium"}," Batal "),t("button",{onClick:$,class:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-lg"},g[6]||(g[6]=[t("i",{class:"fas fa-camera mr-2"},null,-1),b(" Capture ")]))])):(r(),u("div",ke,[t("button",{onClick:g[2]||(g[2]=O=>p.$emit("close")),class:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium"}," Batal "),y.value?x("",!0):(r(),u("button",{key:0,onClick:L,class:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-lg"},g[7]||(g[7]=[t("i",{class:"fas fa-video mr-2"},null,-1),b(" Mulai Rekam ")]))),y.value?(r(),u("button",{key:1,onClick:V,class:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium shadow-lg"},g[8]||(g[8]=[t("i",{class:"fas fa-stop mr-2"},null,-1),b(" Stop Rekam ")]))):x("",!0)])),t("div",we,[C.mode==="photo"?(r(),u("p",$e,"Posisikan kamera dan tekan Capture")):y.value?(r(),u("p",Se,"Tekan Stop Rekam untuk mengakhiri")):(r(),u("p",Ce,"Tekan Mulai Rekam untuk memulai"))])])])])]))}},Te=de(je,[["__scopeId","data-v-cd4bb124"]]),Ee={class:"w-full min-h-screen py-8 px-2 md:px-6"},Oe={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Be=["value"],Ue={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Fe=["id","value"],Me=["for"],Re={class:"font-medium text-gray-900"},Le={key:0,class:"text-sm text-gray-500"},Ve={key:0,class:"bg-white rounded-xl shadow-lg p-6 mb-6"},Ke={class:"bg-white border border-gray-200 rounded-lg shadow-sm mb-4"},Ne={class:"bg-blue-50 border-b border-blue-200 rounded-t-lg p-4"},De={class:"flex items-center justify-between"},ze={class:"flex items-center gap-3"},Ge={class:"text-lg font-semibold text-blue-800"},qe={key:0,class:"flex items-center gap-2"},We={key:0,class:"text-yellow-600 text-sm flex items-center gap-1"},He={key:1,class:"text-green-600 text-sm flex items-center gap-1"},Je={key:2,class:"text-red-600 text-sm flex items-center gap-1"},Xe={class:"flex items-center gap-2"},Ze=["onClick"],Ye=["onClick","disabled"],Qe={key:0,class:"fa-solid fa-spinner fa-spin"},Ie={key:1,class:"fa-solid fa-save"},et={class:"flex items-center justify-between mb-4"},tt={class:"font-medium text-gray-700"},ot=["onClick"],st={class:"space-y-4"},it={class:"flex items-start gap-3 mb-3"},nt=["id","onUpdate:modelValue"],lt=["for"],at={class:"font-medium text-gray-800"},rt={key:0,class:"text-sm text-gray-600"},ut={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},dt=["onUpdate:modelValue"],ct={class:"space-y-2"},pt={class:"flex gap-2"},gt=["onClick"],mt=["onClick"],ft=["data-file-input","onChange"],vt={key:0,class:"flex gap-2 flex-wrap"},bt=["src","alt","onClick"],ht=["onClick"],xt={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},yt={class:"flex gap-4 justify-end"},_t=["href"],kt=["disabled"],wt={class:"relative max-w-4xl max-h-full p-4"},$t=["src","alt"],Ct={key:0,class:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2"},St={class:"bg-white bg-opacity-20 text-white px-3 py-1 rounded"},Rt={__name:"Edit",props:{inspection:Object,outlets:Array,subjects:Array},setup(C){const d=C,i=w({outlet_id:d.inspection.outlet_id||"",inspection_date:d.inspection.inspection_date?d.inspection.inspection_date.split(" ")[0]:"",pic_name:d.inspection.pic_name||"",pic_position:d.inspection.pic_position||"",pic_division:d.inspection.pic_division||"",outlet_leader:d.inspection.outlet_leader||"",selected_subjects:d.inspection.details?[...new Set(d.inspection.details.map(s=>s.inspection_subject_id.toString()))]:[],general_notes:d.inspection.general_notes||"",details:{},subject_instances:{}});w({}),w(!1);const m=w({});d.inspection.details&&Array.isArray(d.inspection.details)&&[...new Set(d.inspection.details.map(e=>e.inspection_subject_id.toString()))].forEach(e=>{m.value[e]=null});const h=w(!1),f=w([]),v=w(0),E=w(!1),y=w(""),A=()=>{if(console.log("=== INITIALIZING FORM ==="),console.log("Props inspection:",d.inspection),console.log("Props subjects:",d.subjects),i.value.details={},i.value.subject_instances={},d.inspection.details&&Array.isArray(d.inspection.details)&&d.inspection.details.length>0){console.log("Processing details:",d.inspection.details.length);const s=[...new Set(d.inspection.details.map(e=>e.inspection_subject_id.toString()))];i.value.selected_subjects=s,console.log("Selected subjects:",i.value.selected_subjects),s.forEach(e=>{i.value.subject_instances[e]=[0],i.value.details[e]={},m.value[e]||(m.value[e]=null),d.inspection.details.filter(l=>l.inspection_subject_id==e).forEach(l=>{const a=`${e}_0_${l.inspection_subject_item_id}`,n=[];l.documentation_paths&&Array.isArray(l.documentation_paths)&&l.documentation_paths.forEach(c=>{n.push({file:null,preview:`/storage/${c}`,isExisting:!0,path:c})}),i.value.details[e][a]={subject_id:parseInt(e),item_id:parseInt(l.inspection_subject_item_id),is_checked:l.is_checked||!1,notes:l.notes||"",documentation:[],documentation_preview:n}})}),console.log("Form details initialized:",i.value.details)}else console.log("No details found");console.log("=== FORM INITIALIZATION COMPLETE ==="),console.log("Final form state:",i.value)},S=s=>{console.log("getSubjectName called with:",s,"type:",typeof s),console.log("Available subjects:",d.subjects.map(o=>({id:o.id,name:o.name,type:typeof o.id})));const e=d.subjects.find(o=>o.id==s);return console.log("Found subject:",e),e?e.name:"Unknown Subject"},M=s=>{const e=d.subjects.find(o=>o.id==s);return e?e.items||[]:[]},R=s=>(i.value.subject_instances[s]||(i.value.subject_instances[s]=[0]),i.value.subject_instances[s]),$=(s,e,o)=>{const l=`${s}_${e}_${o}`;if(i.value.details[s]||(i.value.details[s]={}),i.value.details[s][l])return i.value.details[s][l];let a={subject_id:parseInt(s),item_id:parseInt(o),is_checked:!1,notes:"",documentation:[],documentation_preview:[]};if(e===0&&d.inspection.details){const n=d.inspection.details.find(c=>c.inspection_subject_id==s&&c.inspection_subject_item_id==o);if(n){let c=[];n.documentation_paths&&Array.isArray(n.documentation_paths)&&(c=n.documentation_paths.map(_=>({file:null,preview:`/storage/${_}`,isExisting:!0,path:_}))),a={subject_id:parseInt(s),item_id:parseInt(o),is_checked:n.is_checked||!1,notes:n.notes||"",documentation:[],documentation_preview:c}}}return e>0&&(a={subject_id:parseInt(s),item_id:parseInt(o),is_checked:!1,notes:"",documentation:[],documentation_preview:[]}),i.value.details[s][l]=a,i.value.details[s][l]},L=s=>{i.value.subject_instances[s]||(i.value.subject_instances[s]=[0]);const e=i.value.subject_instances[s].length;i.value.subject_instances[s].push(e)},V=(s,e)=>{i.value.subject_instances[s]&&i.value.subject_instances[s].splice(e,1),i.value.details[s]&&Object.keys(i.value.details[s]).forEach(o=>{o.includes(`_${e}_`)&&delete i.value.details[s][o]})},p=(s,e,o,l)=>{const a=Array.from(s.target.files),n=$(e,o,l);a.forEach(c=>{if(c.type.startsWith("image/")){const _=new FileReader;_.onload=F=>{n.documentation.push(c),n.documentation_preview.push({file:c,preview:F.target.result})},_.readAsDataURL(c)}}),s.target.value=""},g=(s,e,o,l)=>{const a=$(s,e,o);a.documentation.splice(l,1),a.documentation_preview.splice(l,1)},O=(s,e,o)=>{const l=document.querySelector(`[data-file-input="${s}-${e}-${o}"]`);l&&l.click()},H=(s,e,o)=>{y.value=`${s}-${e}-${o}`,E.value=!0},K=()=>{E.value=!1,y.value=""},J=s=>{if(y.value){const[e,o,l]=y.value.split("-"),a=$(e,o,l),n=Q(s,`camera-capture-${Date.now()}.jpg`);a.documentation.push(n),a.documentation_preview.push({file:n,preview:s})}K()},X=(s,e)=>{f.value=s,v.value=e,h.value=!0},N=()=>{h.value=!1,f.value=[],v.value=0},Z=()=>{v.value>0&&v.value--},Y=()=>{v.value<f.value.length-1&&v.value++},Q=(s,e)=>{const o=s.split(","),l=o[0].match(/:(.*?);/)[1],a=atob(o[1]);let n=a.length;const c=new Uint8Array(n);for(;n--;)c[n]=a.charCodeAt(n);return new File([c],e,{type:l})},I=async s=>{if(!i.value.outlet_id){k.fire({title:"Peringatan!",text:"Pilih outlet terlebih dahulu!",icon:"warning",confirmButtonText:"OK"});return}if(!i.value.inspection_date){k.fire({title:"Peringatan!",text:"Pilih tanggal inspection terlebih dahulu!",icon:"warning",confirmButtonText:"OK"});return}m.value[s]="saving";try{const e=new FormData;e.append("outlet_id",i.value.outlet_id),e.append("inspection_date",i.value.inspection_date),e.append("general_notes",i.value.general_notes||""),e.append("outlet_leader",i.value.outlet_leader||""),e.append("subject_id",s);const o=[],l=i.value.details[s];if(l&&Object.values(l).forEach(n=>{(n.is_checked||n.notes||n.documentation&&n.documentation.length>0)&&o.push({subject_id:n.subject_id,item_id:n.item_id,is_checked:n.is_checked,notes:n.notes||"",documentation:n.documentation||[]})}),console.log("Subject data for",s,":",l),console.log("Details to save:",o),console.log("General notes being sent:",i.value.general_notes),o.length===0){k.fire({title:"Peringatan!",text:"Tidak ada data untuk disimpan pada subject ini!",icon:"warning",confirmButtonText:"OK"}),m.value[s]="error";return}e.append("details",JSON.stringify(o)),o.forEach((n,c)=>{n.documentation&&n.documentation.length>0&&n.documentation.forEach((_,F)=>{_ instanceof File&&e.append(`details[${c}][documentation][${F}]`,_)})}),console.log("Saving subject:",s,"with details:",o);const a=await fetch(route("dynamic-inspections.update-subject",d.inspection.id),{method:"POST",body:e,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});if(a.ok){const n=await a.json();m.value[s]="saved",k.fire({title:"Berhasil!",text:`Subject "${S(s)}" berhasil disimpan!`,icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1})}else{const n=await a.json();m.value[s]="error",k.fire({title:"Error!",text:`Error saving subject: ${n.message||"Unknown error"}`,icon:"error",confirmButtonText:"OK"})}}catch(e){console.error("Error saving subject:",e),m.value[s]="error",k.fire({title:"Error!",text:"Terjadi kesalahan saat menyimpan subject!",icon:"error",confirmButtonText:"OK"})}},D=async()=>{if(console.log("=== SUBMIT FORM CALLED ==="),console.log("Form state:",i.value),console.log("Form outlet_id:",i.value.outlet_id),console.log("Form inspection_date:",i.value.inspection_date),console.log("Form selected_subjects:",i.value.selected_subjects),!i.value.outlet_id){console.log("Validation failed: outlet_id is empty"),k.fire({title:"Peringatan!",text:"Pilih outlet terlebih dahulu!",icon:"warning",confirmButtonText:"OK"});return}if(!i.value.inspection_date){console.log("Validation failed: inspection_date is empty"),k.fire({title:"Peringatan!",text:"Pilih tanggal inspection terlebih dahulu!",icon:"warning",confirmButtonText:"OK"});return}if(i.value.selected_subjects.length===0){console.log("Validation failed: selected_subjects is empty"),k.fire({title:"Peringatan!",text:"Pilih minimal satu subject untuk inspection!",icon:"warning",confirmButtonText:"OK"});return}const s=i.value.selected_subjects.filter(e=>m.value[e]!=="saved");if(s.length>0){const e=s.map(o=>S(o)).join(", ");k.fire({title:"Konfirmasi",text:`Masih ada subject yang belum disimpan: ${e}. Lanjutkan?`,icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Lanjutkan",cancelButtonText:"Batal"}).then(o=>{o.isConfirmed&&z()});return}z()},z=async()=>{try{const s=await fetch(route("dynamic-inspections.complete",d.inspection.id),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json"},body:JSON.stringify({general_notes:i.value.general_notes,outlet_leader:i.value.outlet_leader})});if(s.ok){const e=await s.json();k.fire({title:"Berhasil!",text:e.message,icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1}).then(()=>{re.visit(route("dynamic-inspections.index"))})}else{const e=await s.json();k.fire({title:"Error!",text:e.error||"Gagal menyelesaikan inspection!",icon:"error",confirmButtonText:"OK"})}}catch(s){console.error("Error completing inspection:",s),k.fire({title:"Error!",text:"Terjadi kesalahan saat menyelesaikan inspection!",icon:"error",confirmButtonText:"OK"})}};return se(()=>i.value.selected_subjects,(s,e)=>{s.filter(l=>!e.includes(l)).forEach(l=>{i.value.details[l]||(i.value.details[l]={}),i.value.subject_instances[l]||(i.value.subject_instances[l]=[0]),m.value[l]||(m.value[l]=null)})},{deep:!0}),W(()=>{console.log("Component mounted, initializing form..."),console.log("Props received:",{inspection:d.inspection,outlets:d.outlets,subjects:d.subjects}),ie(()=>{A()})}),(s,e)=>(r(),G(ue,null,{default:ne(()=>[t("div",Ee,[e[33]||(e[33]=t("h1",{class:"text-3xl font-bold mb-8 text-blue-800 flex items-center gap-3"},[t("i",{class:"fa-solid fa-clipboard-check text-blue-500"}),b(" Edit Outlet/HO Inspection ")],-1)),t("form",{onSubmit:le(D,["prevent"]),class:"max-w-6xl mx-auto"},[t("div",Oe,[e[15]||(e[15]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2"},[t("i",{class:"fa-solid fa-info-circle text-blue-600"}),b(" Inspection Information ")],-1)),t("div",Pe,[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Unit/Outlet *",-1)),T(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>i.value.outlet_id=o),class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},[e[8]||(e[8]=t("option",{value:""},"Pilih Outlet",-1)),(r(!0),u(B,null,U(C.outlets,o=>(r(),u("option",{key:o.id_outlet,value:o.id_outlet},j(o.nama_outlet),9,Be))),128))],512),[[ae,i.value.outlet_id]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Inspection *",-1)),T(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>i.value.inspection_date=o),type:"date",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[P,i.value.inspection_date]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"PIC",-1)),T(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>i.value.pic_name=o),type:"text",class:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100",readonly:""},null,512),[[P,i.value.pic_name]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Jabatan",-1)),T(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>i.value.pic_position=o),type:"text",class:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100",readonly:""},null,512),[[P,i.value.pic_position]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Divisi",-1)),T(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>i.value.pic_division=o),type:"text",class:"w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100",readonly:""},null,512),[[P,i.value.pic_division]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Outlet Leader",-1)),T(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>i.value.outlet_leader=o),type:"text",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Masukkan nama outlet leader"},null,512),[[P,i.value.outlet_leader]])])])]),t("div",Ue,[e[16]||(e[16]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2"},[t("i",{class:"fa-solid fa-list-check text-blue-600"}),b(" Pilih Subject Inspection ")],-1)),t("div",Ae,[(r(!0),u(B,null,U(C.subjects,o=>(r(),u("div",{key:o.id,class:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50"},[T(t("input",{id:`subject-${o.id}`,"onUpdate:modelValue":e[6]||(e[6]=l=>i.value.selected_subjects=l),value:o.id.toString(),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,Fe),[[q,i.value.selected_subjects]]),t("label",{for:`subject-${o.id}`,class:"flex-1 cursor-pointer"},[t("div",Re,j(o.name),1),o.description?(r(),u("div",Le,j(o.description),1)):x("",!0)],8,Me)]))),128))])]),i.value.selected_subjects.length>0?(r(),u("div",Ve,[e[27]||(e[27]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2"},[t("i",{class:"fa-solid fa-clipboard-list text-blue-600"}),b(" Inspection Details ")],-1)),(r(!0),u(B,null,U(i.value.selected_subjects,o=>(r(),u("div",{key:o,class:"mb-8"},[t("div",Ke,[t("div",Ne,[t("div",De,[t("div",ze,[t("h3",Ge,j(S(o)),1),m.value[o]?(r(),u("div",qe,[m.value[o]==="saving"?(r(),u("span",We,e[17]||(e[17]=[t("i",{class:"fa-solid fa-spinner fa-spin"},null,-1),b(" Saving... ")]))):m.value[o]==="saved"?(r(),u("span",He,e[18]||(e[18]=[t("i",{class:"fa-solid fa-check-circle"},null,-1),b(" Saved ")]))):m.value[o]==="error"?(r(),u("span",Je,e[19]||(e[19]=[t("i",{class:"fa-solid fa-exclamation-circle"},null,-1),b(" Error ")]))):x("",!0)])):x("",!0)]),t("div",Xe,[t("button",{type:"button",onClick:l=>L(o),class:"px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition flex items-center gap-1"},e[20]||(e[20]=[t("i",{class:"fa-solid fa-plus"},null,-1),b(" Add More ")]),8,Ze),t("button",{type:"button",onClick:l=>I(o),disabled:m.value[o]==="saving",class:"px-3 py-1 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center gap-1"},[m.value[o]==="saving"?(r(),u("i",Qe)):(r(),u("i",Ie)),e[21]||(e[21]=b(" Save Subject "))],8,Ye)])])]),(r(!0),u(B,null,U(R(o),(l,a)=>(r(),u("div",{key:a,class:"p-4 border-b border-gray-200 last:border-b-0"},[t("div",et,[t("h4",tt,j(S(o))+" #"+j(a+1),1),R(o).length>1?(r(),u("button",{key:0,type:"button",onClick:n=>V(o,a),class:"text-red-600 hover:text-red-800 transition"},e[22]||(e[22]=[t("i",{class:"fa-solid fa-trash"},null,-1)]),8,ot)):x("",!0)]),t("div",st,[(r(!0),u(B,null,U(M(o),n=>(r(),u("div",{key:n.id,class:"border border-gray-200 rounded-lg p-4"},[t("div",it,[T(t("input",{type:"checkbox",id:`item-${o}-${a}-${n.id}`,"onUpdate:modelValue":c=>$(o,a,n.id).is_checked=c,class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mt-1"},null,8,nt),[[q,$(o,a,n.id).is_checked]]),t("label",{for:`item-${o}-${a}-${n.id}`,class:"flex-1 cursor-pointer"},[t("div",at,j(n.name),1),n.description?(r(),u("div",rt,j(n.description),1)):x("",!0)],8,lt)]),t("div",ut,[t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notes",-1)),T(t("textarea",{"onUpdate:modelValue":c=>$(o,a,n.id).notes=c,rows:"2",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Tambahkan catatan..."},null,8,dt),[[P,$(o,a,n.id).notes]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Dokumentasi",-1)),t("div",ct,[t("div",pt,[t("button",{type:"button",onClick:c=>H(o,a,n.id),class:"px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition flex items-center gap-1"},e[24]||(e[24]=[t("i",{class:"fa-solid fa-camera"},null,-1),b(" Camera ")]),8,gt),t("button",{type:"button",onClick:c=>O(o,a,n.id),class:"px-3 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition flex items-center gap-1"},e[25]||(e[25]=[t("i",{class:"fa-solid fa-upload"},null,-1),b(" Upload ")]),8,mt)]),t("input",{"data-file-input":`${o}-${a}-${n.id}`,type:"file",multiple:"",accept:"image/*",onChange:c=>p(c,o,a,n.id),class:"hidden"},null,40,ft),$(o,a,n.id).documentation_preview.length>0?(r(),u("div",vt,[(r(!0),u(B,null,U($(o,a,n.id).documentation_preview,(c,_)=>(r(),u("div",{key:_,class:"relative group"},[t("img",{src:c.preview,alt:`Preview ${_+1}`,class:"w-20 h-20 object-cover rounded-lg border border-gray-200 cursor-pointer hover:shadow-lg transition",onClick:F=>X($(o,a,n.id).documentation_preview.map(ee=>ee.preview),_)},null,8,bt),t("button",{type:"button",onClick:F=>g(o,a,n.id,_),class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600 transition"}," Ã— ",8,ht)]))),128))])):x("",!0)])])])]))),128))])]))),128))])]))),128))])):x("",!0),t("div",xt,[e[28]||(e[28]=t("h2",{class:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2"},[t("i",{class:"fa-solid fa-sticky-note text-blue-600"}),b(" Catatan/Komentar ")],-1)),T(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=o=>i.value.general_notes=o),class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:"4",placeholder:"Tambahkan catatan umum atau komentar..."},null,512),[[P,i.value.general_notes]])]),t("div",yt,[t("a",{href:s.route("dynamic-inspections.show",C.inspection.id),class:"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"}," Cancel ",8,_t),t("button",{type:"button",onClick:D,disabled:i.value.selected_subjects.length===0,class:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},e[29]||(e[29]=[t("i",{class:"fa-solid fa-check"},null,-1),b(" Selesai ")]),8,kt)])],32),E.value?(r(),G(Te,{key:0,"is-open":E.value,onClose:K,onCapture:J},null,8,["is-open"])):x("",!0),h.value?(r(),u("div",{key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",onClick:N},[t("div",wt,[t("button",{onClick:N,class:"absolute -top-4 -right-4 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors z-10"},e[30]||(e[30]=[t("i",{class:"fa-solid fa-times text-gray-600"},null,-1)])),t("img",{src:f.value[v.value],alt:`Image ${v.value+1}`,class:"max-w-full max-h-full object-contain rounded-lg shadow-2xl"},null,8,$t),f.value.length>1?(r(),u("div",Ct,[t("button",{onClick:Z,class:"bg-white bg-opacity-20 text-white px-3 py-1 rounded hover:bg-opacity-30"},e[31]||(e[31]=[t("i",{class:"fa-solid fa-chevron-left"},null,-1)])),t("span",St,j(v.value+1)+" / "+j(f.value.length),1),t("button",{onClick:Y,class:"bg-white bg-opacity-20 text-white px-3 py-1 rounded hover:bg-opacity-30"},e[32]||(e[32]=[t("i",{class:"fa-solid fa-chevron-right"},null,-1)]))])):x("",!0)])])):x("",!0)])]),_:1}))}};export{Rt as default};
