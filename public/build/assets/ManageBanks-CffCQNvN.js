import{r as k,A as E,B as u,C as x,D as e,x as B,Q as A,S as N,G as y,N as l,L as r,E as F,F as g,M as h,H,I as L,W as S}from"./vendor-vue-g7iCcTkf.js";import{A as M}from"./AppLayout-DZJ25Yod.js";import{s as P}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{S as f}from"./app-BujIObx9.js";import"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DNpNU_ax.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const j={class:"max-w-4xl mx-auto py-8 px-2"},G={class:"mb-6"},U={class:"text-2xl font-bold text-blue-700"},K={class:"bg-white rounded-2xl shadow-xl p-8 space-y-6"},W={class:"border-b pb-6"},Q={class:"space-y-4"},Y={key:0,class:"mb-4 space-y-2"},q={class:"flex-1"},z={class:"font-semibold text-gray-800"},J={class:"text-sm text-gray-600"},R={class:"text-xs text-gray-500 mt-1"},X=["onClick"],Z={class:"grid grid-cols-2 gap-4"},I=["value"],ee={slot:"option","slot-scope":"props"},te={class:"font-semibold"},ae={class:"text-sm text-gray-600"},ne={class:"text-xs text-gray-500"},se=["disabled"],oe={key:0,class:"fa fa-spinner fa-spin mr-1"},le={key:1,class:"fa fa-save mr-1"},ie={key:0,class:"text-center py-8 text-gray-400"},ue={key:1,class:"space-y-3"},de={class:"flex-1"},re={class:"font-semibold text-gray-800"},ce={class:"text-sm text-gray-600"},me={class:"text-xs text-gray-500 mt-1"},fe=["onClick","disabled"],_e={key:0,class:"fa fa-spinner fa-spin"},pe={key:1,class:"fa fa-trash"},Te={__name:"ManageBanks",props:{paymentType:Object,outlets:Array,banks:Array,bankAccounts:Array},setup(_){const c=_,p=k(!1),b=k(null),i=k({outlet_id:null,bank:null}),d=k([]);function w(n){return`${n.bank_name} - ${n.account_number} (${n.outlet_name})`}function $(n){var m;const t=c.bankAccounts.filter(s=>s.outlet_id===n).map(s=>s.id),a=d.value.filter(s=>s.outlet_id===n).map(s=>s.bank.id);return((m=c.banks)==null?void 0:m.filter(s=>{if(t.includes(s.id)||a.includes(s.id))return!1;if(n===null){const o=c.bankAccounts.some(v=>v.outlet_id===null&&v.id===s.id),D=d.value.some(v=>v.outlet_id===null&&v.bank.id===s.id);return!o&&!D}else return(s.outlet_id===n||s.outlet_id===null)&&!c.bankAccounts.some(o=>o.outlet_id===n&&o.id===s.id)&&!d.value.some(o=>o.outlet_id===n&&o.bank.id===s.id)}))||[]}function T(n){var s;if(!n)return;if(d.value.some(o=>o.bank.id===n.id&&o.outlet_id===i.value.outlet_id)){f.fire("Info","Bank account ini sudah ada di daftar","info"),i.value.bank=null;return}if(c.bankAccounts.some(o=>o.id===n.id&&o.outlet_id===i.value.outlet_id)){f.fire("Info","Bank account ini sudah terdaftar","info"),i.value.bank=null;return}const m=i.value.outlet_id?((s=c.outlets.find(o=>o.id===i.value.outlet_id))==null?void 0:s.name)||"Unknown":"Head Office (Semua Outlet)";d.value.push({bank:n,outlet_id:i.value.outlet_id,outlet_name:m}),i.value.bank=null}function C(n){d.value.splice(n,1)}async function O(){if(d.value.length===0){f.fire("Info","Tidak ada bank account yang akan disimpan","info");return}p.value=!0;const n=d.value.map(t=>({bank_account_id:t.bank.id,outlet_id:t.outlet_id}));S.post(route("payment-types.store-bank",c.paymentType.id),{banks:n},{onSuccess:()=>{p.value=!1,d.value=[],i.value={outlet_id:null,bank:null},f.fire("Sukses",`${n.length} bank account berhasil ditambahkan`,"success")},onError:t=>{p.value=!1,f.fire("Error",t.message||"Gagal menambahkan bank account","error")}})}async function V(n,t){(await f.fire({title:"Hapus Bank Account?",text:"Bank account akan dihapus dari payment type ini",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"})).isConfirmed&&(b.value=`${n}_${t}`,S.post(route("payment-types.delete-bank",c.paymentType.id),{bank_account_id:n,outlet_id:t},{onSuccess:()=>{b.value=null,f.fire("Sukses","Bank account berhasil dihapus","success")},onError:()=>{b.value=null,f.fire("Error","Gagal menghapus bank account","error")}}))}return(n,t)=>(u(),E(M,null,{default:x(()=>[e("div",j,[e("div",G,[B(A(N),{href:n.route("payment-types.index"),class:"text-blue-600 hover:text-blue-800 mb-4 inline-block"},{default:x(()=>t[2]||(t[2]=[e("i",{class:"fa fa-arrow-left mr-1"},null,-1),y(" Kembali ke Daftar ")])),_:1},8,["href"]),e("h1",U,"Manage Bank Accounts - "+l(_.paymentType.name),1),t[3]||(t[3]=e("p",{class:"text-gray-600 mt-1"},"Kelola bank accounts untuk payment type ini per outlet",-1))]),e("div",K,[e("div",W,[t[9]||(t[9]=e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Tambah Bank Account",-1)),e("div",Q,[d.value.length>0?(u(),r("div",Y,[(u(!0),r(g,null,h(d.value,(a,m)=>(u(),r("div",{key:m,class:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200"},[e("div",q,[e("div",z,l(a.bank.bank_name),1),e("div",J,l(a.bank.account_number)+" - "+l(a.bank.account_name),1),e("div",R,[t[4]||(t[4]=e("i",{class:"fa fa-store mr-1"},null,-1)),y(" "+l(a.outlet_name),1)])]),e("button",{onClick:s=>C(m),class:"text-red-500 hover:text-red-700 px-2 py-1"},t[5]||(t[5]=[e("i",{class:"fa fa-times"},null,-1)]),8,X)]))),128))])):F("",!0),e("div",Z,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Outlet",-1)),H(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.value.outlet_id=a),class:"w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},[t[6]||(t[6]=e("option",{value:null},"Head Office (Semua Outlet)",-1)),(u(!0),r(g,null,h(_.outlets,a=>(u(),r("option",{key:a.id,value:a.id},l(a.name),9,I))),128))],512),[[L,i.value.outlet_id]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Bank Account",-1)),B(A(P),{modelValue:i.value.bank,"onUpdate:modelValue":t[1]||(t[1]=a=>i.value.bank=a),options:$(i.value.outlet_id),label:"bank_name","track-by":"id",placeholder:"Pilih Bank","custom-label":w,searchable:!0,onSelect:T},{default:x(()=>[e("template",ee,[e("div",null,[e("div",te,l(c.option.bank_name),1),e("div",ae,l(c.option.account_number)+" - "+l(c.option.account_name),1),e("div",ne,l(c.option.outlet_name),1)])])]),_:1},8,["modelValue","options"])])]),e("button",{onClick:O,disabled:d.value.length===0||p.value,class:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 font-semibold"},[p.value?(u(),r("i",oe)):(u(),r("i",le)),y(" Simpan Semua ("+l(d.value.length)+") ",1)],8,se)])]),e("div",null,[t[11]||(t[11]=e("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Bank Accounts Terdaftar",-1)),_.bankAccounts.length===0?(u(),r("div",ie," Belum ada bank account yang ditambahkan ")):(u(),r("div",ue,[(u(!0),r(g,null,h(_.bankAccounts,(a,m)=>(u(),r("div",{key:m,class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border"},[e("div",de,[e("div",re,l(a.bank_name),1),e("div",ce,l(a.account_number)+" - "+l(a.account_name),1),e("div",me,[t[10]||(t[10]=e("i",{class:"fa fa-store mr-1"},null,-1)),y(" "+l(a.outlet_name),1)])]),e("button",{onClick:s=>V(a.id,a.outlet_id),disabled:b.value===`${a.id}_${a.outlet_id}`,class:"text-red-500 hover:text-red-700 px-3 py-2 rounded hover:bg-red-50 disabled:opacity-50"},[b.value===`${a.id}_${a.outlet_id}`?(u(),r("i",_e)):(u(),r("i",pe))],8,fe)]))),128))]))])])])]),_:1}))}};export{Te as default};
