import{a8 as R,A as z,B as r,C as M,D as e,x as U,G as S,L as i,H as x,F as f,M as p,N as d,I as D,J as I,E as u,l as A,O as G,r as b,P as E}from"./vendor-vue-g7iCcTkf.js";import{A as J}from"./AppLayout-DZJ25Yod.js";import{_ as K}from"./Modal-BBL5yay4.js";import{_ as X}from"./Pagination-DElM3wPU.js";import{f as Y}from"./utils-aNKEQRww.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./app-BujIObx9.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-DNpNU_ax.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const $={components:{AppLayout:J,Modal:K,Pagination:X},props:{stockBalances:Object,warehouses:Array,products:Array,units:Array,filters:Object},setup(B){const t=b(!1),a=b(null),o=b([]),_=b([]),w=b(null),k=b(null),v=b(!1),n=E({id:null,product_id:"",warehouse_id:"",quantity:"",unit_id:"",batch_number:"",expiry_date:"",notes:""}),s=b(!1),g=b(!1),h=E({warehouse_id:B.filters.warehouse_id||"",product_id:B.filters.product_id||"",search:B.filters.search||""}),P=()=>{h.get(route("food-stock-balances.index"),{preserveState:!0,preserveScroll:!0})},q=()=>{window.location.href=route("food-stock-balances.download-template")},L=l=>{a.value=l.target.files[0],o.value=[],_.value=[],w.value=null},T=async()=>{var c,y,F,C;if(!a.value)return;const l=new FormData;l.append("file",a.value);try{const m=await axios.post(route("food-stock-balances.preview-import"),l,{});m.data.success?(o.value=m.data.preview,o.value.length>0&&(_.value=Object.keys(o.value[0]))):w.value={success:!1,message:m.data.message||"Preview failed",errors:m.data.errors||[]}}catch(m){w.value={success:!1,message:((y=(c=m.response)==null?void 0:c.data)==null?void 0:y.message)||"Preview failed",errors:((C=(F=m.response)==null?void 0:F.data)==null?void 0:C.errors)||[]},console.error("Preview failed:",m)}},N=async()=>{var c,y,F,C;if(!a.value)return;s.value=!0;const l=new FormData;l.append("file",a.value);try{const m=await axios.post(route("food-stock-balances.import"),l,{});w.value=m.data,m.data.success&&setTimeout(()=>{window.location.reload()},2e3)}catch(m){w.value={success:!1,message:((y=(c=m.response)==null?void 0:c.data)==null?void 0:y.message)||"Import failed",errors:((C=(F=m.response)==null?void 0:F.data)==null?void 0:C.errors)||[]}}finally{s.value=!1}},j=()=>{t.value=!1,a.value=null,o.value=[],_.value=[],w.value=null,k.value&&(k.value.value="")},W=l=>{n.id=l.id,n.product_id=l.product_id,n.warehouse_id=l.warehouse_id,n.quantity=l.quantity,n.unit_id=l.unit_id,n.batch_number=l.batch_number||"",n.expiry_date=l.expiry_date?l.expiry_date.split("T")[0]:"",n.notes=l.notes||"",v.value=!0},H=async()=>{var l,c;try{(await axios.put(route("food-stock-balances.update",n.id),n.data())).data.success&&(V(),window.location.reload())}catch(y){(c=(l=y.response)==null?void 0:l.data)!=null&&c.errors&&(n.errors=y.response.data.errors)}},V=()=>{v.value=!1,n.reset(),n.clearErrors()},O=async l=>{if(confirm("Are you sure you want to delete this stock balance?"))try{(await axios.delete(route("food-stock-balances.destroy",l.id))).data.success&&window.location.reload()}catch(c){console.error("Delete failed:",c)}};function Q(){g.value=!0,P(),setTimeout(()=>{g.value=!1},1e3)}return{showImportModal:t,selectedFile:a,previewData:o,previewHeaders:_,importResults:w,fileInput:k,form:h,filter:P,downloadTemplate:q,handleFileUpload:L,previewImport:T,processImport:N,closeImportModal:j,showEditModal:v,editForm:n,editBalance:W,updateBalance:H,closeEditModal:V,deleteBalance:O,formatDate:Y,importLoading:s,loadingReload:g,reloadData:Q}}},ee={class:"py-12"},te={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},oe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},se={class:"mb-6 flex justify-between items-center"},re={class:"flex space-x-4"},ie=["disabled"],de={key:0,class:"animate-spin mr-2"},le={key:1,class:"mr-2"},ae={class:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4"},ne=["value"],me=["value"],ue={class:"overflow-x-auto"},ce={class:"min-w-full divide-y divide-gray-200"},xe={class:"bg-white divide-y divide-gray-200"},fe={class:"px-6 py-4 whitespace-nowrap"},pe={class:"text-sm font-medium text-gray-900"},ge={class:"text-sm text-gray-500"},ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},we={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ve={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},_e={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},he={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Fe=["onClick"],Ce=["onClick"],De={class:"mt-4"},Ie={class:"p-6"},Be={class:"mb-4"},Me={key:0,class:"mb-4"},Se={class:"overflow-x-auto"},Re={class:"min-w-full divide-y divide-gray-200"},Ue={class:"bg-gray-50"},Ae={class:"bg-white divide-y divide-gray-200"},Pe={key:1,class:"mb-4"},Ve={class:"flex"},Ee={class:"flex-shrink-0"},qe={class:"ml-3"},Le={key:0,class:"mt-3"},Te={class:"bg-red-50 border border-red-200 rounded-md p-3"},Ne={class:"flex items-center mb-2"},je={class:"text-sm font-medium text-red-800"},We={class:"max-h-40 overflow-y-auto"},He={class:"space-y-2"},Oe={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 mr-2 flex-shrink-0"},Qe={class:"text-red-700"},ze={class:"mt-6 flex justify-end space-x-3"},Ge=["disabled"],Je={key:0},Ke={key:1},Xe={class:"p-6"},Ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ze=["value"],$e={key:0,class:"mt-1 text-sm text-red-600"},et=["value"],tt={key:0,class:"mt-1 text-sm text-red-600"},ot={key:0,class:"mt-1 text-sm text-red-600"},st=["value"],rt={key:0,class:"mt-1 text-sm text-red-600"},it={key:0,class:"mt-1 text-sm text-red-600"},dt={key:0,class:"mt-1 text-sm text-red-600"},lt={class:"md:col-span-2"},at={key:0,class:"mt-1 text-sm text-red-600"},nt={class:"mt-6 flex justify-end space-x-3"},mt=["disabled"];function ut(B,t,a,o,_,w){const k=R("Pagination"),v=R("Modal"),n=R("AppLayout");return r(),z(n,{title:"Saldo Awal Stok"},{header:M(()=>t[22]||(t[22]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Saldo Awal Stok ",-1)])),default:M(()=>[e("div",ee,[e("div",te,[e("div",oe,[e("div",se,[e("div",re,[e("button",{onClick:t[0]||(t[0]=(...s)=>o.downloadTemplate&&o.downloadTemplate(...s)),class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700"},t[23]||(t[23]=[e("i",{class:"fas fa-download mr-2"},null,-1),S(" Download Template ")])),e("button",{onClick:t[1]||(t[1]=s=>o.showImportModal=!0),class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700"},t[24]||(t[24]=[e("i",{class:"fas fa-file-import mr-2"},null,-1),S(" Import Data ")]))]),e("button",{onClick:t[2]||(t[2]=(...s)=>o.reloadData&&o.reloadData(...s)),disabled:o.loadingReload,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md font-semibold hover:bg-blue-700"},[o.loadingReload?(r(),i("span",de,t[25]||(t[25]=[e("i",{class:"fas fa-spinner"},null,-1)]))):(r(),i("span",le,t[26]||(t[26]=[e("i",{class:"fas fa-sync-alt"},null,-1)]))),t[27]||(t[27]=S(" Load Data "))],8,ie)]),e("div",ae,[e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Warehouse",-1)),x(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.filters.warehouse_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",onChange:t[4]||(t[4]=(...s)=>o.filter&&o.filter(...s))},[t[28]||(t[28]=e("option",{value:""},"All Warehouses",-1)),(r(!0),i(f,null,p(a.warehouses,s=>(r(),i("option",{key:s.id,value:s.id},d(s.name),9,ne))),128))],544),[[D,a.filters.warehouse_id]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700"},"Product",-1)),x(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.filters.product_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",onChange:t[6]||(t[6]=(...s)=>o.filter&&o.filter(...s))},[t[30]||(t[30]=e("option",{value:""},"All Products",-1)),(r(!0),i(f,null,p(a.products,s=>(r(),i("option",{key:s.id,value:s.id},d(s.name),9,me))),128))],544),[[D,a.filters.product_id]])]),e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700"},"Search",-1)),x(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=s=>a.filters.search=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Search by product name or code...",onInput:t[8]||(t[8]=(...s)=>o.filter&&o.filter(...s))},null,544),[[I,a.filters.search]])])]),e("div",ue,[e("table",ce,[t[33]||(t[33]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Product"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Warehouse"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Quantity"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Unit"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Batch Number"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Expiry Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Created By"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",xe,[(r(!0),i(f,null,p(a.stockBalances.data,s=>(r(),i("tr",{key:s.id},[e("td",fe,[e("div",pe,d(s.product.name),1),e("div",ge,d(s.product.code),1)]),e("td",ye,d(s.warehouse.name),1),e("td",be,d(s.quantity),1),e("td",we,d(s.unit.name),1),e("td",ve,d(s.batch_number),1),e("td",_e,d(s.expiry_date?o.formatDate(s.expiry_date):"-"),1),e("td",ke,d(s.creator.name),1),e("td",he,[e("button",{onClick:g=>o.editBalance(s),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,Fe),e("button",{onClick:g=>o.deleteBalance(s),class:"text-red-600 hover:text-red-900"}," Delete ",8,Ce)])]))),128))])])]),e("div",De,[U(k,{links:a.stockBalances.links},null,8,["links"])])])])]),U(v,{show:o.showImportModal,onClose:o.closeImportModal},{default:M(()=>[e("div",Ie,[t[38]||(t[38]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Import Stock Balance",-1)),e("div",Be,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-gray-700"},"Select File",-1)),e("input",{type:"file",ref:"fileInput",onChange:t[9]||(t[9]=(...s)=>o.handleFileUpload&&o.handleFileUpload(...s)),accept:".xlsx,.xls",class:"mt-1 block w-full"},null,544)]),o.previewData.length>0?(r(),i("div",Me,[t[35]||(t[35]=e("h3",{class:"text-md font-medium text-gray-900 mb-2"},"Preview Data",-1)),e("div",Se,[e("table",Re,[e("thead",Ue,[e("tr",null,[(r(!0),i(f,null,p(o.previewHeaders,s=>(r(),i("th",{key:s,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},d(s),1))),128))])]),e("tbody",Ae,[(r(!0),i(f,null,p(o.previewData,(s,g)=>(r(),i("tr",{key:g},[(r(!0),i(f,null,p(o.previewHeaders,h=>(r(),i("td",{key:h,class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},d(s[h]),1))),128))]))),128))])])])])):u("",!0),o.importResults?(r(),i("div",Pe,[e("div",{class:A(["rounded-md p-4",o.importResults.success?"bg-green-50":"bg-red-50"])},[e("div",Ve,[e("div",Ee,[e("i",{class:A(o.importResults.success?"fas fa-check-circle text-green-400":"fas fa-exclamation-circle text-red-400")},null,2)]),e("div",qe,[e("h3",{class:A(["text-sm font-medium",o.importResults.success?"text-green-800":"text-red-800"])},d(o.importResults.message),3),o.importResults.errors&&o.importResults.errors.length>0?(r(),i("div",Le,[e("div",Te,[e("div",Ne,[t[36]||(t[36]=e("i",{class:"fas fa-exclamation-triangle text-red-500 mr-2"},null,-1)),e("span",je,d(o.importResults.errors.length)+" error ditemukan: ",1)]),e("div",We,[e("ul",He,[(r(!0),i(f,null,p(o.importResults.errors,(s,g)=>(r(),i("li",{key:g,class:"flex items-start text-sm"},[e("span",Oe," Row "+d(s.row),1),e("span",Qe,d(s.error),1)]))),128))])])])])):u("",!0)])])],2)])):u("",!0),e("div",ze,[e("button",{onClick:t[10]||(t[10]=(...s)=>o.closeImportModal&&o.closeImportModal(...s)),class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25"}," Cancel "),o.selectedFile&&!o.importResults?(r(),i("button",{key:0,onClick:t[11]||(t[11]=(...s)=>o.previewImport&&o.previewImport(...s)),class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700"}," Preview ")):u("",!0),o.selectedFile&&!o.importResults?(r(),i("button",{key:1,onClick:t[12]||(t[12]=(...s)=>o.processImport&&o.processImport(...s)),class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700",disabled:o.importLoading},[o.importLoading?(r(),i("span",Je,t[37]||(t[37]=[e("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),S(" Importing... ")]))):(r(),i("span",Ke," Import "))],8,Ge)):u("",!0)])])]),_:1},8,["show","onClose"]),U(v,{show:o.showEditModal,onClose:o.closeEditModal},{default:M(()=>[e("div",Xe,[t[49]||(t[49]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Stock Balance",-1)),e("form",{onSubmit:t[21]||(t[21]=G((...s)=>o.updateBalance&&o.updateBalance(...s),["prevent"]))},[e("div",Ye,[e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-gray-700"},"Product",-1)),x(e("select",{"onUpdate:modelValue":t[13]||(t[13]=s=>o.editForm.product_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[39]||(t[39]=e("option",{value:""},"Select Product",-1)),(r(!0),i(f,null,p(a.products,s=>(r(),i("option",{key:s.id,value:s.id},d(s.name)+" ("+d(s.code)+") ",9,Ze))),128))],512),[[D,o.editForm.product_id]]),o.editForm.errors.product_id?(r(),i("div",$e,d(o.editForm.errors.product_id),1)):u("",!0)]),e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700"},"Warehouse",-1)),x(e("select",{"onUpdate:modelValue":t[14]||(t[14]=s=>o.editForm.warehouse_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[41]||(t[41]=e("option",{value:""},"Select Warehouse",-1)),(r(!0),i(f,null,p(a.warehouses,s=>(r(),i("option",{key:s.id,value:s.id},d(s.name),9,et))),128))],512),[[D,o.editForm.warehouse_id]]),o.editForm.errors.warehouse_id?(r(),i("div",tt,d(o.editForm.errors.warehouse_id),1)):u("",!0)]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700"},"Quantity",-1)),x(e("input",{type:"number","onUpdate:modelValue":t[15]||(t[15]=s=>o.editForm.quantity=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",min:"0",step:"0.01",required:""},null,512),[[I,o.editForm.quantity]]),o.editForm.errors.quantity?(r(),i("div",ot,d(o.editForm.errors.quantity),1)):u("",!0)]),e("div",null,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-gray-700"},"Unit",-1)),x(e("select",{"onUpdate:modelValue":t[16]||(t[16]=s=>o.editForm.unit_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[44]||(t[44]=e("option",{value:""},"Select Unit",-1)),(r(!0),i(f,null,p(a.units,s=>(r(),i("option",{key:s.id,value:s.id},d(s.name),9,st))),128))],512),[[D,o.editForm.unit_id]]),o.editForm.errors.unit_id?(r(),i("div",rt,d(o.editForm.errors.unit_id),1)):u("",!0)]),e("div",null,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-gray-700"},"Batch Number",-1)),x(e("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=s=>o.editForm.batch_number=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[I,o.editForm.batch_number]]),o.editForm.errors.batch_number?(r(),i("div",it,d(o.editForm.errors.batch_number),1)):u("",!0)]),e("div",null,[t[47]||(t[47]=e("label",{class:"block text-sm font-medium text-gray-700"},"Expiry Date",-1)),x(e("input",{type:"date","onUpdate:modelValue":t[18]||(t[18]=s=>o.editForm.expiry_date=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[I,o.editForm.expiry_date]]),o.editForm.errors.expiry_date?(r(),i("div",dt,d(o.editForm.errors.expiry_date),1)):u("",!0)]),e("div",lt,[t[48]||(t[48]=e("label",{class:"block text-sm font-medium text-gray-700"},"Notes",-1)),x(e("textarea",{"onUpdate:modelValue":t[19]||(t[19]=s=>o.editForm.notes=s),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[I,o.editForm.notes]]),o.editForm.errors.notes?(r(),i("div",at,d(o.editForm.errors.notes),1)):u("",!0)])]),e("div",nt,[e("button",{type:"button",onClick:t[20]||(t[20]=(...s)=>o.closeEditModal&&o.closeEditModal(...s)),class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25"}," Cancel "),e("button",{type:"submit",class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25",disabled:o.editForm.processing},d(o.editForm.processing?"Saving...":"Save Changes"),9,mt)])],32)])]),_:1},8,["show","onClose"])]),_:1})}const Ct=Z($,[["render",ut]]);export{Ct as default};
