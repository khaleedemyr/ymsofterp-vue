import{r as l,c as _,a as A,j as U,a8 as S,A as D,B as d,C as B,D as t,G as T,H as M,I,N as a,x as L,L as u,E as j,F as z,M as C}from"./vendor-vue-g7iCcTkf.js";import{A as E}from"./AppLayout-BpSu8nlk.js";import{a as F}from"./vendor-utils-CpgP2uT4.js";import"./app-C7BJ3pFi.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DDWCBsJM.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const N={class:"max-w-7xl mx-auto py-8 px-4"},q={class:"flex justify-between items-center mb-6"},V={class:"flex items-center gap-4"},W={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},$={class:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500"},J={class:"flex items-center justify-between"},P={class:"text-3xl font-bold text-gray-900 mt-2"},G={class:"text-xs text-gray-500 mt-1"},R={class:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-500"},H={class:"flex items-center justify-between"},O={class:"text-3xl font-bold text-gray-900 mt-2"},Y={class:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-purple-500"},K={class:"flex items-center justify-between"},Q={class:"text-3xl font-bold text-gray-900 mt-2"},X={class:"text-xs text-gray-500 mt-1"},Z={class:"bg-white rounded-xl shadow-lg p-6 mb-8"},tt={class:"flex justify-between items-center mb-4"},et={class:"text-sm text-gray-500"},st={class:"mt-4"},at={class:"bg-white rounded-xl shadow-lg overflow-hidden"},ot={class:"px-6 py-4 border-b border-gray-200"},it={class:"text-sm text-gray-600 mt-1"},lt={class:"overflow-x-auto"},rt={class:"min-w-full divide-y divide-gray-200"},nt={class:"bg-white divide-y divide-gray-200"},dt={key:0},ut={key:1},ct={class:"px-6 py-4 whitespace-nowrap"},pt={class:"flex items-center"},xt=["src","alt"],mt={class:"text-sm font-medium text-gray-900"},gt={class:"text-xs text-gray-500"},ft={class:"px-6 py-4 whitespace-nowrap"},vt={class:"text-sm text-gray-900"},_t={class:"px-6 py-4 whitespace-nowrap"},yt={class:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full"},ht={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},bt={class:"px-6 py-4 whitespace-nowrap"},wt={class:"text-sm text-gray-900"},kt={class:"text-xs text-gray-500"},Ct={__name:"ActiveUsers",setup(At){const c=l({total_active_sessions:0,unique_active_users:0,time_window_minutes:30}),p=l([]),x=l([]),r=l(null),n=l(30),m=l(!0),v=l("");let g=null;const y=_(()=>[{name:"Active Users",data:x.value.map(s=>s.count)}]),h=_(()=>({chart:{type:"line",height:350,toolbar:{show:!0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0}},animations:{enabled:!0,easing:"easeinout",speed:800,animateGradually:{enabled:!0,delay:150},dynamicAnimation:{enabled:!0,speed:350}},dropShadow:{enabled:!0,top:4,left:2,blur:8,opacity:.18}},stroke:{width:4,curve:"smooth",colors:["#3B82F6"]},markers:{size:5,colors:["#fff"],strokeColors:["#3B82F6"],strokeWidth:3,hover:{size:8}},fill:{type:"gradient",gradient:{shade:"light",type:"vertical",shadeIntensity:.5,gradientToColors:["#3B82F6"],inverseColors:!1,opacityFrom:.8,opacityTo:.3,stops:[0,90,100]}},xaxis:{categories:x.value.map(s=>s.time),labels:{style:{fontSize:"12px",fontWeight:600}}},yaxis:{title:{text:"Jumlah User"},min:0,labels:{style:{fontSize:"12px",fontWeight:600},formatter:s=>s.toLocaleString("id-ID")}},colors:["#3B82F6"],grid:{borderColor:"#E5E7EB",strokeDashArray:4,xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}}},tooltip:{theme:"light",shared:!0,intersect:!1,y:{formatter:s=>s+" user"}},dataLabels:{enabled:!0,style:{fontSize:"12px",fontWeight:600,colors:["#3B82F6"]},offsetY:-5},legend:{show:!1},noData:{text:"Tidak ada data",align:"center",verticalAlign:"middle",style:{color:"#999",fontSize:"14px",fontFamily:void 0}},states:{hover:{filter:{type:"lighten",value:.15}},active:{allowMultipleDataPointsSelection:!1,filter:{type:"darken",value:.35}}},responsive:[{breakpoint:480,options:{chart:{height:300}}}]}));A(()=>{f(),g=setInterval(()=>{f()},5e3)}),U(()=>{g&&clearInterval(g)});function f(){m.value=!0,F.get("/api/monitoring/active-users/stats",{params:{time_window:n.value}}).then(s=>{if(s.data.success){const e=s.data.data;c.value={total_active_sessions:e.total_active_sessions,unique_active_users:e.unique_active_users,time_window_minutes:e.time_window_minutes},p.value=e.active_sessions||[],x.value=e.chart_data||[],r.value=e.peak_time,v.value=e.updated_at}}).catch(s=>{console.error("Error loading stats:",s)}).finally(()=>{m.value=!1})}function b(s){return s?new Date(s).toLocaleString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}function w(s){if(!s)return"-";const i=Math.floor(Date.now()/1e3)-s;return i<60?`${i} detik lalu`:i<3600?`${Math.floor(i/60)} menit lalu`:i<86400?`${Math.floor(i/3600)} jam lalu`:`${Math.floor(i/86400)} hari lalu`}function k(s){s.target.src="/img/default-avatar.png"}return(s,e)=>{const i=S("apexchart");return d(),D(E,null,{default:B(()=>[t("div",N,[t("div",q,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900 flex items-center gap-3"},[t("i",{class:"fa-solid fa-users text-blue-600"}),T(" Monitoring User Aktif ")]),t("p",{class:"text-gray-600 mt-1"},"Real-time monitoring aktifitas user di sistem")],-1)),t("div",V,[e[2]||(e[2]=t("div",{class:"flex items-center gap-2 bg-green-50 px-4 py-2 rounded-lg"},[t("div",{class:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),t("span",{class:"text-sm font-semibold text-green-700"},"Live")],-1)),M(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),onChange:f,class:"border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},e[1]||(e[1]=[t("option",{value:15},"15 Menit",-1),t("option",{value:30},"30 Menit",-1),t("option",{value:60},"1 Jam",-1),t("option",{value:120},"2 Jam",-1)]),544),[[I,n.value]])])]),t("div",W,[t("div",$,[t("div",J,[t("div",null,[e[4]||(e[4]=t("p",{class:"text-gray-600 text-sm font-medium"},"Total Active Sessions",-1)),t("p",P,a(c.value.total_active_sessions||0),1),t("p",G,"Sesi aktif dalam "+a(n.value)+" menit terakhir",1)]),e[5]||(e[5]=t("div",{class:"bg-blue-100 p-4 rounded-full"},[t("i",{class:"fa-solid fa-network-wired text-blue-600 text-2xl"})],-1))])]),t("div",R,[t("div",H,[t("div",null,[e[6]||(e[6]=t("p",{class:"text-gray-600 text-sm font-medium"},"Unique Active Users",-1)),t("p",O,a(c.value.unique_active_users||0),1),e[7]||(e[7]=t("p",{class:"text-xs text-gray-500 mt-1"},"User unik yang sedang aktif",-1))]),e[8]||(e[8]=t("div",{class:"bg-green-100 p-4 rounded-full"},[t("i",{class:"fa-solid fa-user-check text-green-600 text-2xl"})],-1))])]),t("div",Y,[t("div",K,[t("div",null,[e[9]||(e[9]=t("p",{class:"text-gray-600 text-sm font-medium"},"Peak Time Today",-1)),t("p",Q,a(r.value?r.value.formatted:"-"),1),t("p",X,a(r.value?`${r.value.count} sessions`:"No data"),1)]),e[10]||(e[10]=t("div",{class:"bg-purple-100 p-4 rounded-full"},[t("i",{class:"fa-solid fa-clock text-purple-600 text-2xl"})],-1))])])]),t("div",Z,[t("div",tt,[e[11]||(e[11]=t("h2",{class:"text-xl font-bold text-gray-900"},"Trend Active Users (Real-time)",-1)),t("span",et,"Updated: "+a(v.value||"Loading..."),1)]),t("div",st,[L(i,{type:"line",options:h.value,series:y.value,height:"350"},null,8,["options","series"])])]),t("div",at,[t("div",ot,[e[12]||(e[12]=t("h2",{class:"text-xl font-bold text-gray-900"},"Daftar User Aktif",-1)),t("p",it,"User yang sedang aktif dalam "+a(n.value)+" menit terakhir",1)]),t("div",lt,[t("table",rt,[e[15]||(e[15]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider"},"User"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider"},"Email"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider"},"Browser"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider"},"IP Address"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider"},"Last Activity")])],-1)),t("tbody",nt,[m.value?(d(),u("tr",dt,e[13]||(e[13]=[t("td",{colspan:"5",class:"px-6 py-8 text-center"},[t("div",{class:"flex justify-center items-center"},[t("i",{class:"fa fa-spinner fa-spin text-blue-600 text-2xl mr-3"}),t("span",{class:"text-gray-600"},"Loading...")])],-1)]))):p.value.length===0?(d(),u("tr",ut,e[14]||(e[14]=[t("td",{colspan:"5",class:"px-6 py-8 text-center text-gray-500"}," Tidak ada user aktif ",-1)]))):j("",!0),(d(!0),u(z,null,C(p.value,o=>(d(),u("tr",{key:o.session_id,class:"hover:bg-gray-50"},[t("td",ct,[t("div",pt,[t("img",{src:o.user_avatar||"/img/default-avatar.png",alt:o.user_name,class:"h-10 w-10 rounded-full mr-3 object-cover",onError:k},null,40,xt),t("div",null,[t("div",mt,a(o.user_name),1),t("div",gt,"ID: "+a(o.user_id),1)])])]),t("td",ft,[t("div",vt,a(o.user_email),1)]),t("td",_t,[t("span",yt,a(o.user_agent),1)]),t("td",ht,a(o.ip_address),1),t("td",bt,[t("div",wt,a(b(o.last_activity)),1),t("div",kt,a(w(o.last_activity_timestamp)),1)])]))),128))])])])])])]),_:1})}}};export{Ct as default};
