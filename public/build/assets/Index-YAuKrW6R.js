import{r as S,c as y,w as P,W as c,A as U,B as o,C as E,D as e,G as d,O as G,H as b,J as h,I as Y,L as r,N as i,E as m,F as W,M,l as v}from"./vendor-vue-g7iCcTkf.js";import{A as z}from"./AppLayout-DQ4wNTsP.js";import{S as _}from"./app-DAB8i6cE.js";import{l as J}from"./lodash-DB3HVzpp.js";import"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CinBCb2E.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const q={class:"max-w-7xl mx-auto py-8 px-2"},K={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},Q={class:"flex justify-between items-center mt-4"},X={class:"text-sm text-gray-600"},Z={key:0,class:"text-blue-600 font-medium"},ee={key:1,class:"text-gray-500"},te={class:"flex gap-2"},ae={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},se={class:"flex justify-between items-center"},le={class:"text-sm text-blue-800"},oe={key:0,class:"ml-2 font-medium"},re={key:0,class:"text-xs text-blue-600"},ie={class:"bg-white rounded-xl shadow-lg overflow-hidden"},ne={class:"overflow-x-auto"},de={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-white divide-y divide-gray-200"},pe={key:0},ce={class:"px-6 py-3"},me={class:"px-6 py-3"},fe={class:"px-6 py-3"},xe={class:"px-6 py-3"},be={class:"px-6 py-3"},ge={class:"px-6 py-3"},ye={class:"px-6 py-3 text-right"},he={class:"px-6 py-3"},ve={class:"px-6 py-3"},_e=["onClick"],ke=["onClick","disabled"],we={key:0},Ce={key:1},De={key:1,class:"inline-flex items-center text-xs text-gray-400 ml-2",title:"Hanya admin yang dapat menghapus transaksi"},Fe={class:"flex justify-end mt-4 gap-2"},Te=["disabled","onClick","innerHTML"],Ie={__name:"Index",props:{user:Object,retailWarehouseFoods:Object,filters:Object,canDelete:Boolean},setup(H){var C,D,F,T;const n=H,f=S(null),l=S({search:((C=n.filters)==null?void 0:C.search)||"",date_from:((D=n.filters)==null?void 0:D.date_from)||"",date_to:((F=n.filters)==null?void 0:F.date_to)||"",payment_method:((T=n.filters)==null?void 0:T.payment_method)||""}),x=y(()=>l.value.search||l.value.date_from||l.value.date_to||l.value.payment_method),k=y(()=>{let s=0;return l.value.search&&s++,l.value.date_from&&s++,l.value.date_to&&s++,l.value.payment_method&&s++,s}),w=y(()=>n.canDelete),j=J.debounce(()=>{g()},500);P(()=>l.value.search,()=>{j()});function g(){const s={};l.value.search&&(s.search=l.value.search),l.value.date_from&&(s.date_from=l.value.date_from),l.value.date_to&&(s.date_to=l.value.date_to),l.value.payment_method&&(s.payment_method=l.value.payment_method),c.get("/retail-warehouse-food",s,{preserveState:!0,replace:!0})}function L(){l.value={search:"",date_from:"",date_to:"",payment_method:""},c.get("/retail-warehouse-food",{},{preserveState:!0,replace:!0})}function N(){c.visit("/retail-warehouse-food/create")}function V(s){c.visit(`/retail-warehouse-food/${s}`)}function A(s){s&&c.visit(s,{preserveState:!0,replace:!0})}async function $(s){var a,p;if((await _.fire({title:"Hapus Transaksi?",text:`Yakin ingin menghapus transaksi ${s.retail_number}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed){f.value=s.id;try{const u=await axios.delete(`/retail-warehouse-food/${s.id}`);u.data&&u.data.message&&(_.fire({icon:"success",title:"Berhasil",text:u.data.message,timer:1500,showConfirmButton:!1}),setTimeout(()=>c.reload(),1200))}catch(u){_.fire({icon:"error",title:"Gagal",text:((p=(a=u.response)==null?void 0:a.data)==null?void 0:p.message)||"Gagal menghapus transaksi"})}finally{f.value=null}}}function I(s){return s?new Date(s).toLocaleDateString("id-ID"):"-"}function R(s){return s?"Rp "+Number(s).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}):"Rp 0"}return(s,t)=>(o(),U(z,null,{default:E(()=>[e("div",q,[e("div",{class:"flex justify-between items-center mb-6"},[t[4]||(t[4]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-warehouse text-blue-500"}),d(" Warehouse Retail Food ")],-1)),e("button",{onClick:N,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Tambah Baru ")]),e("div",K,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},[e("i",{class:"fa-solid fa-filter text-blue-500"}),d(" Filter Data ")],-1)),e("form",{onSubmit:G(g,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},[e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Cari",-1)),b(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>l.value.search=a),placeholder:"No. transaksi, supplier, warehouse...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[h,l.value.search]])]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Dari",-1)),b(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=a=>l.value.date_from=a),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[h,l.value.date_from]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Sampai",-1)),b(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=a=>l.value.date_to=a),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[h,l.value.date_to]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Metode Pembayaran",-1)),b(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>l.value.payment_method=a),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},t[8]||(t[8]=[e("option",{value:""},"Semua",-1),e("option",{value:"cash"},"Cash",-1),e("option",{value:"contra_bon"},"Contra Bon",-1)]),512),[[Y,l.value.payment_method]])])],32),e("div",Q,[e("div",X,[x.value?(o(),r("span",Z," Filter aktif: "+i(k.value),1)):(o(),r("span",ee," Tidak ada filter aktif "))]),e("div",te,[x.value?(o(),r("button",{key:0,onClick:L,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 transition-colors"},t[10]||(t[10]=[e("i",{class:"fa-solid fa-times mr-1"},null,-1),d(" Reset Filter ")]))):m("",!0),e("button",{onClick:g,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-blue-600 rounded-lg hover:bg-blue-700 transition-colors"},t[11]||(t[11]=[e("i",{class:"fa-solid fa-search mr-1"},null,-1),d(" Terapkan Filter ")]))])])]),e("div",ae,[e("div",se,[e("div",le,[t[13]||(t[13]=e("i",{class:"fa-solid fa-info-circle mr-1"},null,-1)),d(" Menampilkan "+i(n.retailWarehouseFoods.data.length)+" dari "+i(n.retailWarehouseFoods.total)+" transaksi ",1),x.value?(o(),r("span",oe," (dengan filter aktif) ")):m("",!0)]),x.value?(o(),r("div",re,[t[14]||(t[14]=e("i",{class:"fa-solid fa-filter mr-1"},null,-1)),d(" Filter: "+i(k.value)+" aktif ",1)])):m("",!0)])]),e("div",ie,[e("div",ne,[e("table",de,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Tanggal"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"No. Transaksi"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Warehouse"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Warehouse Division"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Supplier"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Metode Pembayaran"),e("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Total"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Aksi")])],-1)),e("tbody",ue,[n.retailWarehouseFoods.data.length?m("",!0):(o(),r("tr",pe,t[15]||(t[15]=[e("td",{colspan:"9",class:"text-center py-10 text-gray-400"},"Tidak ada data.",-1)]))),(o(!0),r(W,null,M(n.retailWarehouseFoods.data,a=>{var p,u,B;return o(),r("tr",{key:a.id},[e("td",ce,i(I(a.transaction_date)),1),e("td",me,i(a.retail_number),1),e("td",fe,i(((p=a.warehouse)==null?void 0:p.name)||a.warehouse_name||"-"),1),e("td",xe,i(((u=a.warehouse_division)==null?void 0:u.name)||a.warehouse_division_name||"-"),1),e("td",be,i(((B=a.supplier)==null?void 0:B.name)||a.supplier_name||"-"),1),e("td",ge,[e("span",{class:v({"px-2 py-1 text-xs font-semibold rounded-full":!0,"bg-green-100 text-green-800":a.payment_method==="cash","bg-blue-100 text-blue-800":a.payment_method==="contra_bon"})},i(a.payment_method==="cash"?"Cash":"Contra Bon"),3)]),e("td",ye,i(R(a.total_amount)),1),e("td",he,[e("span",{class:v({"px-2 py-1 text-xs font-semibold rounded-full":!0,"bg-yellow-100 text-yellow-800":a.status==="draft","bg-green-100 text-green-800":a.status==="approved"})},i(a.status==="draft"?"Draft":"Approved"),3)]),e("td",ve,[e("button",{class:"inline-flex items-center btn btn-xs bg-blue-100 text-blue-800 hover:bg-blue-200 rounded px-2 py-1 font-semibold transition",onClick:O=>V(a.id)},t[16]||(t[16]=[e("i",{class:"fa fa-eye mr-1"},null,-1),d(" Detail ")]),8,_e),w.value?(o(),r("button",{key:0,class:"inline-flex items-center btn btn-xs bg-red-100 text-red-700 hover:bg-red-200 rounded px-2 py-1 font-semibold transition ml-2",onClick:O=>$(a),disabled:f.value===a.id,title:"Hapus transaksi"},[f.value===a.id?(o(),r("span",we,t[17]||(t[17]=[e("i",{class:"fa fa-spinner fa-spin mr-1"},null,-1),d(" Menghapus...")]))):(o(),r("span",Ce,t[18]||(t[18]=[e("i",{class:"fa fa-trash mr-1"},null,-1),d(" Hapus")])))],8,ke)):w.value?m("",!0):(o(),r("span",De,t[19]||(t[19]=[e("i",{class:"fa fa-lock mr-1"},null,-1),d(" Hapus ")])))])])}),128))])])])]),e("div",Fe,[(o(!0),r(W,null,M(n.retailWarehouseFoods.links,a=>(o(),r("button",{key:a.label,disabled:!a.url,onClick:p=>A(a.url),innerHTML:a.label,class:v(["px-3 py-1 rounded-lg border text-sm font-semibold",[a.active?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-700 hover:bg-blue-50",a.url?"cursor-pointer":"opacity-50 cursor-not-allowed"]])},null,10,Te))),128))])])]),_:1}))}};export{Ie as default};
