import{k as U,r as k,A as G,B as l,C as E,D as t,G as n,O as H,H as h,J as C,L as r,E as _,F as v,M as B,l as J,N as a,x as K,Q as q,X as Q,W as V}from"./vendor-vue-g7iCcTkf.js";import{A as W}from"./AppLayout-cjLApVXh.js";import{s as Y}from"./vue-multiselect.esm-V-bx43V9.js";import{S as g}from"./app-vFC8Iw15.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./ProfileUpdateModal-pwkt9lfN.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const X={class:"py-6 px-4 sm:px-6 lg:px-8"},Z={class:"bg-white rounded-2xl shadow-lg border border-gray-100 p-6 mb-6"},tt={class:"space-y-1"},et={class:"space-y-1"},st={class:"space-y-1"},ot={class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},at={class:"overflow-x-auto"},lt={class:"min-w-full divide-y divide-gray-200"},rt={class:"bg-white divide-y divide-gray-200"},it={key:0},nt={class:"hover:bg-blue-50 transition-colors duration-150"},dt={class:"px-3 py-4 text-center"},ct=["onClick"],xt={class:"px-6 py-4 whitespace-nowrap"},pt={class:"text-sm font-semibold text-blue-600"},ut={class:"text-xs text-gray-500"},gt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700"},mt={class:"px-6 py-4 whitespace-nowrap"},bt={class:"text-sm font-medium text-gray-900"},yt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700"},ft={class:"px-6 py-4 whitespace-nowrap"},ht={class:"text-sm text-gray-700"},_t={class:"text-xs text-gray-500"},vt={class:"px-6 py-4 whitespace-nowrap text-right"},wt={class:"text-sm font-bold text-gray-900"},kt={class:"px-6 py-4"},Ct={key:0},Bt={key:1,class:"space-y-1"},jt={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-3"},Tt={class:"flex items-center gap-2 mb-2"},Ft={class:"px-2 py-1 text-xs font-semibold rounded bg-blue-100 text-blue-800"},Nt={class:"text-xs text-gray-700 space-y-1"},St={class:"flex items-start"},Dt={class:"flex-1"},At={class:"flex items-start"},Jt={class:"flex-1"},Vt={key:1,class:"text-sm text-gray-500 italic"},Ot={class:"px-6 py-4 whitespace-nowrap text-center"},Rt=["onClick","disabled"],Pt={key:0},$t={key:1},Lt=["onClick","disabled"],Mt={key:0},It={key:1},Ut={class:"bg-gray-50"},Gt={colspan:"10",class:"px-6 py-4"},Et={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},Ht={class:"overflow-x-auto"},Kt={class:"min-w-full divide-y divide-gray-200"},qt={class:"divide-y divide-gray-200"},Qt={class:"px-4 py-2 text-sm text-gray-600"},Wt={class:"px-4 py-2 text-sm text-gray-900 font-medium"},Yt={class:"px-4 py-2 text-sm text-gray-600 text-center"},zt={class:"px-4 py-2 text-sm text-gray-600 text-center"},Xt={class:"px-4 py-2 text-sm text-gray-600 text-right"},Zt={class:"px-4 py-2 text-sm font-semibold text-gray-900 text-right"},te={key:0},ee={class:"bg-gray-50"},se={class:"px-4 py-2 text-sm font-bold text-gray-900 text-right"},oe={key:0,class:"mt-3 pt-3 border-t border-gray-200"},ae={class:"text-sm text-gray-700"},le={key:0,class:"bg-gray-50 px-6 py-4 border-t border-gray-200"},re={class:"flex items-center justify-between"},ie={class:"text-sm text-gray-700"},ne={class:"font-semibold"},de={class:"font-semibold"},ce={class:"font-semibold"},xe={class:"flex gap-2"},pe=["onClick","disabled","innerHTML"],ue={__name:"Index",props:{user:Object,retailNonFoods:Object,coas:Array,filters:Object},setup(u){const y=u,c=U({search:y.filters.search||"",date_from:y.filters.date_from||"",date_to:y.filters.date_to||""}),m=k({}),x=k({}),f=k({}),O=o=>{f.value[o]=!f.value[o]},w=()=>{V.get(route("retail-non-food-payment.index"),c,{preserveState:!0,preserveScroll:!0})},R=()=>{c.search="",c.date_from="",c.date_to="",w()},P=o=>{o&&V.get(o,{},{preserveState:!0,preserveScroll:!0})},$=async o=>{var s,p;if(!m.value[o.id]){g.fire({icon:"warning",title:"COA Belum Dipilih",text:"Silakan pilih COA terlebih dahulu",confirmButtonColor:"#3b82f6"});return}if((await g.fire({title:"Konfirmasi Buat Jurnal",html:`
      <div class="text-left">
        <p><strong>Transaksi:</strong> ${o.retail_number}</p>
        <p><strong>Total:</strong> ${b(o.total_amount)}</p>
        <p><strong>COA:</strong> ${m.value[o.id].display_name}</p>
      </div>
    `,icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Buat Jurnal",cancelButtonText:"Batal"})).isConfirmed){x.value[o.id]=!0;try{const i=await axios.post(route("retail-non-food-payment.store"),{retail_non_food_id:o.id,coa_id:m.value[o.id].id});x.value[o.id]=!1,await g.fire({icon:"success",title:"Berhasil!",text:i.data.message||"Jurnal berhasil dibuat",confirmButtonColor:"#3b82f6"}),window.location.reload()}catch(i){console.error("Error creating jurnal:",i),x.value[o.id]=!1,await g.fire({icon:"error",title:"Gagal!",text:((p=(s=i.response)==null?void 0:s.data)==null?void 0:p.message)||"Gagal membuat jurnal",confirmButtonColor:"#3b82f6"})}}},L=async o=>{var s,p;if((await g.fire({title:"Konfirmasi Rollback Jurnal",html:`
      <div class="text-left">
        <p><strong>Transaksi:</strong> ${o.retail_number}</p>
        <p><strong>Total:</strong> ${b(o.total_amount)}</p>
        <p class="text-red-600 mt-2"><strong>Perhatian:</strong> Jurnal akan dihapus dan transaksi dapat di-posting ulang</p>
      </div>
    `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Rollback",cancelButtonText:"Batal"})).isConfirmed){x.value[o.id]=!0;try{const i=await axios.post(route("retail-non-food-payment.rollback"),{retail_non_food_id:o.id});x.value[o.id]=!1,await g.fire({icon:"success",title:"Berhasil!",text:i.data.message||"Jurnal berhasil di-rollback",confirmButtonColor:"#3b82f6"}),window.location.reload()}catch(i){console.error("Error rollback jurnal:",i),x.value[o.id]=!1,await g.fire({icon:"error",title:"Gagal!",text:((p=(s=i.response)==null?void 0:s.data)==null?void 0:p.message)||"Gagal rollback jurnal",confirmButtonColor:"#3b82f6"})}}},M=o=>o?new Date(o).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",b=o=>o?"Rp "+parseFloat(o).toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0}):"Rp 0";return(o,e)=>(l(),G(W,null,{default:E(()=>[t("div",X,[e[26]||(e[26]=t("div",{class:"mb-8"},[t("div",{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-2"},[t("div",null,[t("h1",{class:"text-3xl font-bold text-gray-900 flex items-center gap-3"},[t("div",{class:"p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg"},[t("i",{class:"fa-solid fa-money-bill-wave text-white text-xl"})]),t("span",null,"Retail Non Food Payment")]),t("p",{class:"text-sm text-gray-500 mt-1 ml-14"},"Payment untuk transaksi retail non food (cash)")])])],-1)),t("div",Z,[e[8]||(e[8]=t("div",{class:"flex items-center justify-between mb-6"},[t("h3",{class:"text-lg font-bold text-gray-800 flex items-center gap-2"},[t("div",{class:"p-1.5 bg-blue-100 rounded-lg"},[t("i",{class:"fa-solid fa-filter text-blue-600"})]),n(" Filter Data ")])],-1)),t("form",{onSubmit:H(w,["prevent"]),class:"grid grid-cols-1 md:grid-cols-3 gap-4"},[t("div",tt,[e[3]||(e[3]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-1"},[t("i",{class:"fa-solid fa-search mr-1 text-gray-400"}),n("Cari ")],-1)),h(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>c.search=s),placeholder:"No. transaksi, outlet, supplier...",class:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-gray-50 hover:bg-white"},null,512),[[C,c.search]])]),t("div",et,[e[4]||(e[4]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-1"},[t("i",{class:"fa-solid fa-calendar-alt mr-1 text-gray-400"}),n("Tanggal Dari ")],-1)),h(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>c.date_from=s),class:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-gray-50 hover:bg-white"},null,512),[[C,c.date_from]])]),t("div",st,[e[5]||(e[5]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-1"},[t("i",{class:"fa-solid fa-calendar-check mr-1 text-gray-400"}),n("Tanggal Sampai ")],-1)),h(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>c.date_to=s),class:"w-full px-4 py-2.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-gray-50 hover:bg-white"},null,512),[[C,c.date_to]])])],32),t("div",{class:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200"},[t("button",{onClick:R,class:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-gray-700 bg-gray-100 border-2 border-gray-200 rounded-xl hover:bg-gray-200 hover:border-gray-300 transition-all duration-200"},e[6]||(e[6]=[t("i",{class:"fa-solid fa-times"},null,-1),n(" Reset Filter ")])),t("button",{onClick:w,class:"inline-flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl hover:from-blue-600 hover:to-blue-700 shadow-md hover:shadow-lg transition-all duration-200 transform hover:-translate-y-0.5"},e[7]||(e[7]=[t("i",{class:"fa-solid fa-search"},null,-1),n(" Terapkan Filter ")]))])]),t("div",ot,[t("div",at,[t("table",lt,[e[21]||(e[21]=t("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[t("tr",null,[t("th",{scope:"col",class:"px-3 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider w-12"}," # "),t("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," No. Transaksi "),t("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," Tanggal "),t("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," Outlet "),t("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," Supplier "),t("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," Category "),t("th",{scope:"col",class:"px-6 py-4 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"}," Total Amount "),t("th",{scope:"col",class:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"}," Payment Method "),t("th",{scope:"col",class:"px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider"}," Status Jurnal "),t("th",{scope:"col",class:"px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider"}," COA "),t("th",{scope:"col",class:"px-6 py-4 text-center text-xs font-bold text-gray-700 uppercase tracking-wider"}," Aksi ")])],-1)),t("tbody",rt,[u.retailNonFoods.data.length===0?(l(),r("tr",it,e[9]||(e[9]=[t("td",{colspan:"10",class:"px-6 py-12 text-center"},[t("div",{class:"flex flex-col items-center justify-center text-gray-400"},[t("i",{class:"fa-solid fa-inbox text-6xl mb-4"}),t("p",{class:"text-lg font-semibold"},"Tidak ada data"),t("p",{class:"text-sm mt-1"},"Semua transaksi retail non food cash sudah memiliki jurnal")])],-1)]))):_("",!0),(l(!0),r(v,null,B(u.retailNonFoods.data,s=>{var p,i,j,T,F,N,S,D,A;return l(),r(v,{key:s.id},[t("tr",nt,[t("td",dt,[t("button",{onClick:d=>O(s.id),class:"text-gray-600 hover:text-blue-600 transition-colors duration-150"},[t("i",{class:J(f.value[s.id]?"fa-solid fa-chevron-down":"fa-solid fa-chevron-right")},null,2)],8,ct)]),t("td",xt,[t("div",pt,a(s.retail_number),1),t("div",ut,"oleh: "+a(((p=s.creator)==null?void 0:p.nama_lengkap)||"-"),1)]),t("td",gt,a(M(s.transaction_date)),1),t("td",mt,[t("div",bt,a(((i=s.outlet)==null?void 0:i.nama_outlet)||"-"),1)]),t("td",yt,a(((j=s.supplier)==null?void 0:j.name)||"-"),1),t("td",ft,[t("div",ht,a(((T=s.category_budget)==null?void 0:T.name)||"-"),1),t("div",_t,a(((F=s.category_budget)==null?void 0:F.division)||"-"),1)]),t("td",vt,[t("span",wt,a(b(s.total_amount)),1)]),e[15]||(e[15]=t("td",{class:"px-6 py-4 whitespace-nowrap"},[t("span",{class:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"}," CASH ")],-1)),t("td",kt,[s.jurnal_created?(l(),r("div",Bt,[s.jurnal&&s.jurnal.length>0?(l(),r("div",jt,[t("div",Tt,[t("span",Ft,[e[10]||(e[10]=t("i",{class:"fa-solid fa-receipt mr-1"},null,-1)),n(a(s.jurnal[0].no_jurnal),1)])]),t("div",Nt,[t("div",St,[e[11]||(e[11]=t("span",{class:"font-semibold w-16"},"Debit:",-1)),t("span",Dt,a((N=s.jurnal[0].coa_debit)==null?void 0:N.code)+" - "+a((S=s.jurnal[0].coa_debit)==null?void 0:S.name),1)]),t("div",At,[e[12]||(e[12]=t("span",{class:"font-semibold w-16"},"Kredit:",-1)),t("span",Jt,a((D=s.jurnal[0].coa_kredit)==null?void 0:D.code)+" - "+a((A=s.jurnal[0].coa_kredit)==null?void 0:A.name),1)])])])):(l(),r("span",Vt,"Jurnal sudah dibuat"))])):(l(),r("div",Ct,[K(q(Y),{modelValue:m.value[s.id],"onUpdate:modelValue":d=>m.value[s.id]=d,options:y.coas,searchable:!0,"close-on-select":!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih COA...","track-by":"id",label:"display_name","preselect-first":!1,class:"w-96"},null,8,["modelValue","onUpdate:modelValue","options"])]))]),t("td",Ot,[s.jurnal_created?(l(),r("button",{key:1,onClick:d=>L(s),disabled:x.value[s.id],class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-red-500 to-red-600 rounded-lg hover:from-red-600 hover:to-red-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg transition-all duration-200 transform hover:-translate-y-0.5"},[e[14]||(e[14]=t("i",{class:"fa-solid fa-trash-undo"},null,-1)),x.value[s.id]?(l(),r("span",Mt,"Processing...")):(l(),r("span",It,"Rollback"))],8,Lt)):(l(),r("button",{key:0,onClick:d=>$(s),disabled:!m.value[s.id]||x.value[s.id],class:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg transition-all duration-200 transform hover:-translate-y-0.5"},[e[13]||(e[13]=t("i",{class:"fa-solid fa-check-circle"},null,-1)),x.value[s.id]?(l(),r("span",Pt,"Processing...")):(l(),r("span",$t,"Buat Jurnal"))],8,Rt))])]),h(t("tr",Ut,[t("td",Gt,[t("div",Et,[e[20]||(e[20]=t("h4",{class:"text-sm font-bold text-gray-700 mb-3 flex items-center gap-2"},[t("i",{class:"fa-solid fa-list text-blue-600"}),n(" Detail Items ")],-1)),t("div",Ht,[t("table",Kt,[e[18]||(e[18]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-semibold text-gray-600"},"No"),t("th",{class:"px-4 py-2 text-left text-xs font-semibold text-gray-600"},"Item Name"),t("th",{class:"px-4 py-2 text-center text-xs font-semibold text-gray-600"},"Qty"),t("th",{class:"px-4 py-2 text-center text-xs font-semibold text-gray-600"},"Unit"),t("th",{class:"px-4 py-2 text-right text-xs font-semibold text-gray-600"},"Price"),t("th",{class:"px-4 py-2 text-right text-xs font-semibold text-gray-600"},"Subtotal")])],-1)),t("tbody",qt,[(l(!0),r(v,null,B(s.items,(d,I)=>(l(),r("tr",{key:d.id,class:"hover:bg-gray-50"},[t("td",Qt,a(I+1),1),t("td",Wt,a(d.item_name),1),t("td",Yt,a(d.qty),1),t("td",zt,a(d.unit),1),t("td",Xt,a(b(d.price)),1),t("td",Zt,a(b(d.subtotal)),1)]))),128)),!s.items||s.items.length===0?(l(),r("tr",te,e[16]||(e[16]=[t("td",{colspan:"6",class:"px-4 py-3 text-sm text-gray-500 text-center italic"}," Tidak ada item ",-1)]))):_("",!0)]),t("tfoot",ee,[t("tr",null,[e[17]||(e[17]=t("td",{colspan:"5",class:"px-4 py-2 text-sm font-bold text-gray-700 text-right"},"Total:",-1)),t("td",se,a(b(s.total_amount)),1)])])])]),s.notes?(l(),r("div",oe,[e[19]||(e[19]=t("p",{class:"text-xs font-semibold text-gray-600 mb-1"},"Notes:",-1)),t("p",ae,a(s.notes),1)])):_("",!0)])])],512),[[Q,f.value[s.id]]])],64)}),128))])])]),u.retailNonFoods.data.length>0?(l(),r("div",le,[t("div",re,[t("div",ie,[e[22]||(e[22]=n(" Menampilkan ")),t("span",ne,a(u.retailNonFoods.from),1),e[23]||(e[23]=n(" sampai ")),t("span",de,a(u.retailNonFoods.to),1),e[24]||(e[24]=n(" dari ")),t("span",ce,a(u.retailNonFoods.total),1),e[25]||(e[25]=n(" transaksi "))]),t("div",xe,[(l(!0),r(v,null,B(u.retailNonFoods.links,s=>(l(),r("button",{key:s.label,onClick:p=>P(s.url),disabled:!s.url,innerHTML:s.label,class:J(["px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200",s.active?"bg-blue-600 text-white shadow-md":s.url?"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300":"bg-gray-100 text-gray-400 cursor-not-allowed"])},null,10,pe))),128))])])])):_("",!0)])])]),_:1}))}},Be=z(ue,[["__scopeId","data-v-113089b4"]]);export{Be as default};
