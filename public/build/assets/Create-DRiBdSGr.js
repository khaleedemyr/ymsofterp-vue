import{r as h,k as K,c as W,A as z,B as l,C as B,D as t,O as G,H as f,L as n,E as m,l as R,F as w,M as C,N as r,I as E,J as M,V as q,G as g,W as P}from"./vendor-vue-g7iCcTkf.js";import{A as Q}from"./AppLayout-1Wm1ZPw9.js";import"./vendor-utils-CpgP2uT4.js";import"./app-BPKNzj_F.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CVHTvH7j.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const X={class:"max-w-4xl mx-auto"},Y={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Z={class:"p-6"},I={class:"mb-6"},ee=["value"],te={key:0,class:"mt-1 text-sm text-red-600"},se={class:"mb-6"},ae={class:"mb-3"},le={key:0,class:"text-xs text-gray-400 mt-1"},ne={class:"flex gap-2 mb-3"},ie={class:"text-sm text-gray-500"},oe={key:0,class:"text-sm text-blue-600"},re={class:"border border-gray-300 rounded-md p-3 max-h-60 overflow-y-auto"},de=["id","value"],ue=["for"],me=["innerHTML"],pe=["innerHTML"],xe={class:"flex flex-wrap gap-2 text-xs"},be={key:0,class:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-800"},fe=["innerHTML"],ge={key:1,class:"inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-800"},ve=["innerHTML"],ce={key:2,class:"inline-flex items-center px-2 py-1 rounded-full bg-purple-100 text-purple-800"},ye=["innerHTML"],_e={key:0,class:"text-sm text-gray-500 text-center py-4"},ke={key:0},he={key:1},we={key:0,class:"mt-1 text-sm text-red-600"},Ce={key:1,class:"mt-3 p-3 bg-blue-50 rounded-md"},Me={class:"text-sm font-medium text-blue-800 mb-2"},Te={class:"space-y-2"},Le={class:"flex-1"},Ue={class:"font-medium text-gray-900"},je={class:"text-xs text-gray-500"},Se={class:"flex flex-wrap gap-1 mt-1"},He={key:0,class:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-blue-100 text-blue-700"},Ve={key:1,class:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-green-100 text-green-700"},Ae={key:2,class:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-purple-100 text-purple-700"},Be=["onClick"],Ee={class:"mb-6"},Pe={class:"mb-6"},Ne=["value"],Oe={class:"mb-6"},$e={class:"mb-6"},De={class:"flex justify-end gap-4"},Fe=["disabled"],Je={key:0,class:"fa-solid fa-spinner fa-spin"},Ke={key:1,class:"fa-solid fa-save"},et={__name:"Create",props:{masterSoals:Array,users:Array,outlets:Array},setup(T){const b=T,x=h(!1),p=h({}),d=h(""),u=h([]),i=K({master_soal_id:"",user_ids:u,outlet_id:"",max_attempts:1,expired_at:"",notes:""}),_=W(()=>{if(!d.value)return b.users;const a=d.value.toLowerCase();return b.users.filter(e=>{var s,o,c,y,k,H,V,A;return!!((s=e.nama_lengkap)!=null&&s.toLowerCase().includes(a)||(o=e.email)!=null&&o.toLowerCase().includes(a)||(y=(c=e.jabatan)==null?void 0:c.nama_jabatan)!=null&&y.toLowerCase().includes(a)||(H=(k=e.outlet)==null?void 0:k.nama_outlet)!=null&&H.toLowerCase().includes(a)||(A=(V=e.divisi)==null?void 0:V.nama_divisi)!=null&&A.toLowerCase().includes(a))})});function N(){if(x.value=!0,p.value={},!i.master_soal_id){p.value.master_soal_id="Master Soal harus dipilih",x.value=!1;return}if(u.value.length===0){p.value.user_ids="Minimal satu user harus dipilih",x.value=!1;return}const a={master_soal_id:i.master_soal_id,user_ids:u.value,outlet_id:i.outlet_id,max_attempts:i.max_attempts,expired_at:i.expired_at||null,notes:i.notes||null};P.post(route("enroll-test.store"),a,{onStart:()=>{x.value=!0},onFinish:()=>{x.value=!1},onError:e=>{p.value=e}})}function L(){P.visit(route("enroll-test.index"))}function O(){u.value=_.value.map(a=>a.id)}function $(){u.value=[]}function D(a){const e=b.users.find(s=>s.id===a);return e?e.nama_lengkap:"Unknown User"}function F(a){const e=b.users.find(s=>s.id===a);return e?e.email:""}function U(a){var s;const e=b.users.find(o=>o.id===a);return((s=e==null?void 0:e.jabatan)==null?void 0:s.nama_jabatan)||""}function j(a){var s;const e=b.users.find(o=>o.id===a);return((s=e==null?void 0:e.outlet)==null?void 0:s.nama_outlet)||""}function S(a){var s;const e=b.users.find(o=>o.id===a);return((s=e==null?void 0:e.divisi)==null?void 0:s.nama_divisi)||""}function J(a){const e=u.value.indexOf(a);e>-1&&u.value.splice(e,1)}function v(a,e){if(!e||!a)return a;const s=new RegExp(`(${e})`,"gi");return a.replace(s,'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}return(a,e)=>(l(),z(Q,{title:"Tambah Enrollment Test"},{header:B(()=>[t("div",{class:"flex justify-between items-center"},[e[8]||(e[8]=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Tambah Enrollment Test ",-1)),t("button",{onClick:L,class:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg flex items-center gap-2"},e[7]||(e[7]=[t("i",{class:"fa-solid fa-arrow-left"},null,-1),g(" Kembali ")]))])]),default:B(()=>[t("div",X,[t("form",{onSubmit:G(N,["prevent"]),class:"space-y-6"},[t("div",Y,[t("div",Z,[e[32]||(e[32]=t("h3",{class:"text-lg font-semibold mb-4"},"Informasi Enrollment",-1)),t("div",I,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Master Soal * ",-1)),f(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.master_soal_id=s),class:R([{"border-red-500":p.value.master_soal_id},"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"])},[e[9]||(e[9]=t("option",{value:""},"Pilih Master Soal",-1)),(l(!0),n(w,null,C(T.masterSoals,s=>{var o;return l(),n("option",{key:s.id,value:s.id},r(s.judul)+" ("+r(((o=s.pertanyaans)==null?void 0:o.length)||0)+" pertanyaan) ",9,ee)}),128))],2),[[E,i.master_soal_id]]),p.value.master_soal_id?(l(),n("p",te,r(p.value.master_soal_id),1)):m("",!0)]),t("div",se,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," User yang akan di-enroll * ",-1)),e[23]||(e[23]=t("p",{class:"text-sm text-gray-500 mb-3"}," Pilih satu atau lebih user untuk di-enroll ke soal yang dipilih. Setiap user akan mendapat enrollment terpisah untuk soal yang sama. ",-1)),t("div",ae,[f(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>d.value=s),placeholder:"Cari berdasarkan nama, email, jabatan, outlet, atau divisi...",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[M,d.value]]),d.value?m("",!0):(l(),n("div",le,' Contoh: "Manager", "Jakarta", "IT", "admin@company.com" '))]),t("div",ne,[t("button",{type:"button",onClick:O,class:"text-sm text-blue-600 hover:text-blue-800"}," Pilih Semua "),t("button",{type:"button",onClick:$,class:"text-sm text-gray-600 hover:text-gray-800"}," Batal Pilih Semua "),t("span",ie," ("+r(u.value.length)+" user dipilih) ",1),d.value?(l(),n("span",oe," - "+r(_.value.length)+" hasil ditemukan ",1)):m("",!0)]),t("div",re,[(l(!0),n(w,null,C(_.value,s=>{var o,c,y;return l(),n("div",{key:s.id,class:"flex items-start mb-3 p-2 border border-gray-200 rounded hover:bg-gray-50"},[f(t("input",{type:"checkbox",id:`user-${s.id}`,value:s.id,"onUpdate:modelValue":e[2]||(e[2]=k=>u.value=k),class:"mr-3 mt-1 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,8,de),[[q,u.value]]),t("label",{for:`user-${s.id}`,class:"text-sm text-gray-700 cursor-pointer flex-1"},[t("div",{class:"font-medium text-gray-900",innerHTML:v(s.nama_lengkap,d.value)},null,8,me),t("div",{class:"text-xs text-gray-500 mb-1",innerHTML:v(s.email,d.value)},null,8,pe),t("div",xe,[(o=s.jabatan)!=null&&o.nama_jabatan?(l(),n("span",be,[e[11]||(e[11]=t("i",{class:"fa-solid fa-briefcase mr-1"},null,-1)),t("span",{innerHTML:v(s.jabatan.nama_jabatan,d.value)},null,8,fe)])):m("",!0),(c=s.outlet)!=null&&c.nama_outlet?(l(),n("span",ge,[e[12]||(e[12]=t("i",{class:"fa-solid fa-store mr-1"},null,-1)),t("span",{innerHTML:v(s.outlet.nama_outlet,d.value)},null,8,ve)])):m("",!0),(y=s.divisi)!=null&&y.nama_divisi?(l(),n("span",ce,[e[13]||(e[13]=t("i",{class:"fa-solid fa-users mr-1"},null,-1)),t("span",{innerHTML:v(s.divisi.nama_divisi,d.value)},null,8,ye)])):m("",!0)])],8,ue)])}),128)),_.value.length===0?(l(),n("div",_e,[e[17]||(e[17]=t("i",{class:"fa-solid fa-search text-2xl mb-2 block"},null,-1)),d.value?(l(),n("div",ke,[e[14]||(e[14]=g(' Tidak ada user yang cocok dengan "')),t("strong",null,r(d.value),1),e[15]||(e[15]=g('" ')),e[16]||(e[16]=t("div",{class:"text-xs mt-1"},"Coba cari berdasarkan nama, email, jabatan, outlet, atau divisi",-1))])):(l(),n("div",he," Tidak ada user yang tersedia "))])):m("",!0)]),p.value.user_ids?(l(),n("p",we,r(p.value.user_ids),1)):m("",!0),u.value.length>0?(l(),n("div",Ce,[t("h4",Me," User yang dipilih ("+r(u.value.length)+"): ",1),t("div",Te,[(l(!0),n(w,null,C(u.value,s=>(l(),n("div",{key:s,class:"flex items-center justify-between p-2 bg-white rounded-lg border border-blue-200"},[t("div",Le,[t("div",Ue,r(D(s)),1),t("div",je,r(F(s)),1),t("div",Se,[U(s)?(l(),n("span",He,[e[18]||(e[18]=t("i",{class:"fa-solid fa-briefcase mr-1"},null,-1)),g(" "+r(U(s)),1)])):m("",!0),j(s)?(l(),n("span",Ve,[e[19]||(e[19]=t("i",{class:"fa-solid fa-store mr-1"},null,-1)),g(" "+r(j(s)),1)])):m("",!0),S(s)?(l(),n("span",Ae,[e[20]||(e[20]=t("i",{class:"fa-solid fa-users mr-1"},null,-1)),g(" "+r(S(s)),1)])):m("",!0)])]),t("button",{type:"button",onClick:o=>J(s),class:"ml-2 text-red-600 hover:text-red-800 p-1"},e[21]||(e[21]=[t("i",{class:"fa-solid fa-times"},null,-1)]),8,Be)]))),128))])])):m("",!0)]),t("div",Ee,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Maksimal Percobaan ",-1)),f(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=s=>i.max_attempts=s),min:"1",max:"10",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[M,i.max_attempts]]),e[25]||(e[25]=t("p",{class:"mt-1 text-sm text-gray-500"}," Maksimal 10 percobaan. ",-1))]),t("div",Pe,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Lokasi/Outlet ",-1)),f(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>i.outlet_id=s),class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[26]||(e[26]=t("option",{value:""},"Pilih Outlet",-1)),(l(!0),n(w,null,C(T.outlets,s=>(l(),n("option",{key:s.id_outlet,value:s.id_outlet},r(s.nama_outlet),9,Ne))),128))],512),[[E,i.outlet_id]]),e[28]||(e[28]=t("p",{class:"mt-1 text-sm text-gray-500"}," Pilih outlet untuk enrollment test. ",-1))]),t("div",Oe,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Tanggal Kedaluwarsa ",-1)),f(t("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=s=>i.expired_at=s),class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[M,i.expired_at]]),e[30]||(e[30]=t("p",{class:"mt-1 text-sm text-gray-500"}," Kosongkan untuk tidak ada batas waktu. ",-1))]),t("div",$e,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Catatan ",-1)),f(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>i.notes=s),rows:"3",placeholder:"Catatan tambahan untuk enrollment...",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[M,i.notes]])])])]),t("div",De,[t("button",{type:"button",onClick:L,class:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg"}," Batal "),t("button",{type:"submit",disabled:x.value,class:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white px-6 py-2 rounded-lg flex items-center gap-2"},[x.value?(l(),n("i",Je)):(l(),n("i",Ke)),g(" "+r(x.value?"Menyimpan...":"Simpan"),1)],8,Fe)])],32)])]),_:1}))}};export{et as default};
