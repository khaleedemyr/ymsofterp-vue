import{r as d,w as f,c as O,A,B as o,C as G,D as t,L as p,E as b,G as k,H as B,J as L,N as s,l as _,F as C,M as N}from"./vendor-vue-g7iCcTkf.js";import{A as I}from"./AppLayout-zPRaA07p.js";import{a as E}from"./vendor-utils-CpgP2uT4.js";import"./app-_bo91XrJ.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CKY7MlXM.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const $={class:"w-full py-8 px-2"},M={class:"bg-white rounded-xl shadow-xl p-6 mb-6"},P={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},V={class:"flex items-end gap-2"},U=["disabled"],j={key:0,class:"fa-solid fa-spinner fa-spin mr-1"},W={key:1,class:"fa-solid fa-search mr-1"},z=["href"],H={class:"border-b border-gray-200 mb-6"},J={class:"flex gap-1","aria-label":"Tabs"},K={key:0,class:"bg-white rounded-xl shadow-xl p-12 text-center"},q={key:1,class:"bg-white rounded-xl shadow-xl overflow-x-auto"},Q={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-white divide-y divide-gray-200"},Y={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"},Z={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},tt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},et={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},st={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},at={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 text-right"},rt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},it={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},ot={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},pt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},xt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},nt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},ct={key:0},lt={key:2,class:"bg-white rounded-xl shadow-xl overflow-x-auto"},dt={class:"min-w-full divide-y divide-gray-200"},ut={class:"bg-white divide-y divide-gray-200"},gt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"},yt={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},mt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},ht={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},_t={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},ft={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 text-right"},bt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},wt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},vt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},kt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Ct={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Nt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Dt={key:0},Ft={key:3,class:"bg-white rounded-xl shadow-xl overflow-x-auto"},Rt={class:"min-w-full divide-y divide-gray-200"},St={class:"bg-white divide-y divide-gray-200"},Tt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"},Ot={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},At={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Gt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Bt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Lt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},It={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Et={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},$t={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Mt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Pt={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900 text-right"},Vt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 text-right"},Ut={key:0},Zt={__name:"Index",props:{outlets:{type:Array,default:()=>[]},reportRows:{type:Array,default:()=>[]},cogsRows:{type:Array,default:()=>[]},categoryCostRows:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({bulan:""})}},setup(S){const x=S,u=d(!1),g=d({...x.filters}),n=d("cost_inventory"),y=d(x.reportRows||[]),m=d(x.cogsRows||[]),h=d(x.categoryCostRows||[]),w=d({});f(()=>x.filters,r=>{g.value={...r}},{immediate:!0}),f(()=>x.reportRows,r=>{y.value=r||[]},{immediate:!0}),f(()=>x.cogsRows,r=>{m.value=r||[]},{immediate:!0}),f(()=>x.categoryCostRows,r=>{h.value=r||[]},{immediate:!0});const T=O(()=>{const r=g.value.bulan||"";return`/cost-report/export?bulan=${encodeURIComponent(r)}`});function i(r){if(r==null||r==="")return"0";const a=Number(r);return isNaN(a)?"0":new Intl.NumberFormat("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}function D(){const r=g.value.bulan||"";w.value={},y.value=[],m.value=[],h.value=[],F(n.value,r,!0)}function v(r){n.value=r;const a=g.value.bulan||"";a&&F(r,a,!1)}async function F(r,a,e=!1){var R;if(!a)return;const c=`${a}:${r}`;if(!(!e&&w.value[c])){u.value=!0;try{const l=await E.get("/cost-report/tab-data",{params:{bulan:a,tab:r}});(R=l==null?void 0:l.data)!=null&&R.success&&(r==="cost_inventory"?y.value=l.data.reportRows||[]:r==="cogs"?m.value=l.data.cogsRows||[]:r==="category_cost"&&(h.value=l.data.categoryCostRows||[]),w.value[c]=!0)}catch(l){console.error("Failed to load cost report tab data:",l)}finally{u.value=!1}}}return(r,a)=>(o(),A(I,null,{default:G(()=>[t("div",$,[a[13]||(a[13]=t("div",{class:"flex items-center justify-between mb-6"},[t("h1",{class:"text-2xl font-bold flex items-center gap-2"},[t("i",{class:"fa-solid fa-coins text-amber-500"}),k(" Cost Report ")])],-1)),t("div",M,[t("div",P,[t("div",null,[a[4]||(a[4]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bulan",-1)),B(t("input",{type:"month","onUpdate:modelValue":a[0]||(a[0]=e=>g.value.bulan=e),onChange:D,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[L,g.value.bulan]])]),t("div",V,[t("button",{onClick:D,disabled:u.value,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed"},[u.value?(o(),p("i",j)):(o(),p("i",W)),k(" "+s(u.value?"Loading...":"Load Data"),1)],8,U),t("a",{href:T.value,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center px-4 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700 transition"},a[5]||(a[5]=[t("i",{class:"fa-solid fa-file-excel mr-1"},null,-1),k(" Export to Excel ")]),8,z)])])]),t("div",H,[t("nav",J,[t("button",{type:"button",onClick:a[1]||(a[1]=e=>v("cost_inventory")),class:_([n.value==="cost_inventory"?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","px-4 py-3 border-b-2 font-medium text-sm transition"])}," Cost Inventory ",2),t("button",{type:"button",onClick:a[2]||(a[2]=e=>v("cogs")),class:_([n.value==="cogs"?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","px-4 py-3 border-b-2 font-medium text-sm transition"])}," COGS ",2),t("button",{type:"button",onClick:a[3]||(a[3]=e=>v("category_cost")),class:_([n.value==="category_cost"?"border-blue-500 text-blue-600 bg-blue-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","px-4 py-3 border-b-2 font-medium text-sm transition"])}," Category Cost ",2)])]),u.value?(o(),p("div",K,a[6]||(a[6]=[t("div",{class:"text-blue-500"},[t("i",{class:"fa-solid fa-spinner fa-spin text-4xl mb-4"}),t("p",{class:"text-lg font-medium"},"Memuat data...")],-1)]))):n.value==="cost_inventory"?(o(),p("div",q,[t("table",Q,[a[8]||(a[8]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Begin Inventory (Total MAC)"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Official Cost"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cost RND"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet Transfer"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Barang Tersedia"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ending Inventory"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"COGS Aktual"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sales Before Discount"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Discount"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sales After Discount"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Discount vs Sales")])],-1)),t("tbody",X,[(o(!0),p(C,null,N(y.value||[],(e,c)=>(o(),p("tr",{key:e.outlet_id},[t("td",Y,s(c+1),1),t("td",Z,s(e.outlet_name),1),t("td",tt,s(i(e.total_begin_mac)),1),t("td",et,s(i(e.official_cost)),1),t("td",st,s(i(e.cost_rnd)),1),t("td",{class:_(["px-4 py-3 whitespace-nowrap text-sm text-right",(e.outlet_transfer||0)<0?"text-red-600":"text-gray-900"])},s(i(e.outlet_transfer)),3),t("td",at,s(i(e.total_barang_tersedia)),1),t("td",rt,s(i(e.ending_inventory)),1),t("td",it,s(i(e.cogs_aktual)),1),t("td",ot,s(i(e.sales_before_discount)),1),t("td",pt,s(i(e.discount)),1),t("td",xt,s(i(e.sales_after_discount)),1),t("td",nt,s(e.pct_discount!=null?Number(e.pct_discount).toFixed(2)+"%":"-"),1)]))),128)),!y.value||y.value.length===0?(o(),p("tr",ct,a[7]||(a[7]=[t("td",{colspan:"13",class:"px-4 py-8 text-center text-gray-500"},"Tidak ada data. Pilih bulan lalu klik Load Data.",-1)]))):b("",!0)])])])):n.value==="cogs"?(o(),p("div",lt,[t("table",dt,[a[10]||(a[10]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"COGS"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Category Cost"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Meal Employees"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"COGS Pembanding"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Deviasi"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Toleransi 2%"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% COGS Pembanding"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% COGS Actual Before Disc"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% COGS Actual After Disc"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% COGS Foods"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Deviasi"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Category Cost")])],-1)),t("tbody",ut,[(o(!0),p(C,null,N(m.value||[],(e,c)=>(o(),p("tr",{key:e.outlet_id},[t("td",gt,s(c+1),1),t("td",yt,s(e.outlet_name),1),t("td",mt,s(i(e.cogs)),1),t("td",ht,s(i(e.category_cost)),1),t("td",_t,s(i(e.meal_employees)),1),t("td",ft,s(i(e.cogs_pembanding)),1),t("td",{class:_(["px-4 py-3 whitespace-nowrap text-sm text-right",(e.deviasi||0)<0?"text-red-600":(e.deviasi||0)>0?"text-green-600":"text-gray-900"])},s(i(e.deviasi)),3),t("td",bt,s(i(e.toleransi_2_pct)),1),t("td",wt,s(e.pct_cogs_pembanding!=null?Number(e.pct_cogs_pembanding).toFixed(2)+"%":"-"),1),t("td",vt,s(e.pct_cogs_actual_before_disc!=null?Number(e.pct_cogs_actual_before_disc).toFixed(2)+"%":"-"),1),t("td",kt,s(e.pct_cogs_actual_after_disc!=null?Number(e.pct_cogs_actual_after_disc).toFixed(2)+"%":"-"),1),t("td",Ct,s(e.pct_cogs_foods!=null?Number(e.pct_cogs_foods).toFixed(2)+"%":"-"),1),t("td",{class:_(["px-4 py-3 whitespace-nowrap text-sm text-right",(e.pct_deviasi||0)<0?"text-red-600":(e.pct_deviasi||0)>0?"text-green-600":"text-gray-900"])},s(e.pct_deviasi!=null?Number(e.pct_deviasi).toFixed(2)+"%":"-"),3),t("td",Nt,s(e.pct_category_cost!=null?Number(e.pct_category_cost).toFixed(2)+"%":"-"),1)]))),128)),!m.value||m.value.length===0?(o(),p("tr",Dt,a[9]||(a[9]=[t("td",{colspan:"14",class:"px-4 py-8 text-center text-gray-500"},"Tidak ada data. Pilih bulan lalu klik Load Data.",-1)]))):b("",!0)])])])):n.value==="category_cost"?(o(),p("div",Ft,[t("table",Rt,[a[12]||(a[12]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Guest Supplies"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Guest Supplies"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Spoilage"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Spoilage"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Waste"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Waste"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Non Commodity"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Non Commodity"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Category Cost"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"% Category Cost")])],-1)),t("tbody",St,[(o(!0),p(C,null,N(h.value||[],(e,c)=>(o(),p("tr",{key:e.outlet_id},[t("td",Tt,s(c+1),1),t("td",Ot,s(e.outlet_name),1),t("td",At,s(i(e.guest_supplies)),1),t("td",Gt,s(e.pct_guest_supplies!=null?Number(e.pct_guest_supplies).toFixed(2)+"%":"-"),1),t("td",Bt,s(i(e.spoilage)),1),t("td",Lt,s(e.pct_spoilage!=null?Number(e.pct_spoilage).toFixed(2)+"%":"-"),1),t("td",It,s(i(e.waste)),1),t("td",Et,s(e.pct_waste!=null?Number(e.pct_waste).toFixed(2)+"%":"-"),1),t("td",$t,s(i(e.non_commodity)),1),t("td",Mt,s(e.pct_non_commodity!=null?Number(e.pct_non_commodity).toFixed(2)+"%":"-"),1),t("td",Pt,s(i(e.category_cost)),1),t("td",Vt,s(e.pct_category_cost!=null?Number(e.pct_category_cost).toFixed(2)+"%":"-"),1)]))),128)),!h.value||h.value.length===0?(o(),p("tr",Ut,a[11]||(a[11]=[t("td",{colspan:"12",class:"px-4 py-8 text-center text-gray-500"},"Tidak ada data. Pilih bulan lalu klik Load Data.",-1)]))):b("",!0)])])])):b("",!0)])]),_:1}))}};export{Zt as default};
