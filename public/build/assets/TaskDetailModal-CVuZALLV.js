import{r as f,w as M,c as O,L as e,B as t,E as h,x as P,D as l,F as d,M as c,C as A,G as p,N as n,_ as B,l as R}from"./vendor-vue-g7iCcTkf.js";import L from"./LightboxModal-C05wjdKL.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";const W={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40"},E={class:"bg-white rounded-2xl shadow-2xl p-0 w-full max-w-3xl relative animate-fadeIn overflow-y-auto max-h-screen"},q={class:"flex flex-col"},G={class:"flex border-b bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-2xl"},V=["onClick"],z={class:"text-xs"},F={key:0,class:"flex items-center justify-center h-40 text-blue-400 animate-pulse"},H={key:0},J={class:"mb-2"},K={class:"mb-2"},Q={class:"mb-2"},U={class:"mb-2"},X={class:"mb-2"},Y={class:"mb-2"},Z={class:"mb-2"},ee={class:"mb-2"},te={key:1},se={key:0,class:"text-gray-400"},oe={key:1},le={class:"flex flex-wrap gap-3 mb-3"},ie=["src","onClick"],ne=["src","onClick"],ae=["onClick"],de=["href"],re={key:2},ce={key:0,class:"text-gray-400"},ue={key:1},ve={class:"font-semibold mb-1"},_e={class:"flex flex-wrap gap-3"},pe=["src","onClick"],me=["src","onClick"],fe=["onClick"],he={key:3},be={key:0,class:"text-gray-400"},ge={key:1},ye={class:"font-semibold"},ke={class:"mt-2"},xe={class:"list-disc ml-5"},we={key:4},Ce={key:0,class:"text-gray-400"},$e={key:1},je={class:"font-semibold"},Ne={class:"mt-2"},Ie={class:"list-disc ml-5"},Pe={class:"mt-2"},Re={class:"list-disc ml-5"},Te=["href"],De=["src","onClick"],Me={class:"mt-2"},Oe={key:0,class:"text-xs text-gray-500 mb-2"},Ae={class:"flex flex-row flex-wrap gap-3 ml-5"},Be=["src","onClick"],Le=["src","onClick"],Se={key:5},We={key:0,class:"text-gray-400"},Ee={key:1},qe={class:"font-semibold"},Ge={key:0,class:"mt-2"},Ve={class:"flex flex-row flex-wrap gap-3"},ze=["src","onClick"],Fe={class:"mt-2"},He={class:"list-disc ml-5"},Je={class:"flex flex-wrap gap-3 mt-1"},Ke=["src","onClick"],Qe={key:6},Ue={key:0,class:"text-gray-400"},Xe={key:1},Ye={class:"font-semibold"},Ze={class:"flex flex-wrap gap-3 mt-2"},et=["src","onClick"],tt=["src","onClick"],st={__name:"TaskDetailModal",props:{task:Object,show:Boolean},emits:["close"],setup($,{emit:ot}){const g=$,T=[{key:"info",label:"Info",icon:"fas fa-info-circle"},{key:"attachments",label:"Attachments",icon:"fas fa-paperclip"},{key:"action_plan",label:"Action Plan",icon:"fas fa-tasks"},{key:"pr",label:"PR",icon:"fas fa-file-invoice"},{key:"po",label:"PO",icon:"fas fa-file-contract"},{key:"retail",label:"Retail",icon:"fas fa-store"},{key:"evidence",label:"Evidence",icon:"fas fa-camera"}],_=f("info"),a=f({info:{},assigned_to:[],attachments:[],documents:[],action_plans:[],pr:[],po:[],retail:[],evidence:[]}),y=f(!1),k=f(!1),j=f([]),N=f(0);function v(r,s){j.value=r,N.value=s,k.value=!0}function b(r){return r?"Rp "+Number(r).toLocaleString("id-ID"):"Rp 0"}M(()=>g.show,async r=>{if(r&&g.task&&g.task.id){_.value="info",y.value=!0;try{const s=await fetch(`/api/maintenance-tasks/${g.task.id}/detail`);a.value=await s.json()}finally{y.value=!1}}});const x=O(()=>a.value.attachments.map(r=>({type:r.file_type&&r.file_type.startsWith("image/")?"image":r.file_type&&r.file_type.startsWith("video/")?"video":"file",url:"/storage/"+r.file_path,caption:r.file_name})));function w(r){return r.media.map(s=>({type:s.media_type==="image"||s.media_type==="photo"?"image":s.media_type==="video"?"video":"file",url:"/storage/"+s.file_path,caption:s.file_path.split("/").pop()}))}function D(r){return r.items.flatMap(s=>s.barang_images.map(o=>({type:"image",url:"/storage/"+o.file_path,caption:o.file_path.split("/").pop()})))}function I(r){const s=r.photos.map(i=>({type:"image",url:"/storage/"+i.path,caption:i.path.split("/").pop()})),o=r.videos.map(i=>({type:"video",url:"/storage/"+i.path,caption:i.path.split("/").pop()}));return[...s,...o]}return(r,s)=>(t(),e(d,null,[$.show?(t(),e("div",W,[l("div",E,[l("button",{onClick:s[0]||(s[0]=o=>r.$emit("close")),class:"absolute top-3 right-3 text-gray-400 hover:text-red-500 text-xl z-10"},s[2]||(s[2]=[l("i",{class:"fas fa-times"},null,-1)])),l("div",q,[l("div",G,[(t(),e(d,null,c(T,o=>l("button",{key:o.key,onClick:i=>_.value=o.key,class:R(["flex-1 flex flex-col items-center py-3 transition-all duration-300",_.value===o.key?"bg-white shadow text-blue-700 font-bold":"text-gray-500 hover:text-blue-600"])},[l("i",{class:R([o.icon,"text-lg mb-1"])},null,2),l("span",z,n(o.label),1)],10,V)),64))]),P(B,{name:"fade-slide",mode:"out-in"},{default:A(()=>[(t(),e("div",{key:_.value,class:"p-6"},[y.value?(t(),e("div",F,s[3]||(s[3]=[l("i",{class:"fas fa-spinner fa-spin text-3xl"},null,-1)]))):(t(),e(d,{key:1},[_.value==="info"?(t(),e("div",H,[s[12]||(s[12]=l("h2",{class:"text-lg font-bold mb-2"},"Info Task",-1)),l("div",J,[s[4]||(s[4]=l("span",{class:"font-semibold"},"Task Number:",-1)),p(" "+n(a.value.info.task_number),1)]),l("div",K,[s[5]||(s[5]=l("span",{class:"font-semibold"},"Created By:",-1)),p(" "+n(a.value.info.created_by||"-"),1)]),l("div",Q,[s[6]||(s[6]=l("span",{class:"font-semibold"},"Title:",-1)),p(" "+n(a.value.info.title),1)]),l("div",U,[s[7]||(s[7]=l("span",{class:"font-semibold"},"Description:",-1)),p(" "+n(a.value.info.description||"-"),1)]),l("div",X,[s[8]||(s[8]=l("span",{class:"font-semibold"},"Outlet:",-1)),p(" "+n(a.value.info.outlet_name),1)]),l("div",Y,[s[9]||(s[9]=l("span",{class:"font-semibold"},"Due Date:",-1)),p(" "+n(a.value.info.due_date),1)]),l("div",Z,[s[10]||(s[10]=l("span",{class:"font-semibold"},"Status:",-1)),p(" "+n(a.value.info.status),1)]),l("div",ee,[s[11]||(s[11]=l("span",{class:"font-semibold"},"Assigned To:",-1)),(t(!0),e(d,null,c(a.value.assigned_to,o=>(t(),e("span",{key:o,class:"inline-block bg-indigo-100 text-indigo-700 rounded px-2 py-0.5 mr-1 text-xs font-semibold"},n(o),1))),128))])])):_.value==="attachments"?(t(),e("div",te,[s[15]||(s[15]=l("h2",{class:"text-lg font-bold mb-2"},"Attachments",-1)),a.value.attachments.length===0&&a.value.documents.length===0?(t(),e("div",se,"No attachments")):(t(),e("div",oe,[l("div",le,[(t(!0),e(d,null,c(a.value.attachments,(o,i)=>(t(),e(d,{key:o.id},[o.file_type&&o.file_type.startsWith("image/")?(t(),e("img",{key:0,src:"/storage/"+o.file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:u=>v(x.value,i)},null,8,ie)):o.file_type&&o.file_type.startsWith("video/")?(t(),e("video",{key:1,src:"/storage/"+o.file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:u=>v(x.value,i)},null,8,ne)):(t(),e("div",{key:2,class:"w-20 h-20 flex items-center justify-center bg-gray-100 rounded shadow border cursor-pointer",onClick:u=>v(x.value,i)},s[13]||(s[13]=[l("i",{class:"fas fa-paperclip text-2xl text-blue-400"},null,-1)]),8,ae))],64))),128))]),(t(!0),e(d,null,c(a.value.documents,o=>(t(),e("div",{key:o.id,class:"mb-2 flex items-center gap-2"},[s[14]||(s[14]=l("i",{class:"fas fa-file-alt text-green-400"},null,-1)),l("a",{href:"/storage/"+o.file_path,target:"_blank",class:"underline hover:text-green-600"},n(o.file_name),9,de)]))),128))]))])):_.value==="action_plan"?(t(),e("div",re,[s[17]||(s[17]=l("h2",{class:"text-lg font-bold mb-2"},"Action Plan",-1)),a.value.action_plans.length===0?(t(),e("div",ce,"No action plan")):(t(),e("div",ue,[(t(!0),e(d,null,c(a.value.action_plans,o=>(t(),e("div",{key:o.id,class:"mb-4 p-3 rounded-xl bg-blue-50 shadow-sm"},[l("div",ve,n(o.description),1),l("div",_e,[(t(!0),e(d,null,c(o.media,(i,u)=>(t(),e(d,{key:i.id},[i.media_type==="image"||i.media_type==="photo"?(t(),e("img",{key:0,src:"/storage/"+i.file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:m=>v(w(o),u)},null,8,pe)):i.media_type==="video"?(t(),e("video",{key:1,src:"/storage/"+i.file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:m=>v(w(o),u)},null,8,me)):(t(),e("div",{key:2,class:"w-20 h-20 flex items-center justify-center bg-gray-100 rounded shadow border cursor-pointer",onClick:m=>v(w(o),u)},s[16]||(s[16]=[l("i",{class:"fas fa-paperclip text-2xl text-blue-400"},null,-1)]),8,fe))],64))),128))])]))),128))]))])):_.value==="pr"?(t(),e("div",he,[s[19]||(s[19]=l("h2",{class:"text-lg font-bold mb-2"},"Purchase Requisition (PR)",-1)),a.value.pr.length===0?(t(),e("div",be,"No PR")):(t(),e("div",ge,[(t(!0),e(d,null,c(a.value.pr,o=>(t(),e("div",{key:o.id,class:"mb-4 p-3 rounded-xl bg-yellow-50 shadow-sm"},[l("div",ye,"PR Number: "+n(o.pr_number),1),l("div",null,"Status: "+n(o.status),1),l("div",null,"Total: "+n(b(o.total_amount)),1),l("div",ke,[s[18]||(s[18]=l("div",{class:"font-semibold text-xs mb-1"},"Items:",-1)),l("ul",xe,[(t(!0),e(d,null,c(o.items,i=>(t(),e("li",{key:i.id},n(i.item_name)+" ("+n(i.quantity)+" x "+n(b(i.price))+")",1))),128))])])]))),128))]))])):_.value==="po"?(t(),e("div",we,[s[23]||(s[23]=l("h2",{class:"text-lg font-bold mb-2"},"Purchase Order (PO)",-1)),a.value.po.length===0?(t(),e("div",Ce,"No PO")):(t(),e("div",$e,[(t(!0),e(d,null,c(a.value.po,o=>(t(),e("div",{key:o.id,class:"mb-4 p-3 rounded-xl bg-pink-50 shadow-sm"},[l("div",je,"PO Number: "+n(o.po_number),1),l("div",null,"Status: "+n(o.status),1),l("div",null,"Total: "+n(b(o.total_amount)),1),l("div",Ne,[s[20]||(s[20]=l("div",{class:"font-semibold text-xs mb-1"},"Items:",-1)),l("ul",Ie,[(t(!0),e(d,null,c(o.items,i=>(t(),e("li",{key:i.id},n(i.item_name)+" ("+n(i.quantity)+" x "+n(b(i.price))+")",1))),128))])]),l("div",Pe,[s[21]||(s[21]=l("div",{class:"font-semibold text-xs mb-1"},"Invoices:",-1)),l("ul",Re,[(t(!0),e(d,null,c(o.invoices,i=>(t(),e("li",{key:i.id},[l("a",{href:"/storage/"+i.invoice_file_path,target:"_blank",class:"underline text-blue-600"},n(i.invoice_number),9,Te),p(" ("+n(i.invoice_date)+") ",1),i.invoice_file_path?(t(),e("img",{key:0,src:"/storage/"+i.invoice_file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer mt-1",onClick:u=>v([{type:"image",url:"/storage/"+i.invoice_file_path,caption:i.invoice_number}],0)},null,8,De)):h("",!0)]))),128))])]),l("div",Me,[s[22]||(s[22]=l("div",{class:"font-semibold text-xs mb-1"},"Good Receives:",-1)),o.receives.length>0?(t(),e("div",Oe,"Notes: "+n(o.receives[0].notes||"-"),1)):h("",!0),l("div",Ae,[(t(!0),e(d,null,c(o.receives,i=>(t(),e(d,{key:i.id},[i.file_type&&i.file_type.startsWith("image/")?(t(),e("img",{key:0,src:"/storage/"+i.file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:u=>v([{type:"image",url:"/storage/"+i.file_path,caption:i.notes||"Good Receive"}],0)},null,8,Be)):i.file_type&&i.file_type.startsWith("video/")?(t(),e("video",{key:1,src:"/storage/"+i.file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:u=>v([{type:"video",url:"/storage/"+i.file_path,caption:i.notes||"Good Receive"}],0)},null,8,Le)):h("",!0)],64))),128))])])]))),128))]))])):_.value==="retail"?(t(),e("div",Se,[s[26]||(s[26]=l("h2",{class:"text-lg font-bold mb-2"},"Retail",-1)),a.value.retail.length===0?(t(),e("div",We,"No retail data")):(t(),e("div",Ee,[(t(!0),e(d,null,c(a.value.retail,o=>(t(),e("div",{key:o.id,class:"mb-4 p-3 rounded-xl bg-green-50 shadow-sm"},[l("div",qe,"Toko: "+n(o.nama_toko),1),l("div",null,"Alamat: "+n(o.alamat_toko),1),o.all_invoice_images&&o.all_invoice_images.length?(t(),e("div",Ge,[s[24]||(s[24]=l("div",{class:"text-xs font-semibold mb-1"},"Invoice:",-1)),l("div",Ve,[(t(!0),e(d,null,c(o.all_invoice_images,(i,u)=>(t(),e("img",{key:i.id,src:"/storage/"+i.file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:m=>v(o.all_invoice_images.map(C=>({type:"image",url:"/storage/"+C.file_path,caption:C.file_path.split("/").pop()})),u)},null,8,ze))),128))])])):h("",!0),l("div",Fe,[s[25]||(s[25]=l("div",{class:"font-semibold text-xs mb-1"},"Items:",-1)),l("ul",He,[(t(!0),e(d,null,c(o.items,i=>(t(),e("li",{key:i.id},[p(n(i.nama_barang)+" ("+n(i.qty)+" x "+n(b(i.harga_barang))+") ",1),l("div",Je,[(t(!0),e(d,null,c(i.barang_images,(u,m)=>(t(),e("img",{key:u.id,src:"/storage/"+u.file_path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:C=>v(D(o),m)},null,8,Ke))),128))])]))),128))])])]))),128))]))])):_.value==="evidence"?(t(),e("div",Qe,[s[27]||(s[27]=l("h2",{class:"text-lg font-bold mb-2"},"Evidence",-1)),a.value.evidence.length===0?(t(),e("div",Ue,"No evidence")):(t(),e("div",Xe,[(t(!0),e(d,null,c(a.value.evidence,o=>(t(),e("div",{key:o.id,class:"mb-4 p-3 rounded-xl bg-indigo-50 shadow-sm"},[l("div",Ye,n(o.notes||"Evidence"),1),l("div",Ze,[(t(!0),e(d,null,c(o.photos,(i,u)=>(t(),e("img",{key:i.id,src:"/storage/"+i.path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:m=>v(I(o),u)},null,8,et))),128)),(t(!0),e(d,null,c(o.videos,(i,u)=>(t(),e("video",{key:i.id,src:"/storage/"+i.path,class:"w-20 h-20 object-cover rounded shadow border cursor-pointer",onClick:m=>v(I(o),o.photos.length+u)},null,8,tt))),128))])]))),128))]))])):h("",!0)],64))]))]),_:1})])])])):h("",!0),P(L,{show:k.value,mediaList:j.value,startIndex:N.value,onClose:s[1]||(s[1]=o=>k.value=!1)},null,8,["show","mediaList","startIndex"])],64))}},dt=S(st,[["__scopeId","data-v-26a2610f"]]);export{dt as default};
