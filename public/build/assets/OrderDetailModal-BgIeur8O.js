import{c as y,L as i,B as a,D as r,N as l,E as d,F as c,M as p,O as B}from"./vendor-vue-g7iCcTkf.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";const L={class:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col relative animate-fadeIn overflow-hidden"},F={class:"bg-gradient-to-r from-slate-700 to-slate-800 text-white px-6 py-4 flex items-center justify-between shrink-0"},E={class:"text-slate-300 text-sm mt-0.5"},V={class:"overflow-y-auto flex-1 p-6 space-y-5"},T={class:"bg-slate-50 rounded-xl p-4"},z={class:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm"},K={class:"text-slate-500"},R={class:"text-slate-800 font-medium text-right"},q={key:0,class:"bg-violet-50 rounded-xl p-4"},J={class:"space-y-1.5"},W={class:"font-medium text-slate-700"},G={class:"font-semibold text-violet-800"},H={key:1,class:"bg-amber-50 rounded-xl p-4"},Q={class:"flex justify-between text-sm"},U={class:"font-semibold text-amber-900"},X={key:0,class:"mt-1.5 text-sm text-slate-600"},Y={key:2,class:"bg-emerald-50 rounded-xl p-4"},Z={class:"text-lg font-bold text-emerald-900"},tt={key:0,class:"mt-2 space-y-1 text-sm"},et={class:"font-medium"},rt={key:3,class:"bg-sky-50 rounded-xl p-4"},ot={class:"overflow-x-auto rounded-lg border border-sky-200 bg-white"},st={class:"min-w-full text-sm"},nt={class:"px-3 py-2"},it={class:"px-3 py-2"},at={class:"font-medium text-slate-800"},lt={key:0,class:"mt-1 space-y-1"},dt={key:1,class:"mt-1 text-xs text-amber-700"},ut={class:"px-3 py-2 text-right"},ct={class:"px-3 py-2 text-right"},mt={class:"px-3 py-2 text-right font-medium"},ft={key:4,class:"bg-blue-50 rounded-xl p-4"},pt={class:"flex flex-wrap gap-2"},xt={class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-100 text-blue-900 font-medium text-sm"},bt={key:0,class:"inline-flex items-center px-3 py-1.5 rounded-lg bg-blue-200/70 text-blue-900 text-sm"},yt={key:1,class:"text-slate-600 text-sm"},gt={__name:"OrderDetailModal",props:{order:{type:Object,required:!0}},setup(s){const x=s,N=["nomor","paid_number","nama_outlet","kode_outlet","table","waiters","mode","pax","created_at","total","discount","service","grand_total","status","member_name"];function M(t){return{created_at:"Waktu",waiters:"Waiter",mode:"Mode",nomor:"No. Order",paid_number:"Paid Number",table:"Meja",pax:"Pax",total:"Subtotal",discount:"Diskon",cashback:"Cashback",dpp:"DPP",pb1:"PB1",service:"Service",grand_total:"Grand Total",status:"Status",kode_outlet:"Kode Outlet",nama_outlet:"Nama Outlet",member_name:"Member"}[t]||t.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase())}function j(t,e){return t.match(/total|discount|cashback|service|pb1|grand|dpp|rounding/i)&&typeof e=="number"?e.toLocaleString("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}):t==="created_at"?e?new Date(e).toLocaleString("id-ID"):"-":e===""||e==null?"-":e}function m(t){if(typeof t=="number")return t.toLocaleString("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0});if(t==null||t==="")return"-";const e=Number(t);return isNaN(e)?String(t):e.toLocaleString("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0})}function I(t){const e=Number(t.amount)||0,o=Number(t.change)||0;return e-o}function _(t){const e=t==null?void 0:t.notes;if(e==null)return"";const o=String(e).trim();return!o||o.toLowerCase()==="null"?"":o}function k(t){if(Array.isArray(t==null?void 0:t.modifiers_formatted)&&t.modifiers_formatted.length)return t.modifiers_formatted.map(n=>String(n??"").trim()).filter(Boolean);const e=t==null?void 0:t.modifiers;if(e==null)return[];if(Array.isArray(e))return e.map(n=>f(n)).filter(Boolean);const o=String(e).trim();if(!o||o.toLowerCase()==="null")return[];try{const n=JSON.parse(o);if(Array.isArray(n))return n.map(u=>f(u)).filter(Boolean);if(n&&typeof n=="object"){const u=[];return Object.entries(n).forEach(([g,h])=>{if(Array.isArray(h)){h.forEach($=>{const v=f($);v&&u.push(`${g}: ${v}`)});return}const S=f(h);u.push(S?`${g}: ${S}`:g)}),u.filter(Boolean)}const b=f(n);return b?[b]:[]}catch{return[o]}}function f(t){return t==null?"":typeof t=="string"?t.trim():typeof t=="number"||typeof t=="boolean"?String(t):typeof t=="object"?t.name?String(t.name):t.label?String(t.label):t.option_name?String(t.option_name):t.option?String(t.option):t.title?String(t.title):Object.values(t).map(e=>e==null?"":String(e).trim()).filter(Boolean).join(" - "):""}function P(t){return!t||typeof t!="object"?!0:!t.name&&!t.code&&t.id==null&&t.value==null}const A=y(()=>{const t=x.order.manual_discount_amount;return t!=null&&String(t).replace(/\D/g,"")!==""&&Number(t)>0}),w=y(()=>{const t=parseInt(x.order.discount,10)||0,e=parseFloat(x.order.manual_discount_amount)||0;return t>0&&e>0?Math.max(t,e):t+e}),O=y(()=>w.value>0),D=y(()=>{const t=x.order.promo_discount_info;if(!t||typeof t!="string")return[];const e=t.trim();if(!e||e[0]!=="{"&&e[0]!=="[")return[];try{const o=JSON.parse(t);if(o&&Array.isArray(o.promos))return o.promos.map(n=>({promo_name:n.promo_name||n.name||"Promo",discount_amount:n.discount_amount??n.amount??0}))}catch{return[]}return[]});return(t,e)=>(a(),i("div",{class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:e[1]||(e[1]=B(o=>t.$emit("close"),["self"]))},[r("div",L,[r("div",F,[r("div",null,[e[2]||(e[2]=r("h2",{class:"text-lg font-bold"},"Detail Order",-1)),r("p",E,l(s.order.nomor)+l(s.order.paid_number?` · ${s.order.paid_number}`:""),1)]),r("button",{type:"button",onClick:e[0]||(e[0]=o=>t.$emit("close")),class:"p-2 rounded-lg text-slate-300 hover:bg-white/10 hover:text-white transition","aria-label":"Tutup"},e[3]||(e[3]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),r("div",V,[r("section",T,[e[4]||(e[4]=r("h3",{class:"text-sm font-semibold text-slate-600 uppercase tracking-wide mb-3"},"Info Transaksi",-1)),r("div",z,[(a(),i(c,null,p(N,o=>(a(),i(c,{key:o},[s.order[o]!==void 0&&s.order[o]!==null?(a(),i(c,{key:0},[r("span",K,l(M(o)),1),r("span",R,l(j(o,s.order[o])),1)],64)):d("",!0)],64))),64))])]),s.order.payments&&s.order.payments.length?(a(),i("section",q,[e[5]||(e[5]=r("h3",{class:"text-sm font-semibold text-violet-700 uppercase tracking-wide mb-2"},"Pembayaran",-1)),r("div",J,[(a(!0),i(c,null,p(s.order.payments,(o,n)=>(a(),i("div",{key:n,class:"flex justify-between items-center text-sm bg-white/60 rounded-lg px-3 py-2"},[r("span",W,l(o.payment_code||o.payment_type||"Payment"),1),r("span",G,l(m(I(o))),1)]))),128))])])):d("",!0),A.value?(a(),i("section",H,[e[7]||(e[7]=r("h3",{class:"text-sm font-semibold text-amber-800 uppercase tracking-wide mb-2"},"Diskon Manual",-1)),r("div",Q,[e[6]||(e[6]=r("span",{class:"text-slate-600"},"Nominal",-1)),r("span",U,l(m(s.order.manual_discount_amount)),1)]),s.order.manual_discount_reason?(a(),i("div",X," Alasan: "+l(s.order.manual_discount_reason),1)):d("",!0)])):d("",!0),O.value?(a(),i("section",Y,[e[8]||(e[8]=r("h3",{class:"text-sm font-semibold text-emerald-800 uppercase tracking-wide mb-1"},"Total Diskon Promo",-1)),r("p",Z,l(m(w.value)),1),D.value.length?(a(),i("div",tt,[(a(!0),i(c,null,p(D.value,(o,n)=>(a(),i("div",{key:n,class:"flex justify-between text-slate-700"},[r("span",null,l(o.promo_name),1),r("span",et,l(m(o.discount_amount)),1)]))),128))])):d("",!0)])):d("",!0),s.order.items&&s.order.items.length?(a(),i("section",rt,[e[10]||(e[10]=r("h3",{class:"text-sm font-semibold text-sky-800 uppercase tracking-wide mb-3"},"Item Pesanan",-1)),r("div",ot,[r("table",st,[e[9]||(e[9]=r("thead",null,[r("tr",{class:"bg-sky-100 text-sky-900"},[r("th",{class:"px-3 py-2.5 text-left font-semibold"},"No"),r("th",{class:"px-3 py-2.5 text-left font-semibold"},"Nama Item"),r("th",{class:"px-3 py-2.5 text-right font-semibold"},"Qty"),r("th",{class:"px-3 py-2.5 text-right font-semibold"},"Harga"),r("th",{class:"px-3 py-2.5 text-right font-semibold"},"Subtotal")])],-1)),r("tbody",null,[(a(!0),i(c,null,p(s.order.items,(o,n)=>(a(),i("tr",{key:o.id||n,class:"border-t border-sky-100 hover:bg-sky-50/50"},[r("td",nt,l(n+1),1),r("td",it,[r("div",at,l(o.item_name||"-"),1),k(o).length?(a(),i("div",lt,[(a(!0),i(c,null,p(k(o),(b,u)=>(a(),i("div",{key:`mod-${n}-${u}`,class:"text-xs text-slate-600"}," • Modifier: "+l(b),1))),128))])):d("",!0),_(o)?(a(),i("div",dt," • Notes: "+l(_(o)),1)):d("",!0)]),r("td",ut,l(o.qty??0),1),r("td",ct,l(m(o.price??0)),1),r("td",mt,l(m(o.subtotal??0)),1)]))),128))])])])])):d("",!0),s.order.promo&&!P(s.order.promo)?(a(),i("section",ft,[e[11]||(e[11]=r("h3",{class:"text-sm font-semibold text-blue-800 uppercase tracking-wide mb-2"},"Promo Diterapkan",-1)),r("div",pt,[r("span",xt,l(s.order.promo.name||s.order.promo.code||"Promo"),1),s.order.promo.code?(a(),i("span",bt,l(s.order.promo.code),1)):d("",!0),s.order.promo.type?(a(),i("span",yt,l(s.order.promo.type)+" "+l(s.order.promo.value!=null?`· ${s.order.promo.value}`:""),1)):d("",!0)])])):d("",!0)])])]))}},wt=C(gt,[["__scopeId","data-v-df332754"]]);export{wt as default};
