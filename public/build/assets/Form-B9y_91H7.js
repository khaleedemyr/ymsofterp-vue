import{$ as dt,c as k,r as _,w as j,A as K,B as i,C as W,D as t,L as r,E as g,G as p,F as h,M as v,N as u,l as F,Y as G,O as z,H as f,Q as J,J as I,I as U,x as pt,Z as $,T as mt,W as H}from"./vendor-vue-g7iCcTkf.js";import{A as ct}from"./AppLayout-Cke2dYBX.js";import{a as y}from"./vendor-utils-CpgP2uT4.js";import{S as V}from"./app-AaUk6aDd.js";import{s as ft}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DtjcyHN1.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const gt={class:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-white py-12 px-4 md:px-8"},ht={class:"w-full max-w-4xl bg-white rounded-3xl shadow-3xl p-10 border border-blue-100 transition-all duration-300 hover:shadow-4xl"},vt={key:0,class:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-xl"},bt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},_t={class:"flex items-center justify-between mb-2"},yt={class:"font-semibold text-gray-800"},xt={class:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full"},wt={class:"space-y-1 text-sm"},kt={class:"flex justify-between"},It={class:"font-semibold text-green-600"},Bt={class:"flex justify-between"},Ct={class:"text-blue-600"},St={class:"flex justify-between"},Dt={class:"text-purple-600"},Tt={class:"flex justify-between border-t pt-1"},jt={class:"font-semibold text-gray-800"},Ut={class:"flex justify-between"},$t={class:"text-orange-600"},Vt={class:"flex justify-between border-t pt-1"},qt={class:"font-semibold text-gray-800"},At={class:"flex justify-between"},Ot={class:"mt-2"},Pt={class:"flex justify-between text-xs mb-1"},Ft={class:"w-full bg-gray-200 rounded-full h-2"},Rt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Et=["min"],Mt=["disabled"],Lt=["value"],Nt=["value"],Kt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Wt={class:"flex justify-between items-center"},Gt={class:"text-xs text-gray-500"},zt={class:"overflow-x-auto"},Jt={class:"min-w-full divide-y divide-gray-200"},Ht={class:"bg-white divide-y divide-gray-200"},Qt={class:"px-3 py-2 min-w-[200px]"},Yt={class:"relative"},Zt=["id","onUpdate:modelValue","onInput","onFocus","onBlur","onKeydown"],Xt=["id"],te=["id","onMousedown"],ee={class:"font-medium"},ae={class:"text-xs text-gray-500"},se={class:"text-sm text-gray-600"},le={key:0,class:"absolute right-2 top-2"},ne={class:"px-3 py-2 min-w-[100px]"},oe=["onUpdate:modelValue","onInput"],ie={class:"px-3 py-2 min-w-[100px]"},re={class:"relative"},ue=["onUpdate:modelValue"],de=["value"],pe={key:0,class:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs px-1 rounded-full"},me={class:"px-3 py-2 min-w-[150px]"},ce={class:"relative"},fe=["onUpdate:modelValue","onInput"],ge={key:0,class:"absolute -top-1 -right-1 bg-green-500 text-white text-xs px-1 rounded-full"},he={class:"px-3 py-2 min-w-[150px] text-right"},ve={class:"px-3 py-2"},be=["onClick","disabled"],_e={class:"px-3 py-2 text-right font-bold"},ye={key:0,class:"flex flex-wrap gap-2 mt-2"},xe=["src"],we={key:0,class:"mb-4 p-4 rounded-xl bg-yellow-100 border border-yellow-300 text-yellow-800 shadow flex items-center gap-2 animate-pulse"},ke={class:"flex justify-end gap-2"},Ie=["disabled"],Be={key:0},Ce={key:1},Re={__name:"Form",props:{outlets:Array,warehouse_outlets:Array,suppliers:Array},setup(Q){const B=Q,x=dt(),C=k(()=>{var l,e;return((e=(l=x.props.auth)==null?void 0:l.user)==null?void 0:e.id_outlet)||""}),R=new Date().toISOString().split("T")[0];function E(){return{item_id:"",item_name:"",qty:"",unit_id:"",price:0,subtotal:0,unitOptions:[],suggestions:[],showDropdown:!1,highlightedIndex:-1,loading:!1}}const s=_({transaction_date:new Date().toISOString().split("T")[0],outlet_id:C.value==1?"":C.value,warehouse_outlet_id:"",notes:"",payment_method:"",supplier:null,items:[E()]}),Y=k(()=>C.value!=1),w=_(!1),S=_(0),b=_([]),Z=k(()=>s.value.payment_method!=="cash"?!1:S.value+M.value>=5e5);function X(){s.value.items.push(E())}function tt(l){s.value.items.length!==1&&(s.value.items.splice(l,1),q())}function D(l){const e=s.value.items[l];e.subtotal=(e.qty||0)*(e.price||0)}const M=k(()=>s.value.items.reduce((l,e)=>l+(e.subtotal||0),0));async function et(l,e){var a,o;if(!e||e.length<2){s.value.items[l].suggestions=[],s.value.items[l].highlightedIndex=-1;return}s.value.items[l].loading=!0;try{const d=await y.get("/items/search-for-outlet-transfer",{params:{q:e,outlet_id:s.value.outlet_id,region_id:(o=(a=x.props.auth)==null?void 0:a.user)==null?void 0:o.region_id}});s.value.items[l].suggestions=d.data,s.value.items[l].showDropdown=!0,s.value.items[l].highlightedIndex=0}finally{s.value.items[l].loading=!1}}function L(l,e){const a=e.target.value;s.value.items[l].item_id="",s.value.items[l].item_name=a,s.value.items[l].showDropdown=!0,et(l,a)}async function N(l,e){var o,d,n,m;console.log("selectItem called",{idx:l,item:e.name,payment_method:s.value.payment_method,outlet_id:s.value.outlet_id,region_id:(d=(o=x.props.auth)==null?void 0:o.user)==null?void 0:d.region_id}),s.value.items[l].item_id=e.id,s.value.items[l].item_name=e.name,s.value.items[l].suggestions=[],s.value.items[l].showDropdown=!1,s.value.items[l].highlightedIndex=-1;const a=await y.get(`/retail-food/get-item-units/${e.id}`,{params:{payment_method:s.value.payment_method,outlet_id:s.value.outlet_id,region_id:(m=(n=x.props.auth)==null?void 0:n.user)==null?void 0:m.region_id}});console.log("API response:",a.data),s.value.items[l].unitOptions=a.data.units,s.value.payment_method==="contra_bon"&&a.data.default_unit?(console.log("Auto-filling for contra bon:",{default_unit:a.data.default_unit,default_price:a.data.default_price}),s.value.items[l].unit_id=a.data.default_unit.id,a.data.default_price>0&&(s.value.items[l].price=a.data.default_price),D(l)):(console.log("Not auto-filling:",{payment_method:s.value.payment_method,has_default_unit:!!a.data.default_unit}),s.value.items[l].unit_id=""),await q()}function at(l){setTimeout(()=>{s.value.items[l].showDropdown=!1},200)}function T(l,e){const a=s.value.items[l];!a.showDropdown||!a.suggestions.length||(e.key==="ArrowDown"?(e.preventDefault(),a.highlightedIndex=(a.highlightedIndex+1)%a.suggestions.length):e.key==="ArrowUp"?(e.preventDefault(),a.highlightedIndex=(a.highlightedIndex-1+a.suggestions.length)%a.suggestions.length):e.key==="Enter"?(e.preventDefault(),a.highlightedIndex>=0&&a.suggestions[a.highlightedIndex]&&N(l,a.suggestions[a.highlightedIndex])):e.key==="Escape"&&(a.showDropdown=!1))}function st(l){const e=document.getElementById(`item-input-${l}`);if(!e)return{};const a=e.getBoundingClientRect();return{position:"fixed",left:`${a.left}px`,top:`${a.bottom}px`,width:`${a.width}px`,zIndex:99999}}async function lt(){if(!s.value.outlet_id||!s.value.transaction_date){S.value=0;return}try{const l=await y.get("/retail-food/daily-total",{params:{outlet_id:s.value.outlet_id,transaction_date:s.value.transaction_date,payment_method:"cash"}});S.value=l.data.total||0}catch{S.value=0}}async function q(){if(!s.value.outlet_id){b.value=[];return}try{const l=s.value.items.filter(a=>a.item_name&&a.item_name.trim()!=="");if(l.length===0){b.value=[];return}const e=await y.post("/retail-food/get-budget-info",{items:l.map(a=>({item_name:a.item_name,qty:a.qty||0,price:a.price||0})),outlet_id:s.value.outlet_id});b.value=e.data.budget_info||[]}catch(l){console.error("Error fetching budget info:",l),b.value=[]}}j([()=>s.value.outlet_id,()=>s.value.transaction_date,()=>s.value.payment_method,()=>s.value.items.map(l=>[l.qty,l.price])],lt,{immediate:!0,deep:!0}),j([()=>s.value.outlet_id,()=>s.value.items.map(l=>[l.item_name,l.qty,l.price])],q,{immediate:!0,deep:!0}),j(()=>s.value.payment_method,async l=>{var e,a;if(l==="cash"){const o=B.suppliers.find(d=>d.name.toLowerCase().includes("cash supplier"));o&&(s.value.supplier=o)}else if(l==="contra_bon")for(let o=0;o<s.value.items.length;o++){const d=s.value.items[o];if(d.item_id&&d.item_id!=="")try{const n=await y.get(`/retail-food/get-item-units/${d.item_id}`,{params:{payment_method:"contra_bon",outlet_id:s.value.outlet_id,region_id:(a=(e=x.props.auth)==null?void 0:e.user)==null?void 0:a.region_id}});n.data.default_unit&&(s.value.items[o].unit_id=n.data.default_unit.id,n.data.default_price>0&&(s.value.items[o].price=n.data.default_price),D(o))}catch(n){console.error("Error updating item for contra bon:",n)}}});const A=_([]),O=_([]);function nt(l){A.value=Array.from(l.target.files),O.value=A.value.map(e=>URL.createObjectURL(e))}async function ot(){var e,a;if(w.value)return;if(s.value.transaction_date&&s.value.transaction_date<R){await V.fire({icon:"warning",title:"Tanggal Tidak Valid",text:"Tanggal transaksi tidak boleh backdate. Pilih tanggal hari ini atau setelahnya.",confirmButtonText:"OK",confirmButtonColor:"#F59E0B"});return}if((await V.fire({title:"Simpan Data?",text:"Apakah Anda yakin ingin menyimpan transaksi ini?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya, Simpan",cancelButtonText:"Batal",confirmButtonColor:"#2563eb",cancelButtonColor:"#6b7280",reverseButtons:!0})).isConfirmed){w.value=!0;try{const o=new FormData;o.append("outlet_id",s.value.outlet_id),o.append("warehouse_outlet_id",s.value.warehouse_outlet_id),o.append("transaction_date",s.value.transaction_date),o.append("notes",s.value.notes),o.append("payment_method",s.value.payment_method),o.append("supplier_id",s.value.supplier?s.value.supplier.id:""),s.value.items.forEach((n,m)=>{var P;o.append(`items[${m}][item_name]`,n.item_name),o.append(`items[${m}][qty]`,n.qty),o.append(`items[${m}][unit_id]`,n.unit_id),o.append(`items[${m}][unit]`,((P=n.unitOptions.find(ut=>ut.id===n.unit_id))==null?void 0:P.name)||""),o.append(`items[${m}][price]`,n.price)}),A.value.forEach((n,m)=>{o.append("invoices[]",n)});const d=await y.post("/retail-food",o,{headers:{"Content-Type":"multipart/form-data"}});d.data.message&&(await V.fire({icon:"success",title:"Berhasil",text:d.data.message,timer:1500,showConfirmButton:!1}),H.visit("/retail-food"))}catch(o){V.fire({icon:"error",title:"Gagal",text:((a=(e=o.response)==null?void 0:e.data)==null?void 0:a.message)||"Gagal menyimpan transaksi"})}finally{w.value=!1}}}function it(){H.visit("/retail-food")}function c(l){return l?"Rp "+Number(l).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}):"Rp 0"}j(()=>C.value,l=>{l!=1&&(s.value.outlet_id=l)},{immediate:!0});const rt=k(()=>s.value.outlet_id?B.warehouse_outlets.filter(l=>String(l.outlet_id)===String(s.value.outlet_id)):[]);return(l,e)=>(i(),K(ct,null,{default:W(()=>[t("div",gt,[t("div",ht,[e[36]||(e[36]=t("h1",{class:"text-3xl font-extrabold mb-6 flex items-center gap-3 text-blue-800 drop-shadow-lg"},[t("i",{class:"fa-solid fa-store text-blue-500 text-3xl"}),p(" Input Retail Food ")],-1)),e[37]||(e[37]=t("div",{class:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-xl"},[t("h3",{class:"text-lg font-semibold text-blue-800 mb-3 flex items-center gap-2"},[t("i",{class:"fa-solid fa-info-circle text-blue-600"}),p(" Cara Penggunaan Retail Food ")]),t("div",{class:"text-sm text-blue-700 space-y-2"},[t("div",{class:"flex items-start gap-2"},[t("span",{class:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"1"),t("span",null,[t("strong",null,"Isi Data Transaksi:"),p(" Pilih tanggal, outlet, warehouse outlet, metode pembayaran (Cash/Contra Bon), dan supplier. "),t("strong",null,'Jika metode pembayaran Cash, pilih supplier "CASH SUPPLIER".')])]),t("div",{class:"flex items-start gap-2"},[t("span",{class:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"2"),t("span",null,[t("strong",null,"Tambah Items:"),p(" Cari item dengan mengetik nama item, pilih unit dan isi quantity serta harga. "),t("strong",null,"Jika metode pembayaran Contra Bon, unit medium dan harga akan otomatis terisi."),p(' Klik "+ Tambah Item" untuk menambah item baru.')])]),t("div",{class:"flex items-start gap-2"},[t("span",{class:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"3"),t("span",null,[t("strong",null,"Upload Bukti:"),p(" Upload foto bon/invoice dalam format JPG/PNG (bisa lebih dari 1 file).")])]),t("div",{class:"flex items-start gap-2"},[t("span",{class:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"4"),t("span",null,[t("strong",null,"Catatan:"),p(" Total transaksi "),t("strong",null,"Cash"),p(" per outlet per hari maksimal Rp 500.000. Transaksi "),t("strong",null,"Contra Bon"),p(" tidak ada batasan. Sistem akan memberikan peringatan jika melebihi batas.")])]),t("div",{class:"flex items-start gap-2"},[t("span",{class:"bg-blue-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"5"),t("span",null,[t("strong",null,"Simpan:"),p(' Klik tombol "Simpan" untuk menyimpan transaksi. Data akan otomatis masuk ke inventory outlet.')])])])],-1)),b.value.length>0?(i(),r("div",vt,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold text-yellow-800 mb-3 flex items-center gap-2"},[t("i",{class:"fa-solid fa-chart-pie text-yellow-600"}),p(" Informasi Budget Sub Category ")],-1)),t("div",bt,[(i(!0),r(h,null,v(b.value,a=>(i(),r("div",{key:a.sub_category_id,class:"bg-white p-3 rounded-lg border border-yellow-200 shadow-sm"},[t("div",_t,[t("h4",yt,u(a.sub_category_name),1),t("span",xt,u(a.category_name),1)]),t("div",wt,[t("div",kt,[e[6]||(e[6]=t("span",{class:"text-gray-600"},"Budget:",-1)),t("span",It,u(c(a.budget_amount)),1)]),t("div",Bt,[e[7]||(e[7]=t("span",{class:"text-gray-600"},"Retail Food:",-1)),t("span",Ct,u(c(a.retail_food_total)),1)]),t("div",St,[e[8]||(e[8]=t("span",{class:"text-gray-600"},"Food Floor Order:",-1)),t("span",Dt,u(c(a.food_floor_order_total)),1)]),t("div",Tt,[e[9]||(e[9]=t("span",{class:"text-gray-600"},"Total Bulanan:",-1)),t("span",jt,u(c(a.monthly_total)),1)]),t("div",Ut,[e[10]||(e[10]=t("span",{class:"text-gray-600"},"Input Baru:",-1)),t("span",$t,u(c(a.new_items_total)),1)]),t("div",Vt,[e[11]||(e[11]=t("span",{class:"text-gray-600"},"Total Setelah Input:",-1)),t("span",qt,u(c(a.total_after_new_items)),1)]),t("div",At,[e[12]||(e[12]=t("span",{class:"text-gray-600"},"Sisa Budget:",-1)),t("span",{class:F([a.remaining_budget>0?"text-green-600":"text-red-600","font-semibold"])},u(c(a.remaining_budget)),3)]),t("div",Ot,[t("div",Pt,[e[13]||(e[13]=t("span",null,"Penggunaan Budget",-1)),t("span",null,u(a.budget_percentage)+"%",1)]),t("div",Ft,[t("div",{class:F([a.budget_percentage>=90?"bg-red-500":a.budget_percentage>=70?"bg-yellow-500":"bg-green-500","h-2 rounded-full transition-all duration-300"]),style:G({width:Math.min(a.budget_percentage,100)+"%"})},null,6)])])])]))),128))])])):g("",!0),t("form",{onSubmit:z(ot,["prevent"]),class:"space-y-7"},[t("div",Rt,[t("div",null,[e[15]||(e[15]=t("label",{class:"block text-xs font-bold text-gray-600 mb-2"},"Tanggal",-1)),f(t("input",{type:"date",min:J(R),"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.transaction_date=a),class:"input input-bordered w-full shadow-inner rounded-xl focus:ring-2 focus:ring-blue-300 transition-all duration-200",required:""},null,8,Et),[[I,s.value.transaction_date]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-xs font-bold text-gray-600 mb-2"},"Outlet",-1)),f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.outlet_id=a),disabled:Y.value,class:"input input-bordered w-full shadow-inner rounded-xl focus:ring-2 focus:ring-blue-300 transition-all duration-200",required:""},[e[16]||(e[16]=t("option",{value:""},"Pilih Outlet",-1)),(i(!0),r(h,null,v(B.outlets,a=>(i(),r("option",{key:a.id_outlet,value:a.id_outlet},u(a.nama_outlet),9,Lt))),128))],8,Mt),[[U,s.value.outlet_id]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-xs font-bold text-gray-600 mb-2"},"Warehouse Outlet",-1)),f(t("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.warehouse_outlet_id=a),class:"input input-bordered w-full shadow-inner rounded-xl focus:ring-2 focus:ring-blue-300 transition-all duration-200",required:""},[e[18]||(e[18]=t("option",{value:""},"Pilih Warehouse Outlet",-1)),(i(!0),r(h,null,v(rt.value,a=>(i(),r("option",{key:a.id,value:a.id},u(a.name),9,Nt))),128))],512),[[U,s.value.warehouse_outlet_id]])])]),t("div",Kt,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-xs font-bold text-gray-600 mb-2"},"Metode Pembayaran",-1)),f(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.payment_method=a),class:"input input-bordered w-full shadow-inner rounded-xl focus:ring-2 focus:ring-blue-300 transition-all duration-200",required:""},e[20]||(e[20]=[t("option",{value:""},"Pilih Metode Pembayaran",-1),t("option",{value:"cash"},"Cash",-1),t("option",{value:"contra_bon"},"Contra Bon",-1)]),512),[[U,s.value.payment_method]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-xs font-bold text-gray-600 mb-2"},"Supplier",-1)),pt(J(ft),{modelValue:s.value.supplier,"onUpdate:modelValue":e[4]||(e[4]=a=>s.value.supplier=a),options:B.suppliers,searchable:!0,"close-on-select":!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih atau cari supplier...","track-by":"id",label:"name","preselect-first":!1,class:"w-full"},{option:W(({option:a})=>[t("div",Wt,[t("span",null,u(a.name),1),t("span",Gt,u(a.code),1)])]),_:1},8,["modelValue","options"])])]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-xs font-bold text-gray-600 mb-1"},"Items",-1)),t("div",zt,[t("table",Jt,[e[28]||(e[28]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Item"),t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Qty"),t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Unit"),t("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Harga"),t("th",{class:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase"},"Subtotal"),t("th",{class:"px-3 py-2"})])],-1)),t("tbody",Ht,[(i(!0),r(h,null,v(s.value.items,(a,o)=>{var d;return i(),r("tr",{key:o},[t("td",Qt,[t("div",Yt,[f(t("input",{id:`item-input-${o}`,type:"text","onUpdate:modelValue":n=>a.item_name=n,onInput:n=>L(o,n),onFocus:n=>L(o,n),onBlur:n=>at(o),onKeydown:[$(n=>T(o,n),["down"]),$(n=>T(o,n),["up"]),$(n=>T(o,n),["enter"]),$(n=>T(o,n),["esc"])],class:"input input-bordered w-full",required:"",autocomplete:"off",placeholder:"Cari nama item..."},null,40,Zt),[[I,a.item_name]]),(i(),K(mt,{to:"body"},[a.showDropdown&&a.suggestions&&a.suggestions.length>0?(i(),r("div",{key:0,style:G(st(o)),id:`autocomplete-dropdown-${o}`,class:"fixed z-[99999] bg-white border border-blue-200 rounded shadow max-w-xs w-[260px] max-h-96 overflow-auto mt-1"},[(i(!0),r(h,null,v(a.suggestions,(n,m)=>(i(),r("div",{key:n.id,id:`autocomplete-item-${o}-${m}`,onMousedown:z(P=>N(o,n),["prevent"]),class:F(["px-3 py-2 flex justify-between items-center cursor-pointer",a.highlightedIndex===m?"bg-blue-100":"hover:bg-blue-50"])},[t("div",null,[t("div",ee,u(n.name),1),t("div",ae,u(n.sku),1)]),t("div",se,u(n.unit_small||n.unit||""),1)],42,te))),128))],12,Xt)):g("",!0)])),a.loading?(i(),r("div",le,e[23]||(e[23]=[t("i",{class:"fa fa-spinner fa-spin text-blue-400"},null,-1)]))):g("",!0)])]),t("td",ne,[f(t("input",{type:"number",min:"0.01",step:"0.01","onUpdate:modelValue":n=>a.qty=n,onInput:n=>D(o),class:"input input-bordered w-full",required:""},null,40,oe),[[I,a.qty,void 0,{number:!0}]])]),t("td",ie,[t("div",re,[f(t("select",{"onUpdate:modelValue":n=>a.unit_id=n,class:"input input-bordered w-full",required:""},[e[24]||(e[24]=t("option",{value:""},"Pilih Unit",-1)),(i(!0),r(h,null,v(a.unitOptions,n=>(i(),r("option",{key:n.id,value:n.id},u(n.name)+u(n.is_medium?" (Medium)":""),9,de))),128))],8,ue),[[U,a.unit_id]]),s.value.payment_method==="contra_bon"&&((d=a.unitOptions.find(n=>n.id===a.unit_id))!=null&&d.is_medium)?(i(),r("div",pe," Auto ")):g("",!0)])]),t("td",me,[t("div",ce,[f(t("input",{type:"number",min:"0",step:"0.01","onUpdate:modelValue":n=>a.price=n,onInput:n=>D(o),class:"input input-bordered w-full",required:""},null,40,fe),[[I,a.price,void 0,{number:!0}]]),s.value.payment_method==="contra_bon"&&a.price>0?(i(),r("div",ge," Auto ")):g("",!0)])]),t("td",he,u(c(a.subtotal)),1),t("td",ve,[t("button",{type:"button",onClick:n=>tt(o),class:"text-red-500 hover:text-red-700",disabled:s.value.items.length===1},e[25]||(e[25]=[t("i",{class:"fa-solid fa-trash"},null,-1)]),8,be)])])}),128))]),t("tfoot",null,[t("tr",null,[e[26]||(e[26]=t("td",{colspan:"4",class:"px-3 py-2 text-right font-bold"},"Total:",-1)),t("td",_e,u(c(M.value)),1),e[27]||(e[27]=t("td",null,null,-1))])])])]),t("div",{class:"mt-2"},[t("button",{type:"button",onClick:X,class:"text-blue-500 hover:text-blue-700"},e[29]||(e[29]=[t("i",{class:"fa fa-plus mr-1"},null,-1),p(" Tambah Item ")]))])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-xs font-bold text-gray-600 mb-1"},"Catatan",-1)),f(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=a=>s.value.notes=a),class:"input input-bordered w-full",rows:"3"},null,512),[[I,s.value.notes]])]),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-xs font-bold text-gray-600 mb-1"},"Upload Bon/Invoice (jpg/png, bisa lebih dari 1)",-1)),t("input",{type:"file",multiple:"",accept:"image/jpeg,image/png",onChange:nt},null,32),O.value.length?(i(),r("div",ye,[(i(!0),r(h,null,v(O.value,(a,o)=>(i(),r("div",{key:o,class:"w-24 h-24 border rounded overflow-hidden flex items-center justify-center bg-gray-50"},[t("img",{src:a,class:"object-contain w-full h-full"},null,8,xe)]))),128))])):g("",!0)]),Z.value?(i(),r("div",we,e[33]||(e[33]=[t("i",{class:"fa fa-triangle-exclamation text-xl"},null,-1),t("span",null,[p("Total transaksi "),t("strong",null,"Cash"),p(" outlet hari ini sudah melebihi Rp 500.000!")],-1)]))):g("",!0),t("div",ke,[t("button",{type:"button",onClick:it,class:"btn px-6 py-2 rounded-lg font-bold bg-gradient-to-r from-gray-200 to-gray-400 text-gray-700 shadow-md hover:from-gray-300 hover:to-gray-500 active:scale-95 transition-all"}," Batal "),t("button",{type:"submit",class:"btn px-6 py-2 rounded-lg font-bold bg-gradient-to-r from-blue-500 to-blue-700 text-white shadow-lg hover:from-blue-600 hover:to-blue-800 active:scale-95 transition-all flex items-center gap-2",disabled:w.value},[w.value?(i(),r("span",Be,e[34]||(e[34]=[t("i",{class:"fa fa-spinner fa-spin"},null,-1),p(" Menyimpan...")]))):(i(),r("span",Ce,e[35]||(e[35]=[t("i",{class:"fa fa-save"},null,-1),p(" Simpan")])))],8,Ie)])],32)])])]),_:1}))}};export{Re as default};
