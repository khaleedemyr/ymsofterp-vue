import{a as F}from"./vendor-utils-CpgP2uT4.js";import{m as P}from"./vendor-charts-CuqD4wLC.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as m,w as I,c as N,a8 as z,L as l,E as h,B as n,D as t,N as a,x as G,F as k,M as R,G as A,l as W}from"./vendor-vue-g7iCcTkf.js";const H={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},K={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},$={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-7xl sm:w-full max-h-[90vh] flex flex-col"},q={class:"bg-white px-6 py-4 border-b border-gray-200"},J={class:"flex items-center justify-between"},Q={key:0,class:"text-sm text-gray-600 mt-1"},U={class:"bg-white px-6 py-4 flex-1 overflow-y-auto"},X={key:0,class:"text-center py-8"},Y={key:1,class:"text-center py-8"},Z={class:"text-red-600"},tt={key:2},et={class:"bg-white border border-gray-200 rounded-lg p-6 mb-6"},st={class:"h-80"},at={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},rt={class:"bg-blue-50 rounded-lg p-4"},ot={class:"flex items-center"},it={class:"ml-3"},lt={class:"text-2xl font-bold text-blue-800"},nt={class:"bg-green-50 rounded-lg p-4"},dt={class:"flex items-center"},ct={class:"ml-3"},xt={class:"text-lg font-bold text-green-800"},pt={class:"bg-orange-50 rounded-lg p-4"},ut={class:"flex items-center"},mt={class:"ml-3"},gt={class:"text-2xl font-bold text-orange-800"},yt={class:"bg-purple-50 rounded-lg p-4"},ft={class:"flex items-center"},ht={class:"ml-3"},_t={class:"text-2xl font-bold text-purple-800"},vt={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},bt={class:"px-6 py-4 bg-gray-50 border-b border-gray-200"},wt={class:"text-sm text-gray-600"},kt={class:"overflow-x-auto"},Dt={class:"min-w-full divide-y divide-gray-200"},Ot={class:"bg-white divide-y divide-gray-200"},Ft={class:"hover:bg-gray-50"},It={class:"px-6 py-4 whitespace-nowrap"},Nt={class:"text-sm font-medium text-gray-900"},Rt={class:"text-sm text-gray-500"},Tt={class:"px-6 py-4 whitespace-nowrap"},Bt={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},Ct={class:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900"},Et={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900"},St={class:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900"},Lt={class:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900"},Mt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900"},jt={class:"px-6 py-4 whitespace-nowrap text-center"},Pt=["onClick"],Vt={key:0,class:"bg-gray-50"},zt={colspan:"8",class:"px-6 py-4"},Gt={class:"bg-white rounded-lg border border-gray-200 p-4"},At={class:"text-sm font-semibold text-gray-900 mb-3"},Wt={key:0,class:"text-center py-4"},Ht={key:1,class:"overflow-x-auto"},Kt={class:"min-w-full divide-y divide-gray-200"},$t={class:"bg-white divide-y divide-gray-200"},qt={class:"px-2 py-2 whitespace-nowrap text-sm font-medium text-gray-900"},Jt={class:"px-2 py-2 whitespace-nowrap text-sm text-gray-900"},Qt={class:"px-2 py-2 whitespace-nowrap text-sm text-gray-900"},Ut={class:"px-2 py-2 whitespace-nowrap text-sm text-right text-gray-900"},Xt={class:"px-2 py-2 whitespace-nowrap text-sm text-right text-gray-900"},Yt={class:"px-2 py-2 whitespace-nowrap text-sm text-right text-gray-900"},Zt={class:"px-2 py-2 whitespace-nowrap text-sm text-right font-medium text-gray-900"},te={class:"px-2 py-2 whitespace-nowrap text-sm text-right text-gray-900"},ee={class:"px-2 py-2 whitespace-nowrap text-sm text-right text-gray-900"},se={class:"px-2 py-2 whitespace-nowrap text-sm text-gray-900"},ae={class:"px-2 py-2 whitespace-nowrap text-sm text-gray-900"},re={class:"px-2 py-2 whitespace-nowrap text-sm text-gray-900"},oe={class:"px-2 py-2 whitespace-nowrap text-sm text-gray-900"},ie={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},le={class:"px-2 py-2 whitespace-nowrap text-sm text-gray-900"},ne={key:2,class:"text-center py-4"},de={key:0,class:"text-center py-8"},ce={key:3,class:"text-center py-8"},xe={components:{apexchart:P}},pe=Object.assign(xe,{__name:"OutletDetailsModal",props:{isOpen:Boolean,selectedDate:String},emits:["close"],setup(D,{emit:T}){const x=D,B=T,_=m(!1),i=m(null),g=m(null),p=m(new Set),v=m(new Set),u=m({});I(()=>x.selectedDate,r=>{r&&x.isOpen&&O(r)},{immediate:!0}),I(()=>x.isOpen,r=>{r&&x.selectedDate?O(x.selectedDate):r||(i.value=null,g.value=null)});async function O(r){var e,d;if(r){_.value=!0,g.value=null;try{const s=await F.get("/sales-outlet-dashboard/outlet-details",{params:{date:r}});i.value=s.data}catch(s){g.value=((d=(e=s.response)==null?void 0:e.data)==null?void 0:d.error)||"Gagal mengambil data outlet",console.error("Error fetching outlet data:",s)}finally{_.value=!1}}}function f(r){return r.toLocaleString("id-ID")}function b(){B("close")}function C(r){p.value.has(r)?p.value.delete(r):(p.value.add(r),u.value[r]||E(r))}async function E(r){if(x.selectedDate){v.value.add(r);try{const e=await F.get("/sales-outlet-dashboard/outlet-orders",{params:{outlet_code:r,date:x.selectedDate}});u.value[r]=e.data.orders}catch(e){console.error("Error fetching outlet orders:",e),u.value[r]=[]}finally{v.value.delete(r)}}}function y(r){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}const S=N(()=>{var o;if(!((o=i.value)!=null&&o.outlets))return[];const e=[...i.value.outlets].sort((c,w)=>w.revenue-c.revenue).map(c=>c.outlet_name),d={};i.value.outlets.forEach(c=>{d[c.region_name]||(d[c.region_name]={}),d[c.region_name][c.outlet_name]=c.revenue});const s=[];return Object.keys(d).forEach(c=>{const w=d[c],M=e.map(j=>w[j]||0);s.push({name:c,data:M})}),s}),L=N(()=>{var d;if(!((d=i.value)!=null&&d.outlets))return{};const e=[...i.value.outlets].sort((s,o)=>o.revenue-s.revenue).map(s=>s.outlet_name);return{chart:{type:"bar",height:300,toolbar:{show:!0},dropShadow:{enabled:!0,top:4,left:2,blur:8,opacity:.18}},plotOptions:{bar:{borderRadius:4,columnWidth:"60%",dataLabels:{enabled:!1},horizontal:!1}},xaxis:{categories:e,labels:{rotate:-45,style:{fontSize:"12px"}}},yaxis:{title:{text:"Revenue (Rp)"},labels:{formatter:function(s){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}}},colors:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"],legend:{position:"top"},grid:{borderColor:"#e5e7eb"},tooltip:{shared:!0,intersect:!1,y:{formatter:function(s){return s===0?"N/A":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}}},dataLabels:{enabled:!1}}});return(r,e)=>{const d=z("apexchart");return D.isOpen?(n(),l("div",H,[t("div",K,[t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:b}),t("div",$,[t("div",q,[t("div",J,[t("div",null,[e[0]||(e[0]=t("h3",{class:"text-lg font-semibold text-gray-900"}," Detail Outlet per Hari ",-1)),i.value?(n(),l("p",Q,a(i.value.date_formatted),1)):h("",!0)]),t("button",{onClick:b,class:"text-gray-400 hover:text-gray-600 transition-colors"},e[1]||(e[1]=[t("i",{class:"fa-solid fa-times text-xl"},null,-1)]))])]),t("div",U,[_.value?(n(),l("div",X,e[2]||(e[2]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),t("p",{class:"mt-2 text-gray-600"},"Memuat data outlet...",-1)]))):g.value?(n(),l("div",Y,[e[3]||(e[3]=t("div",{class:"text-red-500 mb-4"},[t("i",{class:"fa-solid fa-exclamation-triangle text-4xl"})],-1)),t("p",Z,a(g.value),1)])):i.value?(n(),l("div",tt,[t("div",et,[e[4]||(e[4]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Revenue per Outlet by Region",-1)),t("div",st,[G(d,{type:"bar",height:"100%",options:L.value,series:S.value},null,8,["options","series"])])]),t("div",at,[t("div",rt,[t("div",ot,[e[6]||(e[6]=t("div",{class:"bg-blue-100 p-2 rounded-lg"},[t("i",{class:"fa-solid fa-store text-blue-600"})],-1)),t("div",it,[e[5]||(e[5]=t("p",{class:"text-sm text-blue-600 font-medium"},"Total Outlet",-1)),t("p",lt,a(i.value.summary.total_outlets),1)])])]),t("div",nt,[t("div",dt,[e[8]||(e[8]=t("div",{class:"bg-green-100 p-2 rounded-lg"},[t("i",{class:"fa-solid fa-money-bill-wave text-green-600"})],-1)),t("div",ct,[e[7]||(e[7]=t("p",{class:"text-sm text-green-600 font-medium"},"Total Revenue",-1)),t("p",xt,a(i.value.summary.total_revenue_formatted),1)])])]),t("div",pt,[t("div",ut,[e[10]||(e[10]=t("div",{class:"bg-orange-100 p-2 rounded-lg"},[t("i",{class:"fa-solid fa-receipt text-orange-600"})],-1)),t("div",mt,[e[9]||(e[9]=t("p",{class:"text-sm text-orange-600 font-medium"},"Total Orders",-1)),t("p",gt,a(f(i.value.summary.total_orders)),1)])])]),t("div",yt,[t("div",ft,[e[12]||(e[12]=t("div",{class:"bg-purple-100 p-2 rounded-lg"},[t("i",{class:"fa-solid fa-users text-purple-600"})],-1)),t("div",ht,[e[11]||(e[11]=t("p",{class:"text-sm text-purple-600 font-medium"},"Total Customers",-1)),t("p",_t,a(f(i.value.summary.total_customers)),1)])])])]),t("div",vt,[t("div",bt,[e[13]||(e[13]=t("h4",{class:"text-lg font-semibold text-gray-900"},"Detail per Outlet",-1)),t("p",wt,"Rata-rata revenue per outlet: "+a(i.value.summary.avg_revenue_per_outlet_formatted),1)]),t("div",kt,[t("table",Dt,[e[17]||(e[17]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Outlet "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Region "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Orders "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Revenue "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Customers "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Avg Order Value "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Cover "),t("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),t("tbody",Ot,[(n(!0),l(k,null,R(i.value.outlets,s=>(n(),l(k,{key:s.outlet_code},[t("tr",Ft,[t("td",It,[t("div",null,[t("div",Nt,a(s.outlet_name),1),t("div",Rt,a(s.outlet_code),1)])]),t("td",Tt,[t("span",Bt,a(s.region_name),1)]),t("td",Ct,a(f(s.orders)),1),t("td",Et,a(s.revenue_formatted),1),t("td",St,a(f(s.customers)),1),t("td",Lt,a(s.avg_order_value_formatted),1),t("td",Mt,a(s.cover_formatted),1),t("td",jt,[t("button",{onClick:o=>C(s.outlet_code),class:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[t("i",{class:W([p.value.has(s.outlet_code)?"fa-solid fa-chevron-up":"fa-solid fa-chevron-down","mr-1"])},null,2),A(" "+a(p.value.has(s.outlet_code)?"Tutup":"Lihat Orders"),1)],8,Pt)])]),p.value.has(s.outlet_code)?(n(),l("tr",Vt,[t("td",zt,[t("div",Gt,[t("h5",At," Detail Orders - "+a(s.outlet_name),1),v.value.has(s.outlet_code)?(n(),l("div",Wt,e[14]||(e[14]=[t("div",{class:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1),t("p",{class:"mt-2 text-sm text-gray-600"},"Memuat data orders...",-1)]))):u.value[s.outlet_code]&&u.value[s.outlet_code].length>0?(n(),l("div",Ht,[t("table",Kt,[e[15]||(e[15]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," ID "),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Paid Number "),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Table "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Total "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," PB1 "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Service "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Grand Total "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Pax "),t("th",{class:"px-2 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Comm Fee "),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Waiters "),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Kasir "),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Customer "),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Payment "),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Waktu ")])],-1)),t("tbody",$t,[(n(!0),l(k,null,R(u.value[s.outlet_code],o=>(n(),l("tr",{key:o.id,class:"hover:bg-gray-50"},[t("td",qt,a(o.order_id),1),t("td",Jt,a(o.paid_number),1),t("td",Qt,a(o.table),1),t("td",Ut,a(y(o.total)),1),t("td",Xt,a(y(o.pb1)),1),t("td",Yt,a(y(o.service)),1),t("td",Zt,a(y(o.grand_total)),1),t("td",te,a(o.pax),1),t("td",ee,a(y(o.commfee)),1),t("td",se,a(o.waiters),1),t("td",ae,a(o.kasir),1),t("td",re,a(o.customer),1),t("td",oe,[t("span",ie,a(o.payment_method),1)]),t("td",le,a(o.created_at_formatted),1)]))),128))])])])):(n(),l("div",ne,e[16]||(e[16]=[t("i",{class:"fa-solid fa-receipt text-2xl text-gray-400 mb-2"},null,-1),t("p",{class:"text-sm text-gray-500"},"Tidak ada data orders untuk outlet ini",-1)])))])])])):h("",!0)],64))),128))])])]),i.value.outlets.length===0?(n(),l("div",de,e[18]||(e[18]=[t("i",{class:"fa-solid fa-store text-4xl text-gray-400 mb-4"},null,-1),t("p",{class:"text-gray-500"},"Tidak ada data outlet untuk tanggal ini",-1)]))):h("",!0)])])):(n(),l("div",ce,e[19]||(e[19]=[t("i",{class:"fa-solid fa-calendar text-4xl text-gray-400 mb-4"},null,-1),t("p",{class:"text-gray-500"},"Pilih tanggal untuk melihat detail outlet",-1)])))]),t("div",{class:"bg-gray-50 px-6 py-3 border-t border-gray-200"},[t("div",{class:"flex justify-end"},[t("button",{onClick:b,class:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors"}," Tutup ")])])])])])):h("",!0)}}}),fe=V(pe,[["__scopeId","data-v-b833f0ab"]]);export{fe as default};
