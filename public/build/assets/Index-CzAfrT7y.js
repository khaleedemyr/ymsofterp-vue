import{r as u,W as I,a as re,A as k,B as a,C as _,D as e,L as n,E as y,G as o,H as h,J as T,I as E,F as j,M as R,N as i,l as z,x as ae,Q as O,S as P}from"./vendor-vue-g7iCcTkf.js";import{A as ne}from"./AppLayout-DZJ25Yod.js";import{S as C}from"./app-BujIObx9.js";import{l as le}from"./lodash-DB3HVzpp.js";import"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DNpNU_ax.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const oe={class:"w-full py-8 px-4"},ie={class:"flex flex-col md:flex-row gap-4 mb-6"},ue={class:"bg-white rounded-xl shadow-lg overflow-hidden"},de={class:"overflow-x-auto"},pe={class:"min-w-full divide-y divide-gray-200"},ce={class:"bg-white divide-y divide-gray-200"},xe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},be={key:0,class:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded"},ye={key:1,class:"text-gray-400"},he={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ve={key:0,class:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded"},we={key:1,class:"text-gray-400"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},_e={class:"px-6 py-4 whitespace-nowrap"},Oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Pe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ce={class:"flex space-x-2"},Se=["onClick"],De=["onClick","disabled"],Be={key:0,class:"fas fa-spinner fa-spin mr-1"},Ie={key:1,class:"fas fa-trash mr-1"},Te={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},je={class:"flex-1 flex justify-between sm:hidden"},He={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Ne={class:"text-sm text-gray-700"},Fe={class:"font-medium"},$e={class:"font-medium"},Le={class:"font-medium"},Me={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},Ue=["innerHTML"],Ve={key:0,class:"fixed inset-0 z-[100000] flex items-center justify-center bg-black/40"},Ae={class:"bg-white rounded-xl shadow-lg w-full max-w-6xl p-6 relative"},Ee={class:"p-4",style:{height:"80vh"}},Re=["src"],tt={__name:"Index",props:{purchaseOrders:Object,filters:Object,user:Object},setup(l){var $,L,M,U,V;const p=l,c=u((($=p.filters)==null?void 0:$.search)||""),x=u(((L=p.filters)==null?void 0:L.status)||""),m=u(((M=p.filters)==null?void 0:M.from)||""),f=u(((U=p.filters)==null?void 0:U.to)||""),g=u(((V=p.filters)==null?void 0:V.perPage)||10),d=u(!1),S=u(!1),H=u([]),D=u(""),B=u(null),b=le.debounce(()=>{const r={search:c.value,status:x.value,from:m.value,to:f.value,perPage:g.value};sessionStorage.setItem("po-ops-filters",JSON.stringify(r)),I.get("/po-ops",r,{preserveState:!0,replace:!0})},400);function G(){b()}function J(){b()}function N(){b()}function W(){b()}function K(){c.value="",x.value="",m.value="",f.value="",g.value=10,b()}function F(r){return{draft:"bg-gray-100 text-gray-800",submitted:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",received:"bg-blue-100 text-blue-800",cancelled:"bg-gray-100 text-gray-800"}[r]||"bg-gray-100 text-gray-800"}function Q(r){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r)}function Y(r){return new Date(r).toLocaleDateString("id-ID")}function q(r){var t;C.fire({title:"Konfirmasi Hapus",html:`
      <div class="text-left">
        <p class="mb-2">Apakah Anda yakin ingin menghapus Purchase Order berikut?</p>
        <div class="bg-gray-100 p-3 rounded-lg">
          <p><strong>PO Number:</strong> ${r.number}</p>
          <p><strong>Supplier:</strong> ${((t=r.supplier)==null?void 0:t.name)||"Unknown"}</p>
          <p><strong>Total:</strong> Rp ${new Intl.NumberFormat("id-ID").format(r.grand_total)}</p>
          <p><strong>Status:</strong> <span class="px-2 py-1 rounded text-xs ${F(r.status)}">${r.status.toUpperCase()}</span></p>
        </div>
        <p class="mt-2 text-red-600 text-sm"><i class="fas fa-exclamation-triangle mr-1"></i>Tindakan ini tidak dapat dibatalkan!</p>
      </div>
    `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:'<i class="fas fa-trash mr-2"></i>Ya, Hapus!',cancelButtonText:'<i class="fas fa-times mr-2"></i>Batal',showLoaderOnConfirm:!0,preConfirm:()=>(d.value=!0,new Promise((s,v)=>{I.delete(`/po-ops/${r.id}`,{onSuccess:w=>{d.value=!1,s()},onError:w=>{d.value=!1,v(new Error("Gagal menghapus PO. Silakan coba lagi."))}})})),allowOutsideClick:()=>!d.value}).then(s=>{s.isConfirmed&&C.fire({title:"Berhasil!",text:`Purchase Order ${r.number} berhasil dihapus.`,icon:"success",timer:2e3,showConfirmButton:!1})}).catch(s=>{C.fire({title:"Error!",text:s.message||"Gagal menghapus Purchase Order.",icon:"error",confirmButtonText:"OK"})})}function X(){I.visit("/po-ops/create")}async function Z(r){try{H.value=[r];const t=r.id.toString();D.value=`/po-ops/print-preview?ids=${encodeURIComponent(t)}`,S.value=!0}catch(t){console.error("Error preparing print:",t),C.fire("Error","Gagal mempersiapkan print","error")}}function ee(){S.value=!1,D.value="",H.value=[]}function te(){B.value&&B.value.contentWindow.print()}return re(()=>{const r=sessionStorage.getItem("po-ops-filters");if(r){const t=JSON.parse(r);c.value=t.search||"",x.value=t.status||"",m.value=t.from||"",f.value=t.to||"",g.value=t.perPage||10}}),(r,t)=>(a(),k(ne,{title:"Purchase Order Ops"},{default:_(()=>[e("div",oe,[e("div",{class:"flex justify-between items-center mb-6"},[t[5]||(t[5]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-shopping-cart text-blue-500"}),o(" Purchase Order Ops ")],-1)),e("button",{onClick:X,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Buat Purchase Order Baru ")]),e("div",ie,[h(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),onInput:G,placeholder:"Cari PO number, supplier, PR number, outlet...",class:"flex-1 px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,544),[[T,c.value]]),h(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>x.value=s),onChange:J,class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[6]||(t[6]=[e("option",{value:""},"Semua Status",-1),e("option",{value:"draft"},"Draft",-1),e("option",{value:"approved"},"Approved",-1),e("option",{value:"received"},"Received",-1),e("option",{value:"rejected"},"Rejected",-1)]),544),[[E,x.value]]),h(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>m.value=s),onChange:N,placeholder:"Dari Tanggal",class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,544),[[T,m.value]]),h(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=s=>f.value=s),onChange:N,placeholder:"Sampai Tanggal",class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,544),[[T,f.value]]),h(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>g.value=s),onChange:W,class:"w-full md:w-auto px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[7]||(t[7]=[e("option",{value:"10"},"10 Per Halaman",-1),e("option",{value:"25"},"25 Per Halaman",-1),e("option",{value:"50"},"50 Per Halaman",-1)]),544),[[E,g.value]]),e("button",{onClick:K,class:"w-full md:w-auto px-4 py-2 bg-gray-500 text-white rounded-xl hover:bg-gray-600 transition"}," Clear Filters ")]),e("div",ue,[e("div",de,[e("table",pe,[t[11]||(t[11]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"PO Number"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Supplier"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Source PR"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Outlet"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Creator"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ce,[(a(!0),n(j,null,R(l.purchaseOrders.data,s=>{var v,w,A;return a(),n("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",xe,i(s.number),1),e("td",me,i(Y(s.date)),1),e("td",fe,i(((v=s.supplier)==null?void 0:v.name)||"-"),1),e("td",ge,[s.source_pr_number?(a(),n("span",be,i(s.source_pr_number),1)):(a(),n("span",ye,"-"))]),e("td",he,[(w=s.outlet)!=null&&w.nama_outlet?(a(),n("span",ve,i(s.outlet.nama_outlet),1)):(a(),n("span",we,"-"))]),e("td",ke,i(Q(s.grand_total)),1),e("td",_e,[e("span",{class:z(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",F(s.status)])},i(s.status.toUpperCase()),3)]),e("td",Oe,i(((A=s.creator)==null?void 0:A.nama_lengkap)||"-"),1),e("td",Pe,[e("div",Ce,[ae(O(P),{href:`/po-ops/${s.id}`,class:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded hover:bg-blue-200 transition-colors",title:"Lihat Detail"},{default:_(()=>t[8]||(t[8]=[e("i",{class:"fas fa-eye mr-1"},null,-1),o(" Detail ")])),_:2},1032,["href"]),e("button",{onClick:se=>Z(s),class:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded hover:bg-purple-200 transition-colors",title:"Print PDF"},t[9]||(t[9]=[e("i",{class:"fas fa-print mr-1"},null,-1),o(" Print ")]),8,Se),s.status==="draft"||s.status==="approved"?(a(),n("button",{key:0,onClick:se=>q(s),disabled:d.value,class:"inline-flex items-center px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded hover:bg-red-200 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Hapus Purchase Order"},[d.value?(a(),n("i",Be)):(a(),n("i",Ie)),t[10]||(t[10]=o(" Hapus "))],8,De)):y("",!0)])])])}),128))])])]),l.purchaseOrders.links?(a(),n("div",Te,[e("div",je,[l.purchaseOrders.prev_page_url?(a(),k(O(P),{key:0,href:l.purchaseOrders.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:_(()=>t[12]||(t[12]=[o(" Previous ")])),_:1},8,["href"])):y("",!0),l.purchaseOrders.next_page_url?(a(),k(O(P),{key:1,href:l.purchaseOrders.next_page_url,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:_(()=>t[13]||(t[13]=[o(" Next ")])),_:1},8,["href"])):y("",!0)]),e("div",He,[e("div",null,[e("p",Ne,[t[14]||(t[14]=o(" Showing ")),e("span",Fe,i(l.purchaseOrders.from),1),t[15]||(t[15]=o(" to ")),e("span",$e,i(l.purchaseOrders.to),1),t[16]||(t[16]=o(" of ")),e("span",Le,i(l.purchaseOrders.total),1),t[17]||(t[17]=o(" results "))])]),e("div",null,[e("nav",Me,[(a(!0),n(j,null,R(l.purchaseOrders.links,s=>(a(),n(j,{key:s.label},[s.url?(a(),k(O(P),{key:0,href:s.url,innerHTML:s.label,class:z(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",s.active?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"])},null,8,["href","innerHTML","class"])):(a(),n("span",{key:1,innerHTML:s.label,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700"},null,8,Ue))],64))),128))])])])])):y("",!0)])]),S.value?(a(),n("div",Ve,[e("div",Ae,[e("button",{onClick:ee,class:"absolute top-3 right-3 text-gray-400 hover:text-gray-600"},t[18]||(t[18]=[e("i",{class:"fas fa-times text-lg"},null,-1)])),e("div",{class:"flex justify-between items-center mb-4"},[t[20]||(t[20]=e("h3",{class:"text-lg font-medium"},"Preview Purchase Order",-1)),e("div",{class:"flex gap-2"},[e("button",{onClick:te,class:"px-3 py-1 text-sm bg-blue-100 text-blue-600 rounded hover:bg-blue-200 flex items-center gap-1"},t[19]||(t[19]=[e("i",{class:"fas fa-print"},null,-1),o(" Print ")]))])]),e("div",Ee,[e("iframe",{src:D.value,class:"w-full h-full border-0",ref_key:"previewFrame",ref:B},null,8,Re)])])])):y("",!0)]),_:1}))}};export{tt as default};
