import{P as E,r as x,w as F,L as a,E as b,B as r,D as s,N as n,O as D,H as g,J as V,Q as l,I as C,F as _,M as w,x as S,C as N,l as B,a6 as O,G as U}from"./vendor-vue-g7iCcTkf.js";import{S as h}from"./app-B-3LCfNP.js";import{s as M}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as I}from"./vendor-ui-CrPgGUUb.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";const T={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 transition-all"},K={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-auto p-0 animate-fade-in"},q={class:"px-8 pt-8 pb-2"},z={class:"flex items-center gap-2 mb-6"},G={class:"text-2xl font-bold text-gray-900"},H={class:"space-y-4"},L={key:0,class:"text-xs text-red-500 mt-1"},$={key:0,class:"text-xs text-red-500 mt-1"},J=["value"],Q={key:0,class:"text-xs text-red-500 mt-1"},Y=["value"],W={key:0,class:"text-xs text-red-500 mt-1"},X={class:"flex gap-4"},Z={class:"flex-1"},ee={key:0,class:"text-xs text-red-500 mt-1"},te={class:"flex-1"},se={class:"ml-2 text-gray-700"},oe={key:0,class:"text-xs text-red-500 mt-1"},le={class:"mt-4"},ie={class:"flex gap-4 mb-2"},ae={class:"inline-flex items-center"},re={class:"inline-flex items-center"},ne={key:0},ue={class:"flex flex-wrap gap-2 mt-2"},de=["onClick"],ce={key:1},me={class:"flex flex-wrap gap-2 mt-2"},be=["onClick"],pe={class:"mt-8 flex justify-end gap-3"},ge=["disabled"],fe={__name:"SubCategoryFormModal",props:{show:Boolean,mode:String,subCategory:Object,categories:Array,coas:Array,regions:Array,outlets:Array},emits:["close","success"],setup(v,{emit:P}){const i=v,y=P,t=E({code:"",name:"",description:"",status:"active",show_pos:"1",category_id:"",coa_id:"",availability_type:"",selected_regions:[],selected_outlets:[]}),u=x("byRegion"),d=x([]),c=x([]);F(()=>i.show,f=>{if(f&&i.mode==="edit"&&i.subCategory){t.code=i.subCategory.code,t.name=i.subCategory.name,t.description=i.subCategory.description,t.status=i.subCategory.status,t.show_pos=String(i.subCategory.show_pos),t.category_id=i.subCategory.category_id,t.coa_id=i.subCategory.coa_id||"";const e=i.subCategory.outlet_ids?i.outlets.filter(p=>i.subCategory.outlet_ids.includes(p.id)):[];c.value=e;const o=[...new Set(e.map(p=>p.region_id))];d.value=i.regions.filter(p=>o.includes(p.id)),u.value=e.length>0?"byOutlet":"byRegion"}else t.code="",t.name="",t.description="",t.status="active",t.show_pos="1",t.category_id="",t.coa_id="",d.value=[],c.value=[],u.value="byRegion"});const m=x(!1);async function R(){let f=[];if(u.value==="byRegion"){if(d.value.length===0){h.fire("Pilih minimal satu region!"),m.value=!1;return}f=i.outlets.filter(e=>d.value.map(o=>o.id).includes(e.region_id)).map(e=>e.id)}else{if(c.value.length===0){h.fire("Pilih minimal satu outlet!"),m.value=!1;return}f=c.value.map(e=>e.id)}t.availability_type=u.value,t.outlet_ids=f,t.selected_regions=d.value.map(e=>({id:e.id})),t.selected_outlets=c.value.map(e=>({id:e.id})),console.log("DEBUG SUBMIT",{availability_type:t.availability_type,show_pos:t.show_pos,selected_regions:t.selected_regions}),m.value=!0,i.mode==="create"?t.post(route("sub-categories.store"),{forceFormData:!0,onSuccess:()=>{h.fire("Berhasil","Sub Kategori berhasil ditambahkan!","success"),y("success"),y("close")},onError:e=>{console.error("Error creating sub category:",e),m.value=!1},onFinish:()=>m.value=!1}):i.mode==="edit"&&i.subCategory&&(t._method="PUT",t.post(route("sub-categories.update",i.subCategory.id),{forceFormData:!0,onSuccess:()=>{h.fire("Berhasil","Sub Kategori berhasil diupdate!","success"),y("success"),y("close")},onError:e=>{console.error("Error updating sub category:",e),m.value=!1},onFinish:()=>m.value=!1}))}function A(){y("close")}return(f,e)=>v.show?(r(),a("div",T,[s("div",K,[s("div",q,[s("div",z,[e[11]||(e[11]=s("svg",{class:"w-7 h-7 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{d:"M16 7a4 4 0 01-8 0","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M12 3v4m0 0a4 4 0 01-4 4H4m8-4a4 4 0 014 4h4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),s("h3",G,n(v.mode==="edit"?"Edit":"Tambah")+" Sub Kategori",1)]),s("form",{onSubmit:D(R,["prevent"])},[s("div",H,[s("div",null,[e[12]||(e[12]=s("label",{class:"block text-sm font-medium text-gray-700"},"Nama",-1)),g(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l(t).name=o),type:"text",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[V,l(t).name]]),l(t).errors.name?(r(),a("div",L,n(l(t).errors.name),1)):b("",!0)]),s("div",null,[e[13]||(e[13]=s("label",{class:"block text-sm font-medium text-gray-700"},"Deskripsi",-1)),g(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=o=>l(t).description=o),rows:"3",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[V,l(t).description]]),l(t).errors.description?(r(),a("div",$,n(l(t).errors.description),1)):b("",!0)]),s("div",null,[e[15]||(e[15]=s("label",{class:"block text-sm font-medium text-gray-700"},"Kategori",-1)),g(s("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>l(t).category_id=o),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:""},[e[14]||(e[14]=s("option",{value:""},"Pilih Kategori",-1)),(r(!0),a(_,null,w(v.categories,o=>(r(),a("option",{key:o.id,value:o.id},n(o.name),9,J))),128))],512),[[C,l(t).category_id]]),l(t).errors.category_id?(r(),a("div",Q,n(l(t).errors.category_id),1)):b("",!0)]),s("div",null,[e[17]||(e[17]=s("label",{class:"block text-sm font-medium text-gray-700"},"CoA",-1)),g(s("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>l(t).coa_id=o),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},[e[16]||(e[16]=s("option",{value:""},"Pilih CoA (Opsional)",-1)),(r(!0),a(_,null,w(v.coas||[],o=>(r(),a("option",{key:o.id,value:o.id},n(o.code)+" - "+n(o.name),9,Y))),128))],512),[[C,l(t).coa_id]]),l(t).errors.coa_id?(r(),a("div",W,n(l(t).errors.coa_id),1)):b("",!0)]),s("div",X,[s("div",Z,[e[19]||(e[19]=s("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),g(s("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>l(t).status=o),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},e[18]||(e[18]=[s("option",{value:"active"},"Active",-1),s("option",{value:"inactive"},"Inactive",-1)]),512),[[C,l(t).status]]),l(t).errors.status?(r(),a("div",ee,n(l(t).errors.status),1)):b("",!0)]),s("div",te,[e[20]||(e[20]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Show POS",-1)),S(l(I),{modelValue:l(t).show_pos,"onUpdate:modelValue":[e[5]||(e[5]=o=>l(t).show_pos=o),e[6]||(e[6]=o=>l(t).show_pos=o?"1":"0")],class:B([l(t).show_pos==="1"?"bg-blue-600":"bg-gray-200","relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none"]),checked:l(t).show_pos==="1"},{default:N(()=>[s("span",{class:B([l(t).show_pos==="1"?"translate-x-6":"translate-x-1","inline-block h-4 w-4 transform rounded-full bg-white transition"])},null,2)]),_:1},8,["modelValue","class","checked"]),s("span",se,n(l(t).show_pos==="1"?"Yes":"No"),1),l(t).errors.show_pos?(r(),a("div",oe,n(l(t).errors.show_pos),1)):b("",!0)])]),s("div",le,[e[25]||(e[25]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Sub Category Availability",-1)),s("div",ie,[s("label",ae,[g(s("input",{type:"radio",value:"byRegion","onUpdate:modelValue":e[7]||(e[7]=o=>u.value=o),class:"form-radio text-blue-600"},null,512),[[O,u.value]]),e[21]||(e[21]=s("span",{class:"ml-2"},"By Region",-1))]),s("label",re,[g(s("input",{type:"radio",value:"byOutlet","onUpdate:modelValue":e[8]||(e[8]=o=>u.value=o),class:"form-radio text-blue-600"},null,512),[[O,u.value]]),e[22]||(e[22]=s("span",{class:"ml-2"},"By Outlet",-1))])]),u.value==="byRegion"?(r(),a("div",ne,[e[23]||(e[23]=s("label",{class:"block text-xs text-gray-500 mb-1"},"Pilih Region",-1)),S(l(M),{modelValue:d.value,"onUpdate:modelValue":e[9]||(e[9]=o=>d.value=o),options:i.regions,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"name","track-by":"id",placeholder:"Pilih Region",class:"mb-2"},null,8,["modelValue","options"]),s("div",ue,[(r(!0),a(_,null,w(d.value,o=>(r(),a("span",{key:o.id,class:"inline-flex items-center bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs font-semibold"},[U(n(o.name)+" ",1),s("button",{type:"button",class:"ml-1 text-blue-500 hover:text-red-500",onClick:p=>d.value=d.value.filter(k=>k.id!==o.id)},"×",8,de)]))),128))])])):b("",!0),u.value==="byOutlet"?(r(),a("div",ce,[e[24]||(e[24]=s("label",{class:"block text-xs text-gray-500 mb-1"},"Pilih Outlet",-1)),S(l(M),{modelValue:c.value,"onUpdate:modelValue":e[10]||(e[10]=o=>c.value=o),options:i.outlets,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"nama_outlet","track-by":"id",placeholder:"Pilih Outlet",class:"mb-2"},null,8,["modelValue","options"]),s("div",me,[(r(!0),a(_,null,w(c.value,o=>(r(),a("span",{key:o.id,class:"inline-flex items-center bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs font-semibold"},[U(n(o.nama_outlet)+" ",1),s("button",{type:"button",class:"ml-1 text-blue-500 hover:text-red-500",onClick:p=>c.value=c.value.filter(k=>k.id!==o.id)},"×",8,be)]))),128))])])):b("",!0)])]),s("div",pe,[s("button",{type:"button",onClick:A,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Batal "),s("button",{type:"submit",disabled:m.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},n(m.value?"Menyimpan...":"Simpan"),9,ge)])],32)])])])):b("",!0)}},Se=j(fe,[["__scopeId","data-v-391bfc81"]]);export{Se as default};
