import{P as J,r as y,c as P,w as M,A as _e,B as i,C as K,D as t,x as ye,G as _,Q as c,S as pe,O as me,L as u,E as p,N as d,H as f,F as x,M as C,I as Y,J as k,l as N,X as fe}from"./vendor-vue-g7iCcTkf.js";import{A as he}from"./AppLayout-lnDyFfsm.js";import{a as I}from"./vendor-utils-CpgP2uT4.js";import{S as j}from"./app-CUjRlmlQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CXOsavaw.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const ve={class:"w-full py-8 px-4"},ge={class:"flex justify-between items-center mb-6"},xe={class:"mb-4 flex items-center justify-end gap-2 text-sm"},be={key:0,class:"text-blue-600 flex items-center gap-1"},qe={key:1,class:"text-green-600 flex items-center gap-1"},we={key:0,class:"text-xs text-gray-500"},ke={key:2,class:"text-red-600 flex items-center gap-1"},Se={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Ce=["value"],De={class:"block text-sm font-medium text-gray-700 mb-2"},Ae={key:0,class:"text-red-500"},Fe=["required","disabled"],Ie={value:""},Te=["value"],Ve={key:0,class:"text-xs text-gray-500 mt-1"},Me={class:"mb-6"},je={class:"mb-4"},Ue={class:"relative"},Be={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},Ee=["onClick"],Le={class:"font-medium"},We={class:"text-sm text-gray-600"},$e={key:0,class:"text-xs text-blue-600 font-medium"},Pe={key:0,class:"space-y-2"},Ne={key:0,class:"flex items-center justify-between p-3 rounded-md bg-gray-50 border border-gray-200"},Re={class:"flex items-center space-x-3"},Qe={class:"flex items-center space-x-2"},ze=["onClick"],Ge=["onClick"],Oe={class:"flex items-center space-x-2"},He={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Xe={class:"font-medium"},Je={class:"text-sm text-gray-600"},Ke={key:0,class:"text-xs text-blue-600 font-medium"},Ye=["onClick"],Ze={key:0,class:"mb-6"},es={class:"flex justify-between items-center mb-4"},ss={class:"text-lg font-semibold text-gray-800"},ts={class:"overflow-x-auto"},as={class:"min-w-full divide-y divide-gray-200 border border-gray-300"},ls={class:"bg-white divide-y divide-gray-200"},os=["onClick"],rs={class:"px-4 py-3 font-bold text-gray-800",colspan:"8"},ns={class:"flex items-center justify-between"},is={class:"flex items-center gap-2"},us={class:"text-sm"},ds={class:"text-xs text-gray-500 font-normal"},cs={class:"text-xs text-gray-600"},_s={key:0,class:"fa-solid fa-chevron-down"},ys={key:1,class:"fa-solid fa-chevron-right"},ps={class:"px-4 py-3 text-sm font-medium text-gray-900"},ms={class:"font-semibold pl-6"},fs={class:"px-3 py-3"},hs={class:"flex items-center gap-2"},vs=["onUpdate:modelValue","onInput"],gs={class:"text-xs text-gray-600 font-medium whitespace-nowrap"},xs={class:"px-3 py-3"},bs={class:"flex items-center gap-2"},qs=["onUpdate:modelValue","onInput"],ws={class:"text-xs text-gray-600 font-medium whitespace-nowrap"},ks={class:"px-3 py-3"},Ss={class:"flex items-center gap-2"},Cs=["onUpdate:modelValue","onInput"],Ds={class:"text-xs text-gray-600 font-medium whitespace-nowrap"},As={class:"px-3 py-3 text-sm text-right text-gray-700"},Fs={class:"font-medium"},Is={class:"px-3 py-3 text-sm text-right text-gray-700"},Ts={class:"font-semibold"},Vs={class:"px-3 py-3 text-center text-sm"},Ms={key:0},js={key:1,class:"text-gray-400 text-xs"},Us={class:"px-3 py-3"},Bs=["onUpdate:modelValue"],Es={key:1,class:"text-gray-400 text-xs"},Ls={class:"bg-gray-100 border-t-2 border-gray-400"},Ws={class:"px-3 py-4 text-right font-bold text-gray-900 text-lg"},$s={key:1,class:"text-center py-8"},Ps={key:2,class:"text-center py-8 text-gray-500"},Ns={key:3,class:"flex justify-end gap-4 mt-6"},Rs=["disabled"],Qs={key:0,class:"fa fa-spinner fa-spin mr-2"},zs={key:1,class:"fa-solid fa-save mr-2"},tt={__name:"Create",props:{warehouses:Array,warehouseDivisions:Array,items:Array,selectedWarehouseId:[String,Number],selectedWarehouseDivisionId:[String,Number]},setup(R){const T=R,a=J({warehouse_id:T.selectedWarehouseId||"",warehouse_division_id:T.selectedWarehouseDivisionId||"",opname_date:new Date().toISOString().split("T")[0],notes:"",items:T.items||[],approvers:[]}),U=y(!1),S=y(!1),b=y(new Set),q=y(""),v=y([]),w=y(!1),B=y(null),h=y(!1),V=y(!1),D=y([]),g=y(null),m=y("idle"),E=y(null),L=y(null),Z=P(()=>{const e={};return a.items.forEach(s=>{const l=s.category_name||"Uncategorized";e[l]||(e[l]=[]),e[l].push(s)}),e});function Q(e){if(!e||e.qty_physical_small===null||e.qty_physical_small===void 0||e.qty_physical_small==="")return 0;const s=parseFloat(e.qty_physical_small)||0,l=parseFloat(e.mac)||0;return s*l}const ee=P(()=>!a.items||a.items.length===0?0:a.items.reduce((e,s)=>e+Q(s),0));function se(e){b.value.has(e)?b.value.delete(e):b.value.add(e)}M(()=>a.items,e=>{if(e&&e.length>0){const s=new Set;e.forEach(l=>{s.add(l.category_name||"Uncategorized")}),b.value=s}},{immediate:!0});const te=P(()=>{if(D.value.length>0)return D.value;let e=T.warehouseDivisions||[];return a.warehouse_id&&(e=e.filter(s=>String(s.warehouse_id)===String(a.warehouse_id))),e});async function z(){if(a.warehouse_division_id="",a.items=[],h.value=!1,D.value=[],!!a.warehouse_id){V.value=!0;try{const e=await I.get(route("warehouse-stock-opnames.check-divisions"),{params:{warehouse_id:a.warehouse_id}});e.data&&e.data.has_divisions?(h.value=!0,D.value=e.data.divisions||[]):(h.value=!1,D.value=[],await A())}catch(e){console.error("Error checking warehouse divisions:",e),h.value=!1,await A()}finally{V.value=!1}}}function ae(){a.warehouse_division_id?A():a.items=[]}async function A(){if(!a.warehouse_id){a.items=[];return}if(h.value&&!a.warehouse_division_id){a.items=[];return}U.value=!0;try{const e=await I.get(route("warehouse-stock-opnames.get-items"),{params:{warehouse_id:a.warehouse_id,warehouse_division_id:a.warehouse_division_id||null}});if(!Array.isArray(e.data)){console.error("Response is not an array:",e.data),j.fire({title:"Error",text:"Format data tidak valid. Silakan coba lagi.",icon:"error",confirmButtonColor:"#3085d6"});return}a.items=e.data.map(s=>({inventory_item_id:s.inventory_item_id,item_name:s.item_name,category_name:s.category_name,qty_system_small:parseFloat(s.qty_system_small)||0,qty_system_medium:parseFloat(s.qty_system_medium)||0,qty_system_large:parseFloat(s.qty_system_large)||0,qty_physical_small:null,qty_physical_medium:null,qty_physical_large:null,reason:"",small_unit_name:s.small_unit_name,medium_unit_name:s.medium_unit_name,large_unit_name:s.large_unit_name,small_conversion_qty:parseFloat(s.small_conversion_qty)||1,medium_conversion_qty:parseFloat(s.medium_conversion_qty)||1,mac:parseFloat(s.mac)||0}))}catch(e){console.error("Error loading items:",e);let s="Gagal memuat items. Silakan coba lagi.";e.response?e.response.data&&e.response.data.error?s=e.response.data.error:e.response.status===422?s="Data yang dikirim tidak valid. Silakan cek kembali.":e.response.status===500&&(s="Terjadi kesalahan di server. Silakan hubungi administrator."):e.request&&(s="Tidak ada response dari server. Silakan cek koneksi internet."),j.fire({title:"Error",text:s,icon:"error",confirmButtonColor:"#3085d6"}),a.items=[]}finally{U.value=!1}}function W(e,s){const l=e[`qty_physical_${s}`];if(l==null||l===""){e.qty_physical_small=null,e.qty_physical_medium=null,e.qty_physical_large=null;return}const n=parseFloat(l);isNaN(n)||n<0||(s==="small"?e.small_conversion_qty&&e.small_conversion_qty>0?(e.qty_physical_medium=n/e.small_conversion_qty,e.medium_conversion_qty&&e.medium_conversion_qty>0?e.qty_physical_large=n/(e.small_conversion_qty*e.medium_conversion_qty):e.qty_physical_large=e.qty_physical_medium):(e.qty_physical_medium=n,e.qty_physical_large=n):s==="medium"?(e.small_conversion_qty&&e.small_conversion_qty>0?e.qty_physical_small=n*e.small_conversion_qty:e.qty_physical_small=n,e.medium_conversion_qty&&e.medium_conversion_qty>0?e.qty_physical_large=n/e.medium_conversion_qty:e.qty_physical_large=n):s==="large"&&(e.medium_conversion_qty&&e.medium_conversion_qty>0?(e.qty_physical_medium=n*e.medium_conversion_qty,e.small_conversion_qty&&e.small_conversion_qty>0?e.qty_physical_small=e.qty_physical_medium*e.small_conversion_qty:e.qty_physical_small=e.qty_physical_medium):(e.qty_physical_medium=n,e.qty_physical_small=n)),e.qty_physical_small!==null&&(e.qty_physical_small=Math.round(e.qty_physical_small*100)/100),e.qty_physical_medium!==null&&(e.qty_physical_medium=Math.round(e.qty_physical_medium*100)/100),e.qty_physical_large!==null&&(e.qty_physical_large=Math.round(e.qty_physical_large*100)/100))}function $(e){const s=(e.qty_physical_small??e.qty_system_small)-e.qty_system_small,l=(e.qty_physical_medium??e.qty_system_medium)-e.qty_system_medium,n=(e.qty_physical_large??e.qty_system_large)-e.qty_system_large;return s!==0||l!==0||n!==0}function le(e){const s=(e.qty_physical_small??e.qty_system_small)-e.qty_system_small;return s>0?"+":s<0?"-":"0"}function oe(e){const s=(e.qty_physical_small??e.qty_system_small)-e.qty_system_small;return s>0?"bg-green-100 text-green-800":s<0?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}function G(e){return e==null?"0":Number(e).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}function re(e){return e==null||e===""||isNaN(e)?"Rp 0":"Rp "+Number(e).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}async function O(e=""){if(e.length<2){v.value=[],w.value=!1;return}try{const s=await I.get(route("warehouse-stock-opnames.approvers"),{params:{search:e},headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});console.log("Approvers response:",s.data),s.data&&s.data.success?(v.value=s.data.users||[],w.value=v.value.length>0):(v.value=[],w.value=!1)}catch(s){console.error("Failed to load approvers:",s),v.value=[],w.value=!1}}function ne(){B.value&&clearTimeout(B.value),B.value=setTimeout(()=>{q.value.length>=2?O(q.value):(v.value=[],w.value=!1)},300)}function ie(e){if(!e||!e.id){console.error("Invalid user object:",e);return}a.approvers.find(s=>s&&s.id===e.id)||(a.approvers.push(e),F()),q.value="",w.value=!1}function ue(e){a.approvers.splice(e,1),F()}function H(e,s){const l=a.approvers.splice(e,1)[0];a.approvers.splice(s,0,l),F()}async function de(){if(a.warehouse_id&&!S.value){m.value="saving";try{const e=a.items.map(o=>{const r={inventory_item_id:o.inventory_item_id,reason:o.reason||""};return o.qty_physical_small!==null&&o.qty_physical_small!==void 0&&o.qty_physical_small!==""&&(r.qty_physical_small=parseFloat(o.qty_physical_small)),o.qty_physical_medium!==null&&o.qty_physical_medium!==void 0&&o.qty_physical_medium!==""&&(r.qty_physical_medium=parseFloat(o.qty_physical_medium)),o.qty_physical_large!==null&&o.qty_physical_large!==void 0&&o.qty_physical_large!==""&&(r.qty_physical_large=parseFloat(o.qty_physical_large)),r}),s=a.approvers.filter(o=>o&&o.id).map(o=>o.id),l={warehouse_id:a.warehouse_id,warehouse_division_id:a.warehouse_division_id,opname_date:a.opname_date,notes:a.notes,items:e,approvers:s,autosave:!0};let n;g.value?n=await I.put(route("warehouse-stock-opnames.update",g.value),l):n=await I.post(route("warehouse-stock-opnames.store"),l),n.data.success&&(n.data.id&&!g.value&&(g.value=n.data.id),m.value="saved",L.value=new Date,setTimeout(()=>{m.value==="saved"&&(m.value="idle")},3e3))}catch(e){console.error("Autosave error:",e),m.value="error",setTimeout(()=>{m.value==="error"&&(m.value="idle")},5e3)}}}function F(){E.value&&clearTimeout(E.value),E.value=setTimeout(()=>{de()},2e3)}function ce(){if(a.items.length===0){j.fire({title:"Error",text:"Minimal harus ada 1 item.",icon:"error",confirmButtonColor:"#3085d6"});return}const e=a.items.map(r=>{const X={inventory_item_id:r.inventory_item_id,qty_physical_small:r.qty_physical_small!==null&&r.qty_physical_small!==void 0&&r.qty_physical_small!==""?parseFloat(r.qty_physical_small):null,qty_physical_medium:r.qty_physical_medium!==null&&r.qty_physical_medium!==void 0&&r.qty_physical_medium!==""?parseFloat(r.qty_physical_medium):null,qty_physical_large:r.qty_physical_large!==null&&r.qty_physical_large!==void 0&&r.qty_physical_large!==""?parseFloat(r.qty_physical_large):null,reason:r.reason||""};return console.log("Item before processing:",{inventory_item_id:r.inventory_item_id,qty_physical_small_raw:r.qty_physical_small,qty_physical_medium_raw:r.qty_physical_medium,qty_physical_large_raw:r.qty_physical_large,qty_system_small:r.qty_system_small,qty_system_medium:r.qty_system_medium,qty_system_large:r.qty_system_large}),console.log("Item after processing:",X),X});console.log("All items to submit:",e),S.value=!0;const s=g.value?"warehouse-stock-opnames.update":"warehouse-stock-opnames.store",l=g.value?{id:g.value}:{},n=a.approvers.filter(r=>r&&r.id).map(r=>r.id);J({warehouse_id:a.warehouse_id,warehouse_division_id:a.warehouse_division_id,opname_date:a.opname_date,notes:a.notes,items:e,approvers:n}).post(route(s,l),{preserveScroll:!0,onSuccess:()=>{S.value=!1,g.value=null},onError:r=>{S.value=!1,console.error("Error:",r),j.fire({title:"Error",text:"Gagal menyimpan stock opname. Silakan coba lagi.",icon:"error",confirmButtonColor:"#3085d6"})}})}return M(()=>a.warehouse_division_id,()=>{a.warehouse_division_id?A():h.value||A()}),M([()=>a.warehouse_id,()=>a.warehouse_division_id,()=>a.opname_date,()=>a.notes],()=>{F()}),M(()=>a.items,()=>{F()},{deep:!0}),a.warehouse_id&&a.items.length===0&&z(),(e,s)=>(i(),_e(he,null,{default:K(()=>[t("div",ve,[t("div",ge,[s[8]||(s[8]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-clipboard-check text-blue-500"}),_(" Buat Warehouse Stock Opname Baru ")],-1)),ye(c(pe),{href:e.route("warehouse-stock-opnames.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:K(()=>s[7]||(s[7]=[t("i",{class:"fas fa-arrow-left mr-2"},null,-1),_(" Kembali ")])),_:1},8,["href"])]),t("form",{onSubmit:me(ce,["prevent"]),class:"bg-white rounded-xl shadow-lg p-6"},[t("div",xe,[m.value==="saving"?(i(),u("span",be,s[9]||(s[9]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),_(" Menyimpan... ")]))):m.value==="saved"?(i(),u("span",qe,[s[10]||(s[10]=t("i",{class:"fas fa-check-circle"},null,-1)),s[11]||(s[11]=_(" Tersimpan ")),L.value?(i(),u("span",we," ("+d(new Date(L.value).toLocaleTimeString("id-ID"))+") ",1)):p("",!0)])):m.value==="error"?(i(),u("span",ke,s[12]||(s[12]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),_(" Gagal menyimpan ")]))):p("",!0)]),t("div",Se,[t("div",null,[s[14]||(s[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Warehouse *",-1)),f(t("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>c(a).warehouse_id=l),onChange:z,required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[s[13]||(s[13]=t("option",{value:""},"Pilih Warehouse",-1)),(i(!0),u(x,null,C(R.warehouses,l=>(i(),u("option",{key:l.id,value:l.id},d(l.name),9,Ce))),128))],544),[[Y,c(a).warehouse_id]])]),t("div",null,[t("label",De,[s[15]||(s[15]=_(" Warehouse Division ")),h.value?(i(),u("span",Ae,"*")):p("",!0)]),f(t("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>c(a).warehouse_division_id=l),onChange:ae,required:h.value,disabled:!c(a).warehouse_id||V.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed"},[t("option",Ie,d(h.value?"Pilih Division":"Semua Division"),1),(i(!0),u(x,null,C(te.value,l=>(i(),u("option",{key:l.id,value:l.id},d(l.name),9,Te))),128))],40,Fe),[[Y,c(a).warehouse_division_id]]),V.value?(i(),u("p",Ve,s[16]||(s[16]=[t("i",{class:"fa fa-spinner fa-spin mr-1"},null,-1),_("Memeriksa division... ")]))):p("",!0)]),t("div",null,[s[17]||(s[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tanggal Opname *",-1)),f(t("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>c(a).opname_date=l),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[k,c(a).opname_date]])]),t("div",null,[s[18]||(s[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catatan",-1)),f(t("textarea",{"onUpdate:modelValue":s[3]||(s[3]=l=>c(a).notes=l),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Catatan tambahan..."},null,512),[[k,c(a).notes]])])]),t("div",Me,[s[23]||(s[23]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Approval Flow",-1)),s[24]||(s[24]=t("p",{class:"text-sm text-gray-600 mb-4"},"Tambahkan approvers secara berurutan dari terendah ke tertinggi. Approver pertama = level terendah, approver terakhir = level tertinggi.",-1)),t("div",je,[t("div",Ue,[f(t("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>q.value=l),type:"text",placeholder:"Cari user berdasarkan nama, email, atau jabatan...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onInput:ne,onFocus:s[5]||(s[5]=l=>q.value.length>=2&&O(q.value))},null,544),[[k,q.value]]),w.value&&v.value.length>0?(i(),u("div",Be,[(i(!0),u(x,null,C(v.value,l=>(i(),u("div",{key:l.id,onClick:n=>ie(l),class:"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-200 last:border-b-0"},[t("div",Le,d(l.name),1),t("div",We,d(l.email),1),l.jabatan?(i(),u("div",$e,d(l.jabatan),1)):p("",!0)],8,Ee))),128))])):p("",!0)])]),c(a).approvers.length>0?(i(),u("div",Pe,[s[22]||(s[22]=t("h4",{class:"font-medium text-gray-700"},"Urutan Approval (Terendah ke Tertinggi):",-1)),(i(!0),u(x,null,C(c(a).approvers,(l,n)=>(i(),u(x,{key:(l==null?void 0:l.id)||n},[l&&l.id?(i(),u("div",Ne,[t("div",Re,[t("div",Qe,[n>0?(i(),u("button",{key:0,onClick:o=>H(n,n-1),class:"p-1 text-gray-500 hover:text-gray-700",title:"Pindah ke atas"},s[19]||(s[19]=[t("i",{class:"fa fa-arrow-up"},null,-1)]),8,ze)):p("",!0),n<c(a).approvers.length-1?(i(),u("button",{key:1,onClick:o=>H(n,n+1),class:"p-1 text-gray-500 hover:text-gray-700",title:"Pindah ke bawah"},s[20]||(s[20]=[t("i",{class:"fa fa-arrow-down"},null,-1)]),8,Ge)):p("",!0)]),t("div",Oe,[t("span",He," Level "+d(n+1),1),t("div",null,[t("div",Xe,d(l.name),1),t("div",Je,d(l.email),1),l.jabatan?(i(),u("div",Ke,d(l.jabatan),1)):p("",!0)])])]),t("button",{onClick:o=>ue(n),class:"p-1 text-red-500 hover:text-red-700",title:"Hapus Approver"},s[21]||(s[21]=[t("i",{class:"fa fa-times"},null,-1)]),8,Ye)])):p("",!0)],64))),128))])):p("",!0)]),c(a).items.length>0?(i(),u("div",Ze,[t("div",es,[t("h3",ss,"Items ("+d(c(a).items.length)+")",1)]),t("div",ts,[t("table",as,[s[27]||(s[27]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase w-48"},"Item"),t("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-40"},[_(" Qty Physical"),t("br"),_("Small ")]),t("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-40"},[_(" Qty Physical"),t("br"),_("Medium ")]),t("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-40"},[_(" Qty Physical"),t("br"),_("Large ")]),t("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-32"},"MAC"),t("th",{class:"px-3 py-3 text-right text-xs font-bold text-gray-700 uppercase w-40"},[_("Subtotal"),t("br"),_("(Qty Ã— MAC)")]),t("th",{class:"px-3 py-3 text-center text-xs font-bold text-gray-700 uppercase w-48"},"Selisih"),t("th",{class:"px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase w-48"},"Alasan")])],-1)),t("tbody",ls,[(i(!0),u(x,null,C(Z.value,(l,n)=>(i(),u(x,{key:n},[t("tr",{class:"bg-blue-50 hover:bg-blue-100 cursor-pointer transition",onClick:o=>se(n)},[t("td",rs,[t("div",ns,[t("div",is,[t("i",{class:N([b.value.has(n)?"fa-solid fa-chevron-down":"fa-solid fa-chevron-right","text-blue-600 transition-transform"])},null,2),t("span",us,d(n||"Uncategorized"),1),t("span",ds," ("+d(l.length)+" item"+d(l.length>1?"s":"")+") ",1)]),t("div",cs,[b.value.has(n)?(i(),u("i",_s)):(i(),u("i",ys))])])])],8,os),(i(!0),u(x,null,C(l,o=>f((i(),u("tr",{key:o.inventory_item_id,class:N([{"bg-yellow-50":$(o)},"hover:bg-gray-50 transition"])},[t("td",ps,[t("div",ms,d(o.item_name),1)]),t("td",fs,[t("div",hs,[f(t("input",{"onUpdate:modelValue":r=>o.qty_physical_small=r,type:"number",step:"any",min:"0",onInput:r=>W(o,"small"),class:"w-full px-3 py-2 border border-gray-300 rounded-md text-right text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,vs),[[k,o.qty_physical_small,void 0,{number:!0}]]),t("span",gs,d(o.small_unit_name||"-"),1)])]),t("td",xs,[t("div",bs,[f(t("input",{"onUpdate:modelValue":r=>o.qty_physical_medium=r,type:"number",step:"any",min:"0",onInput:r=>W(o,"medium"),class:"w-full px-3 py-2 border border-gray-300 rounded-md text-right text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,qs),[[k,o.qty_physical_medium,void 0,{number:!0}]]),t("span",ws,d(o.medium_unit_name||"-"),1)])]),t("td",ks,[t("div",Ss,[f(t("input",{"onUpdate:modelValue":r=>o.qty_physical_large=r,type:"number",step:"any",min:"0",onInput:r=>W(o,"large"),class:"w-full px-3 py-2 border border-gray-300 rounded-md text-right text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,Cs),[[k,o.qty_physical_large,void 0,{number:!0}]]),t("span",Ds,d(o.large_unit_name||"-"),1)])]),t("td",As,[t("div",Fs,d(re(o.mac)),1)]),t("td",Is,[t("div",Ts,d(G(Q(o))),1)]),t("td",Vs,[$(o)?(i(),u("div",Ms,[t("span",{class:N([oe(o),"px-2 py-1 rounded text-xs font-semibold whitespace-nowrap"])},d(le(o)),3)])):(i(),u("span",js,"-"))]),t("td",Us,[$(o)?f((i(),u("input",{key:0,"onUpdate:modelValue":r=>o.reason=r,type:"text",placeholder:"Alasan selisih...",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,Bs)),[[k,o.reason]]):(i(),u("span",Es,"-"))])],2)),[[fe,b.value.has(n)]])),128))],64))),128))]),t("tfoot",Ls,[t("tr",null,[s[25]||(s[25]=t("td",{class:"px-4 py-4 text-right font-bold text-gray-900",colspan:"5"}," GRAND TOTAL ",-1)),t("td",Ws,d(G(ee.value)),1),s[26]||(s[26]=t("td",{class:"px-3 py-4",colspan:"2"},null,-1))])])])])])):p("",!0),U.value?(i(),u("div",$s,s[28]||(s[28]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"},null,-1),t("p",{class:"mt-2 text-gray-600"},"Memuat items...",-1)]))):c(a).items.length===0&&c(a).warehouse_id?(i(),u("div",Ps,s[29]||(s[29]=[t("i",{class:"fa-solid fa-inbox text-4xl mb-4"},null,-1),t("p",null,"Tidak ada item dengan stock untuk warehouse yang dipilih.",-1)]))):p("",!0),c(a).items.length>0?(i(),u("div",Ns,[t("button",{type:"button",onClick:s[6]||(s[6]=l=>e.$inertia.visit(e.route("warehouse-stock-opnames.index"))),class:"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 font-semibold"}," Batal "),t("button",{type:"submit",disabled:S.value,class:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-semibold disabled:opacity-50"},[S.value?(i(),u("i",Qs)):(i(),u("i",zs)),s[30]||(s[30]=_(" Simpan Draft "))],8,Rs)])):p("",!0)],32)])]),_:1}))}};export{tt as default};
