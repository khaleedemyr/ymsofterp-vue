import{r as h,c as _,A as ue,B as l,C as G,D as e,x as K,G as c,H as w,J as C,L as i,E as m,F as f,M as b,N as r,l as E,_ as W,O as J,V as O,X,W as T}from"./vendor-vue-g7iCcTkf.js";import{A as ce}from"./AppLayout-BdiuRSin.js";import{S as k}from"./app-xIQ7JztA.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./ProfileUpdateModal-LiNpoaCg.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const fe={class:"w-full min-h-screen bg-gray-50 py-8 px-2"},be={class:"max-w-7xl w-full mx-auto"},me={class:"flex justify-between items-center mb-6"},ve={class:"flex justify-between items-center mb-4"},xe={class:"bg-white rounded-xl shadow-lg overflow-x-auto"},ge={class:"min-w-full divide-y divide-gray-200"},ye={class:"bg-white divide-y divide-gray-200"},he={key:0},we={class:"px-6 py-4 whitespace-nowrap"},_e={class:"px-6 py-4 whitespace-nowrap"},ke={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium flex justify-end gap-2"},Ce=["onClick"],Se=["onClick"],$e={class:"flex justify-end mt-4 gap-2"},Ae=["onClick"],Me={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"},je={class:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full p-0 relative animate-fadeInUp flex flex-col h-[80vh]"},Be={class:"p-8 pb-2 sticky top-0 z-10 bg-white"},Ee={class:"mb-4"},Pe={class:"mb-4"},Re={class:"flex justify-between mb-2 overflow-x-auto whitespace-nowrap px-2 gap-2"},Ne={class:"text-xs mt-1 text-center truncate w-full",style:{"min-width":"70px"}},Ve={class:"flex flex-col items-center min-w-[90px]"},ze={key:0,class:"overflow-y-auto max-h-[400px] px-8 pb-4 custom-scrollbar"},De={class:"mb-2 flex items-center gap-2"},Ue=["checked","onChange"],Ge=["for"],Te={class:"flex items-center gap-2 mb-2"},Le={class:"font-semibold flex-1"},qe=["checked","onChange","id"],Fe=["for"],Ie={class:"grid grid-cols-2 gap-2"},He=["value"],Ke={class:"text-sm capitalize"},We={key:1,class:"overflow-y-auto max-h-[400px] px-8 pb-4 custom-scrollbar"},Je={class:"mb-4"},Oe={class:"mb-4"},Xe={class:"mb-4"},Ye={key:0,class:"text-gray-400 italic"},Qe={key:1},Ze={key:0,class:"mb-2"},et={class:"font-semibold"},tt={class:"flex flex-wrap gap-2 mt-1"},st={class:"flex justify-between p-8 pt-4 sticky bottom-0 z-10 bg-white border-t"},lt=["disabled"],it=["disabled"],ot=["disabled"],at={key:0,class:"fa-solid fa-spinner fa-spin"},nt={key:1,class:"fa-solid fa-save"},rt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"},dt={class:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full p-0 relative animate-fadeInUp flex flex-col h-[80vh]"},ut={class:"p-8 pb-2 sticky top-0 z-10 bg-white"},ct={class:"mb-4"},pt={class:"mb-4"},ft={class:"flex justify-between mb-2 overflow-x-auto whitespace-nowrap px-2 gap-2"},bt={class:"text-xs mt-1 text-center truncate w-full",style:{"min-width":"70px"}},mt={key:0,class:"overflow-y-auto max-h-[400px] px-8 pb-4 custom-scrollbar"},vt={class:"mb-2 flex items-center gap-2"},xt=["checked","onChange"],gt=["for"],yt={class:"flex items-center gap-2 mb-2"},ht={class:"font-semibold flex-1"},wt=["checked","onChange","id"],_t=["for"],kt={class:"grid grid-cols-2 gap-2"},Ct=["value"],St={class:"text-sm capitalize"},$t={key:1,class:"overflow-y-auto max-h-[400px] px-8 pb-4 custom-scrollbar"},At={class:"mb-4"},Mt={class:"mb-4"},jt={class:"mb-4"},Bt={key:0,class:"text-gray-400 italic"},Et={key:1},Pt={key:0,class:"mb-2"},Rt={class:"font-semibold"},Nt={class:"flex flex-wrap gap-2 mt-1"},Vt={class:"flex justify-between p-8 pt-4 sticky bottom-0 z-10 bg-white border-t"},zt=["disabled"],Dt=["disabled"],Ut=["disabled"],Gt={key:0,class:"fa-solid fa-spinner fa-spin"},Tt={key:1,class:"fa-solid fa-save"},L=15,Lt={__name:"Index",props:{roles:{type:Array,default:()=>[]},menus:{type:Array,default:()=>[]}},setup(P){const S=P,$=h(""),R=h(1),A=h(!1),M=h(!1),d=h({name:"",description:"",permissions:[]}),n=h({id:null,name:"",description:"",permissions:[]}),p=h(!1),N=_(()=>$.value?S.roles.filter(o=>o.name.toLowerCase().includes($.value.toLowerCase())):S.roles),Y=_(()=>Math.ceil(N.value.length/L)),Q=_(()=>{const o=(R.value-1)*L;return N.value.slice(o,o+L)}),g=_(()=>(S.menus||[]).filter(o=>!o.parent_id)),V=o=>(S.menus||[]).filter(t=>t.parent_id===o),v=h(0),x=h(0),j=_(()=>g.value.length),B=_(()=>v.value===j.value),Z=_(()=>x.value===j.value);function ee(o){k.fire({title:"Hapus Role?",text:"Role yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(t=>{t.isConfirmed&&T.delete(`/roles/${o}`,{onSuccess:()=>{k.fire({icon:"success",title:"Berhasil",text:"Role berhasil dihapus!"})},onError:()=>{k.fire({icon:"error",title:"Gagal",text:"Gagal menghapus role."})}})})}function te(){p.value=!0,T.post("/roles",d.value,{onSuccess:()=>{p.value=!1,k.fire({icon:"success",title:"Berhasil",text:"Role berhasil disimpan!"}),A.value=!1,v.value=0,d.value.permissions=[]},onError:()=>{p.value=!1,k.fire({icon:"error",title:"Gagal",text:"Gagal menyimpan role."})}})}function se(o){n.value={id:o.id,name:o.name,description:o.description,permissions:o.permissions.map(t=>`${t.menu_id}-${t.action}`)},M.value=!0}function le(){p.value=!0,T.put(`/roles/${n.value.id}`,n.value,{onSuccess:()=>{p.value=!1,k.fire({icon:"success",title:"Berhasil",text:"Role berhasil diupdate!"}),M.value=!1,n.value={id:null,name:"",description:"",permissions:[]}},onError:()=>{p.value=!1,k.fire({icon:"error",title:"Gagal",text:"Gagal update role."})}})}function ie(){v.value<j.value&&v.value++}function oe(){v.value>0&&v.value--}function ae(){x.value<j.value&&x.value++}function ne(){x.value>0&&x.value--}function re(){A.value=!1,v.value=0,d.value.permissions=[]}function de(){M.value=!1,x.value=0,n.value.permissions=[]}function q(o,t){return V(o).flatMap(s=>["view","create","update","delete"].map(a=>`${s.id}-${a}`))}function z(o,t){const s=q(o);return s.length>0&&s.every(a=>t.permissions.includes(a))}function F(o,t){const s=q(o);z(o,t)?t.permissions=t.permissions.filter(a=>!s.includes(a)):t.permissions=Array.from(new Set([...t.permissions,...s]))}function I(o){return["view","create","update","delete"].map(t=>`${o}-${t}`)}function D(o,t){return I(o).every(a=>t.permissions.includes(a))}function H(o,t){const s=I(o);D(o,t)?t.permissions=t.permissions.filter(a=>!s.includes(a)):t.permissions=Array.from(new Set([...t.permissions,...s]))}return(o,t)=>(l(),ue(ce,null,{default:G(()=>[e("div",fe,[e("div",be,[e("div",me,[t[9]||(t[9]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-user-shield text-blue-500"}),c(" Role Management ")],-1)),e("button",{onClick:t[0]||(t[0]=s=>A.value=!0),class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-all duration-200 shadow-md"},t[8]||(t[8]=[e("i",{class:"fa-solid fa-plus"},null,-1),c(" Add Role ")]))]),e("div",ve,[w(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>$.value=s),type:"text",placeholder:"Search role name...",class:"w-72 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[C,$.value]])]),e("div",xe,[e("table",ge,[t[13]||(t[13]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Action")])],-1)),e("tbody",ye,[N.value.length===0?(l(),i("tr",he,t[10]||(t[10]=[e("td",{colspan:"3",class:"text-center py-10 text-gray-400"},"Tidak ada data role.",-1)]))):m("",!0),(l(!0),i(f,null,b(Q.value,s=>(l(),i("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",we,r(s.name),1),e("td",_e,r(s.description),1),e("td",ke,[e("button",{onClick:a=>se(s),class:"text-blue-600 hover:text-blue-900",title:"Edit"},t[11]||(t[11]=[e("i",{class:"fa-solid fa-pen-to-square"},null,-1)]),8,Ce),e("button",{onClick:a=>ee(s.id),class:"text-red-600 hover:text-red-900",title:"Delete"},t[12]||(t[12]=[e("i",{class:"fa-solid fa-trash"},null,-1)]),8,Se)])]))),128))])])]),e("div",$e,[(l(!0),i(f,null,b(Y.value,s=>(l(),i("button",{key:s,onClick:a=>R.value=s,class:E(["px-3 py-1 rounded-lg border text-sm font-semibold",R.value===s?"bg-blue-600 text-white shadow-lg":"bg-white text-blue-700 hover:bg-blue-50"])},r(s),11,Ae))),128))])]),K(W,{name:"fade"},{default:G(()=>[A.value?(l(),i("div",Me,[e("div",je,[e("div",Be,[e("button",{onClick:re,class:"absolute top-4 right-4 text-gray-400 hover:text-red-500 text-2xl transition-all"},t[14]||(t[14]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])),t[18]||(t[18]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("i",{class:"fa-solid fa-plus text-blue-500"}),c(" Create Role ")],-1)),e("div",Ee,[t[15]||(t[15]=e("label",{class:"block font-semibold mb-1 flex items-center gap-2"},[e("i",{class:"fa-solid fa-user-tag text-gray-400"}),c(" Name ")],-1)),w(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value.name=s),type:"text",class:"block w-full py-2 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[C,d.value.name]])]),e("div",Pe,[t[16]||(t[16]=e("label",{class:"block font-semibold mb-1 flex items-center gap-2"},[e("i",{class:"fa-solid fa-align-left text-gray-400"}),c(" Description ")],-1)),w(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>d.value.description=s),rows:"3",class:"block w-full py-2 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"},null,512),[[C,d.value.description]])]),e("div",Re,[(l(!0),i(f,null,b(g.value,(s,a)=>(l(),i("div",{key:s.id,class:"flex flex-col items-center min-w-[90px]"},[e("div",{class:E(["w-8 h-8 rounded-full flex items-center justify-center font-bold",v.value===a?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"])},r(a+1),3),e("div",Ne,r(s.name),1)]))),128)),e("div",Ve,[e("div",{class:E(["w-8 h-8 rounded-full flex items-center justify-center font-bold",B.value?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"])},r(g.value.length+1),3),t[17]||(t[17]=e("div",{class:"text-xs mt-1 text-center truncate w-full",style:{"min-width":"70px"}},"Preview",-1))])])]),e("form",{onSubmit:J(te,["prevent"]),class:"flex flex-col flex-1 min-h-0"},[g.value.length&&!B.value?(l(),i("div",ze,[(l(!0),i(f,null,b(g.value,(s,a)=>w((l(),i("div",{key:s.id},[e("div",De,[e("input",{type:"checkbox",checked:z(s.id,d.value),onChange:u=>F(s.id,d.value),id:"select-all-parent-{{parent.id}}",class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,Ue),e("label",{for:"select-all-parent-"+s.id,class:"font-semibold cursor-pointer"},"Select All",8,Ge)]),(l(!0),i(f,null,b(V(s.id),u=>(l(),i("div",{key:u.id,class:"mb-4 border rounded-lg p-4"},[e("div",Te,[e("h3",Le,r(u.name),1),e("input",{type:"checkbox",checked:D(u.id,d.value),onChange:y=>H(u.id,d.value),id:"select-all-menu-"+u.id,class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,qe),e("label",{for:"select-all-menu-"+u.id,class:"text-xs font-medium cursor-pointer"},"Select All",8,Fe)]),e("div",Ie,[(l(),i(f,null,b(["view","create","update","delete"],y=>e("label",{key:y,class:"flex items-center gap-2"},[w(e("input",{type:"checkbox",value:`${u.id}-${y}`,"onUpdate:modelValue":t[4]||(t[4]=U=>d.value.permissions=U),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,8,He),[[O,d.value.permissions]]),e("span",Ke,r(y),1)])),64))])]))),128))])),[[X,v.value===a]])),128))])):m("",!0),B.value?(l(),i("div",We,[t[22]||(t[22]=e("h3",{class:"text-lg font-bold mb-2 flex items-center gap-2"},[e("i",{class:"fa-solid fa-eye text-blue-500"}),c(" Preview Role")],-1)),e("div",Je,[t[19]||(t[19]=e("div",{class:"font-semibold"},"Name:",-1)),e("div",null,r(d.value.name),1)]),e("div",Oe,[t[20]||(t[20]=e("div",{class:"font-semibold"},"Description:",-1)),e("div",null,r(d.value.description||"-"),1)]),e("div",Xe,[t[21]||(t[21]=e("div",{class:"font-semibold mb-2"},"Permissions:",-1)),d.value.permissions.length===0?(l(),i("div",Ye,"No permissions selected.")):(l(),i("div",Qe,[(l(!0),i(f,null,b(P.menus,s=>(l(),i("div",{key:s.id},[["view","create","update","delete"].some(a=>d.value.permissions.includes(`${s.id}-${a}`))?(l(),i("div",Ze,[e("div",et,r(s.name),1),e("div",tt,[d.value.permissions.includes(`${s.id}-${o.action}`)?(l(),i(f,{key:0},b(["view","create","update","delete"],a=>e("span",{key:a,class:"px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs capitalize font-semibold border border-blue-200"},r(a),1)),64)):m("",!0)])])):m("",!0)]))),128))]))])])):m("",!0),e("div",st,[e("button",{type:"button",class:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-lg flex items-center gap-2",onClick:oe,disabled:v.value===0||p.value},t[23]||(t[23]=[e("i",{class:"fa-solid fa-arrow-left"},null,-1),c(" Sebelumnya ")]),8,lt),B.value?(l(),i("button",{key:1,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg flex items-center gap-2",disabled:p.value},[p.value?(l(),i("i",at)):(l(),i("i",nt)),t[25]||(t[25]=c(" Simpan "))],8,ot)):(l(),i("button",{key:0,type:"button",class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg flex items-center gap-2",onClick:ie,disabled:p.value},t[24]||(t[24]=[c(" Selanjutnya "),e("i",{class:"fa-solid fa-arrow-right"},null,-1)]),8,it))])],32)])])):m("",!0)]),_:1}),K(W,{name:"fade"},{default:G(()=>[M.value?(l(),i("div",rt,[e("div",dt,[e("div",ut,[e("button",{onClick:de,class:"absolute top-4 right-4 text-gray-400 hover:text-red-500 text-2xl transition-all"},t[26]||(t[26]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])),t[29]||(t[29]=e("h2",{class:"text-xl font-bold mb-6 flex items-center gap-2"},[e("i",{class:"fa-solid fa-pen-to-square text-blue-500"}),c(" Edit Role ")],-1)),e("div",ct,[t[27]||(t[27]=e("label",{class:"block font-semibold mb-1 flex items-center gap-2"},[e("i",{class:"fa-solid fa-user-tag text-gray-400"}),c(" Name ")],-1)),w(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>n.value.name=s),type:"text",class:"block w-full py-2 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[C,n.value.name]])]),e("div",pt,[t[28]||(t[28]=e("label",{class:"block font-semibold mb-1 flex items-center gap-2"},[e("i",{class:"fa-solid fa-align-left text-gray-400"}),c(" Description ")],-1)),w(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>n.value.description=s),rows:"3",class:"block w-full py-2 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500"},null,512),[[C,n.value.description]])]),e("div",ft,[(l(!0),i(f,null,b(g.value,(s,a)=>(l(),i("div",{key:s.id,class:"flex flex-col items-center min-w-[90px]"},[e("div",{class:E(["w-8 h-8 rounded-full flex items-center justify-center font-bold",x.value===a?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"])},r(a+1),3),e("div",bt,r(s.name),1)]))),128))])]),e("form",{onSubmit:J(le,["prevent"]),class:"flex flex-col flex-1 min-h-0"},[g.value.length?(l(),i("div",mt,[(l(!0),i(f,null,b(g.value,(s,a)=>w((l(),i("div",{key:s.id},[e("div",vt,[e("input",{type:"checkbox",checked:z(s.id,n.value),onChange:u=>F(s.id,n.value),id:"select-all-parent-{{parent.id}}",class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,xt),e("label",{for:"select-all-parent-"+s.id,class:"font-semibold cursor-pointer"},"Select All",8,gt)]),(l(!0),i(f,null,b(V(s.id),u=>(l(),i("div",{key:u.id,class:"mb-4 border rounded-lg p-4"},[e("div",yt,[e("h3",ht,r(u.name),1),e("input",{type:"checkbox",checked:D(u.id,n.value),onChange:y=>H(u.id,n.value),id:"select-all-menu-"+u.id,class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,wt),e("label",{for:"select-all-menu-"+u.id,class:"text-xs font-medium cursor-pointer"},"Select All",8,_t)]),e("div",kt,[(l(),i(f,null,b(["view","create","update","delete"],y=>e("label",{key:y,class:"flex items-center gap-2"},[w(e("input",{type:"checkbox",value:`${u.id}-${y}`,"onUpdate:modelValue":t[7]||(t[7]=U=>n.value.permissions=U),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,8,Ct),[[O,n.value.permissions]]),e("span",St,r(y),1)])),64))])]))),128))])),[[X,x.value===a]])),128))])):m("",!0),Z.value?(l(),i("div",$t,[t[33]||(t[33]=e("h3",{class:"text-lg font-bold mb-2 flex items-center gap-2"},[e("i",{class:"fa-solid fa-eye text-blue-500"}),c(" Preview Role")],-1)),e("div",At,[t[30]||(t[30]=e("div",{class:"font-semibold"},"Name:",-1)),e("div",null,r(n.value.name),1)]),e("div",Mt,[t[31]||(t[31]=e("div",{class:"font-semibold"},"Description:",-1)),e("div",null,r(n.value.description||"-"),1)]),e("div",jt,[t[32]||(t[32]=e("div",{class:"font-semibold mb-2"},"Permissions:",-1)),n.value.permissions.length===0?(l(),i("div",Bt,"No permissions selected.")):(l(),i("div",Et,[(l(!0),i(f,null,b(P.menus,s=>(l(),i("div",{key:s.id},[["view","create","update","delete"].some(a=>n.value.permissions.includes(`${s.id}-${a}`))?(l(),i("div",Pt,[e("div",Rt,r(s.name),1),e("div",Nt,[n.value.permissions.includes(`${s.id}-${o.action}`)?(l(),i(f,{key:0},b(["view","create","update","delete"],a=>e("span",{key:a,class:"px-2 py-1 rounded bg-blue-100 text-blue-800 text-xs capitalize font-semibold border border-blue-200"},r(a),1)),64)):m("",!0)])])):m("",!0)]))),128))]))])])):m("",!0),e("div",Vt,[e("button",{type:"button",class:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-6 py-2 rounded-lg flex items-center gap-2",onClick:ne,disabled:x.value===0||p.value},t[34]||(t[34]=[e("i",{class:"fa-solid fa-arrow-left"},null,-1),c(" Sebelumnya ")]),8,zt),x.value<g.value.length-1?(l(),i("button",{key:0,type:"button",class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg flex items-center gap-2",onClick:ae,disabled:p.value},t[35]||(t[35]=[c(" Selanjutnya "),e("i",{class:"fa-solid fa-arrow-right"},null,-1)]),8,Dt)):(l(),i("button",{key:1,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg flex items-center gap-2",disabled:p.value},[p.value?(l(),i("i",Gt)):(l(),i("i",Tt)),t[36]||(t[36]=c(" Simpan "))],8,Ut))])],32)])])):m("",!0)]),_:1})])]),_:1}))}},Qt=pe(Lt,[["__scopeId","data-v-a39c20ee"]]);export{Qt as default};
