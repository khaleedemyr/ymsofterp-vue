import{r as d,W as u,w as J,A as K,B as r,C as Q,D as e,G as y,H as v,J as j,L as c,F as E,M as F,N as l,I as _,E as P,l as Z}from"./vendor-vue-g7iCcTkf.js";import{l as ee}from"./lodash-DB3HVzpp.js";import{S as w}from"./app-CL3toCqm.js";import{A as te}from"./AppLayout-Cg9_BqdS.js";import{a as L}from"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DcALjTaB.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const ae={class:"max-w-7xl w-full mx-auto py-8 px-2"},se={class:"bg-white rounded-xl shadow-lg p-4 mb-6"},ne={class:"grid grid-cols-1 md:grid-cols-6 gap-4"},le=["value"],oe={class:"bg-white rounded-xl shadow-lg overflow-hidden"},re={class:"overflow-x-auto"},ie={class:"min-w-full divide-y divide-gray-200"},de={class:"bg-white divide-y divide-gray-200"},ue={key:0},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},me={class:"px-6 py-4 whitespace-nowrap"},pe={class:"text-sm font-medium text-blue-600"},xe={class:"text-xs text-gray-500"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},be={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900"},ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ve={class:"px-6 py-4 whitespace-nowrap"},we={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},he={class:"flex items-center gap-2"},ke=["onClick"],Ce=["onClick"],Se=["onClick"],Be=["onClick"],_e={key:0,class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},Pe={class:"flex items-center justify-between"},Ie={class:"flex-1 flex justify-between sm:hidden"},Me=["disabled"],Ae=["disabled"],De={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Te={class:"text-sm text-gray-700"},$e={class:"font-medium"},Ve={class:"font-medium"},Re={class:"font-medium"},je={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},Ee=["disabled"],Fe={class:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700"},Le=["disabled"],Ke={__name:"Index",props:{maintenances:Object,assets:Array,filters:Object},setup(s){var M,A,D,T,$,V,R;const i=s,h=d(((M=i.filters)==null?void 0:M.search)||""),m=d(((A=i.filters)==null?void 0:A.asset_id)||""),p=d(((D=i.filters)==null?void 0:D.maintenance_type)||""),x=d(((T=i.filters)==null?void 0:T.status)||"all"),g=d((($=i.filters)==null?void 0:$.date_from)||""),S=d(((V=i.filters)==null?void 0:V.date_to)||""),f=d(((R=i.filters)==null?void 0:R.per_page)||15),N=ee.debounce(()=>{u.get("/asset-management/maintenances",{search:h.value,asset_id:m.value,maintenance_type:p.value,status:x.value,date_from:g.value,date_to:S.value,per_page:f.value},{preserveState:!0,replace:!0})},400);function U(){N()}function B(n){if(n){const t=new URL(n);t.searchParams.set("search",h.value),t.searchParams.set("asset_id",m.value),t.searchParams.set("maintenance_type",p.value),t.searchParams.set("status",x.value),t.searchParams.set("date_from",g.value),t.searchParams.set("date_to",S.value),t.searchParams.set("per_page",f.value),u.visit(t.toString(),{preserveState:!0,replace:!0})}}function q(){u.visit("/asset-management/maintenances/create")}function H(n){u.visit(`/asset-management/maintenances/${n.id}`)}function W(n){u.visit(`/asset-management/maintenances/${n.id}/edit`)}async function X(n){var a,o,k,C;if((await w.fire({title:"Complete Maintenance?",text:`Konfirmasi bahwa maintenance untuk "${(a=n.asset)==null?void 0:a.name}" sudah selesai?`,icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Complete",cancelButtonText:"Batal"})).isConfirmed)try{(o=(await L.post(`/asset-management/maintenances/${n.id}/complete`,{},{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}})).data)!=null&&o.success&&(w.fire("Berhasil","Maintenance berhasil di-complete","success"),I())}catch(b){w.fire("Error",((C=(k=b.response)==null?void 0:k.data)==null?void 0:C.message)||"Gagal complete maintenance","error")}}async function G(n){var a;if((await w.fire({title:"Apakah Anda yakin?",text:"Maintenance record akan dihapus",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const o=await L.delete(`/asset-management/maintenances/${n.id}`,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});((a=o.data)!=null&&a.success||o.status===200)&&(w.fire("Berhasil","Maintenance berhasil dihapus","success"),I())}catch{w.fire("Error","Gagal menghapus maintenance","error")}}function O(n){return{Scheduled:"bg-gray-100 text-gray-800","In Progress":"bg-yellow-100 text-yellow-800",Completed:"bg-green-100 text-green-800",Cancelled:"bg-red-100 text-red-800"}[n]||"bg-gray-100 text-gray-800"}function z(n){return n==null||n===void 0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n)}function Y(n){return n?new Date(n).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"}function I(){u.reload({preserveState:!0,replace:!0})}return J([m,p,x,g,S,f],()=>{u.get("/asset-management/maintenances",{search:h.value,asset_id:m.value,maintenance_type:p.value,status:x.value,date_from:g.value,date_to:S.value,per_page:f.value},{preserveState:!0,replace:!0})}),(n,t)=>(r(),K(te,null,{default:Q(()=>[e("div",ae,[e("div",{class:"flex justify-between items-center mb-6"},[t[11]||(t[11]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-wrench text-blue-500"}),y(" Asset Maintenances ")],-1)),e("button",{onClick:q,class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2"},t[10]||(t[10]=[e("i",{class:"fa-solid fa-plus"},null,-1),y(" Record Maintenance ")]))]),e("div",se,[e("div",ne,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),v(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>h.value=a),onInput:U,placeholder:"Cari asset...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,544),[[j,h.value]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Asset",-1)),v(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>m.value=a),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[t[13]||(t[13]=e("option",{value:""},"Semua Asset",-1)),(r(!0),c(E,null,F(s.assets,a=>(r(),c("option",{key:a.id,value:a.id},l(a.asset_code)+" - "+l(a.name),9,le))),128))],512),[[_,m.value]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Type",-1)),v(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>p.value=a),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},t[15]||(t[15]=[e("option",{value:""},"Semua Tipe",-1),e("option",{value:"Cleaning"},"Cleaning",-1),e("option",{value:"Service"},"Service",-1),e("option",{value:"Repair"},"Repair",-1),e("option",{value:"Inspection"},"Inspection",-1)]),512),[[_,p.value]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),v(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>x.value=a),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},t[17]||(t[17]=[e("option",{value:"all"},"Semua Status",-1),e("option",{value:"Scheduled"},"Scheduled",-1),e("option",{value:"In Progress"},"In Progress",-1),e("option",{value:"Completed"},"Completed",-1),e("option",{value:"Cancelled"},"Cancelled",-1)]),512),[[_,x.value]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Date From",-1)),v(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=a=>g.value=a),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[j,g.value]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Per Page",-1)),v(e("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>f.value=a),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},t[20]||(t[20]=[e("option",{value:"10"},"10",-1),e("option",{value:"15"},"15",-1),e("option",{value:"25"},"25",-1),e("option",{value:"50"},"50",-1)]),512),[[_,f.value]])])])]),e("div",oe,[e("div",re,[e("table",ie,[t[27]||(t[27]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"No"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Asset"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Cost"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Vendor"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi")])],-1)),e("tbody",de,[s.maintenances.data&&s.maintenances.data.length===0?(r(),c("tr",ue,t[22]||(t[22]=[e("td",{colspan:"8",class:"px-6 py-4 text-center text-gray-500"}," Tidak ada data ",-1)]))):P("",!0),(r(!0),c(E,null,F(s.maintenances.data,(a,o)=>{var k,C;return r(),c("tr",{key:a.id,class:"hover:bg-gray-50"},[e("td",ce,l((s.maintenances.current_page-1)*s.maintenances.per_page+o+1),1),e("td",me,[e("div",null,[e("p",pe,l((k=a.asset)==null?void 0:k.asset_code),1),e("p",xe,l((C=a.asset)==null?void 0:C.name),1)])]),e("td",ge,l(Y(a.maintenance_date)),1),e("td",fe,l(a.maintenance_type),1),e("td",be,l(z(a.cost)),1),e("td",ye,l(a.vendor||"-"),1),e("td",ve,[e("span",{class:Z([O(a.status),"px-2 py-1 rounded-full text-xs font-medium"])},l(a.status),3)]),e("td",we,[e("div",he,[e("button",{onClick:b=>H(a),class:"text-green-600 hover:text-green-900",title:"View"},t[23]||(t[23]=[e("i",{class:"fa-solid fa-eye"},null,-1)]),8,ke),e("button",{onClick:b=>W(a),class:"text-blue-600 hover:text-blue-900",title:"Edit"},t[24]||(t[24]=[e("i",{class:"fa-solid fa-edit"},null,-1)]),8,Ce),a.status!=="Completed"?(r(),c("button",{key:0,onClick:b=>X(a),class:"text-green-600 hover:text-green-900",title:"Complete"},t[25]||(t[25]=[e("i",{class:"fa-solid fa-check-circle"},null,-1)]),8,Se)):P("",!0),e("button",{onClick:b=>G(a),class:"text-red-600 hover:text-red-900",title:"Hapus"},t[26]||(t[26]=[e("i",{class:"fa-solid fa-trash"},null,-1)]),8,Be)])])])}),128))])])]),s.maintenances.last_page>1?(r(),c("div",_e,[e("div",Pe,[e("div",Ie,[e("button",{onClick:t[6]||(t[6]=a=>B(s.maintenances.prev_page_url)),disabled:!s.maintenances.prev_page_url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,Me),e("button",{onClick:t[7]||(t[7]=a=>B(s.maintenances.next_page_url)),disabled:!s.maintenances.next_page_url,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Ae)]),e("div",De,[e("div",null,[e("p",Te,[t[28]||(t[28]=y(" Menampilkan ")),e("span",$e,l(s.maintenances.from),1),t[29]||(t[29]=y(" sampai ")),e("span",Ve,l(s.maintenances.to),1),t[30]||(t[30]=y(" dari ")),e("span",Re,l(s.maintenances.total),1),t[31]||(t[31]=y(" hasil "))])]),e("div",null,[e("nav",je,[e("button",{onClick:t[8]||(t[8]=a=>B(s.maintenances.prev_page_url)),disabled:!s.maintenances.prev_page_url,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},t[32]||(t[32]=[e("i",{class:"fa-solid fa-chevron-left"},null,-1)]),8,Ee),e("span",Fe," Page "+l(s.maintenances.current_page)+" of "+l(s.maintenances.last_page),1),e("button",{onClick:t[9]||(t[9]=a=>B(s.maintenances.next_page_url)),disabled:!s.maintenances.next_page_url,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},t[33]||(t[33]=[e("i",{class:"fa-solid fa-chevron-right"},null,-1)]),8,Le)])])])])])):P("",!0)])])]),_:1}))}};export{Ke as default};
