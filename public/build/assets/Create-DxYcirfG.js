import{r as c,c as D,A as q,B as o,C as F,D as e,G as n,O as G,L as r,E as d,H as v,l as m,F as y,M as _,N as u,I as C,a6 as V,J as I,W as M}from"./vendor-vue-g7iCcTkf.js";import{A as E}from"./AppLayout-hxs5t3XP.js";import"./vendor-utils-CpgP2uT4.js";import"./app-D6rf3j_5.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-D4k-zQf5.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const z={class:"w-full py-8 px-4"},W={class:"max-w-4xl mx-auto"},Y={class:"bg-white rounded-2xl shadow-lg p-8"},$=["value"],j={key:0,class:"mt-1 text-sm text-red-600"},H=["value"],J={key:0,class:"mt-1 text-sm text-red-600"},P=["disabled"],R=["value"],K={key:0,class:"mt-1 text-sm text-red-600"},Q={key:1,class:"mt-1 text-sm text-gray-500"},X={class:"grid grid-cols-2 gap-4"},Z={key:0,class:"mt-1 text-sm text-red-600"},ee={class:"relative"},te=["disabled"],le={key:0,class:"mt-2"},se={class:"flex flex-wrap gap-2"},oe=["onClick"],re={key:1,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto"},ae=["onClick"],ie={key:0,class:"mt-1 text-sm text-red-600"},ue={key:0,class:"mt-1 text-sm text-red-600"},ne={key:0,class:"bg-blue-50 border border-blue-200 rounded-xl p-4"},de={class:"flex items-center justify-end gap-4 pt-6 border-t border-gray-200"},me=["disabled"],pe={key:0,class:"fa-solid fa-spinner fa-spin mr-2"},ce={key:1,class:"fa-solid fa-arrow-right mr-2"},Ae={__name:"Create",props:{outlets:Array,departemenOptions:Array,selectedOutlet:Number,selectedDepartemen:String,users:Array,guidances:Array},setup(w){const k=w,s=c({outlet_id:k.selectedOutlet||"",departemen:k.selectedDepartemen||"",guidance_id:"",inspection_mode:"product",inspection_date:new Date().toISOString().split("T")[0],auditees:[]}),f=c(""),p=c([]),g=c([]),x=c(!1),a=c({}),b=c(!1),N=D(()=>s.value.outlet_id?k.users.filter(i=>i.id_outlet==s.value.outlet_id):[]),O=D(()=>s.value.departemen?k.guidances.filter(i=>i.departemen===s.value.departemen):[]);function h(){if(f.value.length<2){g.value=[],x.value=!1;return}g.value=N.value.filter(i=>i.nama_lengkap.toLowerCase().includes(f.value.toLowerCase())&&!p.value.some(t=>t.id===i.id)),x.value=g.value.length>0}function U(i){p.value.push(i),f.value="",x.value=!1,g.value=[],s.value.auditees=p.value.map(t=>t.id)}function T(i){p.value.splice(i,1),s.value.auditees=p.value.map(t=>t.id)}function B(){setTimeout(()=>{x.value=!1},200)}function L(){b.value=!0,a.value={},M.post(route("inspections.store"),s.value,{onSuccess:()=>{},onError:i=>{a.value=i},onFinish:()=>{b.value=!1}})}function A(){M.visit("/inspections")}return(i,t)=>(o(),q(E,{title:"Create Inspection"},{default:F(()=>[e("div",z,[e("div",W,[e("div",{class:"flex items-center gap-4 mb-8"},[e("button",{onClick:A,class:"text-gray-500 hover:text-gray-700 transition"},t[7]||(t[7]=[e("i",{class:"fa-solid fa-arrow-left text-xl"},null,-1)])),t[8]||(t[8]=e("h1",{class:"text-3xl font-bold text-gray-800 flex items-center gap-3"},[e("i",{class:"fa-solid fa-clipboard-check text-blue-500"}),n(" Create New Inspection ")],-1))]),e("div",Y,[e("form",{onSubmit:G(L,["prevent"]),class:"space-y-6"},[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-store mr-2"}),n("Outlet * ")],-1)),v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.outlet_id=l),class:m(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",a.value.outlet_id?"border-red-500":"border-gray-300"]),required:""},[t[9]||(t[9]=e("option",{value:""},"Select Outlet",-1)),(o(!0),r(y,null,_(w.outlets,l=>(o(),r("option",{key:l.id_outlet,value:l.id_outlet},u(l.nama_outlet),9,$))),128))],2),[[C,s.value.outlet_id]]),a.value.outlet_id?(o(),r("p",j,u(a.value.outlet_id),1)):d("",!0)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-building mr-2"}),n("Department * ")],-1)),v(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.departemen=l),class:m(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",a.value.departemen?"border-red-500":"border-gray-300"]),required:""},[t[11]||(t[11]=e("option",{value:""},"Select Department",-1)),(o(!0),r(y,null,_(w.departemenOptions,l=>(o(),r("option",{key:l,value:l},u(l),9,H))),128))],2),[[C,s.value.departemen]]),a.value.departemen?(o(),r("p",J,u(a.value.departemen),1)):d("",!0)]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-clipboard-list mr-2"}),n("Guidance * ")],-1)),v(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.guidance_id=l),class:m(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",a.value.guidance_id?"border-red-500":"border-gray-300"]),disabled:!s.value.departemen,required:""},[t[13]||(t[13]=e("option",{value:""},"Select Guidance",-1)),(o(!0),r(y,null,_(O.value,l=>(o(),r("option",{key:l.id,value:l.id},u(l.title),9,R))),128))],10,P),[[C,s.value.guidance_id]]),a.value.guidance_id?(o(),r("p",K,u(a.value.guidance_id),1)):d("",!0),s.value.departemen?d("",!0):(o(),r("p",Q,"Select department first"))]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-cogs mr-2"}),n("Inspection Mode * ")],-1)),e("div",X,[e("label",{class:m(["flex items-center p-4 border rounded-xl cursor-pointer hover:bg-blue-50 transition",s.value.inspection_mode==="product"?"border-blue-500 bg-blue-50":"border-gray-300"])},[v(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=l=>s.value.inspection_mode=l),value:"product",class:"mr-3 text-blue-600 focus:ring-blue-500"},null,512),[[V,s.value.inspection_mode]]),t[15]||(t[15]=e("div",null,[e("div",{class:"font-medium text-gray-800"},"Product Mode"),e("div",{class:"text-sm text-gray-500"},"Direct point assignment")],-1))],2),e("label",{class:m(["flex items-center p-4 border rounded-xl cursor-pointer hover:bg-green-50 transition",s.value.inspection_mode==="cleanliness"?"border-green-500 bg-green-50":"border-gray-300"])},[v(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=l=>s.value.inspection_mode=l),value:"cleanliness",class:"mr-3 text-green-600 focus:ring-green-500"},null,512),[[V,s.value.inspection_mode]]),t[16]||(t[16]=e("div",null,[e("div",{class:"font-medium text-gray-800"},"Cleanliness Mode"),e("div",{class:"text-sm text-gray-500"},"Yes/No/NA rating")],-1))],2)]),a.value.inspection_mode?(o(),r("p",Z,u(a.value.inspection_mode),1)):d("",!0)]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-users mr-2"}),n("Auditees ")],-1)),e("div",ee,[v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>f.value=l),onInput:h,onFocus:h,onBlur:B,disabled:!s.value.outlet_id,class:m(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",a.value.auditees?"border-red-500":"border-gray-300",s.value.outlet_id?"":"bg-gray-100 cursor-not-allowed"]),placeholder:"Type to search auditees..."},null,42,te),[[I,f.value]]),p.value.length>0?(o(),r("div",le,[e("div",se,[(o(!0),r(y,null,_(p.value,(l,S)=>(o(),r("span",{key:l.id,class:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800"},[n(u(l.nama_lengkap)+" ",1),e("button",{onClick:ve=>T(S),class:"ml-2 text-blue-600 hover:text-blue-800"},t[18]||(t[18]=[e("i",{class:"fa-solid fa-times text-xs"},null,-1)]),8,oe)]))),128))])])):d("",!0),x.value?(o(),r("div",re,[(o(!0),r(y,null,_(g.value,l=>(o(),r("div",{key:l.id,onClick:S=>U(l),class:"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0"},u(l.nama_lengkap),9,ae))),128))])):d("",!0)]),a.value.auditees?(o(),r("p",ie,u(a.value.auditees),1)):d("",!0),t[20]||(t[20]=e("p",{class:"mt-1 text-sm text-gray-500"}," Type to search users from the chosen outlet to be audited ",-1))]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-calendar mr-2"}),n("Inspection Date * ")],-1)),v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.inspection_date=l),type:"date",class:m(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",a.value.inspection_date?"border-red-500":"border-gray-300"]),required:""},null,2),[[I,s.value.inspection_date]]),a.value.inspection_date?(o(),r("p",ue,u(a.value.inspection_date),1)):d("",!0)]),s.value.outlet_id&&s.value.departemen?(o(),r("div",ne,t[22]||(t[22]=[e("h3",{class:"text-sm font-semibold text-blue-800 mb-2"},[e("i",{class:"fa-solid fa-info-circle mr-2"}),n("Session Information ")],-1),e("p",{class:"text-sm text-blue-700"}," This outlet and department will be remembered for future inspections. You can add multiple findings to this inspection session. ",-1)]))):d("",!0),e("div",de,[e("button",{type:"button",onClick:A,class:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-xl font-medium transition"},t[23]||(t[23]=[e("i",{class:"fa-solid fa-times mr-2"},null,-1),n("Cancel ")])),e("button",{type:"submit",disabled:b.value||!s.value.outlet_id||!s.value.departemen,class:m(["px-6 py-3 rounded-xl font-medium transition",b.value||!s.value.outlet_id||!s.value.departemen?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white"])},[b.value?(o(),r("i",pe)):(o(),r("i",ce)),n(" "+u(b.value?"Creating...":"Start Inspection"),1)],10,me)])],32)])])])]),_:1}))}};export{Ae as default};
