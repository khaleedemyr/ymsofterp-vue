import{r as g,$ as De,c as ie,w as _e,W as U,A as Se,B as i,C as j,D as e,L as d,E,G as m,x as de,N as u,Q as ue,S as ce,H as M,J as V,I as Ee,F as xe,M as fe,l as W}from"./vendor-vue-g7iCcTkf.js";import{u as Le,A as Te}from"./AppLayout-Cke2dYBX.js";import{S as h}from"./app-AaUk6aDd.js";import{E as Ce}from"./jspdf.es.min-BNHjn-f4.js";import{a as P}from"./vendor-utils-CpgP2uT4.js";import{d as Fe}from"./vendor-ui-CrPgGUUb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DtjcyHN1.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";async function Oe({orderNumber:o,date:x,outlet:L,items:b,kasirName:D,divisionName:w,warehouseName:k,roNumber:C,roDate:S,roCreatorName:_,showReprintLabel:y=!1}){let c=0;c+=15,c+=20,c+=8,c+=10,c+=8,b&&b.length?b.forEach(f=>{const v=f.name.length>20?Math.ceil(f.name.length/20):1;c+=v*3.5+4}):c+=8,c+=12,c+=15;const l=new Ce({unit:"mm",format:[80,Math.max(297,c)]});let a=10;y&&(l.setFontSize(8),l.setFont(void 0,"normal"),l.text("reprint",78,7,{align:"right"})),l.setFontSize(13),l.setFont(void 0,"bold"),l.text("DELIVERY ORDER",40,a,{align:"center"}),a+=6,l.setFontSize(10),l.text("JUSTUS GROUP",40,a,{align:"center"}),a+=5,l.setFont(void 0,"bold"),(w||k)&&(l.text(`${w||""}${w&&k?" - ":""}${k||""}`,40,a,{align:"center"}),a+=5),l.setFont(void 0,"normal"),l.setFontSize(9),l.text(`No: ${o}`,2,a),a+=4,l.text(`Tanggal: ${x}`,2,a),a+=4,l.text(`Outlet: ${L}`,2,a),a+=4,C&&(l.text(`RO: ${C}`,2,a),a+=4),S&&(l.text(`Tgl RO: ${S}`,2,a),a+=4),_&&(l.text(`Pembuat RO: ${_}`,2,a),a+=4),a+=1.5,l.setLineWidth(.5),l.line(2,a,78,a),a+=2.5,b&&b.length?b.forEach(f=>{const v=`${f.qty_scan} ${f.unit_code||f.unit} ${f.name}`;l.splitTextToSize(v,76).forEach(A=>{l.text(A,2,a),a+=3.5}),a+=1.5}):(l.text("TIDAK ADA ITEM",2,a),a+=3.5),a+=1.5,l.setLineWidth(.5),l.line(2,a,78,a),a+=2.5,D&&(l.text(`Kasir: ${D}`,2,a),a+=4),l.text("Terima kasih",2,a),a+=8,l.output("dataurlnewwindow")}const $e={class:"max-w-7xl mx-auto py-8 px-2"},Re={class:"flex justify-between items-center mb-6"},Be={class:"flex gap-2"},Ue=["disabled"],Me={key:0,class:"fa fa-spinner fa-spin"},Pe={key:1,class:"fa fa-file-excel"},Ae=["disabled"],Ge={key:0,class:"fa fa-spinner fa-spin"},Ie={key:1,class:"fa fa-chart-bar"},je=["disabled"],Ve={key:0,class:"fa fa-spinner fa-spin"},We={key:1,class:"fa fa-list-ul"},ze={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},He={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},Ye={class:"bg-white rounded-2xl shadow-2xl overflow-x-auto transition-all"},Je={class:"w-full min-w-full divide-y divide-gray-200"},Ke={key:0},qe={key:1},Ne={class:"px-6 py-3"},Qe={class:"px-6 py-3"},Xe={class:"px-6 py-3"},Ze={class:"text-sm"},et={class:"font-medium"},tt={class:"text-gray-500 text-xs"},at={class:"px-6 py-3"},lt={class:"px-6 py-3"},st={class:"px-6 py-3"},rt={class:"text-sm"},ot={class:"font-medium"},nt={class:"px-6 py-3"},it={class:"px-6 py-3"},dt={class:"px-6 py-3"},ut={class:"px-6 py-3"},ct=["onClick","disabled"],xt={key:0,class:"fa fa-spinner fa-spin mr-1"},ft={key:1,class:"fa fa-print mr-1"},pt=["onClick","disabled"],mt={key:0,class:"fa fa-spinner fa-spin mr-1"},bt={key:1,class:"fa fa-trash mr-1"},gt={key:0,class:"flex flex-col items-center mt-6 space-y-4"},yt={class:"flex items-center space-x-1 flex-wrap justify-center","aria-label":"Pagination"},vt=["disabled"],ht={key:1,class:"px-2 py-2 text-gray-500"},wt=["onClick"],kt={key:2,class:"px-2 py-2 text-gray-500"},Dt=["disabled"],_t={class:"text-sm text-gray-600 text-center"},Pt={__name:"Index",props:{orders:Array,filters:Object,canDelete:{type:Boolean,default:!1}},setup(o){var z,H,Y,J,K;const x=o,L=g(null),b=g(null),D=g(!1),w=g(!1),k=g(!1),C=De();ie(()=>{var r;return((r=C.props.auth)==null?void 0:r.user)||C.props.user});const{showLoading:S,hideLoading:_}=Le(),y=g(((z=x.filters)==null?void 0:z.search)||""),c=Fe().format("YYYY-MM-DD"),l=g(((H=x.filters)==null?void 0:H.dateFrom)||c),a=g(((Y=x.filters)==null?void 0:Y.dateTo)||c),f=g(((J=x.filters)==null?void 0:J.load_data)||""),v=g(((K=x.filters)==null?void 0:K.per_page)||15),F=g(f.value==="1"),A=ie(()=>{if(!x.orders||!x.orders.current_page||!x.orders.last_page)return[];const r=x.orders.current_page,t=x.orders.last_page,n=2;let $=Math.max(1,r-n),R=Math.min(t,r+n);r-n<=1&&(R=Math.min(t,1+n*2)),r+n>=t&&($=Math.max(1,t-n*2));const B=[];for(let T=$;T<=R;T++)B.push(T);return B});_e(v,r=>{f.value==="1"&&G()});function pe(r){return r?new Date(r).toLocaleDateString("id-ID"):"-"}function me(r){return r?new Date(r).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"}async function be(r){if((await h.fire({title:"Hapus Delivery Order?",text:"Data dan rollback stok akan dikembalikan. Lanjutkan?",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"})).isConfirmed){L.value=r,S("Menghapus Delivery Order...");try{await U.delete(`/delivery-order/${r}`,{onSuccess:async()=>{_(),await h.fire({icon:"success",title:"Sukses",text:"Delivery Order berhasil dihapus dan stok dikembalikan!",timer:1500,showConfirmButton:!1}),f.value==="1"&&G()},onError:async n=>{_(),await h.fire({icon:"error",title:"Gagal",text:n||"Gagal menghapus Delivery Order"})},preserveScroll:!0})}finally{L.value=null}}}async function ge(r){b.value=r;try{const{data:t}=await P.get(`/api/delivery-order/${r}/struk`);await Oe({...t,showReprintLabel:!0})}catch{await h.fire({icon:"error",title:"Gagal",text:"Gagal mengambil data struk. Coba lagi."})}finally{b.value=null}}function G(){S("Memuat Data Delivery Order..."),U.get(route("delivery-order.index"),{search:y.value,dateFrom:l.value,dateTo:a.value,load_data:"1",per_page:v.value},{preserveState:!0,onFinish:()=>{_(),F.value=!0}})}function ye(){S("Membersihkan Filter..."),y.value="",l.value=c,a.value=c,f.value="",v.value=15,U.get(route("delivery-order.clear-filters"),{},{preserveState:!1,replace:!0,onFinish:()=>{_(),F.value=!1}})}function O(r){f.value==="1"&&(S("Memuat Halaman..."),U.get(route("delivery-order.index"),{search:y.value,dateFrom:l.value,dateTo:a.value,load_data:"1",per_page:v.value,page:r},{preserveState:!0,onFinish:()=>{_()}}))}async function ve(){D.value=!0;try{const r=await P.get(route("delivery-order.export"),{params:{search:y.value,dateFrom:l.value,dateTo:a.value},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([r.data])),n=document.createElement("a");n.href=t,n.setAttribute("download",`delivery-order-${new Date().toISOString().slice(0,10)}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t),await h.fire({icon:"success",title:"Export Berhasil",text:"File Excel berhasil diunduh",timer:1500,showConfirmButton:!1})}catch(r){console.error("Export error:",r),await h.fire({icon:"error",title:"Export Gagal",text:"Gagal mengekspor data ke Excel. Silakan coba lagi."})}finally{D.value=!1}}async function he(){w.value=!0;try{const r=await P.get(route("delivery-order.export-summary"),{params:{search:y.value,dateFrom:l.value,dateTo:a.value},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([r.data])),n=document.createElement("a");n.href=t,n.setAttribute("download",`delivery-order-summary-${new Date().toISOString().slice(0,10)}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t),await h.fire({icon:"success",title:"Export Berhasil",text:"File Summary berhasil diunduh",timer:1500,showConfirmButton:!1})}catch(r){console.error("Export error:",r),await h.fire({icon:"error",title:"Export Gagal",text:"Gagal mengekspor data summary. Silakan coba lagi."})}finally{w.value=!1}}async function we(){k.value=!0;try{const r=await P.get(route("delivery-order.export-detail"),{params:{search:y.value,dateFrom:l.value,dateTo:a.value},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([r.data])),n=document.createElement("a");n.href=t,n.setAttribute("download",`delivery-order-detail-${new Date().toISOString().slice(0,10)}.xlsx`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(t),await h.fire({icon:"success",title:"Export Berhasil",text:"File Detail berhasil diunduh",timer:1500,showConfirmButton:!1})}catch(r){console.error("Export error:",r),await h.fire({icon:"error",title:"Export Gagal",text:"Gagal mengekspor data detail. Silakan coba lagi."})}finally{k.value=!1}}return(r,t)=>(i(),Se(Te,null,{default:j(()=>{var n,$,R,B,T,q,N,Q,X,Z,ee,te,ae,le,se,re,oe;return[e("div",$e,[e("div",Re,[t[9]||(t[9]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-truck-arrow-right text-blue-500"}),m(" Delivery Order ")],-1)),e("div",Be,[e("button",{onClick:ve,disabled:D.value,class:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold flex items-center gap-2"},[D.value?(i(),d("i",Me)):(i(),d("i",Pe)),m(" "+u(D.value?"Exporting...":"Export Excel"),1)],8,Ue),e("button",{onClick:he,disabled:w.value,class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold flex items-center gap-2"},[w.value?(i(),d("i",Ge)):(i(),d("i",Ie)),m(" "+u(w.value?"Exporting...":"Export Summary"),1)],8,Ae),e("button",{onClick:we,disabled:k.value,class:"bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold flex items-center gap-2"},[k.value?(i(),d("i",Ve)):(i(),d("i",We)),m(" "+u(k.value?"Exporting...":"Export Detail"),1)],8,je),de(ue(ce),{href:"/delivery-order/create",class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"},{default:j(()=>t[8]||(t[8]=[m(" + Buat Delivery Order ")])),_:1})])]),e("div",ze,[t[17]||(t[17]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},[e("i",{class:"fa fa-filter text-blue-500"}),m(" Filter Data ")],-1)),e("div",He,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),M(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),type:"text",placeholder:"Cari nomor, outlet, warehouse...",class:"w-full px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[V,y.value]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Dari Tanggal",-1)),M(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value=s),type:"date",class:"w-full px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[V,l.value]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Sampai Tanggal",-1)),M(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value=s),type:"date",class:"w-full px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},null,512),[[V,a.value]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Per Page",-1)),M(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>v.value=s),class:"w-full px-4 py-2 rounded-xl border border-blue-200 shadow focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition"},t[13]||(t[13]=[e("option",{value:"10"},"10",-1),e("option",{value:"15"},"15",-1),e("option",{value:"25"},"25",-1),e("option",{value:"50"},"50",-1),e("option",{value:"100"},"100",-1)]),512),[[Ee,v.value]])])]),e("div",{class:"flex gap-3"},[e("button",{onClick:G,class:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-6 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold flex items-center gap-2"},t[15]||(t[15]=[e("i",{class:"fa fa-search"},null,-1),m(" Load Data ")])),e("button",{onClick:ye,class:"bg-gradient-to-r from-gray-500 to-gray-700 text-white px-6 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold flex items-center gap-2"},t[16]||(t[16]=[e("i",{class:"fa fa-refresh"},null,-1),m(" Clear Filter ")]))])]),e("div",Ye,[e("table",Je,[t[23]||(t[23]=e("thead",{class:"bg-gradient-to-r from-blue-50 to-blue-100"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tl-2xl"},"No"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"No DO"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Tanggal & Jam"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Outlet"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Warehouse Outlet"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Warehouse Info"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Packing List"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"Floor Order"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider"},"User"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-blue-700 uppercase tracking-wider rounded-tr-2xl"},"Aksi")])],-1)),e("tbody",null,[F.value?!o.orders.data||!o.orders.data.length?(i(),d("tr",qe,t[19]||(t[19]=[e("td",{colspan:"10",class:"text-center py-16"},[e("div",{class:"flex flex-col items-center gap-4"},[e("i",{class:"fa fa-inbox text-6xl text-gray-300"}),e("div",{class:"text-gray-500"},[e("p",{class:"text-lg font-semibold"},"Tidak ada data Delivery Order"),e("p",{class:"text-sm"},"Coba ubah filter atau tanggal pencarian")])])],-1)]))):E("",!0):(i(),d("tr",Ke,t[18]||(t[18]=[e("td",{colspan:"10",class:"text-center py-16"},[e("div",{class:"flex flex-col items-center gap-4"},[e("i",{class:"fa fa-search text-6xl text-gray-300"}),e("div",{class:"text-gray-500"},[e("p",{class:"text-lg font-semibold"},'Pilih filter dan klik "Load Data" untuk menampilkan data'),e("p",{class:"text-sm"},"Anda bisa search berdasarkan nomor, outlet, atau warehouse")])])],-1)]))),(i(!0),d(xe,null,fe(((n=o.orders)==null?void 0:n.data)||[],(s,p)=>{var I,ne;return i(),d("tr",{key:s.id,class:"hover:bg-blue-50 transition shadow-sm"},[e("td",Ne,u(((((I=o.orders)==null?void 0:I.current_page)||1)-1)*(((ne=o.orders)==null?void 0:ne.per_page)||15)+p+1),1),e("td",Qe,u(s.number||"-"),1),e("td",Xe,[e("div",Ze,[e("div",et,u(s.created_date||pe(s.created_at)),1),e("div",tt,u(s.created_time||me(s.created_at)),1)])]),e("td",at,u(s.nama_outlet||"-"),1),e("td",lt,u(s.warehouse_outlet_name||"-"),1),e("td",st,[e("div",rt,[e("div",ot,u(s.warehouse_info||"-"),1)])]),e("td",nt,u(s.packing_number||"-"),1),e("td",it,u(s.floor_order_number||"-"),1),e("td",dt,u(s.created_by_name||"-"),1),e("td",ut,[de(ue(ce),{href:`/delivery-order/${s.id}`,class:"inline-flex items-center btn btn-xs bg-blue-100 text-blue-800 hover:bg-blue-200 rounded px-2 py-1 font-semibold transition"},{default:j(()=>t[20]||(t[20]=[e("i",{class:"fa fa-eye mr-1"},null,-1),m(" Detail ")])),_:2},1032,["href"]),e("button",{onClick:ke=>ge(s.id),disabled:b.value===s.id,class:"ml-2 inline-flex items-center btn btn-xs bg-green-100 text-green-800 hover:bg-green-200 rounded px-2 py-1 font-semibold transition disabled:opacity-50"},[b.value===s.id?(i(),d("i",xt)):(i(),d("i",ft)),t[21]||(t[21]=m(" Reprint "))],8,ct),x.canDelete?(i(),d("button",{key:0,onClick:ke=>be(s.id),disabled:L.value===s.id,class:"ml-2 inline-flex items-center btn btn-xs bg-red-100 text-red-800 hover:bg-red-200 rounded px-2 py-1 font-semibold transition disabled:opacity-50"},[L.value===s.id?(i(),d("i",mt)):(i(),d("i",bt)),t[22]||(t[22]=m(" Delete "))],8,pt)):E("",!0)])])}),128))])])]),F.value&&o.orders&&o.orders.total>o.orders.per_page?(i(),d("div",gt,[e("nav",yt,[e("button",{onClick:t[4]||(t[4]=s=>{var p;return O((((p=o.orders)==null?void 0:p.current_page)||1)-1)}),disabled:((($=o.orders)==null?void 0:$.current_page)||1)===1,class:W(["px-3 py-2 text-sm font-medium rounded-md transition-colors",(((R=o.orders)==null?void 0:R.current_page)||1)===1?"text-gray-400 cursor-not-allowed":"text-blue-700 hover:bg-blue-100"])},t[24]||(t[24]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),10,vt),(((B=o.orders)==null?void 0:B.current_page)||1)>3?(i(),d("button",{key:0,onClick:t[5]||(t[5]=s=>O(1)),class:"px-3 py-2 text-sm font-medium text-blue-700 hover:bg-blue-100 rounded-md transition-colors"}," 1 ")):E("",!0),(((T=o.orders)==null?void 0:T.current_page)||1)>4?(i(),d("span",ht,"...")):E("",!0),(i(!0),d(xe,null,fe(A.value,s=>{var p;return i(),d("button",{key:s,onClick:I=>O(s),class:W(["px-3 py-2 text-sm font-medium rounded-md transition-colors",s===(((p=o.orders)==null?void 0:p.current_page)||1)?"bg-blue-500 text-white":"text-blue-700 hover:bg-blue-100"])},u(s),11,wt)}),128)),(((q=o.orders)==null?void 0:q.current_page)||1)<(((N=o.orders)==null?void 0:N.last_page)||1)-3?(i(),d("span",kt,"...")):E("",!0),(((Q=o.orders)==null?void 0:Q.current_page)||1)<(((X=o.orders)==null?void 0:X.last_page)||1)-2?(i(),d("button",{key:3,onClick:t[6]||(t[6]=s=>{var p;return O(((p=o.orders)==null?void 0:p.last_page)||1)}),class:"px-3 py-2 text-sm font-medium text-blue-700 hover:bg-blue-100 rounded-md transition-colors"},u(((Z=o.orders)==null?void 0:Z.last_page)||1),1)):E("",!0),e("button",{onClick:t[7]||(t[7]=s=>{var p;return O((((p=o.orders)==null?void 0:p.current_page)||1)+1)}),disabled:(((ee=o.orders)==null?void 0:ee.current_page)||1)===(((te=o.orders)==null?void 0:te.last_page)||1),class:W(["px-3 py-2 text-sm font-medium rounded-md transition-colors",(((ae=o.orders)==null?void 0:ae.current_page)||1)===(((le=o.orders)==null?void 0:le.last_page)||1)?"text-gray-400 cursor-not-allowed":"text-blue-700 hover:bg-blue-100"])},t[25]||(t[25]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),10,Dt)]),e("div",_t,[m(" Halaman "+u(((se=o.orders)==null?void 0:se.current_page)||1)+" dari "+u(((re=o.orders)==null?void 0:re.last_page)||1)+" ",1),t[26]||(t[26]=e("span",{class:"mx-2"},"â€¢",-1)),m(" Total "+u(((oe=o.orders)==null?void 0:oe.total)||0)+" data ",1)])])):E("",!0)])]}),_:1}))}};export{Pt as default};
