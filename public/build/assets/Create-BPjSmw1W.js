import{P as L,r as f,A as E,B as d,C as B,D as l,G as m,O as F,H as a,Q as s,J as i,L as u,F as y,M as x,N as c,I as v,E as V,x as q,S as X}from"./vendor-vue-g7iCcTkf.js";import{S as j}from"./app-CMkuePvF.js";import{a as G}from"./vendor-utils-CpgP2uT4.js";import{A as O}from"./AppLayout-U5X72hCR.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DCdSPjRr.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const R={class:"max-w-4xl w-full mx-auto py-8 px-2"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},H=["value"],I={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},J={class:"flex gap-2"},K=["value"],W={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q=["value"],z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Z=["value"],h={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},_={key:0,class:"mt-4 grid grid-cols-4 gap-4"},ee=["src"],le=["onClick"],re={class:"flex justify-end gap-3 pt-4 border-t border-gray-200"},te=["disabled"],se={key:0,class:"fa-solid fa-spinner fa-spin"},fe={__name:"Create",props:{categories:Array,outlets:Array,suppliers:Array,brands:Array,nextCode:String},setup(g){const k=g,t=L({asset_code:k.nextCode||"",name:"",category_id:"",brand:"",brand_id:null,model:"",serial_number:"",purchase_date:"",purchase_price:null,supplier_id:null,supplier:"",current_outlet_id:null,status:"Active",photos:[],description:"",useful_life:null,warranty_expiry_date:""}),w=f([]),A=f([]),p=f(!1),b=f(""),S=f(!1);function M(o){const e=Array.from(o.target.files);A.value=[...A.value,...e],e.forEach(r=>{const n=new FileReader;n.onload=U=>{w.value.push(U.target.result)},n.readAsDataURL(r)})}function C(o){w.value.splice(o,1),A.value.splice(o,1)}function P(){if(t.supplier_id){const o=k.suppliers.find(e=>e.id==t.supplier_id);o&&(t.supplier=o.name)}}function T(){if(t.brand_id==="new")p.value=!0,t.brand_id=null;else if(t.brand_id){const o=k.brands.find(e=>e.id==t.brand_id);o&&(t.brand=o.name),p.value=!1}else p.value=!1}async function D(){var o,e,r;if(!b.value||b.value.trim()===""){p.value=!1;return}S.value=!0;try{const n=await G.post("/asset-management/assets/create-brand",{name:b.value.trim()},{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});(o=n.data)!=null&&o.success&&(k.brands.push(n.data.data),t.brand_id=n.data.data.id,t.brand=n.data.data.name,b.value="",p.value=!1)}catch(n){j.fire("Error",((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Gagal membuat brand baru","error")}finally{S.value=!1}}function N(){const o=new FormData;Object.keys(t.data()).forEach(e=>{e!=="photos"&&o.append(e,t[e]||"")}),A.value.forEach((e,r)=>{o.append(`photos[${r}]`,e)}),t.transform(()=>o).post("/asset-management/assets",{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{}})}return(o,e)=>(d(),E(O,null,{default:B(()=>[l("div",R,[e[42]||(e[42]=l("div",{class:"mb-6"},[l("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[l("i",{class:"fa-solid fa-plus-circle text-blue-500"}),m(" Tambah Asset ")])],-1)),l("form",{onSubmit:F(N,["prevent"]),class:"bg-white rounded-xl shadow-lg p-6 space-y-6"},[l("div",null,[e[17]||(e[17]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[m(" Asset Code "),l("span",{class:"text-red-500"},"*")],-1)),a(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>s(t).asset_code=r),required:"",placeholder:"AST-2026-0001",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).asset_code]]),e[18]||(e[18]=l("p",{class:"text-xs text-gray-500 mt-1"},"Format: AST-YYYY-XXXX (contoh: AST-2026-0001)",-1))]),l("div",Y,[l("div",null,[e[19]||(e[19]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[m(" Nama Asset "),l("span",{class:"text-red-500"},"*")],-1)),a(l("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=r=>s(t).name=r),required:"",placeholder:"Masukkan nama asset",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).name]])]),l("div",null,[e[21]||(e[21]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[m(" Kategori "),l("span",{class:"text-red-500"},"*")],-1)),a(l("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>s(t).category_id=r),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[20]||(e[20]=l("option",{value:""},"Pilih Kategori",-1)),(d(!0),u(y,null,x(g.categories,r=>(d(),u("option",{key:r.id,value:r.id},c(r.name),9,H))),128))],512),[[v,s(t).category_id]])])]),l("div",I,[l("div",null,[e[24]||(e[24]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Brand",-1)),l("div",J,[a(l("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>s(t).brand_id=r),onChange:T,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[22]||(e[22]=l("option",{value:null},"Pilih Brand",-1)),(d(!0),u(y,null,x(g.brands,r=>(d(),u("option",{key:r.id,value:r.id},c(r.name),9,K))),128)),e[23]||(e[23]=l("option",{value:"new"},"+ Tambah Brand Baru",-1))],544),[[v,s(t).brand_id]])]),p.value?a((d(),u("input",{key:0,type:"text","onUpdate:modelValue":e[4]||(e[4]=r=>b.value=r),onBlur:D,placeholder:"Masukkan nama brand baru",class:"w-full mt-2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,544)),[[i,b.value]]):s(t).brand_id?V("",!0):a((d(),u("input",{key:1,type:"text","onUpdate:modelValue":e[5]||(e[5]=r=>s(t).brand=r),placeholder:"Atau masukkan brand manual",class:"w-full mt-2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512)),[[i,s(t).brand]])]),l("div",null,[e[25]||(e[25]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Model",-1)),a(l("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=r=>s(t).model=r),placeholder:"Masukkan model",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).model]])])]),l("div",W,[l("div",null,[e[26]||(e[26]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Serial Number",-1)),a(l("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=r=>s(t).serial_number=r),placeholder:"Masukkan serial number",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).serial_number]])]),l("div",null,[e[27]||(e[27]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Pembelian",-1)),a(l("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=r=>s(t).purchase_date=r),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).purchase_date]])])]),l("div",$,[l("div",null,[e[28]||(e[28]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Harga Pembelian",-1)),a(l("input",{type:"number","onUpdate:modelValue":e[9]||(e[9]=r=>s(t).purchase_price=r),step:"0.01",min:"0",placeholder:"0",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).purchase_price]])]),l("div",null,[e[30]||(e[30]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Supplier",-1)),a(l("select",{"onUpdate:modelValue":e[10]||(e[10]=r=>s(t).supplier_id=r),onChange:P,class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[29]||(e[29]=l("option",{value:null},"Pilih Supplier",-1)),(d(!0),u(y,null,x(g.suppliers,r=>(d(),u("option",{key:r.id,value:r.id},c(r.name),9,Q))),128))],544),[[v,s(t).supplier_id]]),s(t).supplier_id?V("",!0):a((d(),u("input",{key:0,type:"text","onUpdate:modelValue":e[11]||(e[11]=r=>s(t).supplier=r),placeholder:"Atau masukkan supplier manual",class:"w-full mt-2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512)),[[i,s(t).supplier]])])]),l("div",z,[l("div",null,[e[32]||(e[32]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Outlet",-1)),a(l("select",{"onUpdate:modelValue":e[12]||(e[12]=r=>s(t).current_outlet_id=r),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},[e[31]||(e[31]=l("option",{value:null},"Tidak Terikat Outlet",-1)),(d(!0),u(y,null,x(g.outlets,r=>(d(),u("option",{key:r.id,value:r.id},c(r.name),9,Z))),128))],512),[[v,s(t).current_outlet_id]])]),l("div",null,[e[34]||(e[34]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[m(" Status "),l("span",{class:"text-red-500"},"*")],-1)),a(l("select",{"onUpdate:modelValue":e[13]||(e[13]=r=>s(t).status=r),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},e[33]||(e[33]=[l("option",{value:"Active"},"Active",-1),l("option",{value:"Maintenance"},"Maintenance",-1),l("option",{value:"Disposed"},"Disposed",-1),l("option",{value:"Lost"},"Lost",-1),l("option",{value:"Transfer"},"Transfer",-1)]),512),[[v,s(t).status]])])]),l("div",h,[l("div",null,[e[35]||(e[35]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Useful Life (Tahun)",-1)),a(l("input",{type:"number","onUpdate:modelValue":e[14]||(e[14]=r=>s(t).useful_life=r),min:"1",placeholder:"5",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).useful_life]])]),l("div",null,[e[36]||(e[36]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Warranty Expiry Date",-1)),a(l("input",{type:"date","onUpdate:modelValue":e[15]||(e[15]=r=>s(t).warranty_expiry_date=r),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).warranty_expiry_date]])])]),l("div",null,[e[38]||(e[38]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Photos",-1)),l("input",{type:"file",onChange:M,multiple:"",accept:"image/*",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,32),e[39]||(e[39]=l("p",{class:"text-xs text-gray-500 mt-1"},"Multiple photos allowed (JPG, PNG, max 2MB each)",-1)),w.value.length>0?(d(),u("div",_,[(d(!0),u(y,null,x(w.value,(r,n)=>(d(),u("div",{key:n,class:"relative"},[l("img",{src:r,alt:"Preview",class:"w-full h-24 object-cover rounded-lg"},null,8,ee),l("button",{type:"button",onClick:U=>C(n),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs"},e[37]||(e[37]=[l("i",{class:"fa-solid fa-times"},null,-1)]),8,le)]))),128))])):V("",!0)]),l("div",null,[e[40]||(e[40]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Deskripsi",-1)),a(l("textarea",{"onUpdate:modelValue":e[16]||(e[16]=r=>s(t).description=r),rows:"4",placeholder:"Masukkan deskripsi asset",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"},null,512),[[i,s(t).description]])]),l("div",re,[q(s(X),{href:"/asset-management/assets",class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"},{default:B(()=>e[41]||(e[41]=[m(" Batal ")])),_:1}),l("button",{type:"submit",disabled:s(t).processing,class:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg flex items-center gap-2 disabled:opacity-50"},[s(t).processing?(d(),u("i",se)):V("",!0),l("span",null,c(s(t).processing?"Menyimpan...":"Simpan"),1)],8,te)])],32)])]),_:1}))}};export{fe as default};
