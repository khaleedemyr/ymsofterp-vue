import{r as p,c as _,w as E,A as j,B as o,C as U,D as e,L as n,E as S,H as k,J as w,F as c,M as y,N as l,I as C,l as B}from"./vendor-vue-g7iCcTkf.js";import{A as G}from"./AppLayout-D6FAfGlz.js";import"./vendor-utils-CpgP2uT4.js";import"./app-dzBjFUgD.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CUUHZNnG.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const O={class:"max-w-7xl mx-auto py-8 px-4"},Q={class:"flex flex-col md:flex-row md:items-center gap-4 mb-4"},W={class:"flex items-center gap-2"},H=["value"],z={class:"flex items-center gap-2"},J=["value"],$={class:"flex items-center gap-2"},K=["value"],X={class:"bg-white rounded-xl shadow-lg overflow-x-auto"},Y={class:"min-w-full divide-y divide-gray-200"},Z={class:"bg-white divide-y divide-gray-200"},ee={key:0},te={class:"hover:bg-gray-50 transition"},se={class:"px-6 py-4 whitespace-nowrap text-sm"},ae={class:"px-6 py-4 whitespace-nowrap text-sm"},le={class:"px-6 py-4 whitespace-nowrap text-sm"},re={class:"px-6 py-4 whitespace-nowrap text-sm"},ie={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},ne={class:"px-6 py-4 whitespace-nowrap text-sm text-right"},de={class:"px-6 py-4 whitespace-nowrap text-center"},ue=["onClick"],pe={key:0},ce={colspan:"8",class:"bg-blue-50 px-6 py-4"},me={class:"overflow-x-auto"},xe={class:"min-w-full border text-xs md:text-sm"},ge={class:"border px-2 py-1"},_e={class:"border px-2 py-1"},ye={class:"border px-2 py-1"},be={class:"border px-2 py-1"},ve={class:"border px-2 py-1"},he={class:"border px-2 py-1"},fe={class:"border px-2 py-1 text-right"},ke={class:"border px-2 py-1 text-right"},qe={class:"border px-2 py-1 text-right"},De={class:"font-bold bg-blue-100"},Ne={class:"border px-2 py-1 text-right"},Se={class:"border px-2 py-1 text-right"},Ce={key:0,class:"flex justify-between items-center mt-4"},Ie={class:"text-sm text-gray-600"},Le={class:"flex gap-1"},Te=["disabled"],Ve={class:"px-2"},Be=["disabled"],Oe={__name:"GoodsReceivedReport",props:{receives:Array,warehouses:Array,items:Array},setup(q){const P=q,m=p(""),u=p(25),d=p(1),b=p(""),v=p(""),h=p({});function A(a){let s=Number(a.qty_received_kg||0),t=a.value_in&&s?a.value_in/s:0,i=a.large_unit_name||"-";return a.unit_id&&a.large_unit_id&&a.unit_id!=a.large_unit_id&&(a.unit_id==a.medium_unit_id&&a.medium_conversion_qty>0?(s=Number(a.qty_received||0)*a.medium_conversion_qty,t=a.price/a.medium_conversion_qty):a.unit_id==a.small_unit_id&&a.small_conversion_qty>0&&a.medium_conversion_qty>0&&(s=Number(a.qty_received||0)*a.small_conversion_qty*a.medium_conversion_qty,t=a.price/(a.small_conversion_qty*a.medium_conversion_qty))),{qty:s,price:t,unit:i}}const x=_(()=>{const a={};P.receives.forEach(t=>{const i=[t.date,t.supplier_name,t.item_name,t.large_unit_name].join("|"),{qty:r,price:T,unit:V}=A(t);a[i]||(a[i]={tanggal:t.date,supplier:t.supplier_name,item:t.item_name,unit:V,qty:0,price:0,total:0,details:[]}),a[i].qty+=r,a[i].total+=r*T,a[i].details.push({...t,qty_large:r,price_large:T,large_unit_name:V})}),Object.values(a).forEach(t=>{t.price=t.qty>0?t.total/t.qty:0});let s=Object.values(a);if(b.value&&(s=s.filter(t=>t.details.some(i=>String(i.warehouse_name)===String(b.value)))),v.value&&(s=s.filter(t=>t.item===v.value)),m.value){const t=m.value.toLowerCase();s=s.filter(i=>i.item&&i.item.toLowerCase().includes(t)||i.supplier&&i.supplier.toLowerCase().includes(t))}return s}),f=_(()=>Math.ceil(x.value.length/u.value)||1),D=_(()=>(d.value-1)*u.value),I=_(()=>Math.min(D.value+u.value,x.value.length)),L=_(()=>x.value.slice(D.value,I.value));function F(){d.value>1&&d.value--}function M(){d.value<f.value&&d.value++}E([u,m],()=>{d.value=1});function N(a){return!a||Number(a)===0?"-":Number(a).toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:2})}function g(a){return!a||Number(a)===0?"-":Number(a).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}function R(a){h.value[a]=!h.value[a]}return(a,s)=>(o(),j(G,null,{default:U(()=>[e("div",O,[s[15]||(s[15]=e("h1",{class:"text-2xl font-bold mb-6"},"Laporan Penerimaan Barang (Goods Received Report)",-1)),e("div",Q,[k(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),type:"text",placeholder:"Cari barang, supplier...",class:"px-4 py-2 border border-gray-300 rounded-lg w-full md:w-64 focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,m.value]]),e("div",W,[s[5]||(s[5]=e("label",{class:"text-sm"},"Warehouse",-1)),k(e("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>b.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[s[4]||(s[4]=e("option",{value:""},"Semua Warehouse",-1)),(o(!0),n(c,null,y(q.warehouses,t=>(o(),n("option",{key:t.id,value:t.name},l(t.name),9,H))),128))],512),[[C,b.value]])]),e("div",z,[s[7]||(s[7]=e("label",{class:"text-sm"},"Barang",-1)),k(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>v.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[s[6]||(s[6]=e("option",{value:""},"Semua Barang",-1)),(o(!0),n(c,null,y(q.items,t=>(o(),n("option",{key:t.id,value:t.name},l(t.name),9,J))),128))],512),[[C,v.value]])]),e("div",$,[s[8]||(s[8]=e("label",{class:"text-sm"},"Tampilkan",-1)),k(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>u.value=t),class:"border border-gray-300 rounded-lg px-2 py-2 focus:ring-blue-500 focus:border-blue-500"},[(o(),n(c,null,y([10,25,50,100],t=>e("option",{key:t,value:t},l(t),9,K)),64))],512),[[C,u.value]]),s[9]||(s[9]=e("span",{class:"text-sm"},"data",-1))])]),e("div",X,[e("table",Y,[s[14]||(s[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Tanggal"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Nama Vendor"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Item"),e("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Satuan"),e("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Qty Item"),e("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Price"),e("th",{class:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider"},"Total"),e("th",{class:"px-6 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider"},"Detail")])],-1)),e("tbody",Z,[L.value.length?S("",!0):(o(),n("tr",ee,s[10]||(s[10]=[e("td",{colspan:"8",class:"text-center py-10 text-gray-400"},"Tidak ada data penerimaan barang.",-1)]))),(o(!0),n(c,null,y(L.value,(t,i)=>(o(),n(c,{key:t.tanggal+t.supplier+t.item+t.unit},[e("tr",te,[e("td",se,l(t.tanggal?new Date(t.tanggal).toLocaleDateString("id-ID"):"-"),1),e("td",ae,l(t.supplier),1),e("td",le,l(t.item),1),e("td",re,l(t.unit),1),e("td",ie,l(N(t.qty)),1),e("td",oe,l(g(t.price)),1),e("td",ne,l(g(t.total)),1),e("td",de,[e("button",{onClick:r=>R(i),class:"text-blue-600 hover:underline font-semibold"},l(h.value[i]?"Tutup":"Detail"),9,ue)])]),h.value[i]?(o(),n("tr",pe,[e("td",ce,[e("div",me,[e("table",xe,[s[13]||(s[13]=e("thead",{class:"bg-blue-100"},[e("tr",null,[e("th",{class:"border px-2 py-1"},"Tanggal"),e("th",{class:"border px-2 py-1"},"Nama Vendor"),e("th",{class:"border px-2 py-1"},"No PO"),e("th",{class:"border px-2 py-1"},"No GR"),e("th",{class:"border px-2 py-1"},"Item"),e("th",{class:"border px-2 py-1"},"Satuan"),e("th",{class:"border px-2 py-1"},"Qty Item"),e("th",{class:"border px-2 py-1"},"Price"),e("th",{class:"border px-2 py-1"},"Total")])],-1)),e("tbody",null,[(o(!0),n(c,null,y(t.details,r=>(o(),n("tr",{key:r.date+r.item_name+r.po_number+r.gr_number},[e("td",ge,l(r.date?new Date(r.date).toLocaleDateString("id-ID"):"-"),1),e("td",_e,l(r.supplier_name),1),e("td",ye,l(r.po_number),1),e("td",be,l(r.gr_number),1),e("td",ve,l(r.item_name),1),e("td",he,l(r.large_unit_name),1),e("td",fe,l(N(r.qty_large)),1),e("td",ke,l(g(r.price_large)),1),e("td",qe,l(g(r.qty_large*r.price_large)),1)]))),128))]),e("tfoot",null,[e("tr",De,[s[11]||(s[11]=e("td",{class:"border px-2 py-1 text-right",colspan:"7"},"Total",-1)),e("td",Ne,l(N(t.qty)),1),s[12]||(s[12]=e("td",{class:"border px-2 py-1"},null,-1)),e("td",Se,l(g(t.total)),1)])])])])])])):S("",!0)],64))),128))])])]),x.value.length?(o(),n("div",Ce,[e("div",Ie," Menampilkan "+l(D.value+1)+" - "+l(I.value)+" dari "+l(x.value.length)+" data ",1),e("div",Le,[e("button",{onClick:F,disabled:d.value===1,class:B(["px-3 py-1 rounded border text-sm",d.value===1?"bg-gray-200 text-gray-400":"bg-white text-blue-700 hover:bg-blue-50"])},"<",10,Te),e("span",Ve,"Halaman "+l(d.value)+" / "+l(f.value),1),e("button",{onClick:M,disabled:d.value===f.value,class:B(["px-3 py-1 rounded border text-sm",d.value===f.value?"bg-gray-200 text-gray-400":"bg-white text-blue-700 hover:bg-blue-50"])},">",10,Be)])])):S("",!0)])]),_:1}))}};export{Oe as default};
