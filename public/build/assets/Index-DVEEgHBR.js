import{r as D,c as B,w as V,W as u,A as $,B as o,C as G,D as t,G as n,O as E,H as y,J as v,L as l,N as i,E as p,F as T,M as F,l as S}from"./vendor-vue-g7iCcTkf.js";import{A as I}from"./AppLayout-1Wm1ZPw9.js";import{S as h}from"./app-BPKNzj_F.js";import{l as U}from"./lodash-DB3HVzpp.js";import{a as W}from"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CVHTvH7j.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const P={class:"max-w-7xl mx-auto py-8 px-2"},Y={class:"bg-white rounded-xl shadow-lg p-6 mb-6"},z={class:"flex justify-between items-center mt-4"},J={class:"text-sm text-gray-600"},q={key:0,class:"text-orange-600 font-medium"},K={key:1,class:"text-gray-500"},Q={class:"flex gap-2"},X={class:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4"},Z={class:"flex justify-between items-center"},tt={class:"text-sm text-orange-800"},et={key:0,class:"ml-2 font-medium"},st={key:0,class:"text-xs text-orange-600"},at={class:"bg-white rounded-xl shadow-lg overflow-hidden"},rt={class:"overflow-x-auto"},ot={class:"min-w-full divide-y divide-gray-200"},lt={class:"bg-white divide-y divide-gray-200"},nt={key:0},it={class:"px-6 py-3"},dt={class:"px-6 py-3"},ut={class:"px-6 py-3"},ct={class:"px-6 py-3"},ft={class:"px-6 py-3"},pt={class:"px-6 py-3"},gt={class:"px-6 py-3"},xt=["onClick"],mt=["onClick","disabled"],bt={key:0},yt={key:1},vt={key:1,class:"inline-flex items-center text-xs text-gray-400 ml-2",title:"Hanya admin yang dapat menghapus return"},ht={class:"flex justify-end mt-4 gap-2"},_t=["disabled","onClick","innerHTML"],Rt={__name:"Index",props:{user:Object,returns:Object,filters:Object,canDelete:Boolean},setup(m){var k,w,C;const d=m,g=D(null),r=D({search:((k=d.filters)==null?void 0:k.search)||"",date_from:((w=d.filters)==null?void 0:w.date_from)||"",date_to:((C=d.filters)==null?void 0:C.date_to)||""}),x=B(()=>r.value.search||r.value.date_from||r.value.date_to),_=B(()=>{let a=0;return r.value.search&&a++,r.value.date_from&&a++,r.value.date_to&&a++,a}),j=U.debounce(()=>{b()},500);V(()=>r.value.search,()=>{j()});function b(){const a={};r.value.search&&(a.search=r.value.search),r.value.date_from&&(a.date_from=r.value.date_from),r.value.date_to&&(a.date_to=r.value.date_to),u.get("/outlet-food-return",a,{preserveState:!0,replace:!0})}function H(){r.value={search:"",date_from:"",date_to:""},u.get("/outlet-food-return",{},{preserveState:!0,replace:!0})}function M(){u.visit("/outlet-food-return/create")}function R(a){u.visit(`/outlet-food-return/${a}`)}function N(a){a&&u.visit(a,{preserveState:!0,replace:!0})}function O(a){return{draft:"Draft",approved:"Approved",rejected:"Rejected"}[a]||a}async function A(a){var s,c;if((await h.fire({title:"Hapus Return?",text:`Yakin ingin menghapus return ${a.return_number}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed){g.value=a.id;try{const f=await W.delete(`/outlet-food-return/${a.id}`);f.data&&f.data.message&&(h.fire({icon:"success",title:"Berhasil",text:f.data.message,timer:1500,showConfirmButton:!1}),setTimeout(()=>u.reload(),1200))}catch(f){h.fire({icon:"error",title:"Gagal",text:((c=(s=f.response)==null?void 0:s.data)==null?void 0:c.message)||"Gagal menghapus return"})}finally{g.value=null}}}function L(a){return a?new Date(a).toLocaleDateString("id-ID"):"-"}return(a,e)=>(o(),$(I,null,{default:G(()=>[t("div",P,[t("div",{class:"flex justify-between items-center mb-6"},[e[3]||(e[3]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-undo text-orange-500"}),n(" Outlet Food Return ")],-1)),t("button",{onClick:M,class:"bg-gradient-to-r from-orange-500 to-orange-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Buat Return ")]),t("div",Y,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},[t("i",{class:"fa-solid fa-filter text-orange-500"}),n(" Filter Data ")],-1)),t("form",{onSubmit:E(b,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},[t("div",null,[e[4]||(e[4]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Cari",-1)),y(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>r.value.search=s),placeholder:"No. return, GR, outlet...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"},null,512),[[v,r.value.search]])]),t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Dari",-1)),y(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>r.value.date_from=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"},null,512),[[v,r.value.date_from]])]),t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Sampai",-1)),y(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>r.value.date_to=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"},null,512),[[v,r.value.date_to]])])],32),t("div",z,[t("div",J,[x.value?(o(),l("span",q," Filter aktif: "+i(_.value),1)):(o(),l("span",K," Tidak ada filter aktif "))]),t("div",Q,[x.value?(o(),l("button",{key:0,onClick:H,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 transition-colors"},e[7]||(e[7]=[t("i",{class:"fa-solid fa-times mr-1"},null,-1),n(" Reset Filter ")]))):p("",!0),t("button",{onClick:b,class:"px-4 py-2 text-sm font-medium text-white bg-orange-600 border border-orange-600 rounded-lg hover:bg-orange-700 transition-colors"},e[8]||(e[8]=[t("i",{class:"fa-solid fa-search mr-1"},null,-1),n(" Terapkan Filter ")]))])])]),t("div",X,[t("div",Z,[t("div",tt,[e[10]||(e[10]=t("i",{class:"fa-solid fa-info-circle mr-1"},null,-1)),n(" Menampilkan "+i(d.returns.data.length)+" dari "+i(d.returns.total)+" return ",1),x.value?(o(),l("span",et," (dengan filter aktif) ")):p("",!0)]),x.value?(o(),l("div",st,[e[11]||(e[11]=t("i",{class:"fa-solid fa-filter mr-1"},null,-1)),n(" Filter: "+i(_.value)+" aktif ",1)])):p("",!0)])]),t("div",at,[t("div",rt,[t("table",ot,[e[17]||(e[17]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Tanggal"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"No. Return"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"No. GR"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Outlet"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Warehouse Outlet"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Status"),t("th",{class:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider"},"Aksi")])],-1)),t("tbody",lt,[d.returns.data.length?p("",!0):(o(),l("tr",nt,e[12]||(e[12]=[t("td",{colspan:"7",class:"text-center py-10 text-gray-400"},"Tidak ada data.",-1)]))),(o(!0),l(T,null,F(d.returns.data,s=>(o(),l("tr",{key:s.id},[t("td",it,i(L(s.return_date)),1),t("td",dt,i(s.return_number),1),t("td",ut,i(s.gr_number),1),t("td",ct,i(s.nama_outlet),1),t("td",ft,i(s.warehouse_outlet_name),1),t("td",pt,[t("span",{class:S({"px-2 py-1 text-xs font-semibold rounded-full":!0,"bg-yellow-100 text-yellow-800":s.status==="draft","bg-green-100 text-green-800":s.status==="approved","bg-red-100 text-red-800":s.status==="rejected"})},i(O(s.status)),3)]),t("td",gt,[t("button",{class:"inline-flex items-center btn btn-xs bg-orange-100 text-orange-800 hover:bg-orange-200 rounded px-2 py-1 font-semibold transition",onClick:c=>R(s.id)},e[13]||(e[13]=[t("i",{class:"fa fa-eye mr-1"},null,-1),n(" Detail ")]),8,xt),m.canDelete?(o(),l("button",{key:0,class:"inline-flex items-center btn btn-xs bg-red-100 text-red-700 hover:bg-red-200 rounded px-2 py-1 font-semibold transition ml-2",onClick:c=>A(s),disabled:g.value===s.id,title:"Hapus return"},[g.value===s.id?(o(),l("span",bt,e[14]||(e[14]=[t("i",{class:"fa fa-spinner fa-spin mr-1"},null,-1),n(" Menghapus...")]))):(o(),l("span",yt,e[15]||(e[15]=[t("i",{class:"fa fa-trash mr-1"},null,-1),n(" Hapus")])))],8,mt)):m.canDelete?p("",!0):(o(),l("span",vt,e[16]||(e[16]=[t("i",{class:"fa fa-lock mr-1"},null,-1),n(" Hapus ")])))])]))),128))])])])]),t("div",ht,[(o(!0),l(T,null,F(d.returns.links,s=>(o(),l("button",{key:s.label,disabled:!s.url,onClick:c=>N(s.url),innerHTML:s.label,class:S(["px-3 py-1 rounded-lg border text-sm font-semibold",[s.active?"bg-orange-600 text-white shadow-lg":"bg-white text-orange-700 hover:bg-orange-50",s.url?"cursor-pointer":"opacity-50 cursor-not-allowed"]])},null,10,_t))),128))])])]),_:1}))}};export{Rt as default};
