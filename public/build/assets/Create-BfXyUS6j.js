import{r as b,A as M,B as d,C as T,D as t,G as m,O as V,L as n,E as c,H as g,l as v,F as E,M as G,N as u,I as U,J as y,W as h}from"./vendor-vue-g7iCcTkf.js";import{A as P}from"./AppLayout-BqaX40sL.js";import{S as r}from"./app-BoSIlzLW.js";import"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CY3nv2ep.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const j={class:"max-w-4xl w-full mx-auto py-8 px-2"},A={class:"bg-white rounded-2xl shadow-lg p-6"},S=["disabled"],J=["value"],D={key:0,class:"mt-1 text-sm text-red-600"},O=["disabled"],K={key:0,class:"mt-1 text-sm text-red-600"},N=["disabled"],F={key:0,class:"mt-1 text-sm text-red-600"},I={class:"border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-blue-400 transition"},W=["disabled"],q={class:"text-lg font-medium text-gray-700 mb-2"},z={key:0,class:"mt-1 text-sm text-red-600"},H={class:"border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-blue-400 transition"},L=["disabled"],Y={class:"text-lg font-medium text-gray-700 mb-2"},$={key:0,class:"mt-1 text-sm text-red-600"},Q={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4"},R={class:"text-xs text-red-600"},X={class:"flex justify-end gap-4 pt-6"},Z=["disabled"],ee=["disabled"],te={key:0,class:"fa-solid fa-spinner fa-spin"},le={key:1,class:"fa-solid fa-upload"},ce={__name:"Create",props:{groups:Array},setup(k){const l=b({group_id:"",title:"",description:"",video:null,thumbnail:null}),o=b({}),a=b(!1),f=b(0);function w(s){const e=s.target.files[0];if(e){if(e.size>100*1024*1024){r.fire({title:"Error!",text:"Ukuran file video maksimal 100MB",icon:"error",confirmButtonColor:"#dc2626"}),s.target.value="";return}if(!["video/mp4","video/webm","video/avi","video/mov"].includes(e.type)){r.fire({title:"Error!",text:"Tipe file video tidak didukung. Gunakan MP4, WebM, AVI, atau MOV",icon:"error",confirmButtonColor:"#dc2626"}),s.target.value="";return}l.value.video=e}}function B(s){const e=s.target.files[0];if(e){if(e.size>2*1024*1024){r.fire({title:"Error!",text:"Ukuran file thumbnail maksimal 2MB",icon:"error",confirmButtonColor:"#dc2626"}),s.target.value="";return}if(!["image/jpeg","image/png","image/jpg"].includes(e.type)){r.fire({title:"Error!",text:"Tipe file thumbnail tidak didukung. Gunakan JPEG, PNG, atau JPG",icon:"error",confirmButtonColor:"#dc2626"}),s.target.value="";return}l.value.thumbnail=e}}async function _(){if(o.value={},!l.value.group_id){o.value.group_id="Group harus dipilih";return}if(!l.value.title.trim()){o.value.title="Judul harus diisi";return}if(!l.value.video){o.value.video="File video harus dipilih";return}if(!(await r.fire({title:"Konfirmasi Upload",text:`Apakah Anda yakin ingin mengupload video "${l.value.video.name}"? Proses ini mungkin memakan waktu beberapa menit.`,icon:"question",showCancelButton:!0,confirmButtonColor:"#2563eb",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Upload!",cancelButtonText:"Batal",reverseButtons:!0})).isConfirmed)return;a.value=!0,f.value=0,r.fire({title:"Mengupload Video...",html:`
      <div class="mb-4">
        <div class="w-full bg-gray-200 rounded-full h-2.5">
          <div class="bg-blue-600 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
        </div>
        <p class="mt-2 text-sm text-gray-600">Mohon tunggu, video sedang diproses...</p>
      </div>
    `,allowOutsideClick:!1,allowEscapeKey:!1,showConfirmButton:!1,didOpen:()=>{const i=r.getHtmlContainer().querySelector(".bg-blue-600");r.getHtmlContainer().querySelector("p");let p=0;const C=setInterval(()=>{p+=Math.random()*15,p>90&&(p=90),i.style.width=p+"%",f.value=p,p>=90&&clearInterval(C)},500)}});const e=new FormData;e.append("group_id",l.value.group_id),e.append("title",l.value.title),e.append("description",l.value.description||""),e.append("video",l.value.video),l.value.thumbnail&&e.append("thumbnail",l.value.thumbnail);try{await h.post("/video-tutorials",e,{onSuccess:i=>{a.value=!1,f.value=100,r.close(),r.fire({title:"Berhasil!",text:"Video tutorial berhasil diupload",icon:"success",confirmButtonColor:"#16a34a",timer:2e3,showConfirmButton:!1})},onError:i=>{a.value=!1,o.value=i,r.close(),r.fire({title:"Error!",text:"Terjadi kesalahan saat mengupload video",icon:"error",confirmButtonColor:"#dc2626"}),console.error("Upload error:",i)},onFinish:()=>{a.value=!1,r.close()}})}catch(i){a.value=!1,console.error("Unexpected error:",i),r.close(),r.fire({title:"Error!",text:"Terjadi kesalahan yang tidak terduga",icon:"error",confirmButtonColor:"#dc2626"})}}function x(){r.fire({title:"Konfirmasi",text:"Apakah Anda yakin ingin keluar? Data yang belum disimpan akan hilang.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc2626",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Keluar",cancelButtonText:"Batal"}).then(s=>{s.isConfirmed&&h.visit("/video-tutorials")})}return(s,e)=>(d(),M(P,{title:"Upload Video Tutorial"},{default:T(()=>[t("div",j,[t("div",{class:"flex justify-between items-center mb-6"},[e[4]||(e[4]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-upload text-blue-500"}),m(" Upload Video Tutorial ")],-1)),t("button",{onClick:x,class:"bg-gray-500 text-white px-4 py-2 rounded-xl hover:bg-gray-600 transition"},e[3]||(e[3]=[t("i",{class:"fa-solid fa-arrow-left mr-2"},null,-1),m(" Kembali ")]))]),t("div",A,[t("form",{onSubmit:V(_,["prevent"]),class:"space-y-6"},[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[m(" Group Video Tutorial "),t("span",{class:"text-red-500"},"*")],-1)),g(t("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>l.value.group_id=i),class:v(["w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",{"border-red-500":o.value.group_id}]),disabled:a.value},[e[5]||(e[5]=t("option",{value:""},"Pilih Group",-1)),(d(!0),n(E,null,G(k.groups,i=>(d(),n("option",{key:i.id,value:i.id},u(i.name),9,J))),128))],10,S),[[U,l.value.group_id]]),o.value.group_id?(d(),n("p",D,u(o.value.group_id),1)):c("",!0)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[m(" Judul Video "),t("span",{class:"text-red-500"},"*")],-1)),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>l.value.title=i),type:"text",class:v(["w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",{"border-red-500":o.value.title}]),placeholder:"Masukkan judul video tutorial",disabled:a.value},null,10,O),[[y,l.value.title]]),o.value.title?(d(),n("p",K,u(o.value.title),1)):c("",!0)]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Deskripsi ",-1)),g(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=i=>l.value.description=i),rows:"4",class:v(["w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition",{"border-red-500":o.value.description}]),placeholder:"Masukkan deskripsi video tutorial (opsional)",disabled:a.value},null,10,N),[[y,l.value.description]]),o.value.description?(d(),n("p",F,u(o.value.description),1)):c("",!0)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[m(" File Video "),t("span",{class:"text-red-500"},"*")],-1)),t("div",I,[t("input",{type:"file",onChange:w,accept:"video/mp4,video/webm,video/avi,video/mov",class:"hidden",id:"video-upload",disabled:a.value},null,40,W),t("label",{for:"video-upload",class:v(["cursor-pointer",{"opacity-50 cursor-not-allowed":a.value}])},[e[9]||(e[9]=t("i",{class:"fa-solid fa-cloud-upload-alt text-4xl text-gray-400 mb-4"},null,-1)),t("p",q,u(l.value.video?l.value.video.name:"Klik untuk memilih file video"),1),e[10]||(e[10]=t("p",{class:"text-sm text-gray-500"}," MP4, WebM, AVI, atau MOV (maksimal 100MB) ",-1))],2)]),o.value.video?(d(),n("p",z,u(o.value.video),1)):c("",!0)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Thumbnail (Opsional) ",-1)),t("div",H,[t("input",{type:"file",onChange:B,accept:"image/jpeg,image/png,image/jpg",class:"hidden",id:"thumbnail-upload",disabled:a.value},null,40,L),t("label",{for:"thumbnail-upload",class:v(["cursor-pointer",{"opacity-50 cursor-not-allowed":a.value}])},[e[12]||(e[12]=t("i",{class:"fa-solid fa-image text-4xl text-gray-400 mb-4"},null,-1)),t("p",Y,u(l.value.thumbnail?l.value.thumbnail.name:"Klik untuk memilih thumbnail"),1),e[13]||(e[13]=t("p",{class:"text-sm text-gray-500"}," JPEG, PNG, atau JPG (maksimal 2MB). Jika tidak dipilih, thumbnail akan dibuat otomatis dari video. ",-1))],2)]),o.value.thumbnail?(d(),n("p",$,u(o.value.thumbnail),1)):c("",!0)]),Object.keys(o.value).length>0?(d(),n("div",Q,[e[15]||(e[15]=t("h3",{class:"text-sm font-medium text-red-800 mb-2"},"Debug Info:",-1)),t("pre",R,u(JSON.stringify(o.value,null,2)),1)])):c("",!0),t("div",X,[t("button",{type:"button",onClick:x,disabled:a.value,class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed"}," Batal ",8,Z),t("button",{type:"submit",disabled:a.value||!l.value.group_id||!l.value.title.trim()||!l.value.video,class:"px-6 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"},[a.value?(d(),n("i",te)):(d(),n("i",le)),m(" "+u(a.value?"Mengupload...":"Upload Video"),1)],8,ee)])],32)])])]),_:1}))}};export{ce as default};
