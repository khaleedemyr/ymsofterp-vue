import{P as O,r as v,w as U,L as r,E as n,B as i,D as s,N as m,O as T,H as g,J as w,Q as o,I as E,x as h,C as F,l as _,a6 as V,F as N,M as P,G as I}from"./vendor-vue-g7iCcTkf.js";import{S}from"./app-BGYKUG_N.js";import{s as M}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as A}from"./vendor-ui-CrPgGUUb.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";const D={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 transition-all"},z={class:"bg-white rounded-2xl shadow-2xl w-full max-w-md mx-auto p-0 animate-fade-in"},K={class:"px-8 pt-8 pb-2"},L={class:"flex items-center gap-2 mb-6"},G={class:"text-2xl font-bold text-gray-900"},H={key:0,class:"text-xs text-red-500 mt-1"},q={key:0,class:"text-xs text-red-500 mt-1"},J={key:0,class:"text-xs text-red-500 mt-1"},Q={class:"flex gap-4"},Y={class:"flex-1"},W={key:0,class:"text-xs text-red-500 mt-1"},X={class:"flex-1"},Z={class:"ml-2 text-gray-700"},$={key:0,class:"text-xs text-red-500 mt-1"},ee={key:0,class:"mt-4"},te={class:"flex gap-4 mb-2"},se={class:"inline-flex items-center"},oe={class:"inline-flex items-center"},le={key:0},ae={key:1},re={key:2,class:"flex flex-wrap gap-2 mt-2"},ie={class:"bg-gray-50 px-6 py-4 flex justify-end rounded-b-2xl"},ne=["disabled"],de={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ue={__name:"CategoryFormModal",props:{show:Boolean,mode:String,category:Object,regions:Array,outlets:Array},emits:["close","success"],setup(f,{emit:B}){const a=f,x=B,t=O({code:"",name:"",description:"",status:"active",show_pos:"1",outlet_ids:[]}),d=v("byRegion"),p=v([]),b=v([]);U(()=>a.show,u=>{if(u&&a.mode==="edit"&&a.category){t.code=a.category.code,t.name=a.category.name,t.description=a.category.description,t.status=a.category.status,t.show_pos=String(a.category.show_pos);const e=a.category.outlet_ids?a.outlets.filter(y=>a.category.outlet_ids.map(String).includes(String(y.id))):[];b.value=e;const l=[...new Set(e.map(y=>y.region_id))];p.value=a.regions.filter(y=>l.includes(y.id)),d.value=e.length>0?"byOutlet":"byRegion"}else u&&a.mode==="create"&&(t.code="",t.name="",t.description="",t.status="active",t.show_pos="1",p.value=[],b.value=[],d.value="byRegion")});const c=v(!1);async function k(){console.log("SUBMIT TERPANGGIL",{selectedRegions:p.value,availabilityType:d.value});let u=[];t.show_pos==="1"&&(d.value==="byRegion"?u=a.outlets.filter(e=>p.value.map(l=>l.id).includes(e.region_id)).map(e=>e.id):u=b.value.map(e=>e.id)),t.outlet_ids=u,console.log("submit form:",{...t}),c.value=!0,a.mode==="create"?t.post(route("categories.store"),{forceFormData:!0,onSuccess:()=>{S.fire("Berhasil","Kategori berhasil ditambahkan!","success"),x("success"),x("close")},onError:e=>{console.error("Error creating category:",e),c.value=!1},onFinish:()=>c.value=!1}):a.mode==="edit"&&a.category&&(t._method="PUT",t.post(route("categories.update",a.category.id),{forceFormData:!0,onSuccess:()=>{S.fire("Berhasil","Kategori berhasil diupdate!","success"),x("success"),x("close")},onError:e=>{console.error("Error updating category:",e),c.value=!1},onFinish:()=>c.value=!1}))}function C(){x("close")}function R(u){return u.name||u.nama_outlet||"-"}return(u,e)=>f.show?(i(),r("div",D,[s("div",z,[s("div",K,[s("div",L,[e[10]||(e[10]=s("svg",{class:"w-7 h-7 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{d:"M16 7a4 4 0 01-8 0","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M12 3v4m0 0a4 4 0 01-4 4H4m8-4a4 4 0 014 4h4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),s("h3",G,m(f.mode==="edit"?"Edit":"Tambah")+" Kategori",1)]),s("form",{onSubmit:T(k,["prevent"]),class:"space-y-5"},[s("div",null,[e[11]||(e[11]=s("label",{class:"block text-sm font-medium text-gray-700"},"Kode",-1)),g(s("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o(t).code=l),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:"",maxlength:"50"},null,512),[[w,o(t).code]]),o(t).errors.code?(i(),r("div",H,m(o(t).errors.code),1)):n("",!0)]),s("div",null,[e[12]||(e[12]=s("label",{class:"block text-sm font-medium text-gray-700"},"Nama",-1)),g(s("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>o(t).name=l),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500",required:"",maxlength:"100"},null,512),[[w,o(t).name]]),o(t).errors.name?(i(),r("div",q,m(o(t).errors.name),1)):n("",!0)]),s("div",null,[e[13]||(e[13]=s("label",{class:"block text-sm font-medium text-gray-700"},"Deskripsi",-1)),g(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>o(t).description=l),rows:"2",class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},null,512),[[w,o(t).description]]),o(t).errors.description?(i(),r("div",J,m(o(t).errors.description),1)):n("",!0)]),s("div",Q,[s("div",Y,[e[15]||(e[15]=s("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),g(s("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>o(t).status=l),class:"mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:ring-blue-500 focus:border-blue-500"},e[14]||(e[14]=[s("option",{value:"active"},"Active",-1),s("option",{value:"inactive"},"Inactive",-1)]),512),[[E,o(t).status]]),o(t).errors.status?(i(),r("div",W,m(o(t).errors.status),1)):n("",!0)]),s("div",X,[e[16]||(e[16]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Show POS",-1)),h(o(A),{modelValue:o(t).show_pos,"onUpdate:modelValue":[e[4]||(e[4]=l=>o(t).show_pos=l),e[5]||(e[5]=l=>o(t).show_pos=l?"1":"0")],class:_([o(t).show_pos==="1"?"bg-blue-600":"bg-gray-200","relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none"]),checked:o(t).show_pos==="1"},{default:F(()=>[s("span",{class:_([o(t).show_pos==="1"?"translate-x-6":"translate-x-1","inline-block h-4 w-4 transform rounded-full bg-white transition"])},null,2)]),_:1},8,["modelValue","class","checked"]),s("span",Z,m(o(t).show_pos==="1"?"Yes":"No"),1),o(t).errors.show_pos?(i(),r("div",$,m(o(t).errors.show_pos),1)):n("",!0)])]),o(t).show_pos==="1"?(i(),r("div",ee,[e[21]||(e[21]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category Availability",-1)),s("div",te,[s("label",se,[g(s("input",{type:"radio",value:"byRegion","onUpdate:modelValue":e[6]||(e[6]=l=>d.value=l),class:"form-radio text-blue-600"},null,512),[[V,d.value]]),e[17]||(e[17]=s("span",{class:"ml-2"},"By Region",-1))]),s("label",oe,[g(s("input",{type:"radio",value:"byOutlet","onUpdate:modelValue":e[7]||(e[7]=l=>d.value=l),class:"form-radio text-blue-600"},null,512),[[V,d.value]]),e[18]||(e[18]=s("span",{class:"ml-2"},"By Outlet",-1))])]),d.value==="byRegion"?(i(),r("div",le,[e[19]||(e[19]=s("label",{class:"block text-xs text-gray-500 mb-1"},"Pilih Region",-1)),h(o(M),{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=l=>p.value=l),options:a.regions,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"name","track-by":"id",placeholder:"Pilih Region",class:"mb-2"},null,8,["modelValue","options"])])):n("",!0),d.value==="byOutlet"?(i(),r("div",ae,[e[20]||(e[20]=s("label",{class:"block text-xs text-gray-500 mb-1"},"Pilih Outlet",-1)),h(o(M),{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=l=>b.value=l),options:a.outlets,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,"custom-label":R,"track-by":"id",placeholder:"Pilih Outlet",class:"mb-2"},null,8,["modelValue","options"])])):n("",!0),b.value.length?(i(),r("div",re,[(i(!0),r(N,null,P(b.value,l=>(i(),r("span",{key:l.id,class:"inline-flex items-center bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-semibold"},m(l.name||l.nama_outlet),1))),128))])):n("",!0)])):n("",!0)],32)]),s("div",ie,[s("button",{type:"button",onClick:C,class:"inline-flex items-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition sm:w-auto sm:text-sm mr-2"}," Batal "),s("button",{type:"button",onClick:k,disabled:c.value,class:"inline-flex items-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[c.value?(i(),r("svg",de,e[22]||(e[22]=[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):n("",!0),I(" "+m(c.value?f.mode==="edit"?"Menyimpan...":"Menambah...":f.mode==="edit"?"Simpan":"Tambah"),1)],8,ne)])])])):n("",!0)}},ve=j(ue,[["__scopeId","data-v-eab8d3d2"]]);export{ve as default};
