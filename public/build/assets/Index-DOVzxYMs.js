import{r as p,w as I,L as r,E as C,B as i,D as e,N as m,F as A,M as T,x as w,H as P,I as z,V as L,G as g,W as B,c as N,A as H,C as $,J as W,Q as M,S as j,Y as F,l as K}from"./vendor-vue-g7iCcTkf.js";import{A as q}from"./AppLayout-hxs5t3XP.js";import{U as G}from"./UserSearchDropdown-hwY_4x37.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./app-D6rf3j_5.js";import"./vendor-charts-CuqD4wLC.js";import"./ProfileUpdateModal-D4k-zQf5.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const Q={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Y={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},O={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"},R={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},X={class:"flex items-center justify-between mb-6"},Z={class:"text-sm text-gray-500"},ee={class:"space-y-6"},se={key:0,class:"space-y-2"},te={class:"flex-1"},oe={class:"font-medium text-gray-900"},le={class:"text-sm text-gray-500"},ae={class:"flex items-center gap-3"},ie=["value","onChange"],re=["onClick"],ne={key:1,class:"text-center py-4 text-gray-500"},de={class:"space-y-4"},ue={class:"relative"},me={key:0,class:"p-3 bg-blue-50 rounded-lg border border-blue-200"},ce={class:"flex items-center justify-between"},fe={class:"font-medium text-gray-900"},pe={class:"text-sm text-gray-500"},xe={class:"flex items-center gap-3"},be={class:"flex items-center p-4 bg-yellow-50 rounded-lg border border-yellow-200"},ge={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},ve=["disabled"],he={key:0,class:"fas fa-spinner fa-spin mr-2"},ye={key:1,class:"fas fa-save mr-2"},we={__name:"DocumentPermissionModal",props:{show:{type:Boolean,default:!1},documentId:{type:[String,Number],required:!0},documentTitle:{type:String,default:""}},emits:["close","saved"],setup(y,{emit:k}){const c=y,x=k,n=p([]),d=p(null),b=p("view"),v=p(!1),h=p(!1);I(()=>c.show,o=>{o&&D()});const D=async()=>{try{const s=await(await fetch(`/shared-documents/${c.documentId}/permissions`)).json();s.success&&(n.value=s.data,v.value=s.is_public||!1)}catch(o){console.error("Error loading permissions:",o)}},S=(o,s)=>{const a=n.value.find(f=>f.id===o);a&&(a.permission=s)},U=o=>{n.value=n.value.filter(s=>s.id!==o)},V=o=>{if(n.value.find(a=>a.user_id===o.id)){alert("User ini sudah memiliki akses ke dokumen");return}d.value=o},_=()=>{d.value=null,b.value="view"},l=()=>{if(!d.value)return;const o={id:"temp_"+Date.now(),user_id:d.value.id,user:d.value,permission:b.value};n.value.push(o),_()},t=async()=>{h.value=!0;try{const o=n.value.map(s=>({user_id:s.user_id,permission:s.permission}));await B.post(`/shared-documents/${c.documentId}/permissions`,{permissions:o,is_public:v.value},{onSuccess:()=>{x("saved"),u()}})}catch(o){console.error("Error saving permissions:",o)}finally{h.value=!1}},u=()=>{x("close")};return(o,s)=>y.show?(i(),r("div",Q,[e("div",Y,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:u}),e("div",O,[e("div",R,[e("div",X,[e("div",null,[s[2]||(s[2]=e("h3",{class:"text-lg font-medium text-gray-900"},"Kelola Permission Dokumen",-1)),e("p",Z,m(y.documentTitle),1)]),e("button",{onClick:u,class:"text-gray-400 hover:text-gray-600"},s[3]||(s[3]=[e("i",{class:"fas fa-times text-xl"},null,-1)]))]),e("div",ee,[e("div",null,[s[6]||(s[6]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"User dengan Akses",-1)),n.value.length>0?(i(),r("div",se,[(i(!0),r(A,null,T(n.value,a=>(i(),r("div",{key:a.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border"},[e("div",te,[e("div",oe,m(a.user.nama_lengkap),1),e("div",le,m(a.user.email),1)]),e("div",ae,[e("select",{value:a.permission,onChange:f=>S(a.id,f.target.value),class:"px-3 py-1 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},s[4]||(s[4]=[e("option",{value:"view"},"View",-1),e("option",{value:"edit"},"Edit",-1),e("option",{value:"admin"},"Admin",-1)]),40,ie),e("button",{onClick:f=>U(a.id),class:"text-red-500 hover:text-red-700 p-1"},s[5]||(s[5]=[e("i",{class:"fas fa-trash text-sm"},null,-1)]),8,re)])]))),128))])):(i(),r("div",ne," Belum ada user yang memiliki akses khusus "))]),e("div",null,[s[9]||(s[9]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Tambah User Baru",-1)),e("div",de,[e("div",ue,[w(G,{placeholder:"Cari user untuk ditambahkan...","selected-users":[],multiple:!1,onUserSelected:V})]),d.value?(i(),r("div",me,[e("div",ce,[e("div",null,[e("div",fe,m(d.value.nama_lengkap),1),e("div",pe,m(d.value.email),1)]),e("div",xe,[P(e("select",{"onUpdate:modelValue":s[0]||(s[0]=a=>b.value=a),class:"px-3 py-1 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},s[7]||(s[7]=[e("option",{value:"view"},"View",-1),e("option",{value:"edit"},"Edit",-1),e("option",{value:"admin"},"Admin",-1)]),512),[[z,b.value]]),e("button",{onClick:l,class:"px-3 py-1 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700"}," Tambah "),e("button",{onClick:_,class:"text-gray-500 hover:text-gray-700"},s[8]||(s[8]=[e("i",{class:"fas fa-times"},null,-1)]))])])])):C("",!0)])]),e("div",be,[P(e("input",{id:"is_public","onUpdate:modelValue":s[1]||(s[1]=a=>v.value=a),type:"checkbox",class:"h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300 rounded"},null,512),[[L,v.value]]),s[10]||(s[10]=e("label",{for:"is_public",class:"ml-2 block text-sm text-gray-900"},[e("span",{class:"font-medium"},"Dokumen Publik"),e("span",{class:"block text-xs text-gray-600"},"Semua user dapat mengakses dokumen ini")],-1))])])]),e("div",ge,[e("button",{onClick:t,disabled:h.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},[h.value?(i(),r("i",he)):(i(),r("i",ye)),s[11]||(s[11]=g(" Simpan Permission "))],8,ve),e("button",{onClick:u,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Batal ")])])])])):C("",!0)}},ke={class:"space-y-6"},_e={class:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-xl border border-white/20 p-6 animate-fade-in-up animation-delay-200"},$e={class:"flex flex-col md:flex-row gap-4"},Ce={class:"flex-1 relative group"},Pe={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 animate-fade-in-up animation-delay-400"},De={class:"p-6"},Se={class:"flex items-center mb-6"},Ue={class:"relative"},Ve={class:"w-8 h-8 text-white relative z-10",fill:"currentColor",viewBox:"0 0 20 20"},Me={key:0,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},je={key:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},Be={key:2,d:"M7 4V2a1 1 0 011-1h4a1 1 0 011 1v2h4a1 1 0 011 1v14a1 1 0 01-1 1H3a1 1 0 01-1-1V5a1 1 0 011-1h4z"},Ae={class:"flex-1"},Te={class:"text-lg font-semibold text-gray-900 truncate group-hover:text-blue-600 transition-colors"},ze={class:"text-sm text-gray-500"},Ee={class:"space-y-3 mb-6"},Ie={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-2 backdrop-blur-sm"},Le={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-2 backdrop-blur-sm"},Ne={class:"flex items-center text-sm text-gray-600 bg-white/30 rounded-lg p-2 backdrop-blur-sm"},He={class:"flex gap-2"},We=["onClick"],Fe=["onClick"],Ke={key:1,class:"text-center py-16 animate-fade-in-up animation-delay-600"},qe={class:"bg-white/80 backdrop-blur-xl rounded-2xl shadow-xl border border-white/20 p-12"},Ge={__name:"Index",props:{documents:{type:Array,required:!0}},setup(y){const k=y,c=p(""),x=p(""),n=p(!1),d=p(null),b=N(()=>{let l=k.documents;return c.value&&(l=l.filter(t=>t.title.toLowerCase().includes(c.value.toLowerCase())||t.filename.toLowerCase().includes(c.value.toLowerCase()))),x.value&&(l=l.filter(t=>t.file_type===x.value)),l}),v=l=>({xlsx:"bg-green-500",xls:"bg-green-500",docx:"bg-blue-500",doc:"bg-blue-500",pptx:"bg-orange-500",ppt:"bg-orange-500"})[l]||"bg-gray-500",h=l=>new Date(l).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}),D=l=>{confirm("Apakah Anda yakin ingin menghapus dokumen ini?")&&B.delete(route("shared-documents.destroy",l))},S=l=>{var o,s,a,f;const t=(a=(s=(o=k.$page)==null?void 0:o.props)==null?void 0:s.auth)==null?void 0:a.user;if(!t)return!1;if(l.created_by===t.id)return!0;const u=(f=l.permissions)==null?void 0:f.find(E=>E.user_id===t.id);return(u==null?void 0:u.permission)==="admin"},U=l=>{d.value=l,n.value=!0},V=()=>{n.value=!1,d.value=null},_=()=>{B.reload()};return(l,t)=>(i(),H(q,null,{default:$(()=>{var u,o;return[e("div",ke,[t[16]||(t[16]=e("div",{class:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 p-8 text-white shadow-2xl"},[e("div",{class:"absolute inset-0 bg-black/10"}),e("div",{class:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16 blur-2xl"}),e("div",{class:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full translate-y-12 -translate-x-12 blur-xl"}),e("div",{class:"relative z-10"},[e("div",{class:"flex items-center justify-between"},[e("div",null,[e("h1",{class:"text-4xl font-bold mb-2 animate-fade-in-up"},"Dokumen Bersama"),e("p",{class:"text-blue-100 text-lg"},"Kelola dan bagikan dokumen Excel, Word, dan PowerPoint secara real-time")]),e("div",{class:"hidden md:block"},[e("div",{class:"w-20 h-20 bg-white/20 rounded-2xl backdrop-blur-sm flex items-center justify-center"},[e("i",{class:"fas fa-file-alt text-3xl text-white"})])])])])],-1)),e("div",_e,[e("div",$e,[e("div",Ce,[t[2]||(t[2]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("i",{class:"fas fa-search text-gray-400 group-focus-within:text-blue-500 transition-colors"})],-1)),P(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),type:"text",placeholder:"Cari dokumen...",class:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 bg-white/50 backdrop-blur-sm"},null,512),[[W,c.value]])]),P(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>x.value=s),class:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300 bg-white/50 backdrop-blur-sm"},t[3]||(t[3]=[e("option",{value:""},"Semua Tipe",-1),e("option",{value:"xlsx"},"Excel",-1),e("option",{value:"docx"},"Word",-1),e("option",{value:"pptx"},"PowerPoint",-1)]),512),[[z,x.value]]),w(M(j),{href:l.route("shared-documents.create"),class:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300"},{default:$(()=>t[4]||(t[4]=[e("i",{class:"fas fa-plus mr-2"},null,-1),g(" Upload Dokumen ")])),_:1},8,["href"])])]),b.value.length>0?(i(),r("div",Pe,[(i(!0),r(A,null,T(b.value,(s,a)=>(i(),r("div",{key:s.id,class:"group bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg hover:shadow-2xl border border-white/20 overflow-hidden transform hover:-translate-y-2 transition-all duration-500 animate-fade-in-up",style:F({animationDelay:`${a*100}ms`})},[e("div",De,[e("div",Se,[e("div",Ue,[e("div",{class:K(["w-16 h-16 rounded-2xl flex items-center justify-center mr-4 shadow-lg transform group-hover:scale-110 transition-transform duration-300",v(s.file_type)])},[t[5]||(t[5]=e("div",{class:"absolute inset-0 bg-white/20 rounded-2xl blur-sm"},null,-1)),(i(),r("svg",Ve,[s.file_type==="xlsx"||s.file_type==="xls"?(i(),r("path",Me)):s.file_type==="docx"||s.file_type==="doc"?(i(),r("path",je)):(i(),r("path",Be))]))],2)]),e("div",Ae,[e("h4",Te,m(s.title),1),e("p",ze,m(s.filename),1)])]),e("div",Ee,[e("div",Ie,[t[6]||(t[6]=e("i",{class:"fas fa-user mr-2 text-blue-500"},null,-1)),g(" "+m(s.creator.name),1)]),e("div",Le,[t[7]||(t[7]=e("i",{class:"fas fa-calendar mr-2 text-green-500"},null,-1)),g(" "+m(h(s.created_at)),1)]),e("div",Ne,[t[8]||(t[8]=e("i",{class:"fas fa-users mr-2 text-purple-500"},null,-1)),g(" "+m(s.permissions.length)+" user"+m(s.permissions.length!==1?"s":""),1)])]),e("div",He,[w(M(j),{href:l.route("shared-documents.show",s.id),class:"flex-1 inline-flex items-center justify-center px-3 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-medium rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 text-sm"},{default:$(()=>t[9]||(t[9]=[e("i",{class:"fas fa-eye mr-1"},null,-1),g(" Buka ")])),_:2},1032,["href"]),S(s)?(i(),r("button",{key:0,onClick:f=>U(s),class:"px-3 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 text-sm",title:"Kelola Permission"},t[10]||(t[10]=[e("i",{class:"fas fa-users"},null,-1)]),8,We)):C("",!0),s.created_by===l.$page.props.auth.user.id?(i(),r("button",{key:1,onClick:f=>D(s.id),class:"px-3 py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 text-sm",title:"Hapus Dokumen"},t[11]||(t[11]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Fe)):C("",!0)])])],4))),128))])):(i(),r("div",Ke,[e("div",qe,[t[13]||(t[13]=e("div",{class:"w-24 h-24 mx-auto mb-6 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl flex items-center justify-center shadow-lg"},[e("i",{class:"fas fa-file-alt text-3xl text-blue-500"})],-1)),t[14]||(t[14]=e("h3",{class:"text-2xl font-bold text-gray-900 mb-2"},"Tidak ada dokumen",-1)),t[15]||(t[15]=e("p",{class:"text-gray-600 mb-8"},"Mulai dengan mengupload dokumen pertama Anda.",-1)),w(M(j),{href:l.route("shared-documents.create"),class:"inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300"},{default:$(()=>t[12]||(t[12]=[e("i",{class:"fas fa-plus mr-2"},null,-1),g(" Upload Dokumen ")])),_:1},8,["href"])])]))]),w(we,{show:n.value,"document-id":(u=d.value)==null?void 0:u.id,"document-title":(o=d.value)==null?void 0:o.title,onClose:V,onSaved:_},null,8,["show","document-id","document-title"])]}),_:1}))}},ls=J(Ge,[["__scopeId","data-v-f1947542"]]);export{ls as default};
