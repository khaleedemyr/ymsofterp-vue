import{r as v,c as C,w as E,a as Ce,j as Pe,A as ie,B as l,C as je,D as e,L as n,E as d,G as c,N as r,O as De,F as P,M as j,H as D,l as y,I as z,a6 as W,J as Fe,W as $}from"./vendor-vue-g7iCcTkf.js";import{A as Ue}from"./AppLayout-DuOTY_8o.js";import Ae from"./LightboxModal-C05wjdKL.js";import{S as F}from"./app-BjOxw_aQ.js";import"./vendor-utils-CpgP2uT4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-B2Hc20Ep.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const Be={class:"w-full py-8 px-4"},Se={class:"max-w-4xl mx-auto"},Ee={class:"bg-white rounded-2xl shadow-lg p-6 mb-8"},$e={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ne={class:"text-gray-800 font-semibold"},Te={class:"text-gray-800 font-semibold"},Le={class:"text-gray-800 font-semibold"},Me={class:"bg-white rounded-2xl shadow-lg p-8"},Ve={class:"flex gap-2 mb-3"},Oe={key:0,class:"space-y-4"},Re={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Ye={class:"border-2 border-dashed border-gray-300 rounded-lg p-2"},qe=["src","alt","onClick"],Ke=["onClick"],ze={class:"text-center text-sm text-gray-600"},We={key:1,class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center text-gray-500"},Ge={key:2,class:"mt-1 text-sm text-red-600"},He=["value"],Je={key:0,class:"mt-1 text-sm text-red-600"},Ie={key:0},Qe=["value"],Xe={key:0,class:"mt-1 text-sm text-red-600"},Ze={key:1},et=["value"],tt={key:0,class:"mt-1 text-sm text-red-600"},st={key:2,class:"bg-green-50 border border-green-200 rounded-xl p-4"},at={class:"flex items-center justify-between"},ot={class:"text-sm text-green-700"},lt={class:"text-right"},nt={class:"text-2xl font-bold text-green-800"},rt={key:3,class:"bg-blue-50 border border-blue-200 rounded-xl p-4"},it={class:"mb-4"},dt={class:"text-sm text-blue-700 mb-4"},ut={class:"grid grid-cols-3 gap-3"},ct={class:"text-center"},mt={class:"text-xs text-green-600"},gt={class:"text-center"},pt={class:"text-xs text-red-600"},vt={key:0,class:"flex items-center justify-between"},ft={class:"text-sm text-blue-700"},bt={class:"text-right"},xt={key:0,class:"mt-1 text-sm text-red-600"},yt={class:"flex items-center justify-end gap-4 pt-6 border-t border-gray-200"},_t=["disabled"],ht={key:0,class:"fa-solid fa-spinner fa-spin mr-2"},kt={key:1,class:"fa-solid fa-save mr-2"},wt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/60"},Ct={class:"bg-white w-full h-full sm:h-auto sm:max-h-[90vh] sm:max-w-xl sm:rounded-2xl shadow-2xl relative flex flex-col"},Pt={class:"flex-1 flex flex-col min-h-0 p-4"},jt={class:"relative bg-black rounded-lg overflow-hidden mb-4 flex-1 min-h-0"},Dt={key:2,class:"mt-8"},Ft={class:"bg-white rounded-2xl shadow-lg p-6"},Ut={class:"grid gap-4"},At={class:"flex items-center justify-between"},Bt={class:"flex-1"},St={class:"flex items-center gap-3 mb-2"},Et={class:"font-semibold text-gray-800"},$t={key:0,class:"text-blue-600 text-sm"},Nt={class:"flex items-center gap-4 text-sm text-gray-600"},Tt={class:"flex items-center gap-2"},Lt={class:"flex items-center gap-2"},Mt=["onClick"],Vt=["src","alt"],Ot={key:1,class:"w-6 h-6 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold"},Rt={class:"text-sm font-medium"},Yt={class:"flex items-center gap-1"},qt={class:"flex items-center gap-1"},Kt={class:"flex items-center gap-1"},zt={key:0,class:"mt-3 pt-3 border-t border-gray-200"},Wt={class:"space-y-2"},Gt={class:"flex items-center justify-between mb-2"},Ht={class:"flex items-center gap-2"},Jt={class:"text-sm font-medium text-gray-800"},It={class:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},Qt={class:"flex items-center gap-2"},Xt={class:"text-xs text-gray-500"},Zt={class:"flex items-center gap-1"},es=["onClick"],ts=["onClick"],ss={class:"flex items-center gap-2 mb-2"},as={class:"flex items-center gap-2"},os=["onClick"],ls=["src","alt"],ns={key:1,class:"w-5 h-5 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold"},rs={class:"text-xs font-medium text-gray-700"},is={class:"text-sm text-gray-600"},ds={class:"mb-1"},us={class:"mb-1"},cs={key:0,class:"mb-1"},ms={key:1,class:"mt-2"},gs={class:"flex gap-2 mt-1"},ps=["src","alt","onClick"],vs={class:"flex items-center gap-2"},fs=["onClick"],bs={key:1,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-lg text-sm font-semibold"},As={__name:"AddFinding",props:{inspection:Object,guidance:Object,categories:Array,parameters:Array,existingInspections:Array},setup(g){const k=g,a=v({category_id:"",parameter_pemeriksaan:"",parameter_id:"",point:0,cleanliness_rating:"",photos:[],notes:""}),m=v({}),U=v(!1),N=v(!1),A=v(!1),O=v(null),T=v(0),L=v([]),f=v([]),de=C(()=>k.inspection.inspection_mode||"product"),R=C(()=>de.value==="cleanliness");C(()=>k.categories.find(s=>s.id==a.value.category_id));const Y=C(()=>{var t;if(!a.value.category_id||!k.guidance)return[];const s=(t=k.guidance.guidance_categories)==null?void 0:t.find(u=>u.category_id==a.value.category_id);return s?s.parameters||[]:[]}),G=C(()=>a.value.parameter_pemeriksaan?Y.value.find(s=>s.parameter_pemeriksaan===a.value.parameter_pemeriksaan):null),q=C(()=>G.value?G.value.details||[]:[]),b=C(()=>a.value.parameter_id?q.value.find(s=>s.parameter_id==a.value.parameter_id):null);E(()=>a.value.parameter_id,s=>{s&&b.value&&(R.value?a.value.point=0:a.value.point=b.value.point)}),E(()=>a.value.cleanliness_rating,s=>{if(s&&b.value){const t=b.value.point;switch(s){case"Yes":a.value.point=t;break;case"No":a.value.point=-t;break;case"NA":a.value.point=0;break}}}),E(()=>a.value.category_id,()=>{a.value.parameter_pemeriksaan="",a.value.parameter_id="",a.value.point=0}),E(()=>a.value.parameter_pemeriksaan,()=>{a.value.parameter_id="",a.value.point=0});function ue(){U.value=!0,m.value={};const s=new FormData;s.append("category_id",a.value.category_id),s.append("parameter_pemeriksaan",a.value.parameter_pemeriksaan),s.append("parameter_id",a.value.parameter_id),s.append("point",a.value.point),s.append("notes",a.value.notes),s.append("finding_type",a.value.finding_type),a.value.photos.forEach((t,u)=>{s.append(`photos[${u}]`,t)}),$.post(route("inspections.store-finding",k.inspection.id),s,{onSuccess:()=>{a.value={category_id:"",parameter_pemeriksaan:"",parameter_id:"",point:0,photos:[],notes:""},L.value=[],f.value=[];const t=document.querySelector('input[type="file"]');t&&(t.value="")},onError:t=>{m.value=t},onFinish:()=>{U.value=!1}})}function H(){$.visit("/inspections")}function ce(){N.value=!0}function J(){N.value=!1}async function me(s){try{const u=await(await fetch(s)).blob(),x=new File([u],`inspection_photo_${Date.now()}.jpg`,{type:"image/jpeg"});a.value.photos.push(x),L.value.push(x);const w=new FileReader;w.onload=M=>{f.value.push(M.target.result)},w.readAsDataURL(x),J()}catch(t){console.error("Error processing photo:",t),alert("Gagal memproses foto. Silakan coba lagi.")}}function ge(s){a.value.photos.splice(s,1),L.value.splice(s,1),f.value.splice(s,1)}function pe(s=0){f.value.length>0&&(T.value=s,O.value=f.value[s],A.value=!0)}function ve(){A.value=!1,O.value=null}const fe=s=>{$.visit(route("inspections.add-finding",s))},I=(s,t)=>{O.value=s,T.value=0,A.value=!0},be=(s,t,u)=>{f.value=t.map(x=>`/storage/${x}`),T.value=u,A.value=!0},Q=s=>s?s.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().slice(0,2):"U",xe=s=>{F.fire({title:"Edit Finding",text:"Edit finding functionality will be implemented soon.",icon:"info",confirmButtonText:"OK"})},ye=async s=>{if((await F.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{await $.delete(route("inspections.delete-finding",[k.inspection.id,s])),F.fire({title:"Deleted!",text:"Finding has been deleted.",icon:"success",timer:2e3,showConfirmButton:!1})}catch(u){console.error("Error deleting finding:",u),F.fire({title:"Error!",text:"Failed to delete finding. Please try again.",icon:"error",confirmButtonText:"OK"})}};function _e(s){const t=Array.from(s.target.files);t.length>0&&(t.forEach(u=>{a.value.photos.push(u),L.value.push(u);const x=new FileReader;x.onload=w=>{f.value.push(w.target.result)},x.readAsDataURL(u)}),s.target.value="")}async function he(){if((await F.fire({title:"Complete Inspection?",text:"Are you sure you want to complete this inspection? This action cannot be undone.",icon:"question",showCancelButton:!0,confirmButtonColor:"#10b981",cancelButtonColor:"#6b7280",confirmButtonText:"Yes, Complete!",cancelButtonText:"Cancel"})).isConfirmed)try{await $.patch(route("inspections.complete",k.inspection.id)),F.fire({title:"Completed!",text:"Inspection has been completed successfully.",icon:"success",timer:2e3,showConfirmButton:!1})}catch(t){console.error("Error completing inspection:",t),F.fire({title:"Error!",text:"Failed to complete inspection. Please try again.",icon:"error",confirmButtonText:"OK"})}}const _=v(null),h=v(null),B=v("environment");async function X(){try{const s={video:{facingMode:B.value,width:{ideal:1280},height:{ideal:720}}};try{h.value=await navigator.mediaDevices.getUserMedia(s)}catch{console.log("Trying fallback camera..."),B.value=B.value==="user"?"environment":"user",h.value=await navigator.mediaDevices.getUserMedia({video:{facingMode:B.value,width:{ideal:1280},height:{ideal:720}}})}_.value&&(_.value.srcObject=h.value,_.value.onloadedmetadata=()=>{console.log("Video ready:",_.value.videoWidth,"x",_.value.videoHeight)})}catch(s){console.error("Error accessing camera:",s),alert("Tidak dapat mengakses kamera. Pastikan Anda memberikan izin akses kamera.")}}async function ke(){B.value=B.value==="user"?"environment":"user",await X()}function we(){if(!_.value||!h.value){alert("Kamera belum siap. Silakan tunggu sebentar.");return}try{const s=document.createElement("canvas");s.width=_.value.videoWidth,s.height=_.value.videoHeight,s.getContext("2d").drawImage(_.value,0,0);const u=s.toDataURL("image/jpeg",.9);me(u)}catch(s){console.error("Error capturing photo:",s),alert("Gagal mengambil foto. Silakan coba lagi.")}}return Ce(()=>{}),Pe(()=>{h.value&&h.value.getTracks().forEach(s=>s.stop())}),E(N,s=>{s?X():h.value&&(h.value.getTracks().forEach(t=>t.stop()),h.value=null)}),(s,t)=>(l(),ie(Ue,{title:"Add Finding"},{default:je(()=>{var u,x,w,M;return[e("div",Be,[e("div",Se,[e("div",{class:"flex items-center justify-between mb-8"},[e("div",{class:"flex items-center gap-4"},[e("button",{onClick:H,class:"text-gray-500 hover:text-gray-700 transition"},t[7]||(t[7]=[e("i",{class:"fa-solid fa-arrow-left text-xl"},null,-1)])),t[8]||(t[8]=e("h1",{class:"text-3xl font-bold text-gray-800 flex items-center gap-3"},[e("i",{class:"fa-solid fa-camera text-blue-500"}),c(" Add Finding ")],-1))]),e("div",{class:"flex gap-3"},[e("button",{onClick:he,class:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-xl font-medium transition"},t[9]||(t[9]=[e("i",{class:"fa-solid fa-check mr-2"},null,-1),c("Complete Inspection ")]))])]),e("div",Ee,[t[13]||(t[13]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Inspection Details",-1)),e("div",$e,[e("div",null,[t[10]||(t[10]=e("label",{class:"text-sm font-medium text-gray-500"},"Created By",-1)),e("p",Ne,r(((u=g.inspection.created_by_user)==null?void 0:u.name)||"-"),1)]),e("div",null,[t[11]||(t[11]=e("label",{class:"text-sm font-medium text-gray-500"},"Outlet",-1)),e("p",Te,r(((x=g.inspection.outlet)==null?void 0:x.nama_outlet)||"-"),1)]),e("div",null,[t[12]||(t[12]=e("label",{class:"text-sm font-medium text-gray-500"},"Department",-1)),e("p",Le,r(g.inspection.departemen),1)])])]),e("div",Me,[e("form",{onSubmit:De(ue,["prevent"]),class:"space-y-6"},[e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-camera mr-2"}),c("Photo Evidence * ")],-1)),e("div",Ve,[e("button",{type:"button",onClick:ce,class:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition flex items-center gap-2"},t[14]||(t[14]=[e("i",{class:"fa-solid fa-camera"},null,-1),c(" Camera ")])),t[15]||(t[15]=e("label",{for:"photo-upload",class:"px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition flex items-center gap-2 cursor-pointer"},[e("i",{class:"fa-solid fa-upload"}),c(" Upload ")],-1)),e("input",{id:"photo-upload",type:"file",accept:"image/*",multiple:"",onChange:_e,class:"hidden"},null,32)]),f.value.length>0?(l(),n("div",Oe,[e("div",Re,[(l(!0),n(P,null,j(f.value,(o,p)=>(l(),n("div",{key:p,class:"relative group"},[e("div",Ye,[e("img",{src:o,alt:`Photo ${p+1}`,class:"w-full h-32 object-cover rounded-lg cursor-pointer hover:opacity-80 transition",onClick:V=>pe(p)},null,8,qe),e("button",{type:"button",onClick:V=>ge(p),class:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition opacity-0 group-hover:opacity-100"},t[16]||(t[16]=[e("i",{class:"fa-solid fa-times"},null,-1)]),8,Ke)])]))),128))]),e("div",ze,r(f.value.length)+" photo(s) selected ",1)])):(l(),n("div",We,t[17]||(t[17]=[e("i",{class:"fa-solid fa-camera text-4xl mb-2"},null,-1),e("p",null,"No photos selected",-1),e("p",{class:"text-sm"},"Use camera or upload button above",-1)]))),m.value.photo?(l(),n("p",Ge,r(m.value.photo),1)):d("",!0),t[19]||(t[19]=e("p",{class:"mt-1 text-sm text-gray-500"},"Upload photo evidence of your finding",-1))]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-tag mr-2"}),c("Category * ")],-1)),D(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>a.value.category_id=o),class:y(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",m.value.category_id?"border-red-500":"border-gray-300"]),required:""},[t[20]||(t[20]=e("option",{value:""},"Select Category",-1)),(l(!0),n(P,null,j(g.categories,o=>(l(),n("option",{key:o.id,value:o.id},r(o.categories),9,He))),128))],2),[[z,a.value.category_id]]),m.value.category_id?(l(),n("p",Je,r(m.value.category_id),1)):d("",!0)]),Y.value.length>0?(l(),n("div",Ie,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-clipboard-list mr-2"}),c("Parameter Pemeriksaan * ")],-1)),D(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.value.parameter_pemeriksaan=o),class:y(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",m.value.parameter_pemeriksaan?"border-red-500":"border-gray-300"]),required:""},[t[22]||(t[22]=e("option",{value:""},"Select Parameter Pemeriksaan",-1)),(l(!0),n(P,null,j(Y.value,o=>(l(),n("option",{key:o.parameter_pemeriksaan,value:o.parameter_pemeriksaan},r(o.parameter_pemeriksaan),9,Qe))),128))],2),[[z,a.value.parameter_pemeriksaan]]),m.value.parameter_pemeriksaan?(l(),n("p",Xe,r(m.value.parameter_pemeriksaan),1)):d("",!0)])):d("",!0),q.value.length>0?(l(),n("div",Ze,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-cogs mr-2"}),c("Parameter * ")],-1)),D(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>a.value.parameter_id=o),class:y(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",m.value.parameter_id?"border-red-500":"border-gray-300"]),required:""},[t[24]||(t[24]=e("option",{value:""},"Select Parameter",-1)),(l(!0),n(P,null,j(q.value,o=>{var p;return l(),n("option",{key:o.parameter_id,value:o.parameter_id},r((p=o.parameter)==null?void 0:p.parameter)+" ("+r(o.point)+" points) ",9,et)}),128))],2),[[z,a.value.parameter_id]]),m.value.parameter_id?(l(),n("p",tt,r(m.value.parameter_id),1)):d("",!0)])):d("",!0),b.value&&!R.value?(l(),n("div",st,[e("div",at,[e("div",null,[t[26]||(t[26]=e("h4",{class:"text-sm font-semibold text-green-800"},"Selected Parameter",-1)),e("p",ot,r((w=b.value.parameter)==null?void 0:w.parameter),1)]),e("div",lt,[e("span",nt,r(b.value.point),1),t[27]||(t[27]=e("p",{class:"text-sm text-green-600"},"Points",-1))])])])):d("",!0),b.value&&R.value?(l(),n("div",rt,[e("div",it,[t[31]||(t[31]=e("h4",{class:"text-sm font-semibold text-blue-800 mb-2"},"Cleanliness Rating",-1)),e("p",dt,r((M=b.value.parameter)==null?void 0:M.parameter),1),e("div",ut,[e("label",{class:y(["flex items-center p-3 border rounded-lg cursor-pointer hover:bg-green-50 transition",a.value.cleanliness_rating==="Yes"?"border-green-500 bg-green-50":"border-gray-300"])},[D(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=o=>a.value.cleanliness_rating=o),value:"Yes",class:"mr-2 text-green-600 focus:ring-green-500"},null,512),[[W,a.value.cleanliness_rating]]),e("div",ct,[t[28]||(t[28]=e("div",{class:"font-medium text-green-800"},"Yes",-1)),e("div",mt,"+"+r(b.value.point)+" pts",1)])],2),e("label",{class:y(["flex items-center p-3 border rounded-lg cursor-pointer hover:bg-red-50 transition",a.value.cleanliness_rating==="No"?"border-red-500 bg-red-50":"border-gray-300"])},[D(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=o=>a.value.cleanliness_rating=o),value:"No",class:"mr-2 text-red-600 focus:ring-red-500"},null,512),[[W,a.value.cleanliness_rating]]),e("div",gt,[t[29]||(t[29]=e("div",{class:"font-medium text-red-800"},"No",-1)),e("div",pt,"-"+r(b.value.point)+" pts",1)])],2),e("label",{class:y(["flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition",a.value.cleanliness_rating==="NA"?"border-gray-500 bg-gray-50":"border-gray-300"])},[D(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=o=>a.value.cleanliness_rating=o),value:"NA",class:"mr-2 text-gray-600 focus:ring-gray-500"},null,512),[[W,a.value.cleanliness_rating]]),t[30]||(t[30]=e("div",{class:"text-center"},[e("div",{class:"font-medium text-gray-800"},"NA"),e("div",{class:"text-xs text-gray-600"},"0 pts")],-1))],2)])]),a.value.cleanliness_rating?(l(),n("div",vt,[e("div",null,[t[32]||(t[32]=e("h4",{class:"text-sm font-semibold text-blue-800"},"Final Points",-1)),e("p",ft,r(a.value.cleanliness_rating)+" Rating",1)]),e("div",bt,[e("span",{class:y(["text-2xl font-bold",a.value.point>0?"text-green-800":a.value.point<0?"text-red-800":"text-gray-800"])},r(a.value.point),3),t[33]||(t[33]=e("p",{class:"text-sm text-blue-600"},"Points",-1))])])):d("",!0)])):d("",!0),e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[e("i",{class:"fa-solid fa-sticky-note mr-2"}),c("Notes ")],-1)),D(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=o=>a.value.notes=o),rows:"3",class:y(["w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",m.value.notes?"border-red-500":"border-gray-300"]),placeholder:"Add any additional notes about this finding..."},null,2),[[Fe,a.value.notes]]),m.value.notes?(l(),n("p",xt,r(m.value.notes),1)):d("",!0)]),e("div",yt,[e("button",{type:"button",onClick:H,class:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-xl font-medium transition"},t[35]||(t[35]=[e("i",{class:"fa-solid fa-times mr-2"},null,-1),c("Cancel ")])),e("button",{type:"submit",disabled:U.value,class:y(["px-6 py-3 rounded-xl font-medium transition",U.value?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white"])},[U.value?(l(),n("i",ht)):(l(),n("i",kt)),c(" "+r(U.value?"Saving...":"Save Finding"),1)],10,_t)])],32)])])]),N.value?(l(),n("div",wt,[e("div",Ct,[e("div",{class:"flex-shrink-0 p-4 border-b border-gray-200 bg-gray-50 sm:bg-white sm:rounded-t-2xl"},[e("div",{class:"flex items-center justify-between"},[t[37]||(t[37]=e("h2",{class:"text-lg font-bold text-gray-900"}," Ambil Foto Temuan ",-1)),e("button",{onClick:J,class:"p-2 text-gray-400 hover:text-red-500 rounded-full hover:bg-gray-100 transition-colors"},t[36]||(t[36]=[e("i",{class:"fas fa-times text-xl"},null,-1)]))])]),e("div",Pt,[e("div",jt,[e("video",{ref_key:"video",ref:_,autoplay:"",playsinline:"",class:"w-full h-full object-cover aspect-[4/3]"},null,512),e("button",{onClick:ke,class:"absolute top-3 right-3 p-3 bg-black/60 hover:bg-black/80 text-white rounded-full transition-all shadow-lg",title:"Switch Kamera"},t[38]||(t[38]=[e("i",{class:"fas fa-camera-rotate text-lg"},null,-1)]))]),e("div",{class:"flex-shrink-0 space-y-3"},[e("div",{class:"flex justify-center"},[e("button",{onClick:we,class:"w-16 h-16 bg-white rounded-full shadow-lg flex items-center justify-center text-2xl text-gray-700 hover:bg-gray-50 transition-all"},t[39]||(t[39]=[e("i",{class:"fas fa-camera"},null,-1)]))])])])])])):d("",!0),A.value?(l(),ie(Ae,{key:1,show:A.value,mediaList:f.value.map((o,p)=>({type:"image",url:o,caption:`Photo Evidence ${p+1}`})),startIndex:T.value,onClose:ve},null,8,["show","mediaList","startIndex"])):d("",!0),g.existingInspections&&g.existingInspections.length>0?(l(),n("div",Dt,[e("div",Ft,[t[52]||(t[52]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center"},[e("i",{class:"fa-solid fa-list-check text-blue-500 mr-2"}),c(" All Inspections in This Outlet & Date ")],-1)),e("div",Ut,[(l(!0),n(P,null,j(g.existingInspections,o=>{var p,V,Z,ee;return l(),n("div",{key:o.id,class:y(["border rounded-xl p-4 hover:shadow-md transition",o.id===g.inspection.id?"border-blue-300 bg-blue-50":"border-gray-200"])},[e("div",At,[e("div",Bt,[e("div",St,[e("h4",Et,[c(r(((p=o.guidance)==null?void 0:p.title)||"Inspection")+" ",1),o.id===g.inspection.id?(l(),n("span",$t,"(Current)")):d("",!0)]),e("span",{class:y(["px-2 py-1 rounded-full text-xs font-semibold",o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"])},r(o.status),3)]),e("div",Nt,[e("div",Tt,[e("div",Lt,[(V=o.created_by_user)!=null&&V.image?(l(),n("div",{key:0,class:"w-6 h-6 rounded-full overflow-hidden cursor-pointer hover:scale-110 transition-transform",onClick:i=>I(`/storage/${o.created_by_user.image}`,o.created_by_user.nama_lengkap)},[e("img",{src:`/storage/${o.created_by_user.image}`,alt:o.created_by_user.nama_lengkap,class:"w-full h-full object-cover"},null,8,Vt)],8,Mt)):(l(),n("div",Ot,r(Q(((Z=o.created_by_user)==null?void 0:Z.nama_lengkap)||"U")),1)),e("span",Rt,r(((ee=o.created_by_user)==null?void 0:ee.nama_lengkap)||"Unknown"),1)])]),e("div",Yt,[t[40]||(t[40]=e("i",{class:"fa-solid fa-calendar"},null,-1)),e("span",null,r(new Date(o.inspection_date).toLocaleDateString()),1)]),e("div",qt,[t[41]||(t[41]=e("i",{class:"fa-solid fa-camera"},null,-1)),e("span",null,r(o.total_findings)+" findings",1)]),e("div",Kt,[t[42]||(t[42]=e("i",{class:"fa-solid fa-star"},null,-1)),e("span",null,r(o.total_points)+" points",1)])]),o.details&&o.details.length>0?(l(),n("div",zt,[t[49]||(t[49]=e("h5",{class:"text-sm font-semibold text-gray-700 mb-2"},"Findings:",-1)),e("div",Wt,[(l(!0),n(P,null,j(o.details,i=>{var te,se,ae,oe,le,ne,re;return l(),n("div",{key:i.id,class:"bg-gray-50 rounded-lg p-3"},[e("div",Gt,[e("div",Ht,[e("span",Jt,r((te=i.category)==null?void 0:te.kode_categories)+" - "+r((se=i.category)==null?void 0:se.categories),1),e("span",It,r(i.point)+" pts ",1)]),e("div",Qt,[e("span",Xt,r(new Date(i.created_at).toLocaleDateString()),1),e("div",Zt,[e("button",{onClick:S=>xe(i.id),class:"w-6 h-6 bg-blue-500 hover:bg-blue-600 text-white rounded flex items-center justify-center text-xs transition",title:"Edit Finding"},t[43]||(t[43]=[e("i",{class:"fa-solid fa-edit"},null,-1)]),8,es),e("button",{onClick:S=>ye(i.id),class:"w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded flex items-center justify-center text-xs transition",title:"Delete Finding"},t[44]||(t[44]=[e("i",{class:"fa-solid fa-trash"},null,-1)]),8,ts)])])]),e("div",ss,[e("div",as,[(ae=i.created_by_user)!=null&&ae.image?(l(),n("div",{key:0,class:"w-5 h-5 rounded-full overflow-hidden cursor-pointer hover:scale-110 transition-transform",onClick:S=>I(`/storage/${i.created_by_user.image}`,i.created_by_user.nama_lengkap)},[e("img",{src:`/storage/${i.created_by_user.image}`,alt:i.created_by_user.nama_lengkap,class:"w-full h-full object-cover"},null,8,ls)],8,os)):(l(),n("div",ns,r(Q(((oe=i.created_by_user)==null?void 0:oe.nama_lengkap)||"U")),1)),e("span",rs,r(((le=i.created_by_user)==null?void 0:le.nama_lengkap)||"Unknown"),1)])]),e("div",is,[e("div",ds,[t[45]||(t[45]=e("strong",null,"Parameter:",-1)),c(" "+r(i.parameter_pemeriksaan),1)]),e("div",us,[t[46]||(t[46]=e("strong",null,"Parameter Detail:",-1)),c(" "+r((ne=i.parameter)==null?void 0:ne.kode_parameter)+" - "+r((re=i.parameter)==null?void 0:re.parameter),1)]),i.notes?(l(),n("div",cs,[t[47]||(t[47]=e("strong",null,"Notes:",-1)),c(" "+r(i.notes),1)])):d("",!0),i.photo_paths&&i.photo_paths.length>0?(l(),n("div",ms,[t[48]||(t[48]=e("strong",{class:"text-xs"},"Photos:",-1)),e("div",gs,[(l(!0),n(P,null,j(i.photo_paths,(S,K)=>(l(),n("img",{key:K,src:`/storage/${S}`,alt:`Finding photo ${K+1}`,class:"w-12 h-12 object-cover rounded cursor-pointer hover:opacity-80 transition",onClick:xs=>be(S,i.photo_paths,K)},null,8,ps))),128))])])):d("",!0)])])}),128))])])):d("",!0)]),e("div",vs,[o.status==="Draft"&&o.id!==g.inspection.id?(l(),n("button",{key:0,onClick:i=>fe(o.id),class:"px-3 py-1 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm transition"},t[50]||(t[50]=[e("i",{class:"fa-solid fa-play mr-1"},null,-1),c(" Continue ")]),8,fs)):d("",!0),o.id===g.inspection.id?(l(),n("span",bs,t[51]||(t[51]=[e("i",{class:"fa-solid fa-check mr-1"},null,-1),c(" Current ")]))):d("",!0)])])],2)}),128))])])])):d("",!0)]}),_:1}))}};export{As as default};
