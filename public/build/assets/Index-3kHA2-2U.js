import{r as m,W as x,w as O,c as K,A as G,B as r,C as W,D as t,L as a,E as b,G as y,N as l,H as v,I as k,J as Y,F as w,M as V,l as _}from"./vendor-vue-g7iCcTkf.js";import{l as q}from"./lodash-DB3HVzpp.js";import{S as T}from"./app-DdwtQE43.js";import{A as z}from"./AppLayout-CLYhXf-W.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CauiUg4O.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const J={class:"max-w-7xl w-full mx-auto py-8 px-2"},R={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-xl mb-4 flex items-center gap-2"},Q={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl mb-4 flex items-center gap-2"},X={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6"},Z={class:"bg-white rounded-xl shadow-lg p-4 border-l-4 border-blue-500"},tt={class:"flex items-center"},et={class:"ml-4"},st={class:"text-2xl font-bold text-gray-800"},ot={class:"bg-white rounded-xl shadow-lg p-4 border-l-4 border-purple-500"},rt={class:"flex items-center"},at={class:"ml-4"},lt={class:"text-2xl font-bold text-gray-800"},it={class:"bg-white rounded-xl shadow-lg p-4 border-l-4 border-green-500"},nt={class:"flex items-center"},dt={class:"ml-4"},pt={class:"text-2xl font-bold text-gray-800"},ut={class:"bg-white rounded-xl shadow-lg p-4 border-l-4 border-orange-500"},ct={class:"flex items-center"},xt={class:"ml-4"},gt={class:"text-2xl font-bold text-gray-800"},ft={class:"mb-4 flex gap-4 flex-wrap"},mt={class:"bg-white rounded-2xl shadow-lg overflow-x-auto"},bt={class:"min-w-full divide-y divide-purple-200"},yt={class:"px-4 py-2 whitespace-nowrap font-mono text-sm"},vt={class:"px-4 py-2 whitespace-nowrap font-semibold"},ht={class:"px-4 py-2"},kt={class:"px-4 py-2 whitespace-nowrap"},wt={key:0,class:"px-2 py-1 rounded-full text-xs font-semibold bg-purple-100 text-purple-800"},_t={key:1,class:"px-2 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-800"},Tt={class:"px-4 py-2 whitespace-nowrap"},Dt={class:"flex items-center"},St={class:"px-4 py-2 whitespace-nowrap text-sm"},Bt=["href"],Ct={key:1,class:"text-gray-400"},Nt={class:"px-4 py-2 whitespace-nowrap text-sm text-gray-900"},Mt={key:0},It={key:1,class:"text-gray-400"},Lt={class:"px-4 py-2 whitespace-nowrap text-center"},$t=["onClick"],Vt={key:1,class:"text-gray-400"},At={key:0},Ft={class:"mt-4 flex justify-between items-center"},Pt={class:"text-sm text-gray-600"},jt={key:0,class:"inline-flex -space-x-px"},Et=["onClick","innerHTML"],Ht=["innerHTML"],Zt={__name:"Index",props:{notifications:Object,totalDevices:Number,stats:Object,filters:Object},setup(i){var S,B,C,N;const d=i,g=m(((S=d.filters)==null?void 0:S.search)||""),p=m(((B=d.filters)==null?void 0:B.status)||""),u=m(((C=d.filters)==null?void 0:C.target_type)||""),c=m(((N=d.filters)==null?void 0:N.per_page)||"15"),A=q.debounce(()=>{x.get("/push-notification",{search:g.value,status:p.value,target_type:u.value,per_page:c.value},{preserveState:!0,replace:!0})},400);function F(){A()}function P(o){o&&x.visit(o,{preserveState:!0,replace:!0})}O([p,u,c],()=>{x.get("/push-notification",{search:g.value,status:p.value,target_type:u.value,per_page:c.value},{preserveState:!0,replace:!0})}),K(()=>{var e;const o=new Date().toDateString();return(e=d.notifications)!=null&&e.data?d.notifications.data.filter(n=>new Date(n.created_at).toDateString()===o&&n.status_send==1).length:0});function j(){x.visit("/push-notification/create")}function D(o,e){return o?o.length>e?o.substring(0,e)+"...":o:""}function f(o){return o.toLocaleString("id-ID")}function E(o){return{0:"belum terkirim",1:"terkirim",2:"sedang di proses"}[o]||"status tidak diketahui"}function H(o){return`/assets/file_photo_notification/${o}`}function U(o){T.fire({title:"Kirim Notifikasi?",text:"Yakin ingin mengirim notifikasi ini ke semua target?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#6c757d",confirmButtonText:"Ya, Kirim",cancelButtonText:"Batal"}).then(e=>{e.isConfirmed&&x.post(`/push-notification/${o}/send`,{},{onSuccess:()=>{T.fire("Berhasil","Notifikasi berhasil dikirim!","success")},onError:n=>{T.fire("Error",n.error||"Gagal mengirim notifikasi","error")}})})}return(o,e)=>(r(),G(z,{title:"Push Notification"},{default:W(()=>{var n,h,M,I,L;return[t("div",J,[t("div",{class:"flex justify-between items-center mb-6"},[e[4]||(e[4]=t("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[t("i",{class:"fa-solid fa-bell text-purple-500"}),y(" Push Notification ")],-1)),t("button",{onClick:j,class:"bg-gradient-to-r from-purple-500 to-purple-700 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transition-all font-semibold"}," + Buat Notifikasi Baru ")]),(n=o.$page.props.flash)!=null&&n.success?(r(),a("div",R,[e[5]||(e[5]=t("i",{class:"fa fa-check-circle"},null,-1)),y(" "+l(o.$page.props.flash.success),1)])):b("",!0),(h=o.$page.props.flash)!=null&&h.error?(r(),a("div",Q,[e[6]||(e[6]=t("i",{class:"fa fa-exclamation-circle"},null,-1)),y(" "+l(o.$page.props.flash.error),1)])):b("",!0),t("div",X,[t("div",Z,[t("div",tt,[e[8]||(e[8]=t("div",{class:"p-2 bg-blue-100 rounded-lg"},[t("i",{class:"fa-solid fa-mobile-screen text-blue-600 text-xl"})],-1)),t("div",et,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-600"},"Total Devices",-1)),t("p",st,l(f(i.totalDevices)),1)])])]),t("div",ot,[t("div",rt,[e[10]||(e[10]=t("div",{class:"p-2 bg-purple-100 rounded-lg"},[t("i",{class:"fa-solid fa-bell text-purple-600 text-xl"})],-1)),t("div",at,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-600"},"Total Notifikasi",-1)),t("p",lt,l(f(((M=i.stats)==null?void 0:M.total_notifications)||0)),1)])])]),t("div",it,[t("div",nt,[e[12]||(e[12]=t("div",{class:"p-2 bg-green-100 rounded-lg"},[t("i",{class:"fa-solid fa-check-circle text-green-600 text-xl"})],-1)),t("div",dt,[e[11]||(e[11]=t("p",{class:"text-sm text-gray-600"},"Terkirim",-1)),t("p",pt,l(f(((I=i.stats)==null?void 0:I.sent_notifications)||0)),1)])])]),t("div",ut,[t("div",ct,[e[14]||(e[14]=t("div",{class:"p-2 bg-orange-100 rounded-lg"},[t("i",{class:"fa-solid fa-clock text-orange-600 text-xl"})],-1)),t("div",xt,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-600"},"Pending",-1)),t("p",gt,l(f(((L=i.stats)==null?void 0:L.pending_notifications)||0)),1)])])])]),t("div",ft,[v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),class:"px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-400 focus:border-purple-400"},e[15]||(e[15]=[t("option",{value:""},"Semua Status",-1),t("option",{value:"sent"},"Terkirim",-1),t("option",{value:"pending"},"Belum Terkirim",-1),t("option",{value:"processing"},"Sedang Diproses",-1)]),512),[[k,p.value]]),v(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),class:"px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-400 focus:border-purple-400"},e[16]||(e[16]=[t("option",{value:""},"Semua Target",-1),t("option",{value:"all"},"All Devices",-1),t("option",{value:"specific"},"Target Spesifik",-1)]),512),[[k,u.value]]),v(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>c.value=s),class:"px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-400 focus:border-purple-400"},e[17]||(e[17]=[t("option",{value:"10"},"10 Data",-1),t("option",{value:"15"},"15 Data",-1),t("option",{value:"25"},"25 Data",-1),t("option",{value:"50"},"50 Data",-1),t("option",{value:"100"},"100 Data",-1)]),512),[[k,c.value]]),v(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>g.value=s),onInput:F,type:"text",placeholder:"Cari ID, Title, Body, Target...",class:"flex-1 px-4 py-2 rounded-xl border border-purple-200 shadow focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition"},null,544),[[Y,g.value]])]),t("div",mt,[t("table",bt,[e[21]||(e[21]=t("thead",{class:"bg-purple-600 text-white"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"ID"),t("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Title"),t("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Body"),t("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Target"),t("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Status"),t("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Image"),t("th",{class:"px-4 py-3 text-left text-xs font-bold uppercase tracking-wider"},"Report"),t("th",{class:"px-4 py-3 text-center text-xs font-bold uppercase tracking-wider"},"Aksi")])],-1)),t("tbody",null,[(r(!0),a(w,null,V(i.notifications.data,s=>(r(),a("tr",{key:s.id,class:"hover:bg-purple-50 transition"},[t("td",yt,l(s.id),1),t("td",vt,l(s.title),1),t("td",ht,l(D(s.body,50)),1),t("td",kt,[s.target==="all"?(r(),a("span",wt," All Devices ")):(r(),a("span",_t,l(D(s.target,30)),1))]),t("td",Tt,[t("div",Dt,[t("div",{class:_(["w-3 h-3 rounded-full mr-2",s.status_send===1?"bg-green-500":s.status_send===2?"bg-blue-500":"bg-orange-500"])},null,2),t("span",{class:_(["text-sm font-medium",s.status_send===1?"text-green-700":s.status_send===2?"text-blue-700":"text-orange-700"])},l(E(s.status_send)),3)])]),t("td",St,[s.photo?(r(),a("a",{key:0,href:H(s.photo),target:"_blank",class:"text-purple-600 hover:text-purple-800 font-medium"},e[18]||(e[18]=[t("i",{class:"fa fa-image mr-1"},null,-1),y(" [image] ")]),8,Bt)):(r(),a("span",Ct,"-"))]),t("td",Nt,[s.target==="all"||s.target===""?(r(),a("span",Mt,l(s.status_send==1?"Finish":"On Process")+": Terkirim ke "+l(s.sended_devices||0)+" perangkat ",1)):(r(),a("span",It,"-"))]),t("td",Lt,[s.status_send==0?(r(),a("button",{key:0,onClick:$=>U(s.id),class:"px-2 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200 transition",title:"Kirim Notifikasi"},e[19]||(e[19]=[t("i",{class:"fa fa-paper-plane"},null,-1)]),8,$t)):(r(),a("span",Vt,"-"))])]))),128)),!i.notifications.data||i.notifications.data.length===0?(r(),a("tr",At,e[20]||(e[20]=[t("td",{colspan:"8",class:"text-center py-8 text-gray-400"},"Tidak ada data notifikasi",-1)]))):b("",!0)])])]),t("div",Ft,[t("div",Pt," Menampilkan "+l(i.notifications.from||0)+" - "+l(i.notifications.to||0)+" dari "+l(i.notifications.total||0)+" data notifikasi ",1),i.notifications.links&&i.notifications.links.length>3?(r(),a("nav",jt,[(r(!0),a(w,null,V(i.notifications.links,(s,$)=>(r(),a(w,{key:$},[s.url?(r(),a("button",{key:0,onClick:Ut=>P(s.url),class:_(["px-3 py-1 border border-gray-300",s.active?"bg-purple-600 text-white":"bg-white text-purple-700 hover:bg-purple-50"]),innerHTML:s.label},null,10,Et)):(r(),a("span",{key:1,class:"px-3 py-1 border border-gray-200 text-gray-400",innerHTML:s.label},null,8,Ht))],64))),128))])):b("",!0)])])]}),_:1}))}};export{Zt as default};
