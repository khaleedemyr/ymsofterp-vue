import{a as m}from"./vendor-utils-CpgP2uT4.js";import{r as b,w as U,a as I,A as N,B as d,x as i,C as u,Q as n,D as s,L as c,F as w,M as _,l as D,N as v,T as F}from"./vendor-vue-g7iCcTkf.js";import{Y as T,h as k,_ as $,G as z,S as E}from"./vendor-ui-CrPgGUUb.js";const G={class:"fixed inset-0 overflow-y-auto"},L={class:"flex min-h-full items-center justify-center p-4"},P={class:"flex justify-between items-center mb-4"},V={class:"mb-4"},Y={class:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto"},Q=["onClick"],R={class:"w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold"},q={class:"truncate"},H={class:"mb-4"},J={class:"flex gap-2 flex-wrap"},K={class:"w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold text-base cursor-pointer"},O=["onClick"],W={class:"flex justify-end gap-2 mt-6"},X=["disabled"],se={__name:"AssignMemberModal",props:{show:Boolean,taskId:[Number,String],onClose:Function},emits:["saved"],setup(r,{emit:C}){const l=r,S=C,g=b([]),o=b([]),f=b(!1);function p(t){return t?t.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):""}function x(t){return o.value.some(e=>e.id===t.id)}function j(t){x(t)?o.value=o.value.filter(e=>e.id!==t.id):o.value.push(t)}function B(t){o.value=o.value.filter(e=>e.id!==t.id)}async function h(){const{data:t}=await m.get("/api/assignable-users");console.log("DATA USERS:",t),g.value=t}async function y(){const{data:t}=await m.get(`/api/maintenance-members/${l.taskId}`);o.value=t}async function M(){f.value=!0;try{await m.post("/api/assign-members",{task_id:l.taskId,user_ids:o.value.map(t=>t.id)}),S("saved"),l.onClose()}finally{f.value=!1}}return U(()=>l.show,t=>{t&&(h(),y())},{immediate:!0}),I(()=>{l.show&&(h(),y())}),(t,e)=>(d(),N(F,{to:"body"},[i(n(E),{appear:"",show:r.show,as:"template"},{default:u(()=>[i(n(T),{as:"div",onClose:r.onClose,class:"relative z-[99999]"},{default:u(()=>[i(n(k),{enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[i(n($),{class:"fixed inset-0 bg-black/60"})]),_:1}),s("div",G,[s("div",L,[i(n(k),{enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[i(n(z),{class:"w-full max-w-2xl transform overflow-hidden rounded-2xl bg-white p-6 shadow-xl transition-all"},{default:u(()=>[s("div",P,[e[3]||(e[3]=s("h3",{class:"text-lg font-bold text-gray-900"},"Assign Member",-1)),s("button",{onClick:e[0]||(e[0]=(...a)=>r.onClose&&r.onClose(...a)),class:"text-gray-400 hover:text-red-500"},e[2]||(e[2]=[s("i",{class:"fas fa-times"},null,-1)]))]),s("div",V,[e[4]||(e[4]=s("div",{class:"text-sm font-semibold mb-2"},"Pilih Member",-1)),s("div",Y,[(d(!0),c(w,null,_(g.value,a=>(d(),c("button",{key:a.id,onClick:A=>j(a),class:D(["flex items-center gap-2 p-2 rounded hover:bg-blue-50 transition",x(a)?"bg-blue-100":"bg-gray-50"])},[s("div",R,v(p(a.nama_lengkap)),1),s("span",q,v(a.nama_lengkap),1)],10,Q))),128))])]),s("div",H,[e[6]||(e[6]=s("div",{class:"text-sm font-semibold mb-2"},"Preview Member",-1)),s("div",J,[(d(!0),c(w,null,_(o.value,a=>(d(),c("div",{key:a.id,class:"relative group"},[s("div",K,v(p(a.nama_lengkap)),1),s("button",{onClick:A=>B(a),class:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center opacity-0 group-hover:opacity-100 transition"},e[5]||(e[5]=[s("i",{class:"fas fa-trash text-xs"},null,-1)]),8,O)]))),128))])]),s("div",W,[s("button",{onClick:e[1]||(e[1]=(...a)=>l.onClose&&l.onClose(...a)),class:"px-4 py-2 rounded bg-gray-200 text-gray-700 hover:bg-gray-300"},"Batal"),s("button",{onClick:M,disabled:o.value.length===0||f.value,class:"px-6 py-2 rounded bg-blue-600 text-white font-semibold hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed"}," Simpan ",8,X)])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])]))}};export{se as default};
