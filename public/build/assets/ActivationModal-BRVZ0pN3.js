import{r as _,c as f,w as $,L as u,E as m,B as r,D as e,N as i,O as U,x as k,G as x,l as y,Q as h,H as I,J}from"./vendor-vue-g7iCcTkf.js";import{s as w}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{a as P}from"./vendor-utils-CpgP2uT4.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},F={class:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4"},L={class:"flex items-center justify-between p-6 border-b"},G={class:"text-lg font-semibold text-gray-900"},H={class:"p-6"},Q={class:"mb-4"},q={class:"text-sm text-gray-600 mb-2"},R={class:"bg-gray-50 p-3 rounded-lg"},W={class:"font-semibold"},X={class:"text-sm text-gray-600"},Y={class:"text-sm text-gray-600"},Z={key:0,class:"text-red-500 text-sm mt-1"},aa={key:0,class:"text-red-500 text-sm mt-1"},ea={key:0,class:"text-red-500 text-sm mt-1"},ta=["max"],sa={key:0,class:"text-red-500 text-sm mt-1"},la={key:0,class:"flex items-center justify-center py-4"},ia={key:1,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded"},oa={class:"flex items-center justify-end gap-3 p-6 border-t"},na=["disabled"],da=["disabled"],ua={key:0},ra={key:1},ma={__name:"ActivationModal",props:{show:Boolean,user:Object,jabatans:Array,divisions:Array,outlets:Array},emits:["close","success"],setup(o,{emit:N}){const v=o,j=N,t=_({jabatan_id:null,division_id:null,outlet_id:null,tanggal_masuk:""}),c=_(!1),s=_({}),b=_(""),S=f(()=>{var l;return((l=v.jabatans)==null?void 0:l.map(a=>({id:a.id_jabatan,name:a.nama_jabatan})))||[]}),T=f(()=>{var l;return((l=v.divisions)==null?void 0:l.map(a=>({id:a.id,name:a.nama_divisi})))||[]}),K=f(()=>{var l;return((l=v.outlets)==null?void 0:l.map(a=>({id:a.id_outlet,name:a.nama_outlet})))||[]}),V=f(()=>t.value.jabatan_id&&t.value.division_id&&t.value.outlet_id&&t.value.tanggal_masuk);$(()=>v.show,l=>{l&&C()});function C(){t.value={jabatan_id:null,division_id:null,outlet_id:null,tanggal_masuk:""},s.value={},b.value=""}async function B(){var l,a,g,p;if(!V.value){s.value={jabatan_id:t.value.jabatan_id?"":"Jabatan harus dipilih",division_id:t.value.division_id?"":"Divisi harus dipilih",outlet_id:t.value.outlet_id?"":"Outlet harus dipilih",tanggal_masuk:t.value.tanggal_masuk?"":"Tanggal bergabung harus diisi"};return}c.value=!0,s.value={},b.value="";try{const n=await P.post(`/users/${v.user.id}/activate`,{jabatan_id:t.value.jabatan_id.id,division_id:t.value.division_id.id,outlet_id:t.value.outlet_id.id,tanggal_masuk:t.value.tanggal_masuk});n.data.success&&(j("success",n.data.message),j("close"))}catch(n){(a=(l=n.response)==null?void 0:l.data)!=null&&a.errors?s.value=n.response.data.errors:b.value=((p=(g=n.response)==null?void 0:g.data)==null?void 0:p.message)||"Terjadi kesalahan saat mengaktifkan karyawan"}finally{c.value=!1}}return(l,a)=>{var g,p,n,A,D,O,M;return o.show?(r(),u("div",E,[e("div",F,[e("div",L,[e("h3",G,i(((g=o.user)==null?void 0:g.status)==="B"?"Aktivasi Karyawan Baru":"Lengkapi Data Karyawan"),1),e("button",{onClick:a[0]||(a[0]=d=>l.$emit("close")),class:"text-gray-400 hover:text-gray-600"},a[6]||(a[6]=[e("i",{class:"fa-solid fa-times text-xl"},null,-1)]))]),e("div",H,[e("div",Q,[e("p",q,i(((p=o.user)==null?void 0:p.status)==="B"?"Karyawan baru yang akan diaktifkan:":"Karyawan yang perlu melengkapi data:"),1),e("div",R,[e("p",W,i((n=o.user)==null?void 0:n.nama_lengkap),1),e("p",X,"NIK: "+i((A=o.user)==null?void 0:A.nik),1),e("p",Y,"Status: "+i(((D=o.user)==null?void 0:D.status)==="B"?"Baru":((O=o.user)==null?void 0:O.status)==="A"?"Aktif":"Non-Aktif"),1)])]),e("form",{onSubmit:U(B,["prevent"]),class:"space-y-4"},[e("div",null,[a[7]||(a[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[x(" Jabatan "),e("span",{class:"text-red-500"},"*")],-1)),k(h(w),{modelValue:t.value.jabatan_id,"onUpdate:modelValue":a[1]||(a[1]=d=>t.value.jabatan_id=d),options:S.value,searchable:!0,"clear-on-select":!1,"close-on-select":!0,"show-labels":!1,"track-by":"id",label:"name",placeholder:"Pilih jabatan...",class:y([{"border-red-500":s.value.jabatan_id},"w-full"])},null,8,["modelValue","options","class"]),s.value.jabatan_id?(r(),u("p",Z,i(s.value.jabatan_id),1)):m("",!0)]),e("div",null,[a[8]||(a[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[x(" Divisi "),e("span",{class:"text-red-500"},"*")],-1)),k(h(w),{modelValue:t.value.division_id,"onUpdate:modelValue":a[2]||(a[2]=d=>t.value.division_id=d),options:T.value,searchable:!0,"clear-on-select":!1,"close-on-select":!0,"show-labels":!1,"track-by":"id",label:"name",placeholder:"Pilih divisi...",class:y([{"border-red-500":s.value.division_id},"w-full"])},null,8,["modelValue","options","class"]),s.value.division_id?(r(),u("p",aa,i(s.value.division_id),1)):m("",!0)]),e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[x(" Outlet "),e("span",{class:"text-red-500"},"*")],-1)),k(h(w),{modelValue:t.value.outlet_id,"onUpdate:modelValue":a[3]||(a[3]=d=>t.value.outlet_id=d),options:K.value,searchable:!0,"clear-on-select":!1,"close-on-select":!0,"show-labels":!1,"track-by":"id",label:"name",placeholder:"Pilih outlet...",class:y([{"border-red-500":s.value.outlet_id},"w-full"])},null,8,["modelValue","options","class"]),s.value.outlet_id?(r(),u("p",ea,i(s.value.outlet_id),1)):m("",!0)]),e("div",null,[a[10]||(a[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[x(" Tanggal Bergabung "),e("span",{class:"text-red-500"},"*")],-1)),I(e("input",{"onUpdate:modelValue":a[4]||(a[4]=d=>t.value.tanggal_masuk=d),type:"date",class:y(["w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"border-red-500":s.value.tanggal_masuk}]),max:new Date().toISOString().split("T")[0]},null,10,ta),[[J,t.value.tanggal_masuk]]),s.value.tanggal_masuk?(r(),u("p",sa,i(s.value.tanggal_masuk),1)):m("",!0),a[11]||(a[11]=e("p",{class:"text-xs text-gray-500 mt-1"},"Tanggal karyawan mulai bekerja di perusahaan",-1))]),c.value?(r(),u("div",la,a[12]||(a[12]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Memproses aktivasi...",-1)]))):m("",!0),b.value?(r(),u("div",ia,i(b.value),1)):m("",!0)],32)]),e("div",oa,[e("button",{onClick:a[5]||(a[5]=d=>l.$emit("close")),type:"button",class:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition",disabled:c.value}," Batal ",8,na),e("button",{onClick:B,type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",disabled:c.value||!V.value},[c.value?(r(),u("span",ua,"Memproses...")):(r(),u("span",ra,i(((M=o.user)==null?void 0:M.status)==="B"?"Aktifkan Karyawan":"Simpan Data"),1))],8,da)])])])):m("",!0)}}},_a=z(ma,[["__scopeId","data-v-28dd19a1"]]);export{_a as default};
