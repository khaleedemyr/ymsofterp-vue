import{r as I,A as z,B as n,C as J,D as e,G as D,N as a,H as _,J as K,L as d,F as g,M as h,I as F,E as T,l as Q,O as X,W as $}from"./vendor-vue-g7iCcTkf.js";import{A as Y}from"./AppLayout-IyEgvQ-G.js";import{a as Z}from"./vendor-utils-CpgP2uT4.js";import{S as E}from"./app-5sHs3Z-e.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-C59QAxMM.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const ee={class:"w-full h-full p-4 flex flex-col"},te={class:"flex justify-between items-center mb-6 flex-shrink-0"},se={class:"flex gap-3"},re=["disabled"],ae={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6 flex-shrink-0"},oe={class:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-blue-500"},le={class:"flex items-center"},ne={class:"ml-4"},ie={class:"text-2xl font-bold text-gray-900"},de={class:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-green-600"},ce={class:"flex items-center"},ue={class:"ml-4"},me={class:"text-2xl font-bold text-green-600"},pe={class:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-red-500"},xe={class:"flex items-center"},ge={class:"ml-4"},fe={class:"text-2xl font-bold text-red-600"},ye={class:"bg-white rounded-xl shadow-lg p-6 border-l-4 border-yellow-500"},_e={class:"flex items-center"},he={class:"ml-4"},be={class:"text-2xl font-bold text-yellow-600"},ve={class:"bg-white rounded-xl shadow-lg p-6 mb-6 flex-shrink-0"},we={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ke=["value"],Ce={class:"bg-white rounded-xl shadow-lg overflow-hidden flex-1 flex flex-col"},Me={class:"overflow-x-auto flex-1"},Le={class:"min-w-full divide-y divide-gray-200"},Ae={class:"bg-white divide-y divide-gray-200"},Se={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ie={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},De={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium"},Te={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium"},$e={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium"},Ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium"},Be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium"},Ue={class:"px-6 py-4 whitespace-nowrap text-sm"},Pe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Re={key:0,class:"px-6 py-4 border-t border-gray-200 flex-shrink-0"},Ne={class:"flex items-center justify-between"},je={class:"text-sm text-gray-700"},qe={class:"flex space-x-2"},He=["onClick","innerHTML"],We=["innerHTML"],Oe=["innerHTML"],tt={__name:"Index",props:{items:{type:Object,default:()=>({data:[],links:[]})},warehouses:{type:Array,default:()=>[]},summary:{type:Object,default:()=>({total_items:0,avg_cost:0})},filters:{type:Object,default:()=>({search:"",warehouse_id:"",per_page:50})}},setup(o){var C,M,L;const f=o,i=I({search:((C=f.filters)==null?void 0:C.search)||"",warehouse_id:((M=f.filters)==null?void 0:M.warehouse_id)||"",per_page:((L=f.filters)==null?void 0:L.per_page)||50});let y=null;const p=I(!1),b=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r||0),u=(r,t)=>!r||r===0?"-":`${new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}/${t||"unit"}`,B=r=>r?new Date(r).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",v=r=>!r.current_cost||!r.small_conversion_qty||!r.medium_conversion_qty?0:r.current_cost*r.small_conversion_qty/r.medium_conversion_qty,w=r=>!r.current_cost||!r.small_conversion_qty?0:r.current_cost*r.small_conversion_qty,k=r=>!r.item_price||!r.mac_plus_12?"N/A":Math.abs(r.item_price-r.mac_plus_12)<=1?"Break Even":r.item_price>r.mac_plus_12?"Profit":"Loss",U=r=>!r.item_price||!r.mac_plus_12?"bg-gray-100 text-gray-800":Math.abs(r.item_price-r.mac_plus_12)<=1?"bg-yellow-100 text-yellow-800":r.item_price>r.mac_plus_12?"bg-green-100 text-green-800":"bg-red-100 text-red-800",x=()=>{$.get("/mac-report",i.value,{preserveState:!0,preserveScroll:!0})},P=()=>{y&&clearTimeout(y),y=setTimeout(()=>{x()},500)},R=()=>{i.value={search:"",warehouse_id:"",per_page:50},x()},N=r=>{const s=new URLSearchParams(r.split("?")[1]).get("page"),c={...i.value};s&&(c.page=s),$.get("/mac-report",c,{preserveState:!0,preserveScroll:!0})},j=async()=>{try{p.value=!0;const r=await Z.post("/mac-report/export",i.value);if(r.data.success){const t=r.data.data,s=r.data.filename;let c=`Item Code,Item Name,Warehouse,MAC Small,MAC Medium,MAC Large,Item Price,MAC Medium+12%,Status,Last Updated
`;t.forEach(l=>{const q=v(l),H=w(l),W=u(l.current_cost||0,l.small_unit_name),O=u(q,l.medium_unit_name),V=u(H,l.large_unit_name),G=k(l);c+=`"${l.item_code||""}","${l.item_name}","${l.warehouse_name||""}","${W}","${O}","${V}","${l.item_price||0}","${l.mac_plus_12||0}","${G}","${l.last_updated||""}"
`});const A=new Blob([c],{type:"text/csv"}),S=window.URL.createObjectURL(A),m=document.createElement("a");m.href=S,m.download=s.replace(".xlsx",".csv"),document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(S),document.body.removeChild(m),E.fire({icon:"success",title:"Export Berhasil!",text:"File telah berhasil diunduh.",confirmButtonColor:"#3085d6"})}}catch(r){console.error("Export error:",r),E.fire({icon:"error",title:"Export Gagal!",text:"Terjadi kesalahan saat mengexport data.",confirmButtonColor:"#3085d6"})}finally{p.value=!1}};return(r,t)=>(n(),z(Y,null,{default:J(()=>[e("div",ee,[e("div",te,[t[4]||(t[4]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900 flex items-center gap-3"},[e("i",{class:"fa-solid fa-chart-line text-blue-600"}),D(" MAC Report (Moving Average Cost) ")]),e("p",{class:"text-gray-600 mt-2"},"Laporan Moving Average Cost untuk semua items dari food inventory")],-1)),e("div",se,[e("button",{onClick:j,disabled:p.value,class:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center gap-2"},[t[3]||(t[3]=e("i",{class:"fa-solid fa-download"},null,-1)),D(" "+a(p.value?"Exporting...":"Export Excel"),1)],8,re)])]),e("div",ae,[e("div",oe,[e("div",le,[t[6]||(t[6]=e("div",{class:"p-3 rounded-full bg-blue-100 text-blue-600"},[e("i",{class:"fa-solid fa-boxes text-xl"})],-1)),e("div",ne,[t[5]||(t[5]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Items",-1)),e("p",ie,a(o.summary.total_items||0),1)])])]),e("div",de,[e("div",ce,[t[8]||(t[8]=e("div",{class:"p-3 rounded-full bg-green-100 text-green-600"},[e("i",{class:"fa-solid fa-arrow-up text-xl"})],-1)),e("div",ue,[t[7]||(t[7]=e("p",{class:"text-sm font-medium text-gray-600"},"Profit Items",-1)),e("p",me,a(o.summary.profit_items||0),1)])])]),e("div",pe,[e("div",xe,[t[10]||(t[10]=e("div",{class:"p-3 rounded-full bg-red-100 text-red-600"},[e("i",{class:"fa-solid fa-arrow-down text-xl"})],-1)),e("div",ge,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-600"},"Loss Items",-1)),e("p",fe,a(o.summary.loss_items||0),1)])])]),e("div",ye,[e("div",_e,[t[12]||(t[12]=e("div",{class:"p-3 rounded-full bg-yellow-100 text-yellow-600"},[e("i",{class:"fa-solid fa-equals text-xl"})],-1)),e("div",he,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-600"},"Break Even",-1)),e("p",be,a(o.summary.break_even_items||0),1)])])])]),e("div",ve,[t[18]||(t[18]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Filters",-1)),e("div",we,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.value.search=s),onInput:P,type:"text",placeholder:"Search items, code, warehouse...",class:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"},null,544),[[K,i.value.search]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Warehouse",-1)),_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.value.warehouse_id=s),onChange:x,class:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"},[t[14]||(t[14]=e("option",{value:""},"All Warehouses",-1)),(n(!0),d(g,null,h(o.warehouses||[],s=>(n(),d("option",{key:s.id,value:s.id},a(s.name),9,ke))),128))],544),[[F,i.value.warehouse_id]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Per Page",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.value.per_page=s),onChange:x,class:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500"},t[16]||(t[16]=[e("option",{value:"10"},"10",-1),e("option",{value:"25"},"25",-1),e("option",{value:"50"},"50",-1),e("option",{value:"100"},"100",-1),e("option",{value:"200"},"200",-1)]),544),[[F,i.value.per_page]])]),e("div",{class:"flex items-end"},[e("button",{onClick:R,class:"w-full bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600"}," Clear Filters ")])])]),e("div",Ce,[t[20]||(t[20]=e("div",{class:"px-6 py-4 border-b border-gray-200 flex-shrink-0"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"MAC Data")],-1)),e("div",Me,[e("table",Le,[t[19]||(t[19]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item Code"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Warehouse"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"MAC Small"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"MAC Medium"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"MAC Large"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item Price"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"MAC Medium+12%"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Last Updated")])],-1)),e("tbody",Ae,[(n(!0),d(g,null,h(o.items.data||[],s=>(n(),d("tr",{key:`${s.item_id}-${s.warehouse_name}`,class:"hover:bg-gray-50"},[e("td",Se,a(s.item_code||"-"),1),e("td",Ie,a(s.item_name),1),e("td",De,a(s.warehouse_name||"-"),1),e("td",Fe,a(u(s.current_cost||0,s.small_unit_name)),1),e("td",Te,a(u(v(s),s.medium_unit_name)),1),e("td",$e,a(u(w(s),s.large_unit_name)),1),e("td",Ee,a(b(s.item_price||0)),1),e("td",Be,a(b(s.mac_plus_12||0)),1),e("td",Ue,[e("span",{class:Q([U(s),"px-2 py-1 rounded-full text-xs font-medium"])},a(k(s)),3)]),e("td",Pe,a(B(s.last_updated)),1)]))),128))])])]),o.items&&o.items.links&&o.items.links.length>3?(n(),d("div",Re,[e("div",Ne,[e("div",je," Showing "+a(o.items.from||0)+" to "+a(o.items.to||0)+" of "+a(o.items.total||0)+" results ",1),e("div",qe,[(n(!0),d(g,null,h(o.items.links,(s,c)=>(n(),d(g,{key:c},[s&&s.url&&!s.active?(n(),d("a",{key:0,onClick:X(A=>N(s.url),["prevent"]),href:"#",class:"px-3 py-2 text-sm rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 cursor-pointer",innerHTML:s.label},null,8,He)):s&&s.active?(n(),d("span",{key:1,class:"px-3 py-2 text-sm rounded-lg bg-blue-600 text-white",innerHTML:s.label},null,8,We)):s?(n(),d("span",{key:2,class:"px-3 py-2 text-sm rounded-lg cursor-not-allowed opacity-50 bg-gray-200 text-gray-500",innerHTML:s.label},null,8,Oe)):T("",!0)],64))),128))])])])):T("",!0)])])]),_:1}))}};export{tt as default};
