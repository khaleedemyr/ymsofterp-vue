import{r as m,c as se,A as _,B as n,C as D,D as e,L as r,E as d,N as l,x as oe,Q as U,S as $,G as g,l as w,F as q,M as V,H as O,J as L,W as k}from"./vendor-vue-g7iCcTkf.js";import{A as le}from"./AppLayout-zPRaA07p.js";import{a as C}from"./vendor-utils-CpgP2uT4.js";import"./app-_bo91XrJ.js";import"./vendor-charts-CuqD4wLC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CKY7MlXM.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";const ae={class:"p-6"},ne={class:"flex justify-between items-center mb-6"},re={class:"text-gray-600"},de={class:"flex space-x-2"},ie={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ue={class:"lg:col-span-2 space-y-6"},me={class:"bg-white rounded-lg shadow-sm border p-6"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={class:"text-lg font-semibold text-gray-900"},ce={class:"text-lg font-semibold text-gray-900"},ge={class:"text-lg font-semibold text-gray-900 capitalize"},fe={class:"text-lg font-semibold text-gray-900"},xe={key:0},be={class:"text-lg font-semibold text-gray-900"},ve={key:1},he={class:"text-lg font-semibold text-gray-900"},we={key:2},ke={class:"text-lg font-semibold text-gray-900"},Ce={class:"bg-white rounded-lg shadow-sm border p-6"},De={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Pe={class:"text-lg font-semibold text-gray-900"},je={class:"text-lg font-semibold text-gray-900"},Ae={class:"text-lg font-semibold text-gray-900"},Ne={class:"text-lg font-semibold text-gray-900"},Fe={key:0,class:"bg-white rounded-lg shadow-sm border p-6"},Se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ie={class:"text-lg font-semibold text-gray-900"},Be={class:"text-lg font-semibold text-gray-900"},Re={class:"bg-white rounded-lg shadow-sm border p-6"},Me={class:"flex justify-between items-center mb-4"},ze={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Ee={class:"flex items-center justify-between mb-2"},_e={class:"flex items-center gap-2"},Ue={class:"text-sm font-medium text-gray-900 truncate"},$e={class:"flex space-x-1"},qe=["onClick"],Ve=["onClick"],Oe={class:"text-xs text-gray-500"},Le={key:1,class:"text-center py-8 text-gray-500"},Ge={class:"space-y-6"},We={class:"bg-white rounded-lg shadow-sm border p-6"},Je={class:"space-y-3"},He={class:"text-lg font-semibold text-gray-900"},Ke={key:0},Qe={class:"text-sm text-gray-900"},Te={key:1},Xe={class:"text-sm text-gray-900"},Ye={class:"bg-white rounded-lg shadow-sm border p-6"},Ze={key:0,class:"space-y-3"},et={class:"font-medium text-gray-900"},tt={class:"text-sm text-gray-600"},st={key:1,class:"text-center py-4 text-gray-500"},ot={key:0,class:"bg-white rounded-lg shadow-sm border p-6"},lt={class:"space-y-3"},at={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},nt={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},rt={class:"mt-3"},dt={class:"flex justify-end space-x-2 mt-4"},it={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ut={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},mt={class:"mt-3"},yt={class:"flex justify-end space-x-2 mt-4"},pt={key:2,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ct={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},gt={class:"mt-3"},ft={class:"flex justify-end space-x-2 mt-4"},At={__name:"Show",props:{payment:Object},setup(s){const f=s,x=m(!1),b=m(!1),v=m(!1),h=m(""),y=m(""),G=m(null),W=se(()=>{var o;return(o=f.payment.approval_flows)==null?void 0:o.some(t=>{var u,i;return t.status==="PENDING"&&t.approver_id===((i=(u=window.auth)==null?void 0:u.user)==null?void 0:i.id)})}),P=o=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",paid:"bg-blue-100 text-blue-800",rejected:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800",J=o=>({PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800"})[o]||"bg-gray-100 text-gray-800",H=o=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o),p=o=>new Date(o).toLocaleDateString("id-ID"),K=o=>{if(o===0)return"0 Bytes";const t=1024,u=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(o)/Math.log(t));return parseFloat((o/Math.pow(t,i)).toFixed(2))+" "+u[i]},Q=o=>o.startsWith("image/")?"fas fa-image":o.includes("pdf")?"fas fa-file-pdf":o.includes("word")?"fas fa-file-word":o.includes("excel")||o.includes("spreadsheet")?"fas fa-file-excel":"fas fa-file",T=async o=>{const t=o.target.files[0];if(!t)return;const u=new FormData;u.append("file",t);try{(await C.post(route("payments.attachments.store",f.payment.id),u,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(k.reload(),x.value=!1)}catch(i){console.error("Upload error:",i),alert("Failed to upload file")}},X=o=>{window.open(route("payments.attachments.download",o.id),"_blank")},Y=async o=>{if(confirm("Are you sure you want to delete this attachment?"))try{(await C.delete(route("payments.attachments.destroy",o.id))).data.success&&k.reload()}catch(t){console.error("Delete error:",t),alert("Failed to delete attachment")}},Z=async()=>{try{(await C.post(route("payments.approve",f.payment.id),{comments:h.value})).data.success&&(k.reload(),b.value=!1,h.value="")}catch(o){console.error("Approval error:",o),alert("Failed to approve payment")}},ee=async()=>{if(!y.value.trim()){alert("Please provide a reason for rejection");return}try{(await C.post(route("payments.reject",f.payment.id),{comments:y.value})).data.success&&(k.reload(),v.value=!1,y.value="")}catch(o){console.error("Rejection error:",o),alert("Failed to reject payment")}};return(o,t)=>(n(),_(le,null,{default:D(()=>{var u,i,j,A,N,F,S,I,B,R,M,z,E;return[e("div",ae,[e("div",ne,[e("div",null,[t[8]||(t[8]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Payment Details",-1)),e("p",re,"Payment Number: "+l(s.payment.payment_number),1)]),e("div",de,[s.payment.status==="pending"?(n(),_(U($),{key:0,href:o.route("payments.edit",s.payment.id),class:"bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg flex items-center gap-2"},{default:D(()=>t[9]||(t[9]=[e("i",{class:"fas fa-edit"},null,-1),g(" Edit Payment ")])),_:1},8,["href"])):d("",!0),oe(U($),{href:o.route("payments.index"),class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center gap-2"},{default:D(()=>t[10]||(t[10]=[e("i",{class:"fas fa-arrow-left"},null,-1),g(" Back to Payments ")])),_:1},8,["href"])])]),e("div",ie,[e("div",ue,[e("div",me,[t[19]||(t[19]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Payment Information",-1)),e("div",ye,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-600"},"Payment Number",-1)),e("p",pe,l(s.payment.payment_number),1)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-600"},"Status",-1)),e("span",{class:w([P(s.payment.status),"inline-flex px-3 py-1 text-sm font-semibold rounded-full"])},l(s.payment.status),3)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-600"},"Amount",-1)),e("p",ce,l(H(s.payment.amount)),1)]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-600"},"Payment Method",-1)),e("p",ge,l(s.payment.payment_method),1)]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-600"},"Payment Date",-1)),e("p",fe,l(p(s.payment.payment_date)),1)]),s.payment.due_date?(n(),r("div",xe,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-600"},"Due Date",-1)),e("p",be,l(p(s.payment.due_date)),1)])):d("",!0),s.payment.reference_number?(n(),r("div",ve,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-600"},"Reference Number",-1)),e("p",he,l(s.payment.reference_number),1)])):d("",!0),s.payment.description?(n(),r("div",we,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-600"},"Description",-1)),e("p",ke,l(s.payment.description),1)])):d("",!0)])]),e("div",Ce,[t[24]||(t[24]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Purchase Requisition Information",-1)),e("div",De,[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-600"},"PR Number",-1)),e("p",Pe,l((u=s.payment.purchase_requisition)==null?void 0:u.number),1)]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-600"},"Division",-1)),e("p",je,l((j=(i=s.payment.purchase_requisition)==null?void 0:i.division)==null?void 0:j.nama_divisi),1)]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-600"},"Created By",-1)),e("p",Ae,l((N=(A=s.payment.purchase_requisition)==null?void 0:A.creator)==null?void 0:N.nama_lengkap),1)]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-600"},"Created Date",-1)),e("p",Ne,l(p((F=s.payment.purchase_requisition)==null?void 0:F.created_at)),1)])])]),s.payment.purchase_order?(n(),r("div",Fe,[t[28]||(t[28]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Purchase Order Information",-1)),e("div",Se,[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-600"},"PO Number",-1)),e("p",Ie,l((S=s.payment.purchase_order)==null?void 0:S.number),1)]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-600"},"PO Status",-1)),e("span",{class:w([P((I=s.payment.purchase_order)==null?void 0:I.status),"inline-flex px-3 py-1 text-sm font-semibold rounded-full"])},l((B=s.payment.purchase_order)==null?void 0:B.status),3)]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-600"},"PO Created Date",-1)),e("p",Be,l(p((R=s.payment.purchase_order)==null?void 0:R.created_at)),1)])])])):d("",!0),e("div",Re,[e("div",Me,[t[30]||(t[30]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Attachments",-1)),s.payment.status==="pending"?(n(),r("button",{key:0,onClick:t[0]||(t[0]=a=>x.value=!0),class:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-md text-sm flex items-center gap-2"},t[29]||(t[29]=[e("i",{class:"fas fa-plus"},null,-1),g(" Upload File ")]))):d("",!0)]),s.payment.attachments&&s.payment.attachments.length>0?(n(),r("div",ze,[(n(!0),r(q,null,V(s.payment.attachments,a=>{var c;return n(),r("div",{key:a.id,class:"border rounded-lg p-4 hover:shadow-md transition-shadow"},[e("div",Ee,[e("div",_e,[e("i",{class:w([Q(a.mime_type),"text-blue-600"])},null,2),e("span",Ue,l(a.file_name),1)]),e("div",$e,[e("button",{onClick:te=>X(a),class:"text-blue-600 hover:text-blue-800",title:"Download"},t[31]||(t[31]=[e("i",{class:"fas fa-download"},null,-1)]),8,qe),s.payment.status==="pending"?(n(),r("button",{key:0,onClick:te=>Y(a),class:"text-red-600 hover:text-red-800",title:"Delete"},t[32]||(t[32]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ve)):d("",!0)])]),e("div",Oe,[e("p",null,"Size: "+l(K(a.file_size)),1),e("p",null,"Uploaded by: "+l((c=a.uploader)==null?void 0:c.nama_lengkap),1),e("p",null,"Date: "+l(p(a.created_at)),1)])])}),128))])):(n(),r("div",Le,t[33]||(t[33]=[e("i",{class:"fas fa-file text-4xl mb-2"},null,-1),e("p",null,"No attachments uploaded",-1)])))])]),e("div",Ge,[e("div",We,[t[37]||(t[37]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Supplier Information",-1)),e("div",Je,[e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-gray-600"},"Supplier Name",-1)),e("p",He,l((M=s.payment.supplier)==null?void 0:M.nama_supplier),1)]),(z=s.payment.supplier)!=null&&z.alamat?(n(),r("div",Ke,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-600"},"Address",-1)),e("p",Qe,l(s.payment.supplier.alamat),1)])):d("",!0),(E=s.payment.supplier)!=null&&E.telepon?(n(),r("div",Te,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-600"},"Phone",-1)),e("p",Xe,l(s.payment.supplier.telepon),1)])):d("",!0)])]),e("div",Ye,[t[39]||(t[39]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Approval Status",-1)),s.payment.approval_flows&&s.payment.approval_flows.length>0?(n(),r("div",Ze,[(n(!0),r(q,null,V(s.payment.approval_flows,a=>{var c;return n(),r("div",{key:a.id,class:"flex items-center justify-between p-3 border rounded-lg"},[e("div",null,[e("p",et,"Level "+l(a.approval_level),1),e("p",tt,l((c=a.approver)==null?void 0:c.nama_lengkap),1)]),e("span",{class:w([J(a.status),"px-2 py-1 text-xs font-semibold rounded-full"])},l(a.status),3)])}),128))])):(n(),r("div",st,t[38]||(t[38]=[e("p",null,"No approval flows configured",-1)])))]),W.value?(n(),r("div",ot,[t[42]||(t[42]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Payment Actions",-1)),e("div",lt,[e("button",{onClick:t[1]||(t[1]=a=>b.value=!0),class:"w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md flex items-center justify-center gap-2"},t[40]||(t[40]=[e("i",{class:"fas fa-check"},null,-1),g(" Approve Payment ")])),e("button",{onClick:t[2]||(t[2]=a=>v.value=!0),class:"w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md flex items-center justify-center gap-2"},t[41]||(t[41]=[e("i",{class:"fas fa-times"},null,-1),g(" Reject Payment ")]))])])):d("",!0)])]),x.value?(n(),r("div",at,[e("div",nt,[e("div",rt,[t[43]||(t[43]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Upload Attachment",-1)),e("input",{ref_key:"fileInput",ref:G,type:"file",onChange:T,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),e("div",dt,[e("button",{onClick:t[3]||(t[3]=a=>x.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Cancel ")])])])])):d("",!0),b.value?(n(),r("div",it,[e("div",ut,[e("div",mt,[t[44]||(t[44]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Approve Payment",-1)),O(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=a=>h.value=a),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add comments (optional)"},null,512),[[L,h.value]]),e("div",yt,[e("button",{onClick:t[5]||(t[5]=a=>b.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:Z,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700"}," Approve ")])])])])):d("",!0),v.value?(n(),r("div",pt,[e("div",ct,[e("div",gt,[t[45]||(t[45]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Reject Payment",-1)),O(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=a=>y.value=a),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Reason for rejection (required)",required:""},null,512),[[L,y.value]]),e("div",ft,[e("button",{onClick:t[7]||(t[7]=a=>v.value=!1),class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:ee,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"}," Reject ")])])])])):d("",!0)])]}),_:1}))}};export{At as default};
