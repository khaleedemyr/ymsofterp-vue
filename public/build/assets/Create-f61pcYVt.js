import{r as _,P as fe,c as D,a as be,A as ye,B as i,C as W,D as e,L as r,E as f,x as X,G as d,Q as y,S as xe,H as g,J as h,a6 as Y,V as ge,N as u,F as j,M as L,l as w,O as Z}from"./vendor-vue-g7iCcTkf.js";import{A as _e}from"./AppLayout-BaHOzAR0.js";import{a as z}from"./vendor-utils-CpgP2uT4.js";import{S}from"./app-e_83ELsm.js";import{s as ve}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-DOFHeIjT.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const he={class:"w-full py-8 px-4 relative"},ke={key:0,class:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 rounded-lg"},we={class:"flex justify-between items-center mb-6"},Pe={class:"bg-white rounded-xl shadow-lg p-6"},De={class:"mb-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200"},Ce={class:"grid grid-cols-2 gap-4"},Fe={class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},Ie={class:"flex items-center justify-between mb-3"},Re={class:"space-y-3"},je={class:"flex items-center space-x-4"},Le={class:"flex items-center"},Se={class:"flex items-center"},Te={key:0},Oe={class:"mb-6"},Ne={class:"flex items-center"},Ee={class:"mb-6"},Ve={class:"mb-6"},qe={class:"relative"},Be={key:0,class:"mt-2 text-sm text-gray-600"},Me={key:0,class:"text-center py-8"},Ue={key:1,class:"text-center py-8"},$e={key:2,class:"text-center py-8"},Ae={class:"text-gray-600"},ze={key:3,class:"space-y-6"},Ge={class:"flex items-center justify-between"},He={class:"flex items-center space-x-4 flex-1"},Je=["onClick","disabled"],Qe={class:"flex-1"},Ke={class:"flex items-center gap-2 mb-1"},We={class:"text-lg font-semibold text-gray-900"},Xe={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},Ye={class:"text-sm text-gray-600"},Ze={class:"text-sm text-gray-500"},et={key:0,class:"text-sm text-red-600 mt-1"},tt={class:"text-sm text-gray-500"},st={key:0,class:"p-4"},lt={key:0,class:"mb-6 p-4 bg-blue-50 rounded-lg"},nt={class:"text-md font-semibold text-gray-900 mb-3 flex items-center"},ot={class:"ml-2 bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full"},at={key:0,class:"text-sm font-semibold text-gray-700 mb-2 flex items-center"},it={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},rt={class:"flex items-center space-x-3 flex-1"},ut={key:0,class:"relative"},dt=["src","alt","onClick"],ct={class:"flex-1 min-w-0"},mt={class:"text-sm font-medium text-gray-900 truncate"},pt={class:"flex items-center space-x-2 text-xs text-gray-500"},ft={class:"flex items-center space-x-1"},bt=["onClick"],yt=["onClick"],xt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},gt={class:"flex items-center space-x-3 flex-1"},_t={key:0,class:"relative"},vt=["src","alt","onClick"],ht={class:"flex-1 min-w-0"},kt={class:"text-sm font-medium text-gray-900 truncate"},wt={class:"flex items-center space-x-2 text-xs text-gray-500"},Pt={class:"flex items-center space-x-1"},Dt=["onClick"],Ct=["onClick"],Ft={key:1,class:"space-y-4"},It={class:"flex items-center justify-between mb-3"},Rt={class:"flex-1"},jt={class:"font-medium text-gray-900"},Lt={class:"text-sm text-gray-600"},St={key:0,class:"flex flex-wrap gap-2 mt-2"},Tt={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Ot={key:1,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},Nt=["onClick"],Et={class:"space-y-3"},Vt=["onUpdate:modelValue"],qt=["onUpdate:modelValue"],Bt=["onUpdate:modelValue","onInput"],Mt=["onUpdate:modelValue","onInput"],Ut={key:0,class:"text-xs text-gray-600"},$t={class:"text-sm font-medium"},At={class:"flex space-x-1"},zt=["onClick"],Gt={class:"mt-6 p-4 bg-gray-50 rounded-lg"},Ht={class:"space-y-2"},Jt={class:"flex justify-between"},Qt={class:"font-medium"},Kt={key:0,class:"flex justify-between"},Wt={class:"font-medium text-red-600"},Xt={class:"flex justify-between"},Yt={class:"font-medium"},Zt={key:1,class:"flex justify-between"},es={class:"font-medium text-red-600"},ts={class:"flex justify-between"},ss={class:"font-medium"},ls={key:2,class:"flex justify-between"},ns={class:"font-medium text-blue-600"},os={class:"flex justify-between border-t pt-2"},as={class:"text-xl font-bold text-green-600"},is={class:"mt-6 flex justify-end"},rs=["disabled"],us={key:0,class:"fas fa-spinner fa-spin mr-2"},ds={key:1,class:"fas fa-plus mr-2"},cs=["src","alt"],ms={class:"absolute bottom-4 left-4 right-4 text-center"},ps={class:"text-white bg-black bg-opacity-50 px-3 py-1 rounded-lg text-sm"},fs={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},bs={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full"},ys={class:"bg-blue-600 px-6 py-4 flex items-center justify-between"},xs={class:"bg-gray-50 px-6 py-4 flex justify-end"},Ls={__name:"Create",setup(gs){const k=_([]),G=_([]),V=_(!1),C=_(!1),O=_({}),q=_(""),F=_(!1),v=_(""),a=fe({items_by_supplier:{},ppn_enabled:!1,discount_total_percent:0,discount_total_amount:0,payment_type:"lunas",payment_terms:""}),ee=async()=>{try{V.value=!0;const t=((await z.get("/api/pr-ops/available")).data||[]).filter(l=>{const s=(l.mode||"pr_ops").toString().toLowerCase(),o=(l.status||"").toString().toUpperCase();return s==="pr_ops"&&["APPROVED","PROCESSED","COMPLETED","PAID"].includes(o)});k.value=t.map(l=>{const s=l.is_held===!0||l.is_held===1||l.is_held==="1"||l.is_held==="true",o={...l,is_held:s,hold_reason:l.hold_reason||null,items:l.items.map(p=>(a.items_by_supplier[p.id]||(a.items_by_supplier[p.id]=[{supplier_id:null,qty:p.qty,price:"",discount_percent:0,discount_amount:0,last_price:"",min_price:"",max_price:""}]),{...p}))};return s&&console.log("Held PR found:",o.number,"Reason:",o.hold_reason),o})}catch(n){console.error("Error fetching PR list:",n),S.fire("Error","Failed to fetch PR list","error")}finally{V.value=!1}},te=async()=>{try{const n=await z.get("/api/suppliers");G.value=n.data}catch(n){console.error("Error fetching suppliers:",n)}},se=n=>{const t=k.value.find(l=>l.id===n);if(t&&t.is_held){S.fire("Warning","PR yang sedang di-hold tidak dapat di-expand. Silakan release PR terlebih dahulu.","warning");return}O.value[n]=!O.value[n]},le=(n,t)=>{a.items_by_supplier[n]||(a.items_by_supplier[n]=[]),a.items_by_supplier[n].push({supplier_id:t,qty:0,price:"",discount_percent:0,discount_amount:0,last_price:"",min_price:"",max_price:""})},ne=(n,t)=>{a.items_by_supplier[n]&&a.items_by_supplier[n].length>1&&a.items_by_supplier[n].splice(t,1)},oe=(n,t)=>{const l=a.items_by_supplier[n][t];if(l&&l.qty&&l.price){const s=parseFloat(l.qty)*parseFloat(l.price),o=parseFloat(l.discount_amount||0);return s-o}return 0};function ae(n,t){const l=a.items_by_supplier[n][t];if(l&&l.discount_percent>0&&l.price&&l.qty){const s=parseFloat(l.price)*parseFloat(l.qty);l.discount_amount=s*(l.discount_percent/100)}else l&&l.discount_percent===0&&(l.discount_amount=0)}function ie(n,t){const l=a.items_by_supplier[n][t];if(l&&l.discount_amount>0&&l.price&&l.qty){const s=parseFloat(l.price)*parseFloat(l.qty);l.discount_percent=l.discount_amount/s*100}else l&&l.discount_amount===0&&(l.discount_percent=0)}const H=D(()=>{let n=0;return Object.values(a.items_by_supplier).forEach(t=>{t.forEach(l=>{l.qty&&l.price&&(n+=parseFloat(l.qty)*parseFloat(l.price))})}),n}),B=D(()=>{let n=0;return Object.values(a.items_by_supplier).forEach(t=>{t.forEach(l=>{if(l.qty&&l.price){const s=parseFloat(l.qty)*parseFloat(l.price),o=parseFloat(l.discount_percent||0),p=parseFloat(l.discount_amount||0);o>0?n+=s*(o/100):n+=p}})}),n}),P=D(()=>H.value-B.value),M=D(()=>{const n=parseFloat(a.discount_total_percent||0),t=parseFloat(a.discount_total_amount||0);return n>0?P.value*(n/100):t}),U=D(()=>P.value-M.value),re=D(()=>{let n=U.value;return a.ppn_enabled&&(n+=n*.11),n});function ue(){a.discount_total_percent>0&&P.value>0?a.discount_total_amount=P.value*(a.discount_total_percent/100):a.discount_total_percent===0&&(a.discount_total_amount=0)}function de(){a.discount_total_amount>0&&P.value>0?a.discount_total_percent=a.discount_total_amount/P.value*100:a.discount_total_amount===0&&(a.discount_total_percent=0)}const ce=async()=>{var n,t;try{C.value=!0;const l={};let s=!1;if(Object.keys(a.items_by_supplier).forEach(p=>{a.items_by_supplier[p].forEach(c=>{if(c.supplier_id&&c.qty&&c.price){const m=k.value.flatMap(R=>R.items).find(R=>R.id==p),x=k.value.find(R=>R.items&&R.items.some(pe=>pe.id==p));if(x&&x.is_held)return;s=!0;const b=typeof c.supplier_id=="object"?c.supplier_id.id:c.supplier_id;l[b]||(l[b]=[]),l[b].push({id:p,supplier_id:b,qty:parseFloat(c.qty),price:parseFloat(c.price),discount_percent:parseFloat(c.discount_percent||0),discount_amount:parseFloat(c.discount_amount||0),pr_id:m==null?void 0:m.pr_id,item_name:m==null?void 0:m.item_name,unit:m==null?void 0:m.unit,arrival_date:m==null?void 0:m.arrival_date})}})}),!s){S.fire("Error","Please select at least one item with supplier, quantity, and price","error");return}a.items_by_supplier=l,a.notes=q.value;const o=await z.post("/po-ops/generate",a.data());o.data.success?(S.fire("Success","Purchase Orders created successfully!","success"),window.location.href="/po-ops"):S.fire("Error",o.data.message||"Failed to create PO","error")}catch(l){console.error("Error creating PO:",l),S.fire("Error",((t=(n=l.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to create PO","error")}finally{C.value=!1}},T=n=>{if(!n)return!1;const t=["jpg","jpeg","png","gif","webp","bmp"],l=n.split(".").pop().toLowerCase();return t.includes(l)},N=n=>{if(!n)return"fa-file";const t=n.split(".").pop().toLowerCase();return{pdf:"fa-file-pdf text-red-500",doc:"fa-file-word text-blue-500",docx:"fa-file-word text-blue-500",xls:"fa-file-excel text-green-500",xlsx:"fa-file-excel text-green-500",ppt:"fa-file-powerpoint text-orange-500",pptx:"fa-file-powerpoint text-orange-500",jpg:"fa-file-image text-purple-500",jpeg:"fa-file-image text-purple-500",png:"fa-file-image text-purple-500",gif:"fa-file-image text-purple-500",txt:"fa-file-alt text-gray-500",zip:"fa-file-archive text-yellow-500",rar:"fa-file-archive text-yellow-500",webp:"fa-file-image text-purple-500",bmp:"fa-file-image text-purple-500"}[t]||"fa-file text-gray-500"},J=n=>{if(!n)return"0 Bytes";const t=1024,l=["Bytes","KB","MB","GB","TB"],s=Math.floor(Math.log(n)/Math.log(t));return parseFloat((n/Math.pow(t,s)).toFixed(2))+" "+l[s]},Q=n=>{window.open(`/purchase-requisitions/attachments/${n.id}/download`,"_blank")},$=_(!1),I=_(null),E=n=>{T(n.file_name)&&(I.value=n,$.value=!0)},K=()=>{$.value=!1,I.value=null},me=n=>{if(!n||n.length===0)return{};const t={};return n.forEach(l=>{var p;const s=l.outlet_id||"no-outlet",o=((p=l.outlet)==null?void 0:p.nama_outlet)||"General";t[s]||(t[s]={outlet_id:s,outlet_name:o,attachments:[]}),t[s].attachments.push(l)}),t},A=D(()=>{if(!v.value||v.value.trim()==="")return k.value;const n=v.value.toLowerCase().trim();return k.value.filter(t=>!!(t.number&&t.number.toLowerCase().includes(n)||t.title&&t.title.toLowerCase().includes(n)||t.division_name&&t.division_name.toLowerCase().includes(n)||t.status&&t.status.toLowerCase().includes(n)||t.date&&new Date(t.date).toLocaleDateString("id-ID").toLowerCase().includes(n)||new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t.amount||0).toLowerCase().includes(n)||t.description&&t.description.toLowerCase().includes(n)||t.items&&t.items.some(s=>!!(s.item_name&&s.item_name.toLowerCase().includes(n)||s.unit&&s.unit.toLowerCase().includes(n)||s.outlet&&s.outlet.nama_outlet&&s.outlet.nama_outlet.toLowerCase().includes(n)||s.category&&s.category.name&&s.category.name.toLowerCase().includes(n)))||t.outlet&&t.outlet.nama_outlet&&t.outlet.nama_outlet.toLowerCase().includes(n)||t.category&&t.category.name&&t.category.name.toLowerCase().includes(n)))});return be(()=>{ee(),te()}),(n,t)=>(i(),ye(_e,{title:"Create Purchase Order Ops"},{default:W(()=>{var l;return[e("div",he,[C.value?(i(),r("div",ke,t[17]||(t[17]=[e("div",{class:"bg-white p-6 rounded-lg shadow-lg flex items-center space-x-3"},[e("i",{class:"fas fa-spinner fa-spin text-blue-500 text-xl"}),e("span",{class:"text-gray-700 font-medium"},"Generating Purchase Orders...")],-1)]))):f("",!0),e("div",we,[t[19]||(t[19]=e("h1",{class:"text-2xl font-bold text-gray-800 flex items-center gap-2"},[e("i",{class:"fa-solid fa-plus text-blue-500"}),d(" Create Purchase Order Ops ")],-1)),X(y(xe),{href:"/po-ops",class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:W(()=>t[18]||(t[18]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),d(" Back to List ")])),_:1})]),e("div",Pe,[e("div",De,[t[22]||(t[22]=e("h4",{class:"text-sm font-semibold text-yellow-800 mb-3"},"Diskon Total",-1)),e("div",Ce,[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Diskon (%)",-1)),g(e("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=s=>y(a).discount_total_percent=s),min:"0",max:"100",step:"0.01",placeholder:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",onInput:ue},null,544),[[h,y(a).discount_total_percent,void 0,{number:!0}]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Diskon (Rp)",-1)),g(e("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=s=>y(a).discount_total_amount=s),min:"0",step:"0.01",placeholder:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",onInput:de},null,544),[[h,y(a).discount_total_amount,void 0,{number:!0}]])])])]),e("div",Fe,[e("div",Ie,[t[24]||(t[24]=e("h4",{class:"text-sm font-semibold text-blue-800"},"Metode Pembayaran",-1)),e("button",{type:"button",onClick:t[2]||(t[2]=s=>F.value=!0),class:"text-blue-600 hover:text-blue-800 text-xs font-medium flex items-center gap-1"},t[23]||(t[23]=[e("i",{class:"fa fa-question-circle"},null,-1),e("span",{class:"text-red-600 font-semibold"},"Klik disini untuk tutorial",-1)]))]),e("div",Re,[e("div",je,[e("label",Le,[g(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=s=>y(a).payment_type=s),value:"lunas",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[Y,y(a).payment_type]]),t[25]||(t[25]=e("span",{class:"ml-2 text-sm text-gray-700"},"Bayar Lunas",-1))]),e("label",Se,[g(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=s=>y(a).payment_type=s),value:"termin",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[Y,y(a).payment_type]]),t[26]||(t[26]=e("span",{class:"ml-2 text-sm text-gray-700"},"Termin Bayar",-1))])]),y(a).payment_type==="termin"?(i(),r("div",Te,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Detail Termin Pembayaran",-1)),g(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>y(a).payment_terms=s),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Contoh: 50% DP saat PO, 50% saat barang diterima"},null,512),[[h,y(a).payment_terms]])])):f("",!0)])]),e("div",Oe,[e("label",Ne,[g(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=s=>y(a).ppn_enabled=s),class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[ge,y(a).ppn_enabled]]),t[28]||(t[28]=e("span",{class:"ml-2 text-sm text-gray-700"},"Enable PPN (11%)",-1))])]),e("div",Ee,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notes",-1)),g(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=s=>q.value=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter notes..."},null,512),[[h,q.value]])]),e("div",Ve,[e("div",qe,[t[31]||(t[31]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("i",{class:"fas fa-search text-gray-400"})],-1)),g(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=s=>v.value=s),placeholder:"Search by PR number, title, division, date, amount, status, item name, outlet, category...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[h,v.value]]),v.value?(i(),r("button",{key:0,onClick:t[9]||(t[9]=s=>v.value=""),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600"},t[30]||(t[30]=[e("i",{class:"fas fa-times"},null,-1)]))):f("",!0)]),v.value?(i(),r("p",Be," Found "+u(A.value.length)+" of "+u(k.value.length)+" PR(s) ",1)):f("",!0)]),V.value?(i(),r("div",Me,t[32]||(t[32]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Loading PR data...",-1)]))):k.value.length===0?(i(),r("div",Ue,t[33]||(t[33]=[e("p",{class:"text-gray-600"},"No available PR found",-1)]))):A.value.length===0?(i(),r("div",$e,[e("p",Ae,'No PR found matching "'+u(v.value)+'"',1)])):(i(),r("div",ze,[(i(!0),r(j,null,L(A.value,s=>(i(),r("div",{key:s.id,class:w(["border border-gray-200 rounded-lg",s.is_held?"opacity-60":""])},[e("div",{class:w(["bg-gray-50 px-4 py-3 border-b border-gray-200",s.is_held?"bg-red-50":""])},[e("div",Ge,[e("div",He,[e("button",{onClick:o=>s.is_held?null:se(s.id),class:w(s.is_held?"text-gray-400 cursor-not-allowed":"text-blue-600 hover:text-blue-800"),disabled:s.is_held},[e("i",{class:w(O.value[s.id]?"fas fa-chevron-down":"fas fa-chevron-right")},null,2)],10,Je),e("div",Qe,[e("div",Ke,[e("h3",We,u(s.number),1),s.is_held?(i(),r("span",Xe,t[34]||(t[34]=[e("i",{class:"fas fa-lock mr-1"},null,-1),d(" ON HOLD ")]))):f("",!0)]),e("p",Ye,u(s.title)+" - "+u(s.division_name),1),e("p",Ze,"Amount: "+u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s.amount)),1),s.is_held&&s.hold_reason?(i(),r("p",et,[t[35]||(t[35]=e("i",{class:"fas fa-info-circle mr-1"},null,-1)),d(" "+u(s.hold_reason),1)])):f("",!0)])]),e("div",tt,u(new Date(s.date).toLocaleDateString("id-ID")),1)])],2),O.value[s.id]?(i(),r("div",st,[s.attachments&&s.attachments.length>0?(i(),r("div",lt,[e("h4",nt,[t[36]||(t[36]=e("i",{class:"fa fa-paperclip mr-2 text-blue-500"},null,-1)),t[37]||(t[37]=d(" Purchase Requisition Attachments ")),e("span",ot,u(s.attachments.length),1)]),s.attachments.some(o=>o.outlet)?(i(!0),r(j,{key:0},L(me(s.attachments),(o,p)=>(i(),r("div",{key:p,class:"mb-4 last:mb-0"},[p!=="no-outlet"?(i(),r("h5",at,[t[38]||(t[38]=e("i",{class:"fa fa-store mr-2 text-blue-500"},null,-1)),d(" Outlet: "+u(o.outlet_name),1)])):f("",!0),e("div",it,[(i(!0),r(j,null,L(o.attachments,c=>{var m;return i(),r("div",{key:c.id,class:"flex items-center p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",rt,[T(c.file_name)?(i(),r("div",ut,[e("img",{src:`/purchase-requisitions/attachments/${c.id}/view`,alt:c.file_name,class:"w-10 h-10 object-cover rounded border border-gray-300 cursor-pointer hover:opacity-80 transition-opacity",onClick:x=>E(c),onError:t[10]||(t[10]=x=>{x.target.style.display="none",x.target.nextElementSibling.style.display="block"})},null,40,dt),e("i",{class:w([N(c.file_name),"text-sm absolute inset-0 flex items-center justify-center bg-gray-100 rounded"]),style:{display:"none"}},null,2)])):(i(),r("i",{key:1,class:w([N(c.file_name),"text-lg text-gray-500"])},null,2)),e("div",ct,[e("p",mt,u(c.file_name),1),e("div",pt,[e("span",null,u(J(c.file_size)),1),t[39]||(t[39]=e("span",null,"•",-1)),e("span",null,u(((m=c.uploader)==null?void 0:m.nama_lengkap)||"Unknown"),1)])])]),e("div",ft,[T(c.file_name)?(i(),r("button",{key:0,onClick:x=>E(c),class:"p-1 text-green-600 hover:text-green-800 hover:bg-green-100 rounded transition-colors",title:"View Image"},t[40]||(t[40]=[e("i",{class:"fa fa-eye text-xs"},null,-1)]),8,bt)):f("",!0),e("button",{onClick:x=>Q(c),class:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded transition-colors",title:"Download"},t[41]||(t[41]=[e("i",{class:"fa fa-download text-xs"},null,-1)]),8,yt)])])}),128))])]))),128)):(i(),r("div",xt,[(i(!0),r(j,null,L(s.attachments,o=>{var p;return i(),r("div",{key:o.id,class:"flex items-center p-3 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",gt,[T(o.file_name)?(i(),r("div",_t,[e("img",{src:`/purchase-requisitions/attachments/${o.id}/view`,alt:o.file_name,class:"w-10 h-10 object-cover rounded border border-gray-300 cursor-pointer hover:opacity-80 transition-opacity",onClick:c=>E(o),onError:t[11]||(t[11]=c=>{c.target.style.display="none",c.target.nextElementSibling.style.display="block"})},null,40,vt),e("i",{class:w([N(o.file_name),"text-sm absolute inset-0 flex items-center justify-center bg-gray-100 rounded"]),style:{display:"none"}},null,2)])):(i(),r("i",{key:1,class:w([N(o.file_name),"text-lg text-gray-500"])},null,2)),e("div",ht,[e("p",kt,u(o.file_name),1),e("div",wt,[e("span",null,u(J(o.file_size)),1),t[42]||(t[42]=e("span",null,"•",-1)),e("span",null,u(((p=o.uploader)==null?void 0:p.nama_lengkap)||"Unknown"),1)])])]),e("div",Pt,[T(o.file_name)?(i(),r("button",{key:0,onClick:c=>E(o),class:"p-1 text-green-600 hover:text-green-800 hover:bg-green-100 rounded transition-colors",title:"View Image"},t[43]||(t[43]=[e("i",{class:"fa fa-eye text-xs"},null,-1)]),8,Dt)):f("",!0),e("button",{onClick:c=>Q(o),class:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded transition-colors",title:"Download"},t[44]||(t[44]=[e("i",{class:"fa fa-download text-xs"},null,-1)]),8,Ct)])])}),128))]))])):f("",!0),s.is_held?f("",!0):(i(),r("div",Ft,[(i(!0),r(j,null,L(s.items,o=>{var p,c;return i(),r("div",{key:o.id,class:"border border-gray-200 rounded-lg p-4"},[e("div",It,[e("div",Rt,[e("h4",jt,u(o.item_name),1),e("p",Lt,"Qty: "+u(o.qty)+" "+u(o.unit)+" | Unit Price: "+u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(o.unit_price)),1),o.outlet||o.category||s.outlet||s.category?(i(),r("div",St,[o.outlet||s.outlet?(i(),r("span",Tt,[t[45]||(t[45]=e("i",{class:"fa fa-store mr-1"},null,-1)),d(" Outlet: "+u((p=o.outlet||s.outlet)==null?void 0:p.nama_outlet),1)])):f("",!0),o.category||s.category?(i(),r("span",Ot,[t[46]||(t[46]=e("i",{class:"fa fa-tag mr-1"},null,-1)),d(" Category: "+u((c=o.category||s.category)==null?void 0:c.name),1)])):f("",!0)])):f("",!0)]),e("button",{onClick:m=>le(o.id,null),class:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600"},t[47]||(t[47]=[e("i",{class:"fas fa-plus mr-1"},null,-1),d(" Add Row ")]),8,Nt)]),e("div",Et,[(i(!0),r(j,null,L(y(a).items_by_supplier[o.id],(m,x)=>(i(),r("div",{key:x,class:"grid grid-cols-1 md:grid-cols-8 gap-3 items-end"},[e("div",null,[t[48]||(t[48]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Supplier",-1)),X(y(ve),{modelValue:m.supplier_id,"onUpdate:modelValue":b=>m.supplier_id=b,options:G.value,"custom-label":b=>b.name,placeholder:"Select Supplier",class:"text-sm"},null,8,["modelValue","onUpdate:modelValue","options","custom-label"])]),e("div",null,[t[49]||(t[49]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Qty",-1)),g(e("input",{type:"number","onUpdate:modelValue":b=>m.qty=b,min:"0",step:"0.01",class:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"},null,8,Vt),[[h,m.qty,void 0,{number:!0}]])]),e("div",null,[t[50]||(t[50]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Price",-1)),g(e("input",{type:"number","onUpdate:modelValue":b=>m.price=b,min:"0",step:"0.01",class:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"},null,8,qt),[[h,m.price,void 0,{number:!0}]])]),e("div",null,[t[51]||(t[51]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Diskon %",-1)),g(e("input",{type:"number","onUpdate:modelValue":b=>m.discount_percent=b,min:"0",max:"100",step:"0.01",onInput:b=>ae(o.id,x),class:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"%"},null,40,Bt),[[h,m.discount_percent,void 0,{number:!0}]])]),e("div",null,[t[52]||(t[52]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Diskon (Rp)",-1)),g(e("input",{type:"number","onUpdate:modelValue":b=>m.discount_amount=b,min:"0",step:"0.01",onInput:b=>ie(o.id,x),class:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Rp"},null,40,Mt),[[h,m.discount_amount,void 0,{number:!0}]])]),m.last_price?(i(),r("div",Ut,[e("div",null,"Last: "+u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(m.last_price)),1),e("div",null,"Min: "+u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(m.min_price)),1),e("div",null,"Max: "+u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(m.max_price)),1)])):f("",!0),e("div",$t,[t[53]||(t[53]=e("div",{class:"text-xs text-gray-600"},"Total",-1)),e("div",null,u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(oe(o.id,x))),1)]),e("div",At,[y(a).items_by_supplier[o.id].length>1?(i(),r("button",{key:0,onClick:b=>ne(o.id,x),class:"text-red-600 hover:text-red-800"},t[54]||(t[54]=[e("i",{class:"fas fa-trash"},null,-1)]),8,zt)):f("",!0)])]))),128))])])}),128))]))])):f("",!0)],2))),128))])),e("div",Gt,[t[62]||(t[62]=e("h3",{class:"text-lg font-semibold mb-3"},"Total Calculation",-1)),e("div",Ht,[e("div",Jt,[t[55]||(t[55]=e("span",{class:"text-gray-600"},"Subtotal:",-1)),e("span",Qt,u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(H.value)),1)]),B.value>0?(i(),r("div",Kt,[t[56]||(t[56]=e("span",{class:"text-gray-600"},"Diskon per Item:",-1)),e("span",Wt,"- "+u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(B.value)),1)])):f("",!0),e("div",Xt,[t[57]||(t[57]=e("span",{class:"text-gray-600"},"Subtotal setelah Diskon Item:",-1)),e("span",Yt,u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(P.value)),1)]),M.value>0?(i(),r("div",Zt,[t[58]||(t[58]=e("span",{class:"text-gray-600"},"Diskon Total:",-1)),e("span",es,"- "+u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(M.value)),1)])):f("",!0),e("div",ts,[t[59]||(t[59]=e("span",{class:"text-gray-600"},"Subtotal setelah Diskon Total:",-1)),e("span",ss,u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(U.value)),1)]),y(a).ppn_enabled?(i(),r("div",ls,[t[60]||(t[60]=e("span",{class:"text-gray-600"},"PPN (11%):",-1)),e("span",ns,u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(U.value*.11)),1)])):f("",!0),e("div",os,[t[61]||(t[61]=e("span",{class:"text-lg font-semibold"},"Grand Total:",-1)),e("span",as,u(new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(re.value)),1)])])]),e("div",is,[e("button",{onClick:ce,disabled:C.value,class:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"},[C.value?(i(),r("i",us)):(i(),r("i",ds)),d(" "+u(C.value?"Generating...":"Generate Purchase Orders"),1)],8,rs)])])]),$.value?(i(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",onClick:K},[e("div",{class:"relative max-w-4xl max-h-full p-4",onClick:t[12]||(t[12]=Z(()=>{},["stop"]))},[e("button",{onClick:K,class:"absolute top-2 right-2 z-10 p-2 text-white bg-black bg-opacity-50 rounded-full hover:bg-opacity-75 transition-colors"},t[63]||(t[63]=[e("i",{class:"fa fa-times text-xl"},null,-1)])),I.value?(i(),r("img",{key:0,src:`/purchase-requisitions/attachments/${I.value.id}/view`,alt:I.value.file_name,class:"max-w-full max-h-full object-contain rounded-lg"},null,8,cs)):f("",!0),e("div",ms,[e("p",ps,u((l=I.value)==null?void 0:l.file_name),1)])])])):f("",!0),F.value?(i(),r("div",{key:1,class:"fixed inset-0 z-50 overflow-y-auto",onClick:t[16]||(t[16]=Z(s=>F.value=!1,["self"]))},[e("div",fs,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t[13]||(t[13]=s=>F.value=!1)}),e("div",bs,[e("div",ys,[t[65]||(t[65]=e("h3",{class:"text-lg font-semibold text-white"},[e("i",{class:"fa fa-graduation-cap mr-2"}),d(" Tutorial: Metode Pembayaran (Payment Type) ")],-1)),e("button",{onClick:t[14]||(t[14]=s=>F.value=!1),class:"text-white hover:text-gray-200 focus:outline-none"},t[64]||(t[64]=[e("i",{class:"fa fa-times text-xl"},null,-1)]))]),t[66]||(t[66]=e("div",{class:"px-6 py-6 max-h-[70vh] overflow-y-auto"},[e("div",{class:"space-y-6"},[e("div",{class:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded"},[e("h4",{class:"font-semibold text-blue-800 mb-2"},[e("i",{class:"fa fa-info-circle mr-2"}),d(" Apa itu Metode Pembayaran? ")]),e("p",{class:"text-sm text-blue-700"},[d(" Metode pembayaran menentukan cara pembayaran untuk Purchase Order ini. Sistem mendukung dua jenis: "),e("strong",null,"Bayar Lunas"),d(" (pembayaran penuh sekaligus) dan "),e("strong",null,"Termin Bayar"),d(" (pembayaran bertahap). Pilihan ini akan mempengaruhi cara pembayaran di menu Non Food Payment nantinya. ")])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center font-bold"}," 1 "),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},[e("span",{class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 mr-2"}," Bayar Lunas "),d(" Pembayaran Penuh Sekaligus ")]),e("ul",{class:"text-sm text-gray-700 space-y-1 list-disc list-inside"},[e("li",null,[d("Pilih opsi "),e("strong",null,'"Bayar Lunas"'),d(" untuk pembayaran penuh sekaligus")]),e("li",null,"Cocok untuk pembayaran langsung setelah barang diterima"),e("li",null,[d("Di menu Non Food Payment, hanya bisa membuat "),e("strong",null,"1x pembayaran"),d(" dengan amount = Grand Total PO")]),e("li",null,"Tidak perlu mengisi detail termin")]),e("div",{class:"bg-green-50 border-l-4 border-green-500 p-3 rounded mt-2"},[e("p",{class:"text-xs text-green-800"},[e("i",{class:"fa fa-check-circle mr-1"}),e("strong",null,"Contoh:"),d(" PO dengan Grand Total Rp 10.000.000 → Payment 1x sebesar Rp 10.000.000 ")])])])])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold"}," 2 "),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},[e("span",{class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mr-2"}," Termin Bayar "),d(" Pembayaran Bertahap ")]),e("ul",{class:"text-sm text-gray-700 space-y-1 list-disc list-inside"},[e("li",null,[d("Pilih opsi "),e("strong",null,'"Termin Bayar"'),d(" untuk pembayaran bertahap")]),e("li",null,"Cocok untuk pembayaran yang dibagi menjadi beberapa termin"),e("li",null,[d("Di menu Non Food Payment, bisa membuat "),e("strong",null,"multiple payments"),d(" sampai lunas")]),e("li",null,[e("strong",null,"Wajib"),d(' mengisi "Detail Termin Pembayaran"')])]),e("div",{class:"bg-blue-50 border-l-4 border-blue-500 p-3 rounded mt-2"},[e("p",{class:"text-xs text-blue-800 mb-2"},[e("i",{class:"fa fa-info-circle mr-1"}),e("strong",null,"Detail Termin Pembayaran:")]),e("ul",{class:"text-xs text-blue-700 space-y-1 list-disc list-inside ml-4"},[e("li",null,'Contoh: "50% di muka, 50% setelah barang diterima"'),e("li",null,'Contoh: "30% di muka, 40% saat pengiriman, 30% setelah diterima"'),e("li",null,"Detail ini akan muncul di menu Non Food Payment sebagai referensi")])])])])]),e("div",{class:"border border-gray-200 rounded-lg p-4"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0 w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold"}," 3 "),e("div",{class:"ml-4 flex-1"},[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Dampak di Menu Non Food Payment"),e("div",{class:"space-y-3"},[e("div",{class:"bg-gray-50 p-3 rounded border border-gray-200"},[e("p",{class:"text-sm font-medium text-gray-900 mb-1"},[e("i",{class:"fa fa-check-circle text-green-500 mr-1"}),d(" Jika PO dengan "),e("strong",null,"Bayar Lunas"),d(": ")]),e("ul",{class:"text-xs text-gray-700 space-y-1 list-disc list-inside ml-4"},[e("li",null,"Hanya bisa membuat 1x payment"),e("li",null,"Amount harus = Grand Total PO"),e("li",null,"Jika sudah ada payment, tidak bisa buat payment baru")])]),e("div",{class:"bg-gray-50 p-3 rounded border border-gray-200"},[e("p",{class:"text-sm font-medium text-gray-900 mb-1"},[e("i",{class:"fa fa-calendar-alt text-blue-500 mr-1"}),d(" Jika PO dengan "),e("strong",null,"Termin Bayar"),d(": ")]),e("ul",{class:"text-xs text-gray-700 space-y-1 list-disc list-inside ml-4"},[e("li",null,"Bisa membuat multiple payments"),e("li",null,"Amount bisa ≤ Sisa Pembayaran"),e("li",null,"Sistem menampilkan: Total PO, Sudah Dibayar, Sisa Pembayaran"),e("li",null,"Progress bar visual untuk tracking pembayaran"),e("li",null,"Riwayat semua pembayaran untuk PO tersebut")])])])])])]),e("div",{class:"bg-amber-50 border-l-4 border-amber-500 p-4 rounded"},[e("h4",{class:"font-semibold text-amber-800 mb-2"},[e("i",{class:"fa fa-lightbulb mr-2"}),d(" Tips Penting ")]),e("ul",{class:"text-sm text-amber-700 space-y-1 list-disc list-inside"},[e("li",null,[d("Metode pembayaran "),e("strong",null,"tidak bisa diubah"),d(" setelah PO dibuat")]),e("li",null,"Pastikan pilih metode yang sesuai dengan kesepakatan dengan supplier"),e("li",null,"Untuk termin, isi detail termin dengan jelas untuk referensi di kemudian hari"),e("li",null,"Detail termin hanya sebagai catatan, sistem tidak memvalidasi apakah pembayaran sesuai detail termin")])])])],-1)),e("div",xs,[e("button",{onClick:t[15]||(t[15]=s=>F.value=!1),class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Tutup ")])])])])):f("",!0)]}),_:1}))}};export{Ls as default};
