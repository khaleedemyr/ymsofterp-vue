import{r as h,aa as ve,P as we,c as ee,a as ke,A as Ce,B as l,C as te,D as t,L as u,H as x,J as b,Q as y,V as D,E as m,x as M,G as S,N as d,F as v,M as k,l as O,O as se}from"./vendor-vue-g7iCcTkf.js";import{A as Pe}from"./AppLayout-BDukGJW2.js";import{a as U}from"./vendor-utils-CpgP2uT4.js";import{S as w}from"./app-DGqVli5-.js";import{s as T}from"./vue-multiselect.esm-V-bx43V9.js";/* empty css                            */import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ProfileUpdateModal-CnwZ944E.js";import"./InputLabel-Bg0AMQZ3.js";import"./PrimaryButton-BbBAD9SX.js";import"./TextInput-B7P_xVe4.js";import"./vendor-charts-CuqD4wLC.js";const qe={class:"py-12"},Ve={class:"w-full px-0"},Ue={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Re={class:"p-6 bg-white border-b border-gray-200"},Ne={class:"mb-6"},Ee={class:"mb-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200"},Ie={class:"grid grid-cols-2 gap-4"},Oe={class:"mb-6 flex items-center"},je={class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},$e={class:"flex flex-wrap gap-4 items-end"},Ae={class:"flex-1 min-w-64"},Be={class:"flex gap-2"},De=["disabled"],Me={key:0,class:"mt-3 text-sm text-blue-600"},Te={key:0,class:"flex justify-center items-center py-8"},Le={key:1},Ke={class:"mb-8"},Fe=["onClick"],Qe={class:"flex items-center"},ze={class:"font-semibold text-blue-800"},Ge={class:"ml-2 text-sm text-blue-600"},He={key:0},We=["onClick"],Je={class:"flex items-center"},Ye={class:"flex-1"},Xe={class:"font-medium"},Ze={key:0,class:"text-sm text-gray-600 mt-1"},et=["onClick"],tt={key:0,class:"p-4 border-t overflow-x-auto"},st={class:"overflow-x-auto"},ot={class:"min-w-full divide-y divide-gray-200"},nt={class:"bg-gray-50"},rt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},it=["onChange"],at={class:"bg-white divide-y divide-gray-200"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ut=["value"],dt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ct={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},pt=["onUpdate:modelValue","max"],mt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},_t={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},xt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},yt={key:0,class:"max-w-xs"},ft={class:"text-gray-600"},bt={key:1,class:"text-gray-400"},gt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ht={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},vt=["onUpdate:modelValue"],wt={class:"text-gray-400"},kt={key:0,class:"text-xs text-blue-500 mt-1"},Ct={key:0},Pt={key:0},St={key:1},qt={key:0},Vt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ut=["onUpdate:modelValue","onInput"],Rt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Nt=["onUpdate:modelValue","onInput"],Et={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},It={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ot=["onClick"],jt=["onClick"],$t={class:"mb-8"},At=["onClick"],Bt={class:"flex items-center"},Dt={class:"font-semibold text-green-800"},Mt={class:"ml-2 text-sm text-green-600"},Tt={key:0},Lt=["onClick"],Kt={class:"flex items-center"},Ft={class:"flex-1"},Qt={class:"font-medium"},zt={class:"ml-2 text-xs text-gray-500"},Gt=["onClick"],Ht={key:0,class:"p-4 border-t overflow-x-auto"},Wt={class:"overflow-x-auto"},Jt={class:"min-w-full divide-y divide-gray-200"},Yt={class:"bg-gray-50"},Xt={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Zt=["onChange"],es={class:"bg-white divide-y divide-gray-200"},ts={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ss=["value"],os={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ns={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},rs=["onUpdate:modelValue","max"],is={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},as={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ls={key:0,class:"max-w-xs"},us={class:"text-gray-600"},ds={key:1,class:"text-gray-400"},cs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ps={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ms=["onUpdate:modelValue"],_s={class:"text-gray-400"},xs={key:0,class:"text-xs text-blue-500 mt-1"},ys={key:0},fs={key:0},bs={key:1},gs={key:0},hs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},vs=["onUpdate:modelValue","onInput"],ws={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ks=["onUpdate:modelValue","onInput"],Cs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ps={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ss=["onClick"],qs=["onClick"],Vs={class:"mt-6 bg-gray-50 p-4 rounded-lg"},Us={class:"space-y-2"},Rs={class:"flex justify-between"},Ns={class:"font-medium"},Es={key:0,class:"flex justify-between"},Is={class:"font-medium text-red-600"},Os={class:"flex justify-between"},js={class:"font-medium"},$s={key:1,class:"flex justify-between"},As={class:"font-medium text-red-600"},Bs={class:"flex justify-between"},Ds={class:"font-medium"},Ms={key:2,class:"flex justify-between"},Ts={class:"font-medium text-blue-600"},Ls={class:"flex justify-between border-t pt-2"},Ks={class:"text-lg font-bold text-green-600"},Fs={class:"mt-6 flex justify-end"},Qs=["disabled"],zs={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Gs={__name:"CreatePurchaseOrderFoods",setup(Hs){const q=h([]),C=h([]),N=h([]),g=h(!1),E=h({}),I=h({}),V=h({}),j=h("");ve();const a=we({items_by_supplier:{},ppn_enabled:!1,discount_total_percent:0,discount_total_amount:0}),oe=async()=>{try{g.value=!0;const s=await U.get("/pr-foods/available");q.value=s.data.map(e=>({...e,items:e.items.map(o=>(a.items_by_supplier[o.id]||(a.items_by_supplier[o.id]=[{supplier_id:null,qty:o.quantity,price:"",discount_percent:0,discount_amount:0,last_price:"",min_price:"",max_price:""}]),{...o}))}))}catch(s){console.error("Error fetching PR list:",s),w.fire("Error","Failed to fetch PR list","error")}finally{g.value=!1}},ne=async()=>{try{g.value=!0;let e=(await U.get("/api/floor-order/supplier-available")).data;!Array.isArray(e)&&typeof e=="object"&&e!==null&&(e=Object.values(e)),Array.isArray(e)||(e=[]),C.value=e.map(o=>({...o,items:(o.items||[]).map(n=>{const i=`ro_${o.id}_${n.id}`;return a.items_by_supplier[i]||(a.items_by_supplier[i]=[{supplier_id:null,qty:n.qty,price:"",discount_percent:0,discount_amount:0,last_price:"",min_price:"",max_price:"",ro_id:o.id,ro_number:o.order_number}]),{...n,itemKey:i,ro_id:o.id,ro_number:o.order_number}})}))}catch(s){console.error("Error fetching RO Supplier list:",s),w.fire("Error","Failed to fetch RO Supplier list","error")}finally{g.value=!1}},re=ee(()=>{const s={};return q.value.forEach(e=>{const o=e.warehouse_id||"unknown",n=e.warehouse_name||"Unknown Warehouse";s[o]||(s[o]={id:o,name:n,prs:[]}),s[o].prs.push(e)}),s}),ie=ee(()=>{const s={};return!C.value||C.value.length===0||C.value.forEach(e=>{const o=e.id_outlet||"unknown",n=e.outlet_name||"Unknown Outlet";s[o]||(s[o]={id:o,name:n,ros:[]}),s[o].ros.push(e)}),s}),ae=async()=>{try{const s=await U.get("/api/suppliers");N.value=s.data}catch(s){console.error("Error fetching suppliers:",s),w.fire("Error","Failed to fetch suppliers","error")}},le=s=>{E.value[s]=!E.value[s]},ue=s=>{I.value[s]=!I.value[s]},L=s=>{V.value[s]=!V.value[s]},P=h(null),f=h([]),K=s=>{const e=q.value.find(o=>o.id===s);e&&(f.value=e.items.map(o=>o.id))},F=s=>{const e=C.value.find(o=>o.id===s);e&&(f.value=e.items.map(o=>o.itemKey))},de=()=>{if(!P.value){w.fire("Error","Pilih supplier terlebih dahulu","error");return}if(f.value.length===0){w.fire("Error","Pilih item terlebih dahulu","error");return}f.value.forEach(s=>{a.items_by_supplier[s]&&a.items_by_supplier[s].forEach(e=>{e.supplier_id=P.value})}),w.fire("Success","Supplier berhasil diterapkan ke item yang dipilih","success"),f.value=[],P.value=null},ce=()=>{f.value=[],P.value=null};function Q(s){a.items_by_supplier[s].push({supplier_id:null,qty:0,price:"",discount_percent:0,discount_amount:0,last_price:"",min_price:"",max_price:""})}function z(s,e){a.items_by_supplier[s].length>1&&a.items_by_supplier[s].splice(e,1)}function G(s,e=-1){return a.items_by_supplier[s].filter((o,n)=>n!==e).reduce((o,n)=>o+Number(n.qty||0),0)}async function pe(){for(const[s,e]of Object.entries(a.items_by_supplier)){const o=e.reduce((i,r)=>i+Number(r.qty||0),0),n=q.value.flatMap(i=>i.items).find(i=>i.id==s);if(n&&o>n.quantity)return(await w.fire({title:"Quantity Exceeds PR",text:`Total qty split untuk item "${n.name}" (${o}) melebihi qty PR (${n.quantity}). Apakah Anda yakin ingin melanjutkan?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Lanjutkan",cancelButtonText:"Batal"})).isConfirmed}return!0}const me=async()=>{if(!await pe())return;const s={};Object.entries(a.items_by_supplier).forEach(([e,o])=>{o.forEach(n=>{const i=n.supplier_id?n.supplier_id.id:null;if(!(!i||!n.price||!n.qty||n.qty<0))if(s[i]||(s[i]=[]),n.ro_id){const r=C.value.find(c=>c.id===n.ro_id),p=r==null?void 0:r.items.find(c=>c.id===Number(e.split("_")[2]));s[i].push({ro_id:n.ro_id,ro_number:n.ro_number,item_id:(p==null?void 0:p.item_id)||Number(e.split("_")[2]),item_name:(p==null?void 0:p.item_name)||"Unknown Item",unit:(p==null?void 0:p.unit)||null,arrival_date:(p==null?void 0:p.arrival_date)||null,supplier_id:i,qty:n.qty,price:n.price,discount_percent:n.discount_percent||0,discount_amount:n.discount_amount||0,source:"ro_supplier"})}else{const r=q.value.flatMap(p=>p.items).find(p=>p.id==e);s[i].push({id:Number(e),supplier_id:i,qty:n.qty,price:n.price,discount_percent:n.discount_percent||0,discount_amount:n.discount_amount||0,arrival_date:(r==null?void 0:r.arrival_date)||null,source:"pr_foods",pr_item_id:(r==null?void 0:r.id)||null})}})});try{g.value=!0;const e=await U.post("/api/po-foods/generate",{items_by_supplier:s,notes:j.value,ppn_enabled:a.ppn_enabled,discount_total_percent:a.discount_total_percent||0,discount_total_amount:a.discount_total_amount||0});w.fire("Success","PO has been generated successfully","success").then(()=>{window.location.href="/po-foods"})}catch(e){console.error("Error generating PO:",e),w.fire("Error","Failed to generate PO","error")}finally{g.value=!1}};function _e(s){return Number(s.small_conversion_qty||s.item&&s.item.small_conversion_qty||1)}function xe(s){return Number(s.medium_conversion_qty||s.item&&s.item.medium_conversion_qty||1)}function H(s,e){const o=_e(e),n=xe(e);let i=s*o,r=s*o*n;return{priceSmall:s,priceMedium:i,priceLarge:r}}function W(s){if(s.discount_percent>0&&s.price&&s.qty){const e=s.price*s.qty;s.discount_amount=e*(s.discount_percent/100)}else s.discount_percent===0&&(s.discount_amount=0)}function J(s){if(s.discount_amount>0&&s.price&&s.qty){const e=s.price*s.qty;s.discount_percent=s.discount_amount/e*100}else s.discount_amount===0&&(s.discount_percent=0)}function Y(s){if(!s.price||!s.qty)return 0;const e=s.price*s.qty,o=s.discount_amount||0;return e-o}function ye(){const s=R();a.discount_total_percent>0&&s>0?a.discount_total_amount=s*(a.discount_total_percent/100):a.discount_total_percent===0&&(a.discount_total_amount=0)}function fe(){const s=R();a.discount_total_amount>0&&s>0?a.discount_total_percent=a.discount_total_amount/s*100:a.discount_total_amount===0&&(a.discount_total_percent=0)}function _(s){return s?"Rp "+Number(s).toLocaleString("id-ID"):"Rp 0"}function be(){try{const s=sessionStorage.getItem("po-foods-filters");if(s){const e=JSON.parse(s),o=new URLSearchParams;e.search&&o.append("search",e.search),e.status&&o.append("status",e.status),e.from&&o.append("from",e.from),e.to&&o.append("to",e.to),e.perPage&&o.append("perPage",e.perPage);const n=o.toString(),i=n?`/po-foods?${n}`:"/po-foods";window.location.href=i}else window.location.href="/po-foods"}catch(s){console.error("Error restoring filters:",s),window.location.href="/po-foods"}}const X=()=>{let s=0;return Object.values(a.items_by_supplier).forEach(e=>{e.forEach(o=>{o.price&&o.qty&&(s+=Number(o.price)*Number(o.qty))})}),s},$=()=>{let s=0;return Object.values(a.items_by_supplier).forEach(e=>{e.forEach(o=>{if(o.price&&o.qty){const n=Number(o.price)*Number(o.qty),i=Number(o.discount_percent||0),r=Number(o.discount_amount||0);i>0?s+=n*(i/100):s+=r}})}),s},R=()=>X()-$(),A=()=>{const s=R(),e=Number(a.discount_total_percent||0),o=Number(a.discount_total_amount||0);return e>0?s*(e/100):o},B=()=>R()-A(),Z=()=>a.ppn_enabled?B()*.11:0,ge=()=>B()+Z(),he=async()=>{var s,e;for(const o of q.value)for(const n of o.items)try{const i=await U.get("/api/items/last-price",{params:{item_id:n.item_id||((s=n.item)==null?void 0:s.id),unit:n.unit}});a.items_by_supplier[n.id]&&a.items_by_supplier[n.id].forEach(r=>{r.last_price=i.data.last_price??0,r.min_price=i.data.min_price??0,r.max_price=i.data.max_price??0;const{priceMedium:p,priceLarge:c}=H(i.data.last_price??0,n);r.price_medium=p,r.price_large=c})}catch{console.warn(`Item ${n.item_id||((e=n.item)==null?void 0:e.id)} (${n.name}) not found in inventory, using default prices`),a.items_by_supplier[n.id]&&a.items_by_supplier[n.id].forEach(r=>{r.last_price=0,r.min_price=0,r.max_price=0,r.price_medium=0,r.price_large=0})}for(const o of C.value)for(const n of o.items)try{const i=await U.get("/api/items/last-price",{params:{item_id:n.item_id,unit:n.unit}});a.items_by_supplier[n.itemKey]&&a.items_by_supplier[n.itemKey].forEach(r=>{r.last_price=i.data.last_price??0,r.min_price=i.data.min_price??0,r.max_price=i.data.max_price??0;const{priceMedium:p,priceLarge:c}=H(i.data.last_price??0,n);r.price_medium=p,r.price_large=c})}catch{console.warn(`Item ${n.item_id} (${n.item_name}) not found in inventory, using default prices`),a.items_by_supplier[n.itemKey]&&a.items_by_supplier[n.itemKey].forEach(r=>{r.last_price=0,r.min_price=0,r.max_price=0,r.price_medium=0,r.price_large=0})}};return ke(async()=>{await oe(),await ne(),await ae(),await he()}),(s,e)=>(l(),Ce(Pe,{title:"Create Purchase Order Foods"},{header:te(()=>e[7]||(e[7]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Create Purchase Order Foods ",-1)])),default:te(()=>[t("div",qe,[t("div",Ve,[t("div",Ue,[t("div",Re,[t("div",{class:"mb-4"},[t("button",{onClick:be,class:"inline-flex items-center px-4 py-2 bg-gray-200 border border-transparent rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition ease-in-out duration-150"}," â† Kembali ")]),t("div",Ne,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Notes",-1)),x(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=o=>j.value=o),rows:"2",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[b,j.value]])]),t("div",Ee,[e[11]||(e[11]=t("h4",{class:"text-sm font-semibold text-yellow-800 mb-3"},"Diskon Total",-1)),t("div",Ie,[t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Diskon (%)",-1)),x(t("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=o=>y(a).discount_total_percent=o),min:"0",max:"100",step:"0.01",placeholder:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",onInput:ye},null,544),[[b,y(a).discount_total_percent,void 0,{number:!0}]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Diskon (Rp)",-1)),x(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=o=>y(a).discount_total_amount=o),min:"0",step:"0.01",placeholder:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500",onInput:fe},null,544),[[b,y(a).discount_total_amount,void 0,{number:!0}]])])])]),t("div",Oe,[x(t("input",{type:"checkbox",id:"ppnSwitch","onUpdate:modelValue":e[3]||(e[3]=o=>y(a).ppn_enabled=o),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[D,y(a).ppn_enabled]]),e[12]||(e[12]=t("label",{for:"ppnSwitch",class:"ml-2 text-sm text-gray-700"},"Include PPN (11%)",-1))]),t("div",je,[e[15]||(e[15]=t("h4",{class:"text-sm font-semibold text-blue-800 mb-3"},"Bulk Supplier Selection",-1)),t("div",$e,[t("div",Ae,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Pilih Supplier",-1)),M(y(T),{modelValue:P.value,"onUpdate:modelValue":e[4]||(e[4]=o=>P.value=o),options:N.value,searchable:!0,"close-on-select":!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih supplier untuk bulk assign...","track-by":"id",label:"name","preselect-first":!1},null,8,["modelValue","options"])]),t("div",Be,[t("button",{onClick:de,disabled:!P.value||f.value.length===0,class:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}," Terapkan ke Item Dipilih ",8,De),t("button",{onClick:ce,class:"px-4 py-2 bg-gray-500 text-white rounded-md text-sm font-medium hover:bg-gray-600"}," Clear ")])]),f.value.length>0?(l(),u("div",Me,[t("strong",null,d(f.value.length),1),e[14]||(e[14]=S(" item dipilih untuk bulk assign "))])):m("",!0)]),g.value?(l(),u("div",Te,e[16]||(e[16]=[t("svg",{class:"animate-spin h-8 w-8 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):(l(),u("div",Le,[t("div",Ke,[e[31]||(e[31]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4 border-b pb-2"},"Purchase Request (PR) Foods",-1)),(l(!0),u(v,null,k(Object.values(re.value),o=>(l(),u("div",{key:o.id,class:"mb-6 border rounded-lg overflow-hidden"},[t("div",{class:"bg-blue-50 px-4 py-3 flex justify-between items-center cursor-pointer hover:bg-blue-100 border-b",onClick:n=>L(o.id)},[t("div",Qe,[(l(),u("svg",{class:O(["w-5 h-5 mr-2 transition-transform",{"transform rotate-90":V.value[o.id]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[17]||(e[17]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2)),t("span",ze,d(o.name),1),t("span",Ge,"("+d(o.prs.length)+" PR)",1)])],8,Fe),V.value[o.id]?(l(),u("div",He,[(l(!0),u(v,null,k(o.prs,n=>(l(),u("div",{key:n.id,class:"border-b last:border-b-0"},[t("div",{class:"bg-gray-50 px-4 py-3 flex justify-between items-center cursor-pointer hover:bg-gray-100",onClick:i=>le(n.id)},[t("div",Je,[(l(),u("svg",{class:O(["w-5 h-5 mr-2 transition-transform",{"transform rotate-90":E.value[n.id]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[18]||(e[18]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2)),t("div",Ye,[t("span",Xe,d(n.number)+" - "+d(n.date),1),n.description?(l(),u("div",Ze,[e[19]||(e[19]=t("strong",null,"Notes:",-1)),S(" "+d(n.description),1)])):m("",!0)]),t("button",{onClick:se(i=>K(n.id),["stop"]),class:"ml-2 px-3 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded text-xs font-medium"}," Select All Items ",8,et)])],8,We),E.value[n.id]?(l(),u("div",tt,[t("div",st,[t("table",ot,[t("thead",nt,[t("tr",null,[t("th",rt,[t("input",{type:"checkbox",onChange:i=>K(n.id),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,40,it)]),e[20]||(e[20]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item",-1)),e[21]||(e[21]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Quantity",-1)),e[22]||(e[22]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Unit",-1)),e[23]||(e[23]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tgl Kedatangan",-1)),e[24]||(e[24]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Notes",-1)),e[25]||(e[25]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Supplier",-1)),e[26]||(e[26]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Price",-1)),e[27]||(e[27]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Diskon %",-1)),e[28]||(e[28]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Diskon (Rp)",-1)),e[29]||(e[29]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subtotal",-1)),e[30]||(e[30]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi",-1))])]),t("tbody",at,[(l(!0),u(v,null,k(n.items,i=>(l(),u(v,{key:i.id},[(l(!0),u(v,null,k(y(a).items_by_supplier[i.id],(r,p)=>(l(),u("tr",{key:p},[t("td",lt,[x(t("input",{type:"checkbox",value:i.id,"onUpdate:modelValue":e[5]||(e[5]=c=>f.value=c),class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,8,ut),[[D,f.value]])]),t("td",dt,d(i.name),1),t("td",ct,[x(t("input",{type:"number","onUpdate:modelValue":c=>r.qty=c,min:"0",step:"0.01",max:i.quantity-G(i.id,p),class:"w-20 border rounded px-2 py-1"},null,8,pt),[[b,r.qty]])]),t("td",mt,d(i.unit),1),t("td",_t,d(i.arrival_date?new Date(i.arrival_date).toLocaleDateString("id-ID"):"-"),1),t("td",xt,[i.note?(l(),u("div",yt,[t("span",ft,d(i.note),1)])):(l(),u("span",bt,"-"))]),t("td",gt,[M(y(T),{modelValue:r.supplier_id,"onUpdate:modelValue":c=>r.supplier_id=c,options:N.value,searchable:!0,"close-on-select":!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih atau cari supplier...","track-by":"id",label:"name","preselect-first":!1,class:"w-40"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("td",ht,[x(t("input",{type:"number","onUpdate:modelValue":c=>r.price=c,placeholder:"Enter price",class:"w-24 border rounded px-2 py-1"},null,8,vt),[[b,r.price]]),t("div",null,[t("small",wt," Last: "+d(_(r.last_price??0))+" | Min: "+d(_(r.min_price??0))+" | Max: "+d(_(r.max_price??0)),1)]),r.price_medium||r.price_large?(l(),u("div",kt,[r.price_medium?(l(),u("div",Ct,[S(" Medium: "+d(_(r.price_medium))+" ",1),i.medium_unit_name?(l(),u("span",Pt,"/ "+d(i.medium_unit_name),1)):m("",!0)])):m("",!0),r.price_large?(l(),u("div",St,[S(" Large: "+d(_(r.price_large))+" ",1),i.large_unit_name?(l(),u("span",qt,"/ "+d(i.large_unit_name),1)):m("",!0)])):m("",!0)])):m("",!0)]),t("td",Vt,[x(t("input",{type:"number","onUpdate:modelValue":c=>r.discount_percent=c,min:"0",max:"100",step:"0.01",placeholder:"%",class:"w-20 border rounded px-2 py-1",onInput:c=>W(r)},null,40,Ut),[[b,r.discount_percent,void 0,{number:!0}]])]),t("td",Rt,[x(t("input",{type:"number","onUpdate:modelValue":c=>r.discount_amount=c,min:"0",step:"0.01",placeholder:"Rp",class:"w-24 border rounded px-2 py-1",onInput:c=>J(r)},null,40,Nt),[[b,r.discount_amount,void 0,{number:!0}]])]),t("td",Et,d(_(Y(r))),1),t("td",It,[t("button",{type:"button",onClick:c=>Q(i.id),class:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded text-xs mr-1"},"Split",8,Ot),y(a).items_by_supplier[i.id].length>1?(l(),u("button",{key:0,type:"button",onClick:c=>z(i.id,p),class:"bg-red-100 hover:bg-red-200 text-red-700 px-2 py-1 rounded text-xs"},"Hapus",8,jt)):m("",!0)])]))),128))],64))),128))])])])])):m("",!0)]))),128))])):m("",!0)]))),128))]),t("div",$t,[e[44]||(e[44]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4 border-b pb-2"},"Request Order (RO) Supplier",-1)),(l(!0),u(v,null,k(Object.values(ie.value),o=>(l(),u("div",{key:o.id,class:"mb-6 border rounded-lg overflow-hidden"},[t("div",{class:"bg-green-50 px-4 py-3 flex justify-between items-center cursor-pointer hover:bg-green-100 border-b",onClick:n=>L(o.id)},[t("div",Bt,[(l(),u("svg",{class:O(["w-5 h-5 mr-2 transition-transform",{"transform rotate-90":V.value[o.id]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[32]||(e[32]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2)),t("span",Dt,d(o.name),1),t("span",Mt,"("+d(o.ros.length)+" RO)",1)])],8,At),V.value[o.id]?(l(),u("div",Tt,[(l(!0),u(v,null,k(o.ros,n=>(l(),u("div",{key:n.id,class:"border-b last:border-b-0"},[t("div",{class:"bg-gray-50 px-4 py-3 flex justify-between items-center cursor-pointer hover:bg-gray-100",onClick:i=>ue(n.id)},[t("div",Kt,[(l(),u("svg",{class:O(["w-5 h-5 mr-2 transition-transform",{"transform rotate-90":I.value[n.id]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[33]||(e[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2)),t("div",Ft,[t("span",Qt,d(n.order_number)+" - "+d(n.tanggal),1),t("span",zt,"("+d(n.outlet_name)+")",1)]),t("button",{onClick:se(i=>F(n.id),["stop"]),class:"ml-2 px-3 py-1 bg-green-100 hover:bg-green-200 text-green-700 rounded text-xs font-medium"}," Select All Items ",8,Gt)])],8,Lt),I.value[n.id]?(l(),u("div",Ht,[t("div",Wt,[t("table",Jt,[t("thead",Yt,[t("tr",null,[t("th",Xt,[t("input",{type:"checkbox",onChange:i=>F(n.id),class:"rounded border-gray-300 text-green-600 focus:ring-green-500"},null,40,Zt)]),e[34]||(e[34]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Item",-1)),e[35]||(e[35]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Quantity",-1)),e[36]||(e[36]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Unit",-1)),e[37]||(e[37]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Notes",-1)),e[38]||(e[38]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Supplier",-1)),e[39]||(e[39]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Price",-1)),e[40]||(e[40]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Diskon %",-1)),e[41]||(e[41]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Diskon (Rp)",-1)),e[42]||(e[42]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subtotal",-1)),e[43]||(e[43]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi",-1))])]),t("tbody",es,[(l(!0),u(v,null,k(n.items,i=>(l(),u(v,{key:i.id},[(l(!0),u(v,null,k(y(a).items_by_supplier[i.itemKey],(r,p)=>(l(),u("tr",{key:p},[t("td",ts,[x(t("input",{type:"checkbox",value:i.itemKey,"onUpdate:modelValue":e[6]||(e[6]=c=>f.value=c),class:"rounded border-gray-300 text-green-600 focus:ring-green-500"},null,8,ss),[[D,f.value]])]),t("td",os,d(i.item_name),1),t("td",ns,[x(t("input",{type:"number","onUpdate:modelValue":c=>r.qty=c,min:"0",step:"0.01",max:i.qty-G(i.itemKey,p),class:"w-20 border rounded px-2 py-1"},null,8,rs),[[b,r.qty]])]),t("td",is,d(i.unit),1),t("td",as,[i.note?(l(),u("div",ls,[t("span",us,d(i.note),1)])):(l(),u("span",ds,"-"))]),t("td",cs,[M(y(T),{modelValue:r.supplier_id,"onUpdate:modelValue":c=>r.supplier_id=c,options:N.value,searchable:!0,"close-on-select":!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Pilih atau cari supplier...","track-by":"id",label:"name","preselect-first":!1,class:"w-40"},null,8,["modelValue","onUpdate:modelValue","options"])]),t("td",ps,[x(t("input",{type:"number","onUpdate:modelValue":c=>r.price=c,placeholder:"Enter price",class:"w-24 border rounded px-2 py-1"},null,8,ms),[[b,r.price]]),t("div",null,[t("small",_s," Last: "+d(_(r.last_price??0))+" | Min: "+d(_(r.min_price??0))+" | Max: "+d(_(r.max_price??0)),1)]),r.price_medium||r.price_large?(l(),u("div",xs,[r.price_medium?(l(),u("div",ys,[S(" Medium: "+d(_(r.price_medium))+" ",1),i.medium_unit_name?(l(),u("span",fs,"/ "+d(i.medium_unit_name),1)):m("",!0)])):m("",!0),r.price_large?(l(),u("div",bs,[S(" Large: "+d(_(r.price_large))+" ",1),i.large_unit_name?(l(),u("span",gs,"/ "+d(i.large_unit_name),1)):m("",!0)])):m("",!0)])):m("",!0)]),t("td",hs,[x(t("input",{type:"number","onUpdate:modelValue":c=>r.discount_percent=c,min:"0",max:"100",step:"0.01",placeholder:"%",class:"w-20 border rounded px-2 py-1",onInput:c=>W(r)},null,40,vs),[[b,r.discount_percent,void 0,{number:!0}]])]),t("td",ws,[x(t("input",{type:"number","onUpdate:modelValue":c=>r.discount_amount=c,min:"0",step:"0.01",placeholder:"Rp",class:"w-24 border rounded px-2 py-1",onInput:c=>J(r)},null,40,ks),[[b,r.discount_amount,void 0,{number:!0}]])]),t("td",Cs,d(_(Y(r))),1),t("td",Ps,[t("button",{type:"button",onClick:c=>Q(i.itemKey),class:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded text-xs mr-1"},"Split",8,Ss),y(a).items_by_supplier[i.itemKey].length>1?(l(),u("button",{key:0,type:"button",onClick:c=>z(i.itemKey,p),class:"bg-red-100 hover:bg-red-200 text-red-700 px-2 py-1 rounded text-xs"},"Hapus",8,qs)):m("",!0)])]))),128))],64))),128))])])])])):m("",!0)]))),128))])):m("",!0)]))),128))]),t("div",Vs,[e[52]||(e[52]=t("h3",{class:"text-lg font-semibold mb-3"},"Total Calculation",-1)),t("div",Us,[t("div",Rs,[e[45]||(e[45]=t("span",{class:"text-gray-600"},"Subtotal:",-1)),t("span",Ns,d(_(X())),1)]),$()>0?(l(),u("div",Es,[e[46]||(e[46]=t("span",{class:"text-gray-600"},"Diskon per Item:",-1)),t("span",Is,"- "+d(_($())),1)])):m("",!0),t("div",Os,[e[47]||(e[47]=t("span",{class:"text-gray-600"},"Subtotal setelah Diskon Item:",-1)),t("span",js,d(_(R())),1)]),A()>0?(l(),u("div",$s,[e[48]||(e[48]=t("span",{class:"text-gray-600"},"Diskon Total:",-1)),t("span",As,"- "+d(_(A())),1)])):m("",!0),t("div",Bs,[e[49]||(e[49]=t("span",{class:"text-gray-600"},"Subtotal setelah Diskon Total:",-1)),t("span",Ds,d(_(B())),1)]),y(a).ppn_enabled?(l(),u("div",Ms,[e[50]||(e[50]=t("span",{class:"text-gray-600"},"PPN (11%):",-1)),t("span",Ts,d(_(Z())),1)])):m("",!0),t("div",Ls,[e[51]||(e[51]=t("span",{class:"text-lg font-semibold"},"Grand Total:",-1)),t("span",Ks,d(_(ge())),1)])])]),t("div",Fs,[t("button",{onClick:me,disabled:g.value,class:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring focus:ring-blue-300 disabled:opacity-25 transition"},[g.value?(l(),u("svg",zs,e[53]||(e[53]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):m("",!0),S(" "+d(g.value?"Generating...":"Generate PO"),1)],8,Qs)])]))])])])])]),_:1}))}},ao=Se(Gs,[["__scopeId","data-v-3f63c6f4"]]);export{ao as default};
