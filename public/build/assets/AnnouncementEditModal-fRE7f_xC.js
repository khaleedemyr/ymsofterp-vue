import{P as E,r as F,L as l,E as r,B as n,D as t,R as M,O as z,H as g,J as B,Q as c,F as f,M as b,G,N as m,I as V}from"./vendor-vue-g7iCcTkf.js";import{S as v}from"./app-BSTQjgZq.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";const N={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 transition-all"},D={class:"bg-white rounded-2xl shadow-2xl w-full max-w-xl mx-auto p-0 animate-fade-in"},O={class:"px-8 pt-8 pb-2"},I={key:0,class:"text-red-500 text-sm mt-1"},P=["onUpdate:modelValue"],H=["onUpdate:modelValue"],q={value:""},Q=["value"],R=["value"],$=["value"],K=["value"],W=["value"],X=["onClick"],Y={class:"bg-gray-50 px-6 py-4 flex justify-end rounded-b-2xl"},Z=["disabled"],tt={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},et={__name:"AnnouncementEditModal",props:{show:Boolean,announcement:Object,users:Array,jabatans:Array,divisis:Array,levels:Array,outlets:Array},emits:["close","success"],setup(u,{emit:A}){var k,w,C,_;const p=u,y=A,e=E({title:((k=p.announcement)==null?void 0:k.title)||"",content:((w=p.announcement)==null?void 0:w.content)||"",image:null,files:[],targets:((_=(C=p.announcement)==null?void 0:C.targets)==null?void 0:_.map(i=>({type:i.target_type,id:i.target_id})))||[]});console.log("Form initialized:",{title:e.title,content:e.content,targets:e.targets});const d=F(!1);async function x(){var i;if(d.value=!0,console.log("Form data before submit:",{title:e.title,content:e.content,targets:e.targets,hasTitle:!!e.title,titleLength:((i=e.title)==null?void 0:i.length)||0}),!e.title||e.title.trim()===""){v.fire({title:"Gagal!",text:"Judul harus diisi!",icon:"error",confirmButtonColor:"#3085d6"}),d.value=!1;return}if(!e.targets||e.targets.length===0){v.fire({title:"Gagal!",text:"Minimal harus ada satu target!",icon:"error",confirmButtonColor:"#3085d6"}),d.value=!1;return}try{await e.put(route("announcement.update",p.announcement.id),{onSuccess:()=>{v.fire({title:"Berhasil!",text:"Pengumuman berhasil diupdate!",icon:"success",confirmButtonColor:"#3085d6"}),y("success"),h()},onError:o=>{v.fire({title:"Gagal!",text:Object.values(o)[0],icon:"error",confirmButtonColor:"#3085d6"})}})}finally{d.value=!1}}function h(){y("close")}function S(){e.targets.push({type:"user",id:""})}function T(i){e.targets.splice(i,1)}function L(i){e.files=Array.from(i.target.files)}function U(i){e.image=i.target.files[0]}return(i,o)=>u.show?(n(),l("div",N,[t("div",D,[t("div",O,[o[9]||(o[9]=M('<div class="flex items-center gap-2 mb-6" data-v-c48cfa5b><svg class="w-7 h-7 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-c48cfa5b><path d="M12 20h9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c48cfa5b></path><path d="M16.5 3.5a2.121 2.121 0 113 3L7 19.5 3 21l1.5-4L16.5 3.5z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c48cfa5b></path></svg><h3 class="text-2xl font-bold text-gray-900" data-v-c48cfa5b>Edit Announcement</h3></div>',1)),t("form",{onSubmit:z(x,["prevent"]),class:"space-y-5"},[t("div",null,[o[2]||(o[2]=t("label",{class:"block text-sm font-medium text-gray-700"},"Judul *",-1)),g(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>c(e).title=a),required:"",class:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"Masukkan judul pengumuman"},null,512),[[B,c(e).title]]),!c(e).title||c(e).title.trim()===""?(n(),l("div",I," Judul harus diisi ")):r("",!0)]),t("div",null,[o[3]||(o[3]=t("label",{class:"block text-sm font-medium text-gray-700"},"Content",-1)),g(t("textarea",{"onUpdate:modelValue":o[1]||(o[1]=a=>c(e).content=a),rows:"4",class:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[B,c(e).content]])]),t("div",null,[o[4]||(o[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Gambar",-1)),t("input",{type:"file",onChange:U,accept:"image/*",class:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,32)]),t("div",null,[o[5]||(o[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"File Tambahan",-1)),t("input",{type:"file",onChange:L,multiple:"",class:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,32)]),t("div",null,[t("div",{class:"flex justify-between items-center"},[o[6]||(o[6]=t("label",{class:"block text-sm font-medium text-gray-700"},"Target",-1)),t("button",{type:"button",onClick:S,class:"text-sm text-blue-600 hover:text-blue-800"}," + Tambah Target ")]),(n(!0),l(f,null,b(c(e).targets,(a,j)=>(n(),l("div",{key:j,class:"mt-2 flex gap-2"},[g(t("select",{"onUpdate:modelValue":s=>a.type=s,class:"focus:ring-blue-500 focus:border-blue-500 block w-1/3 shadow-sm sm:text-sm border-gray-300 rounded-md"},o[7]||(o[7]=[M('<option value="user" data-v-c48cfa5b>User</option><option value="jabatan" data-v-c48cfa5b>Jabatan</option><option value="divisi" data-v-c48cfa5b>Divisi</option><option value="level" data-v-c48cfa5b>Level</option><option value="outlet" data-v-c48cfa5b>Outlet</option>',5)]),8,P),[[V,a.type]]),g(t("select",{"onUpdate:modelValue":s=>a.id=s,class:"focus:ring-blue-500 focus:border-blue-500 block w-2/3 shadow-sm sm:text-sm border-gray-300 rounded-md"},[t("option",q,"Pilih "+m(a.type),1),a.type==="user"?(n(!0),l(f,{key:0},b(u.users,s=>(n(),l("option",{key:s.id,value:s.id},m(s.nama_lengkap),9,Q))),128)):r("",!0),a.type==="jabatan"?(n(!0),l(f,{key:1},b(u.jabatans,s=>(n(),l("option",{key:s.id_jabatan,value:s.id_jabatan},m(s.nama_jabatan),9,R))),128)):r("",!0),a.type==="divisi"?(n(!0),l(f,{key:2},b(u.divisis,s=>(n(),l("option",{key:s.id,value:s.id},m(s.nama_divisi),9,$))),128)):r("",!0),a.type==="level"?(n(!0),l(f,{key:3},b(u.levels,s=>(n(),l("option",{key:s.id,value:s.id},m(s.nama_level),9,K))),128)):r("",!0),a.type==="outlet"?(n(!0),l(f,{key:4},b(u.outlets,s=>(n(),l("option",{key:s.id_outlet,value:s.id_outlet},m(s.nama_outlet),9,W))),128)):r("",!0)],8,H),[[V,a.id]]),t("button",{type:"button",onClick:s=>T(j),class:"text-red-600 hover:text-red-800"},o[8]||(o[8]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,X)]))),128))])],32)]),t("div",Y,[t("button",{type:"button",onClick:x,disabled:d.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[d.value?(n(),l("svg",tt,o[10]||(o[10]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):r("",!0),G(" "+m(d.value?"Menyimpan...":"Simpan"),1)],8,Z),t("button",{type:"button",onClick:h,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Batal ")])])])):r("",!0)}},it=J(et,[["__scopeId","data-v-c48cfa5b"]]);export{it as default};
