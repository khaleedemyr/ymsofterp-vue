import{r as v,c as k,w as se,a as ae,L as l,B as i,D as e,N as o,G as C,E as p,F as x,M as b,H as W,J as le,W as ie,V as ne}from"./vendor-vue-g7iCcTkf.js";import{S as c}from"./app-_bo91XrJ.js";import"./vendor-utils-CpgP2uT4.js";import"./vendor-charts-CuqD4wLC.js";const oe={class:"fixed inset-0 z-50 flex items-center justify-center"},re={class:"backdrop-blur-xl bg-white/10 border border-white/20 rounded-2xl p-4 md:p-6 max-w-7xl w-full mx-2 md:mx-4 max-h-[90vh] overflow-y-auto"},de={class:"flex items-center justify-between mb-6"},ue={class:"text-white/70 mt-1"},ce={class:"backdrop-blur-sm bg-white/5 border border-white/10 rounded-xl p-4 mb-6"},pe={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-white"},ve={class:"flex items-center space-x-2"},ge={class:"flex items-center space-x-2"},xe={class:"flex items-center space-x-2"},be={class:"backdrop-blur-sm bg-white/5 border border-white/10 rounded-xl p-4 mb-6"},me={key:0,class:"space-y-3"},fe={class:"flex items-center space-x-2"},he={class:"px-2 py-1 bg-blue-500/20 text-blue-200 rounded text-sm"},_e={key:0,class:"flex items-start space-x-2"},ye={class:"flex-1"},we={class:"flex flex-wrap gap-2"},ke={key:0,class:"px-2 py-1 bg-green-500/20 text-green-200 rounded text-sm"},je={key:2,class:"px-2 py-1 bg-green-500/20 text-green-200 rounded text-sm"},Pe={key:1,class:"flex items-start space-x-2"},De={class:"flex-1"},Se={class:"flex flex-wrap gap-2"},Ce={key:2,class:"flex items-start space-x-2"},Te={class:"flex-1"},Ae={class:"flex flex-wrap gap-2"},Ie={class:"flex items-center space-x-2 pt-2 border-t border-white/10"},Le={class:"px-2 py-1 bg-cyan-500/20 text-cyan-200 rounded text-sm"},Me={key:1,class:"text-white/60 text-center py-4"},Ne={class:"backdrop-blur-sm bg-white/5 border border-white/10 rounded-xl p-4 mb-6"},Be={class:"flex flex-col lg:flex-row items-start lg:items-center space-y-4 lg:space-y-0 lg:space-x-4"},Ee={class:"flex-1 w-full"},Oe={class:"relative"},Ue={class:"backdrop-blur-sm bg-white/5 border border-white/10 rounded-xl p-4 mb-6"},Ve={class:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 space-y-2 sm:space-y-0"},$e={class:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4"},Ge={key:0,class:"text-white/70 text-sm"},Fe={key:1,class:"text-white/70 text-sm"},He={class:"flex space-x-2"},Je={class:"overflow-x-auto"},Ke={class:"w-full text-white min-w-[1400px]"},We={class:"border-b border-white/20"},Re={class:"text-left py-4 px-3 w-16"},qe=["checked"],ze={class:"py-4 px-3"},Qe=["value","disabled"],Xe={class:"py-4 px-4"},Ye=["title"],Ze={class:"py-4 px-3"},et=["title"],tt={class:"py-4 px-4"},st=["title"],at={class:"py-4 px-4"},lt=["title"],it={class:"py-4 px-4"},nt=["title"],ot={class:"py-4 px-4"},rt=["title"],dt={class:"py-4 px-3"},ut=["title"],ct={class:"py-4 px-3"},pt={key:0,class:"inline-block px-3 py-1 bg-green-500/20 border border-green-500/30 rounded text-xs text-green-200 whitespace-nowrap"},vt={key:1,class:"inline-block px-3 py-1 bg-gray-500/20 border border-gray-500/30 rounded text-xs text-gray-200 whitespace-nowrap"},gt={key:0,class:"flex items-center justify-between mt-4"},xt={class:"text-white/70 text-sm"},bt={class:"flex items-center space-x-2"},mt=["disabled"],ft={class:"text-white px-3 py-1"},ht=["disabled"],_t={class:"flex items-center justify-end space-x-4"},yt=["disabled"],wt={key:0,class:"fas fa-spinner fa-spin mr-2"},kt={key:1,class:"fas fa-paper-plane mr-2"},j=20,Ct={__name:"InvitationModal",props:{training:Object,divisions:Array,jabatans:Array,levels:Array,invitedParticipants:Array},emits:["close","invited"],setup(g,{emit:R}){const m=g,L=R,f=v(!1),h=v(""),d=v([]),u=v(1),P=v([]),_=v(!1),a=v(null),T=v(""),M=k(()=>{let n=P.value;if(h.value){const t=h.value.toLowerCase();n=n.filter(r=>{var y,s,w;return((y=r.nama_lengkap)==null?void 0:y.toLowerCase().includes(t))||((s=r.email)==null?void 0:s.toLowerCase().includes(t))||((w=r.nik)==null?void 0:w.toLowerCase().includes(t))})}return n}),A=k(()=>M.value.length),D=k(()=>Math.ceil(A.value/j)),I=k(()=>{const n=(u.value-1)*j,t=n+j;return M.value.slice(n,t)}),N=k(()=>{const n=I.value.filter(t=>!S(t.id));return n.length>0&&n.every(t=>d.value.includes(t.id))}),S=n=>m.invitedParticipants.some(t=>t.user_id===n),q=n=>new Date(n).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),z=n=>{switch(n){case"all":return"Semua Divisi";case"single":return"Satu Divisi";case"multiple":return"Multi Divisi";default:return"Tidak Ditentukan"}},Q=async()=>{var n;if(!((n=m.training)!=null&&n.id)){console.error("No training ID provided");return}_.value=!0;try{console.log("Loading participants for training ID:",m.training.id);const t=await fetch(route("lms.schedules.relevant-participants",m.training.id));if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();console.log("API Response:",r),r.success?(P.value=r.participants,a.value=r.course,T.value=r.filter_applied,console.log("Loaded relevant participants:",r.participants.length),console.log("Filter applied:",r.filter_applied),console.log("Course targets:",r.course)):(console.error("API returned error:",r.message),P.value=[],a.value=null,T.value="")}catch(t){console.error("Error loading relevant participants:",t),P.value=[]}finally{_.value=!1}},B=()=>{const n=I.value.filter(t=>!S(t.id)).map(t=>t.id);d.value=[...new Set([...d.value,...n])]},E=()=>{d.value=[]},X=()=>{N.value?E():B()},Y=()=>{u.value>1&&u.value--},Z=()=>{u.value<D.value&&u.value++},ee=async()=>{if(d.value.length===0){c.fire({icon:"warning",title:"Peringatan",text:"Pilih peserta terlebih dahulu"});return}f.value=!0,console.log("=== SHOWING LOADING MODAL ==="),console.log("Swal object:",c),console.log("Swal.fire method:",typeof c.fire);try{c.fire({title:"Sabar Bu Ghea....",text:"Antosan sakedap Bu Ghea, Nuju loding",icon:"info",showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,backdrop:!0,didOpen:()=>{c.showLoading()}}),console.log("Loading modal should be visible now")}catch(n){console.error("Error showing loading modal:",n)}try{await ie.post(route("lms.schedules.invite",m.training.id),{user_ids:d.value},{onSuccess:()=>{c.close(),c.fire({icon:"success",title:"Berhasil",text:"Undangan berhasil dikirim"}),L("invited"),L("close")},onError:n=>{c.close(),c.fire({icon:"error",title:"Error",text:Object.values(n)[0]||"Terjadi kesalahan saat mengirim undangan"})}})}catch{c.close(),c.fire({icon:"error",title:"Error",text:"Terjadi kesalahan saat mengirim undangan"})}finally{f.value=!1}};return se([h],()=>{u.value=1}),ae(()=>{Q()}),(n,t)=>{var r,y;return i(),l("div",oe,[t[36]||(t[36]=e("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm"},null,-1)),e("div",re,[e("div",de,[e("div",null,[t[4]||(t[4]=e("h3",{class:"text-2xl font-bold text-white"},"Undang Peserta",-1)),e("p",ue,o((r=g.training.course)==null?void 0:r.title),1)]),e("button",{onClick:t[0]||(t[0]=s=>n.$emit("close")),class:"text-white/70 hover:text-white"},t[5]||(t[5]=[e("i",{class:"fas fa-times text-xl"},null,-1)]))]),e("div",ce,[e("div",pe,[e("div",ve,[t[6]||(t[6]=e("i",{class:"fas fa-calendar text-blue-400"},null,-1)),e("span",null,o(q(g.training.scheduled_date)),1)]),e("div",ge,[t[7]||(t[7]=e("i",{class:"fas fa-clock text-green-400"},null,-1)),e("span",null,o(g.training.start_time)+" - "+o(g.training.end_time),1)]),e("div",xe,[t[8]||(t[8]=e("i",{class:"fas fa-users text-purple-400"},null,-1)),e("span",null,o(g.training.participant_count)+" peserta terdaftar",1)])])]),e("div",be,[t[20]||(t[20]=e("h4",{class:"text-lg font-semibold text-white mb-3 flex items-center"},[e("i",{class:"fas fa-bullseye text-yellow-400 mr-2"}),C(" Target Training ")],-1)),a.value?(i(),l("div",me,[e("div",fe,[t[9]||(t[9]=e("i",{class:"fas fa-info-circle text-blue-400"},null,-1)),t[10]||(t[10]=e("span",{class:"text-white/80"},"Tipe Target:",-1)),e("span",he,o(z(a.value.target_type)),1)]),a.value.target_division_id||a.value.target_divisions&&a.value.target_divisions.length>0?(i(),l("div",_e,[t[12]||(t[12]=e("i",{class:"fas fa-building text-green-400 mt-1"},null,-1)),e("div",ye,[t[11]||(t[11]=e("span",{class:"text-white/80 block mb-1"},"Target Divisi:",-1)),e("div",we,[a.value.target_division_id&&a.value.target_divisions&&a.value.target_divisions.length>0?(i(),l("span",ke,o(((y=a.value.target_divisions[0])==null?void 0:y.nama_divisi)||"Divisi ID: "+a.value.target_division_id),1)):a.value.target_divisions&&a.value.target_divisions.length>0?(i(!0),l(x,{key:1},b(a.value.target_divisions,s=>(i(),l("span",{key:s.id,class:"px-2 py-1 bg-green-500/20 text-green-200 rounded text-sm"},o(s.nama_divisi),1))),128)):a.value.target_division_id?(i(),l("span",je," Divisi ID: "+o(a.value.target_division_id),1)):p("",!0)])])])):p("",!0),a.value.target_jabatan_ids&&a.value.target_jabatan_ids.length>0||a.value.target_jabatans&&a.value.target_jabatans.length>0?(i(),l("div",Pe,[t[14]||(t[14]=e("i",{class:"fas fa-user-tie text-purple-400 mt-1"},null,-1)),e("div",De,[t[13]||(t[13]=e("span",{class:"text-white/80 block mb-1"},"Target Jabatan:",-1)),e("div",Se,[a.value.target_jabatans&&a.value.target_jabatans.length>0?(i(!0),l(x,{key:0},b(a.value.target_jabatans,s=>(i(),l("span",{key:s.id_jabatan,class:"px-2 py-1 bg-purple-500/20 text-purple-200 rounded text-sm"},o(s.nama_jabatan),1))),128)):a.value.target_jabatan_ids&&a.value.target_jabatan_ids.length>0?(i(!0),l(x,{key:1},b(a.value.target_jabatan_ids,s=>(i(),l("span",{key:s,class:"px-2 py-1 bg-purple-500/20 text-purple-200 rounded text-sm"}," Jabatan ID: "+o(s),1))),128)):p("",!0)])])])):p("",!0),a.value.target_outlet_ids&&a.value.target_outlet_ids.length>0||a.value.target_outlets&&a.value.target_outlets.length>0?(i(),l("div",Ce,[t[16]||(t[16]=e("i",{class:"fas fa-store text-orange-400 mt-1"},null,-1)),e("div",Te,[t[15]||(t[15]=e("span",{class:"text-white/80 block mb-1"},"Target Outlet:",-1)),e("div",Ae,[a.value.target_outlets&&a.value.target_outlets.length>0?(i(!0),l(x,{key:0},b(a.value.target_outlets,s=>(i(),l("span",{key:s.id_outlet,class:"px-2 py-1 bg-orange-500/20 text-orange-200 rounded text-sm"},o(s.nama_outlet),1))),128)):a.value.target_outlet_ids&&a.value.target_outlet_ids.length>0?(i(!0),l(x,{key:1},b(a.value.target_outlet_ids,s=>(i(),l("span",{key:s,class:"px-2 py-1 bg-orange-500/20 text-orange-200 rounded text-sm"}," Outlet ID: "+o(s),1))),128)):p("",!0)])])])):p("",!0),e("div",Ie,[t[17]||(t[17]=e("i",{class:"fas fa-filter text-cyan-400"},null,-1)),t[18]||(t[18]=e("span",{class:"text-white/80"},"Filter yang diterapkan:",-1)),e("span",Le,o(T.value||"Sedang memuat..."),1)])])):(i(),l("div",Me,t[19]||(t[19]=[e("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),C(" Memuat informasi target training... ")])))]),e("div",Ne,[e("div",Be,[e("div",Ee,[t[22]||(t[22]=e("label",{class:"block text-white/70 text-sm mb-2"},"Cari Peserta",-1)),e("div",Oe,[W(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>h.value=s),type:"text",placeholder:"Nama, email, atau NIK...",class:"w-full bg-white/10 border border-white/20 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 pl-10"},null,512),[[le,h.value]]),t[21]||(t[21]=e("i",{class:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-white/50"},null,-1))])]),t[23]||(t[23]=e("div",{class:"flex items-center space-x-2 text-white/70 text-sm"},[e("i",{class:"fas fa-info-circle"}),e("span",{class:"hidden sm:inline"},"Peserta sudah difilter sesuai target training"),e("span",{class:"sm:hidden"},"Sudah difilter")],-1))])]),e("div",Ue,[e("div",Ve,[t[25]||(t[25]=e("h4",{class:"text-lg font-semibold text-white"},"Daftar Peserta",-1)),e("div",$e,[_.value?(i(),l("span",Ge,t[24]||(t[24]=[e("i",{class:"fas fa-spinner fa-spin mr-1"},null,-1),C("Memuat peserta... ")]))):(i(),l("span",Fe,o(d.value.length)+" dipilih",1)),e("div",He,[_.value?p("",!0):(i(),l("button",{key:0,onClick:B,class:"px-3 py-1 bg-blue-500/20 border border-blue-500/30 rounded-lg text-blue-200 hover:bg-blue-500/30 transition-all text-sm whitespace-nowrap"}," Pilih Semua ")),_.value?p("",!0):(i(),l("button",{key:1,onClick:E,class:"px-3 py-1 bg-gray-500/20 border border-gray-500/30 rounded-lg text-gray-200 hover:bg-gray-500/30 transition-all text-sm whitespace-nowrap"}," Hapus Pilihan "))])])]),e("div",Je,[e("table",Ke,[e("thead",null,[e("tr",We,[e("th",Re,[e("input",{type:"checkbox",checked:N.value,onChange:X,class:"rounded border-white/30 bg-white/10 text-blue-500 focus:ring-blue-500"},null,40,qe)]),t[26]||(t[26]=e("th",{class:"text-left py-4 px-4 w-56"},"Nama",-1)),t[27]||(t[27]=e("th",{class:"text-left py-4 px-3 w-32"},"NIK",-1)),t[28]||(t[28]=e("th",{class:"text-left py-4 px-4 w-64"},"Email",-1)),t[29]||(t[29]=e("th",{class:"text-left py-4 px-4 w-56"},"Divisi",-1)),t[30]||(t[30]=e("th",{class:"text-left py-4 px-4 w-56"},"Jabatan",-1)),t[31]||(t[31]=e("th",{class:"text-left py-4 px-4 w-64"},"Outlet",-1)),t[32]||(t[32]=e("th",{class:"text-left py-4 px-3 w-40"},"Level",-1)),t[33]||(t[33]=e("th",{class:"text-left py-4 px-3 w-40"},"Status",-1))])]),e("tbody",null,[(i(!0),l(x,null,b(I.value,s=>{var w,O,U,V,$,G,F,H,J,K;return i(),l("tr",{key:s.id,class:"border-b border-white/10 hover:bg-white/5"},[e("td",ze,[W(e("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":t[2]||(t[2]=te=>d.value=te),disabled:S(s.id),class:"rounded border-white/30 bg-white/10 text-blue-500 focus:ring-blue-500"},null,8,Qe),[[ne,d.value]])]),e("td",Xe,[e("div",{class:"font-medium truncate",title:s.nama_lengkap},o(s.nama_lengkap),9,Ye)]),e("td",Ze,[e("div",{class:"text-sm truncate",title:s.nik||"-"},o(s.nik||"-"),9,et)]),e("td",tt,[e("div",{class:"text-sm truncate",title:s.email},o(s.email),9,st)]),e("td",at,[e("div",{class:"text-sm truncate",title:((w=s.divisi)==null?void 0:w.nama_divisi)||"-"},o(((O=s.divisi)==null?void 0:O.nama_divisi)||"-"),9,lt)]),e("td",it,[e("div",{class:"text-sm truncate",title:((U=s.jabatan)==null?void 0:U.nama_jabatan)||"-"},o(((V=s.jabatan)==null?void 0:V.nama_jabatan)||"-"),9,nt)]),e("td",ot,[e("div",{class:"text-sm truncate",title:(($=s.outlet)==null?void 0:$.nama_outlet)||"-"},o(((G=s.outlet)==null?void 0:G.nama_outlet)||"-"),9,rt)]),e("td",dt,[e("div",{class:"text-sm truncate",title:((H=(F=s.jabatan)==null?void 0:F.level)==null?void 0:H.nama_level)||"-"},o(((K=(J=s.jabatan)==null?void 0:J.level)==null?void 0:K.nama_level)||"-"),9,ut)]),e("td",ct,[S(s.id)?(i(),l("span",pt," Sudah Diundang ")):(i(),l("span",vt," Belum Diundang "))])])}),128))])])]),D.value>1?(i(),l("div",gt,[e("div",xt," Menampilkan "+o((u.value-1)*j+1)+" - "+o(Math.min(u.value*j,A.value))+" dari "+o(A.value)+" peserta ",1),e("div",bt,[e("button",{onClick:Y,disabled:u.value===1,class:"px-3 py-1 bg-white/10 border border-white/20 rounded text-white disabled:opacity-50 disabled:cursor-not-allowed"},t[34]||(t[34]=[e("i",{class:"fas fa-chevron-left"},null,-1)]),8,mt),e("span",ft,o(u.value)+" / "+o(D.value),1),e("button",{onClick:Z,disabled:u.value===D.value,class:"px-3 py-1 bg-white/10 border border-white/20 rounded text-white disabled:opacity-50 disabled:cursor-not-allowed"},t[35]||(t[35]=[e("i",{class:"fas fa-chevron-right"},null,-1)]),8,ht)])])):p("",!0)]),e("div",_t,[e("button",{onClick:t[3]||(t[3]=s=>n.$emit("close")),class:"px-6 py-3 bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl text-white font-semibold hover:bg-white/30 transition-all"}," Batal "),e("button",{onClick:ee,disabled:d.value.length===0||f.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl font-semibold hover:from-blue-600 hover:to-blue-700 transition-all disabled:opacity-50"},[f.value?(i(),l("i",wt)):(i(),l("i",kt)),C(" "+o(f.value?"Mengirim Undangan...":`Kirim Undangan (${d.value.length})`),1)],8,yt)])])])}}};export{Ct as default};
